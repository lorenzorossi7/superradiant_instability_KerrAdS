    // compute independent residuals of the AdS4D system
    if (ct!=0)
    {
        //(NOTE: for t>t0, have cycled time sequence np1,n,nm1 to time sequence n,nm1,np1,
        // so here, time level n is the most advanced time level)  

    	if ((add_perturb_postt0)&&(ct<=perturb_finalt)&&((fabs(amp_Y)>pow(10.0,-10))||(fabs(amp_V)>pow(10.0,-10))))
	    {
	    	if (floor(ct/perturb_deltat)>floor((ct-dt)/perturb_deltat))
	    	{
	    		if (add_perturb_t0) {count_perturb_tsteps=floor(ct/perturb_deltat)+1;}
	    		if (!add_perturb_t0) {count_perturb_tsteps=floor(ct/perturb_deltat);}
	
        		if (my_rank==0) 
        		{
        			printf("At time T=%lf - before saving output and moving to the next time step\n"
        				   "Adding l=2,m=2 spherical harmonics perturbations to gb_n's\n"
        				   "for the %i-th time\n"
        			   	   "WARNING: adding constraint-violating perturbations\n",ct,count_perturb_tsteps);
        			printf("Amplitudes\n");
        			printf("amp_Y=%lf,amp_V=%lf\n",amp_Y,amp_V);
        			printf("===============================================================\n\n");
        		}
	
        		sph_harm_perturb_(phi1_n,
        				gb_tt_n,
                        gb_tx_n,
                        gb_ty_n,
                        gb_tz_n,
                        gb_xx_n,
                        gb_xy_n,
                        gb_xz_n,
                        gb_yy_n,
                        gb_yz_n,
                        gb_zz_n,
                        &amp_Y,&amp_V,
                    	&AdS_L,x,y,z,&dt,chr,&AMRD_ex,&Nx,&Ny,&Nz);
	
				//for (i=0; i<Nx; i++)
				//{    
				//	for (j=0; j<Ny; j++)
				//	{ 
				//	   	for (k=0; k<Nz; k++)
				//	    {  
				//			if (sqrt(x[i]*x[i]+y[j]*y[j]+z[k]*z[k])<0.4)
				//		    {   
				//				ind=i+Nx*(j+Ny*k);
				//				printf("POST-boost_perturb\n");
				//				printf("i=%i,j=%i,k=%i,Nx=%i,Ny=%i,Nz=%i,x[i]=%lf,y[j]=%lf,z[k]=%lf,rho=%lf\n"
				//				       ,i,j,k,Nx,Ny,Nz,x[i],y[j],z[k],sqrt(x[i]*x[i]+y[j]*y[j]+z[k]*z[k]));
				//				printf("phi1_nm1[ind]=%lf,phi1_n[ind]=%lf,phi1_np1[ind]=%lf\n",phi1_nm1[ind],phi1_n[ind],phi1_np1[ind]);
				//				printf("phi1_t_n[ind]=%lf\n",phi1_t_n[ind]);
				//				printf("gb_tt_nm1[ind]=%lf,gb_tt_n[ind]=%lf,gb_tt_np1[ind]=%lf\n",gb_tt_nm1[ind],gb_tt_n[ind],gb_tt_np1[ind]);
				//			}
				//	    }
				//	}
				//} 
				//
				//   	    MPI_Barrier(MPI_COMM_WORLD);
				//    if (my_rank==0) {printf("POST-boost_perturb\n"); fflush(stdout); }
	
	    	}
	    }

	    if (g_L==Lc)
        {
			//we save here the values of the Kretschmann scalar at the centre of the grid at times greater than 0, computed at the end of g_evo_opt //The value of the Kretschmann scalar at the centre of the grid at t=0 is saved in pre_io_calc.  
		    if (output_kretschcentregrid)
		    {
		        *lkretschcentregrid0= *kretschcentregrid;
		    }
	
		    if ((lsteps%AMRD_save_ivec0[3]==0)&&(lsteps!=0))
	   		{
	            if (output_kretsch && output_kretschcentregrid)
	            {
	                MPI_Allreduce((lkretschcentregrid0),(maxkretschcentregrid0),1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                MPI_Allreduce((lkretschcentregrid0),(minkretschcentregrid0),1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                if (uniSize>1)
	                {
	                    *kretschcentregrid0=*maxkretschcentregrid0+*minkretschcentregrid0;
	                }
	                else
	                {
	                    *kretschcentregrid0=*maxkretschcentregrid0;
	                }
	                if (my_rank==0)
	                {
	                    // save kretschcentregrid as ascii
	                    FILE *fp;
	                    size_name = snprintf(NULL, 0, "%st_kretschcentregrid.txt",AMRD_save_tag) + 1;
    					name = malloc(size_name); 
	                    sprintf(name,"%st_kretschcentregrid.txt",AMRD_save_tag);
	                    fp = fopen(name, "a+");
	                    fprintf(fp,"%24.16e %24.16e \n",ct,*kretschcentregrid0);
	                    fclose(fp);
	                    free(name);
	                }
	            } 
	        }//closes condition on (lsteps%AMRD_save_ivec0[3]==0)&&(lsteps!=0)
	    }//closes condition on g_L==Lc

		if ((g_L==bdy_L) && (fabs(coarse_t-ct)<pow(10,-10)))
	    {

	    	if (my_rank==0) {printf("\nOn level grid L=%i, at time ct=%lf, coarse time=%lf (coarse time step=%i)\n",g_L,ct,coarse_t,lsteps);}
	
		    if (output_bdyquantities)
		    {
    			calc_leadordcoeff_phi1_(leadordcoeff_phi1,
               		phi1_n,phi1_nm1,phi1_np1,
               		x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
            	calc_quasiset_ll_(
                        	quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
                        	quasiset_chichi_ll,quasiset_chixi_ll,
                        	quasiset_xixi_ll,
                        	quasiset_tracell,
                        	quasiset_massdensityll,
                            quasiset_angmomdensityxll,
                            quasiset_angmomdensityyll,
                            quasiset_angmomdensityzll,
                        	gb_tt_n,gb_tt_nm1,gb_tt_np1,
                        	gb_tx_n,gb_tx_nm1,gb_tx_np1,
                        	gb_ty_n,gb_ty_nm1,gb_ty_np1,
                        	gb_tz_n,gb_tz_nm1,gb_tz_np1,
                        	gb_xx_n,gb_xx_nm1,gb_xx_np1,
                        	gb_xy_n,gb_xy_nm1,gb_xy_np1,
                        	gb_xz_n,gb_xz_nm1,gb_xz_np1,
                        	gb_yy_n,gb_yy_nm1,gb_yy_np1,
                        	gb_yz_n,gb_yz_nm1,gb_yz_np1,
                        	gb_zz_n,gb_zz_nm1,gb_zz_np1,
                        	x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width,
                        	&ief_bh_r0,&a_rot0,&kerrads_background); 

				if ((lsteps%AMRD_save_ivec0[3]==0)&&(lsteps!=0))
	        	{

						//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: pre_freepts extrap\n"); fflush(stdout);}
		            //FREE POINTS EXTRAPOLATION
		        	if (bdy_extrap_freepts)
		        	{   
	
		        		//EXTRAPOLATION WITH FIRST SET OF PARAMETERS (denoted by index 1 at the end)
	
		        		//FIRST ORDER EXTRAPOLATION
		            	if (output_bdy_extraporder1_paramset1)
	            		{
							bdy_extrap_order=1;
	
							//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
							if (rad_extrap)
		                	{
	    	            		if (my_rank==0) printf("%i-th order radial extrapolation of boundary quantities using paramset1 parameters - saved in freepts_extraporder1_paramset1*.txt files\n",bdy_extrap_order);
	        	        		nexttobdypoints_radextrap_(chrbdy_freepts_extraporder1_paramset1,&numbdypoints_freepts_extraporder1_paramset1,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset1,&half_steps_from_bdy_int_paramset1,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	            	    	}
	                		else
	                		{
	                			nexttobdypoints_freepts_(chrbdy_freepts_extraporder1_paramset1,&numbdypoints_freepts_extraporder1_paramset1,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset1,&half_steps_from_bdy_int_paramset1,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                		}
	
								//MPI_Barrier(MPI_COMM_WORLD);
								//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset1 - POST COMPUTE NUMBER OF BOUNDARY QUANTITIES   \n"); fflush(stdout);}
	
	                		//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_freepts_extraporder1_paramset1 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_freepts_extraporder1_paramset1 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_freepts_extraporder1_paramset1,1,MPI_INT,vecbdypoints_freepts_extraporder1_paramset1,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_freepts_extraporder1_paramset1,&basenumbdypoints_freepts_extraporder1_paramset1,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_freepts_extraporder1_paramset1=%i\n",numbdypoints_freepts_extraporder1_paramset1);
	                        //fflush(stdout); 
	                        quasiset_tt_freepts_extraporder1_paramset1              = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_tchi_freepts_extraporder1_paramset1            = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_txi_freepts_extraporder1_paramset1             = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_chichi_freepts_extraporder1_paramset1          = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_chixi_freepts_extraporder1_paramset1           = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_xixi_freepts_extraporder1_paramset1            = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_trace_freepts_extraporder1_paramset1           = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_massdensity_freepts_extraporder1_paramset1     = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx_freepts_extraporder1_paramset1  = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy_freepts_extraporder1_paramset1  = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz_freepts_extraporder1_paramset1  = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        bdyphi_freepts_extraporder1_paramset1                   = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));   
	                        xpbdy_freepts_extraporder1_paramset1               = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        ypbdy_freepts_extraporder1_paramset1               = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        zpbdy_freepts_extraporder1_paramset1               = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));  
	                       	x_outermostpt_freepts_extraporder1_paramset1            = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                       	y_outermostpt_freepts_extraporder1_paramset1            = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                       	z_outermostpt_freepts_extraporder1_paramset1            = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real)); 
	
	                        lquasiset_tt0_freepts_extraporder1_paramset1            = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_tchi0_freepts_extraporder1_paramset1          = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_txi0_freepts_extraporder1_paramset1           = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_chichi0_freepts_extraporder1_paramset1        = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_chixi0_freepts_extraporder1_paramset1         = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_xixi0_freepts_extraporder1_paramset1          = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_trace0_freepts_extraporder1_paramset1         = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_massdensity0_freepts_extraporder1_paramset1   = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityx0_freepts_extraporder1_paramset1= malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityy0_freepts_extraporder1_paramset1= malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityz0_freepts_extraporder1_paramset1= malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lbdyphi0_freepts_extraporder1_paramset1                 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));   
	                        maxquasiset_tt0_freepts_extraporder1_paramset1          = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_tchi0_freepts_extraporder1_paramset1        = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_txi0_freepts_extraporder1_paramset1         = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_chichi0_freepts_extraporder1_paramset1      = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_chixi0_freepts_extraporder1_paramset1       = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_xixi0_freepts_extraporder1_paramset1        = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_trace0_freepts_extraporder1_paramset1       = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_massdensity0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityx0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityy0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityz0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxbdyphi0_freepts_extraporder1_paramset1               = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));   
	                        minquasiset_tt0_freepts_extraporder1_paramset1          = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_tchi0_freepts_extraporder1_paramset1        = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_txi0_freepts_extraporder1_paramset1         = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_chichi0_freepts_extraporder1_paramset1      = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_chixi0_freepts_extraporder1_paramset1       = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_xixi0_freepts_extraporder1_paramset1        = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_trace0_freepts_extraporder1_paramset1       = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_massdensity0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityx0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityy0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityz0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minbdyphi0_freepts_extraporder1_paramset1               = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));   
	                        quasiset_tt0_freepts_extraporder1_paramset1             = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_tchi0_freepts_extraporder1_paramset1           = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_txi0_freepts_extraporder1_paramset1            = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_chichi0_freepts_extraporder1_paramset1         = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_chixi0_freepts_extraporder1_paramset1          = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_xixi0_freepts_extraporder1_paramset1           = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_trace0_freepts_extraporder1_paramset1          = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_massdensity0_freepts_extraporder1_paramset1    = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        AdS_mass0_freepts_extraporder1_paramset1                = malloc(sizeof(real));
	                        bdyphi0_freepts_extraporder1_paramset1                  = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));    
	                        xpbdy0_freepts_extraporder1_paramset1              = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        ypbdy0_freepts_extraporder1_paramset1              = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        zpbdy0_freepts_extraporder1_paramset1              = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));   
	                       	x_outermostpt0_freepts_extraporder1_paramset1           = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                       	y_outermostpt0_freepts_extraporder1_paramset1           = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                       	z_outermostpt0_freepts_extraporder1_paramset1           = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real)); 
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_freepts_extraporder1_paramset1=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_freepts_extraporder1_paramset1=vecbdypoints_freepts_extraporder1_paramset1[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_freepts_extraporder1_paramset1=is_bdy_freepts_extraporder1_paramset1+vecbdypoints_freepts_extraporder1_paramset1[j];
	                            }
	                            ie_bdy_freepts_extraporder1_paramset1=is_bdy_freepts_extraporder1_paramset1+vecbdypoints_freepts_extraporder1_paramset1[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_freepts_extraporder1_paramset1[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_freepts_extraporder1_paramset1[i]=dsplsbdypoints_freepts_extraporder1_paramset1[i]+vecbdypoints_freepts_extraporder1_paramset1[j];
	                                }
	                            }
	                        }   
	
	                        if (rad_extrap)
							{
								xyz_bdy_out_radextrap_(xpbdy_freepts_extraporder1_paramset1,ypbdy_freepts_extraporder1_paramset1,zpbdy_freepts_extraporder1_paramset1,
	                        						x_outermostpt_freepts_extraporder1_paramset1,y_outermostpt_freepts_extraporder1_paramset1,z_outermostpt_freepts_extraporder1_paramset1,
	                        						chrbdy_freepts_extraporder1_paramset1,&numbdypoints_freepts_extraporder1_paramset1,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
							}
	                    	else
	                    	{
	                        	xyz_extrap_outermost_(xpbdy_freepts_extraporder1_paramset1,ypbdy_freepts_extraporder1_paramset1,zpbdy_freepts_extraporder1_paramset1,
	                        						x_outermostpt_freepts_extraporder1_paramset1,y_outermostpt_freepts_extraporder1_paramset1,z_outermostpt_freepts_extraporder1_paramset1,
	                        						chrbdy_freepts_extraporder1_paramset1,&numbdypoints_freepts_extraporder1_paramset1,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	                        }
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_freepts_extraporder1_paramset1,numbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,xpbdy0_freepts_extraporder1_paramset1,vecbdypoints_freepts_extraporder1_paramset1,dsplsbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_freepts_extraporder1_paramset1,numbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,ypbdy0_freepts_extraporder1_paramset1,vecbdypoints_freepts_extraporder1_paramset1,dsplsbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_freepts_extraporder1_paramset1,numbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,zpbdy0_freepts_extraporder1_paramset1,vecbdypoints_freepts_extraporder1_paramset1,dsplsbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_freepts_extraporder1_paramset1,numbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,x_outermostpt0_freepts_extraporder1_paramset1,vecbdypoints_freepts_extraporder1_paramset1,dsplsbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_freepts_extraporder1_paramset1,numbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,y_outermostpt0_freepts_extraporder1_paramset1,vecbdypoints_freepts_extraporder1_paramset1,dsplsbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_freepts_extraporder1_paramset1,numbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,z_outermostpt0_freepts_extraporder1_paramset1,vecbdypoints_freepts_extraporder1_paramset1,dsplsbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_freepts_extraporder1_paramset1 = malloc(sizeof(real));
	                                chiextrap0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                                xiextrap0_freepts_extraporder1_paramset1  = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_freepts_extraporder1_paramset1,chiextrap0_freepts_extraporder1_paramset1,xiextrap0_freepts_extraporder1_paramset1,xpbdy0_freepts_extraporder1_paramset1,ypbdy0_freepts_extraporder1_paramset1,zpbdy0_freepts_extraporder1_paramset1,&basenumbdypoints_freepts_extraporder1_paramset1);  
	                                basebdy_Nchi_freepts_extraporder1_paramset1=0;//initialize
	                                basebdy_Nxi_freepts_extraporder1_paramset1=0; //initialize
	                                bdyn_(&basebdy_Nchi_freepts_extraporder1_paramset1,&basebdy_Nxi_freepts_extraporder1_paramset1,&basenumbdypoints_freepts_extraporder1_paramset1,chiextrap0_freepts_extraporder1_paramset1,xiextrap0_freepts_extraporder1_paramset1);  
	                                rhobdy0_freepts_extraporder1_paramset1 = malloc(sizeof(real));
	                                chibdy0_freepts_extraporder1_paramset1 = malloc(basebdy_Nchi_freepts_extraporder1_paramset1*sizeof(real));
	                                xibdy0_freepts_extraporder1_paramset1  = malloc(basebdy_Nxi_freepts_extraporder1_paramset1*sizeof(real));   
	                            }
	                        }
	
	
							if (rad_extrap)
	                		{
	
	                			bdyphi_radextrap_(bdyphi_freepts_extraporder1_paramset1,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder1_paramset1,ypbdy_freepts_extraporder1_paramset1,zpbdy_freepts_extraporder1_paramset1,
	                                        chrbdy_freepts_extraporder1_paramset1,&numbdypoints_freepts_extraporder1_paramset1,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        	quasiset_radextrap_(quasiset_tt_freepts_extraporder1_paramset1,quasiset_tchi_freepts_extraporder1_paramset1,quasiset_txi_freepts_extraporder1_paramset1,
	                                quasiset_chichi_freepts_extraporder1_paramset1,quasiset_chixi_freepts_extraporder1_paramset1,
	                                quasiset_xixi_freepts_extraporder1_paramset1,
	                                quasiset_trace_freepts_extraporder1_paramset1,
	                                quasiset_massdensity_freepts_extraporder1_paramset1,
	                                quasiset_angmomdensityx_freepts_extraporder1_paramset1,
	                                quasiset_angmomdensityy_freepts_extraporder1_paramset1,
	                                quasiset_angmomdensityz_freepts_extraporder1_paramset1,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder1_paramset1,ypbdy_freepts_extraporder1_paramset1,zpbdy_freepts_extraporder1_paramset1,
	                                chrbdy_freepts_extraporder1_paramset1,&numbdypoints_freepts_extraporder1_paramset1,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                		}
	                		else
	                		{   
	                        	extrap_bdyphi_freepts_(bdyphi_freepts_extraporder1_paramset1,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder1_paramset1,ypbdy_freepts_extraporder1_paramset1,zpbdy_freepts_extraporder1_paramset1,
	                                        chrbdy_freepts_extraporder1_paramset1,&numbdypoints_freepts_extraporder1_paramset1,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        	extrap_quasiset_freepts_(quasiset_tt_freepts_extraporder1_paramset1,quasiset_tchi_freepts_extraporder1_paramset1,quasiset_txi_freepts_extraporder1_paramset1,
	                                quasiset_chichi_freepts_extraporder1_paramset1,quasiset_chixi_freepts_extraporder1_paramset1,
	                                quasiset_xixi_freepts_extraporder1_paramset1,
	                                quasiset_trace_freepts_extraporder1_paramset1,
	                                quasiset_massdensity_freepts_extraporder1_paramset1,
	                                quasiset_angmomdensityx_freepts_extraporder1_paramset1,
	                                quasiset_angmomdensityy_freepts_extraporder1_paramset1,
	                                quasiset_angmomdensityz_freepts_extraporder1_paramset1,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder1_paramset1,ypbdy_freepts_extraporder1_paramset1,zpbdy_freepts_extraporder1_paramset1,
	                                chrbdy_freepts_extraporder1_paramset1,&numbdypoints_freepts_extraporder1_paramset1,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                        } 
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_freepts_extraporder1_paramset1; i<ie_bdy_freepts_extraporder1_paramset1; i++)
	                        {
	                            lquasiset_tt0_freepts_extraporder1_paramset1           [i] = quasiset_tt_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_tchi0_freepts_extraporder1_paramset1         [i] = quasiset_tchi_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_txi0_freepts_extraporder1_paramset1          [i] = quasiset_txi_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_chichi0_freepts_extraporder1_paramset1       [i] = quasiset_chichi_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_chixi0_freepts_extraporder1_paramset1        [i] = quasiset_chixi_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_xixi0_freepts_extraporder1_paramset1         [i] = quasiset_xixi_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_trace0_freepts_extraporder1_paramset1        [i] = quasiset_trace_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_massdensity0_freepts_extraporder1_paramset1  [i] = quasiset_massdensity_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_angmomdensityx0_freepts_extraporder1_paramset1 [i] = quasiset_angmomdensityx_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_angmomdensityy0_freepts_extraporder1_paramset1 [i] = quasiset_angmomdensityy_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_angmomdensityz0_freepts_extraporder1_paramset1 [i] = quasiset_angmomdensityz_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lbdyphi0_freepts_extraporder1_paramset1                [i] = bdyphi_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                        }   

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset1 - POST PERFORM EXTRAPOLATION BOUNDARY QUANTITIES   \n"); fflush(stdout);}
	
							//PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder1_paramset1,          maxquasiset_tt0_freepts_extraporder1_paramset1,          basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder1_paramset1,        maxquasiset_tchi0_freepts_extraporder1_paramset1,        basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder1_paramset1,         maxquasiset_txi0_freepts_extraporder1_paramset1,         basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder1_paramset1,      maxquasiset_chichi0_freepts_extraporder1_paramset1,      basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder1_paramset1,       maxquasiset_chixi0_freepts_extraporder1_paramset1,       basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder1_paramset1,        maxquasiset_xixi0_freepts_extraporder1_paramset1,        basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder1_paramset1,       maxquasiset_trace0_freepts_extraporder1_paramset1,       basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder1_paramset1, maxquasiset_massdensity0_freepts_extraporder1_paramset1, basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder1_paramset1, maxquasiset_angmomdensityx0_freepts_extraporder1_paramset1, basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder1_paramset1, maxquasiset_angmomdensityy0_freepts_extraporder1_paramset1, basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder1_paramset1, maxquasiset_angmomdensityz0_freepts_extraporder1_paramset1, basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder1_paramset1,               maxbdyphi0_freepts_extraporder1_paramset1,               basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder1_paramset1,          minquasiset_tt0_freepts_extraporder1_paramset1,          basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder1_paramset1,        minquasiset_tchi0_freepts_extraporder1_paramset1,        basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder1_paramset1,         minquasiset_txi0_freepts_extraporder1_paramset1,         basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder1_paramset1,      minquasiset_chichi0_freepts_extraporder1_paramset1,      basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder1_paramset1,       minquasiset_chixi0_freepts_extraporder1_paramset1,       basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder1_paramset1,        minquasiset_xixi0_freepts_extraporder1_paramset1,        basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder1_paramset1,       minquasiset_trace0_freepts_extraporder1_paramset1,       basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder1_paramset1, minquasiset_massdensity0_freepts_extraporder1_paramset1, basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder1_paramset1, minquasiset_angmomdensityx0_freepts_extraporder1_paramset1, basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder1_paramset1, minquasiset_angmomdensityy0_freepts_extraporder1_paramset1, basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder1_paramset1, minquasiset_angmomdensityz0_freepts_extraporder1_paramset1, basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder1_paramset1,               minbdyphi0_freepts_extraporder1_paramset1,               basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset1 - in PRINT BOUNDARY QUANTITIES - POST MPI_Allreduce   \n"); fflush(stdout);}

	                        for (i=0; i<basenumbdypoints_freepts_extraporder1_paramset1; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_freepts_extraporder1_paramset1          [i] = maxquasiset_tt0_freepts_extraporder1_paramset1          [i] + minquasiset_tt0_freepts_extraporder1_paramset1          [i];
	                                    quasiset_tchi0_freepts_extraporder1_paramset1        [i] = maxquasiset_tchi0_freepts_extraporder1_paramset1        [i] + minquasiset_tchi0_freepts_extraporder1_paramset1        [i];
	                                    quasiset_txi0_freepts_extraporder1_paramset1         [i] = maxquasiset_txi0_freepts_extraporder1_paramset1         [i] + minquasiset_txi0_freepts_extraporder1_paramset1         [i];
	                                    quasiset_chichi0_freepts_extraporder1_paramset1      [i] = maxquasiset_chichi0_freepts_extraporder1_paramset1      [i] + minquasiset_chichi0_freepts_extraporder1_paramset1      [i];
	                                    quasiset_chixi0_freepts_extraporder1_paramset1       [i] = maxquasiset_chixi0_freepts_extraporder1_paramset1       [i] + minquasiset_chixi0_freepts_extraporder1_paramset1       [i];
	                                    quasiset_xixi0_freepts_extraporder1_paramset1        [i] = maxquasiset_xixi0_freepts_extraporder1_paramset1        [i] + minquasiset_xixi0_freepts_extraporder1_paramset1        [i];
	                                    quasiset_trace0_freepts_extraporder1_paramset1       [i] = maxquasiset_trace0_freepts_extraporder1_paramset1       [i] + minquasiset_trace0_freepts_extraporder1_paramset1       [i];
	                                    quasiset_massdensity0_freepts_extraporder1_paramset1 [i] = maxquasiset_massdensity0_freepts_extraporder1_paramset1 [i] + minquasiset_massdensity0_freepts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityx0_freepts_extraporder1_paramset1 [i] + minquasiset_angmomdensityx0_freepts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityy0_freepts_extraporder1_paramset1 [i] + minquasiset_angmomdensityy0_freepts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityz0_freepts_extraporder1_paramset1 [i] + minquasiset_angmomdensityz0_freepts_extraporder1_paramset1 [i];
	                                    bdyphi0_freepts_extraporder1_paramset1               [i] = maxbdyphi0_freepts_extraporder1_paramset1               [i] + minbdyphi0_freepts_extraporder1_paramset1               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_freepts_extraporder1_paramset1          [i] = maxquasiset_tt0_freepts_extraporder1_paramset1          [i];
	                                    quasiset_tchi0_freepts_extraporder1_paramset1        [i] = maxquasiset_tchi0_freepts_extraporder1_paramset1        [i];
	                                    quasiset_txi0_freepts_extraporder1_paramset1         [i] = maxquasiset_txi0_freepts_extraporder1_paramset1         [i];
	                                    quasiset_chichi0_freepts_extraporder1_paramset1      [i] = maxquasiset_chichi0_freepts_extraporder1_paramset1      [i];
	                                    quasiset_chixi0_freepts_extraporder1_paramset1       [i] = maxquasiset_chixi0_freepts_extraporder1_paramset1       [i];
	                                    quasiset_xixi0_freepts_extraporder1_paramset1        [i] = maxquasiset_xixi0_freepts_extraporder1_paramset1        [i];
	                                    quasiset_trace0_freepts_extraporder1_paramset1       [i] = maxquasiset_trace0_freepts_extraporder1_paramset1       [i];
	                                    quasiset_massdensity0_freepts_extraporder1_paramset1 [i] = maxquasiset_massdensity0_freepts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityx0_freepts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityy0_freepts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityz0_freepts_extraporder1_paramset1 [i];
	                                    bdyphi0_freepts_extraporder1_paramset1               [i] = maxbdyphi0_freepts_extraporder1_paramset1               [i];
	                                }  
	                        }      

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset1 - in PRINT BOUNDARY QUANTITIES - PRE print   \n"); fflush(stdout);} 
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {     
	                            			size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder1_paramset1[j],ypbdy0_freepts_extraporder1_paramset1[j],zpbdy0_freepts_extraporder1_paramset1[j],j);
		                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder1_paramset1[j],ypbdy0_freepts_extraporder1_paramset1[j],zpbdy0_freepts_extraporder1_paramset1[j],j);
		                                    }
		                                    fclose(fp);
		                                    free(name);

		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder1_paramset1[j],ypbdy0_freepts_extraporder1_paramset1[j],zpbdy0_freepts_extraporder1_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }  

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset1 - in PRINT BOUNDARY QUANTITIES - post print xext   \n"); fflush(stdout);}  


	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder1_paramset1[j],y_outermostpt0_freepts_extraporder1_paramset1[j],z_outermostpt0_freepts_extraporder1_paramset1[j],j);
	                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder1_paramset1[j],y_outermostpt0_freepts_extraporder1_paramset1[j],z_outermostpt0_freepts_extraporder1_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder1_paramset1[j],y_outermostpt0_freepts_extraporder1_paramset1[j],z_outermostpt0_freepts_extraporder1_paramset1[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name);
	                                	}   
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset1 - in PRINT BOUNDARY QUANTITIES - post print xout   \n"); fflush(stdout);} 

	                                if(output_bdyphi)
	                                {
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder1_paramset1[j],j);
		                                    }
		                                    fclose(fp); 
		                                    free(name);
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder1_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                } 
	                                }    

	                                    // save quasiset_ll as ascii
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder1_paramset1[j],quasiset_tchi0_freepts_extraporder1_paramset1[j],quasiset_txi0_freepts_extraporder1_paramset1[j],quasiset_chichi0_freepts_extraporder1_paramset1[j],quasiset_chixi0_freepts_extraporder1_paramset1[j],quasiset_xixi0_freepts_extraporder1_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder1_paramset1[j],quasiset_tchi0_freepts_extraporder1_paramset1[j],quasiset_txi0_freepts_extraporder1_paramset1[j],quasiset_chichi0_freepts_extraporder1_paramset1[j],quasiset_chixi0_freepts_extraporder1_paramset1[j],quasiset_xixi0_freepts_extraporder1_paramset1[j],
	                                                    j_red);
	                                            //printf("%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                            //        ct,
	                                            //        quasiset_tt0_freepts_extraporder1_paramset1[j],quasiset_tchi0_freepts_extraporder1_paramset1[j],quasiset_txi0_freepts_extraporder1_paramset1[j],quasiset_chichi0_freepts_extraporder1_paramset1[j],quasiset_chixi0_freepts_extraporder1_paramset1[j],quasiset_xixi0_freepts_extraporder1_paramset1[j],
	                                            //        j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset1 - in PRINT BOUNDARY QUANTITIES - post print quasisetll  \n"); fflush(stdout);} 

	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_freepts_extraporder1_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_freepts_extraporder1_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {   
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_freepts_extraporder1_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);  
	                                    free(name); 
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_freepts_extraporder1_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {

		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
			                            	sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder1_paramset1[j],quasiset_angmomdensityy0_freepts_extraporder1_paramset1[j],quasiset_angmomdensityz0_freepts_extraporder1_paramset1[j],
		                                                    j);
		                                    }
		                                    fclose(fp);
		                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder1_paramset1[j],quasiset_angmomdensityy0_freepts_extraporder1_paramset1[j],quasiset_angmomdensityz0_freepts_extraporder1_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_freepts_extraporder1_paramset1=1;
	                                chibdy_xibdy_(chibdy0_freepts_extraporder1_paramset1,xibdy0_freepts_extraporder1_paramset1,xpbdy0_freepts_extraporder1_paramset1,ypbdy0_freepts_extraporder1_paramset1,zpbdy0_freepts_extraporder1_paramset1,&basenumbdypoints_freepts_extraporder1_paramset1,chiextrap0_freepts_extraporder1_paramset1,xiextrap0_freepts_extraporder1_paramset1,&basebdy_Nchi_freepts_extraporder1_paramset1,&basebdy_Nxi_freepts_extraporder1_paramset1);    
	                                doubleintegralonsphere_(AdS_mass0_freepts_extraporder1_paramset1,quasiset_massdensity0_freepts_extraporder1_paramset1,xpbdy0_freepts_extraporder1_paramset1,ypbdy0_freepts_extraporder1_paramset1,zpbdy0_freepts_extraporder1_paramset1,&basenumbdypoints_freepts_extraporder1_paramset1,rhobdy0_freepts_extraporder1_paramset1,chibdy0_freepts_extraporder1_paramset1,xibdy0_freepts_extraporder1_paramset1,&basebdy_Nchi_freepts_extraporder1_paramset1,&basebdy_Nxi_freepts_extraporder1_paramset1);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_%st_AdSmass.txt",AMRD_save_tag) + 1;
    								name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_freepts_extraporder1_paramset1);
	                                fclose(fp);
	                                free(name);
	                            }
	                        }

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset1 - POST PRINT BOUNDARY QUANTITIES   \n"); fflush(stdout);}

	                        free(vecbdypoints_freepts_extraporder1_paramset1);
	                        free(dsplsbdypoints_freepts_extraporder1_paramset1);
	                        free(quasiset_tt_freepts_extraporder1_paramset1);
	                        free(quasiset_tchi_freepts_extraporder1_paramset1);
	                        free(quasiset_txi_freepts_extraporder1_paramset1);
	                        free(quasiset_chichi_freepts_extraporder1_paramset1);
	                        free(quasiset_chixi_freepts_extraporder1_paramset1);
	                        free(quasiset_xixi_freepts_extraporder1_paramset1);
	                        free(quasiset_trace_freepts_extraporder1_paramset1);
	                        free(quasiset_massdensity_freepts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityx_freepts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityy_freepts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityz_freepts_extraporder1_paramset1);
	                        free(bdyphi_freepts_extraporder1_paramset1);  
	                        free(xpbdy_freepts_extraporder1_paramset1);
	                        free(ypbdy_freepts_extraporder1_paramset1);
	                        free(zpbdy_freepts_extraporder1_paramset1);   
	                       	free(x_outermostpt_freepts_extraporder1_paramset1);
	                       	free(y_outermostpt_freepts_extraporder1_paramset1);
	                       	free(z_outermostpt_freepts_extraporder1_paramset1);   
	
	                        free(lquasiset_tt0_freepts_extraporder1_paramset1);        
	                        free(lquasiset_tchi0_freepts_extraporder1_paramset1);
	                        free(lquasiset_txi0_freepts_extraporder1_paramset1);
	                        free(lquasiset_chichi0_freepts_extraporder1_paramset1);
	                        free(lquasiset_chixi0_freepts_extraporder1_paramset1);
	                        free(lquasiset_xixi0_freepts_extraporder1_paramset1);
	                        free(lquasiset_trace0_freepts_extraporder1_paramset1);
	                        free(lquasiset_massdensity0_freepts_extraporder1_paramset1);
	                        free(lquasiset_angmomdensityx0_freepts_extraporder1_paramset1);
	                        free(lquasiset_angmomdensityy0_freepts_extraporder1_paramset1);
	                        free(lquasiset_angmomdensityz0_freepts_extraporder1_paramset1);
	                        free(lbdyphi0_freepts_extraporder1_paramset1);      
	                        free(maxquasiset_tt0_freepts_extraporder1_paramset1);        
	                        free(maxquasiset_tchi0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_txi0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_chichi0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_chixi0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_xixi0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_trace0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_massdensity0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_angmomdensityx0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_angmomdensityy0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_angmomdensityz0_freepts_extraporder1_paramset1);
	                        free(maxbdyphi0_freepts_extraporder1_paramset1);    
	                        free(minquasiset_tt0_freepts_extraporder1_paramset1);
	                        free(minquasiset_tchi0_freepts_extraporder1_paramset1);
	                        free(minquasiset_txi0_freepts_extraporder1_paramset1);
	                        free(minquasiset_chichi0_freepts_extraporder1_paramset1);
	                        free(minquasiset_chixi0_freepts_extraporder1_paramset1);
	                        free(minquasiset_xixi0_freepts_extraporder1_paramset1);
	                        free(minquasiset_trace0_freepts_extraporder1_paramset1);
	                        free(minquasiset_massdensity0_freepts_extraporder1_paramset1);
	                        free(minquasiset_angmomdensityx0_freepts_extraporder1_paramset1);
	                        free(minquasiset_angmomdensityy0_freepts_extraporder1_paramset1);
	                        free(minquasiset_angmomdensityz0_freepts_extraporder1_paramset1);
	                        free(minbdyphi0_freepts_extraporder1_paramset1);    
	                        free(quasiset_tt0_freepts_extraporder1_paramset1);
	                        free(quasiset_tchi0_freepts_extraporder1_paramset1);
	                        free(quasiset_txi0_freepts_extraporder1_paramset1);
	                        free(quasiset_chichi0_freepts_extraporder1_paramset1);
	                        free(quasiset_chixi0_freepts_extraporder1_paramset1);
	                        free(quasiset_xixi0_freepts_extraporder1_paramset1);
	                        free(quasiset_trace0_freepts_extraporder1_paramset1);
	                        free(quasiset_massdensity0_freepts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityx0_freepts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityy0_freepts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityz0_freepts_extraporder1_paramset1);
	                        free(bdyphi0_freepts_extraporder1_paramset1);
	                        free(AdS_mass0_freepts_extraporder1_paramset1);     
	                        free(xpbdy0_freepts_extraporder1_paramset1);
	                        free(ypbdy0_freepts_extraporder1_paramset1);
	                        free(zpbdy0_freepts_extraporder1_paramset1);
	                       	free(x_outermostpt0_freepts_extraporder1_paramset1);
	                       	free(y_outermostpt0_freepts_extraporder1_paramset1);
	                       	free(z_outermostpt0_freepts_extraporder1_paramset1);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_freepts_extraporder1_paramset1);
	                            free(chiextrap0_freepts_extraporder1_paramset1);
	                            free(xiextrap0_freepts_extraporder1_paramset1);             
	                            free(rhobdy0_freepts_extraporder1_paramset1);
	                            free(chibdy0_freepts_extraporder1_paramset1);
	                            free(xibdy0_freepts_extraporder1_paramset1);    
	                        }	
	            		}//closes condition on output_bdy_extraporder1_paramset1

						//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_freepts 1st order extrap paramset1\n"); fflush(stdout);}

	            		//SECOND ORDER EXTRAPOLATION
		            	if (output_bdy_extraporder2_paramset1)
	            		{
							bdy_extrap_order=2;
	
							//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
                			if (rad_extrap)
	                		{
    	            			if (my_rank==0) printf("%i-th order radial extrapolation of boundary quantities using paramset1 parameters - saved in freepts_extraporder2_paramset1*.txt files\n",bdy_extrap_order);
        	        			nexttobdypoints_radextrap_(chrbdy_freepts_extraporder2_paramset1,&numbdypoints_freepts_extraporder2_paramset1,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset1,&half_steps_from_bdy_int_paramset1,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
            	    		}
                			else
                			{
                				nexttobdypoints_freepts_(chrbdy_freepts_extraporder2_paramset1,&numbdypoints_freepts_extraporder2_paramset1,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset1,&half_steps_from_bdy_int_paramset1,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
                			}
	
	
	                		//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_freepts_extraporder2_paramset1 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_freepts_extraporder2_paramset1 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_freepts_extraporder2_paramset1,1,MPI_INT,vecbdypoints_freepts_extraporder2_paramset1,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_freepts_extraporder2_paramset1,&basenumbdypoints_freepts_extraporder2_paramset1,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_freepts_extraporder2_paramset1=%i\n",numbdypoints_freepts_extraporder2_paramset1);
	                        //fflush(stdout); 
	                        quasiset_tt_freepts_extraporder2_paramset1              = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_tchi_freepts_extraporder2_paramset1            = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_txi_freepts_extraporder2_paramset1             = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_chichi_freepts_extraporder2_paramset1          = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_chixi_freepts_extraporder2_paramset1           = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_xixi_freepts_extraporder2_paramset1            = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_trace_freepts_extraporder2_paramset1           = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_massdensity_freepts_extraporder2_paramset1     = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx_freepts_extraporder2_paramset1  = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy_freepts_extraporder2_paramset1  = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz_freepts_extraporder2_paramset1  = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        bdyphi_freepts_extraporder2_paramset1                   = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));   
	                        xpbdy_freepts_extraporder2_paramset1               = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        ypbdy_freepts_extraporder2_paramset1               = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        zpbdy_freepts_extraporder2_paramset1               = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));  
	                       	x_outermostpt_freepts_extraporder2_paramset1            = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                       	y_outermostpt_freepts_extraporder2_paramset1            = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                       	z_outermostpt_freepts_extraporder2_paramset1            = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real)); 
	
	                        lquasiset_tt0_freepts_extraporder2_paramset1            = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_tchi0_freepts_extraporder2_paramset1          = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_txi0_freepts_extraporder2_paramset1           = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_chichi0_freepts_extraporder2_paramset1        = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_chixi0_freepts_extraporder2_paramset1         = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_xixi0_freepts_extraporder2_paramset1          = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_trace0_freepts_extraporder2_paramset1         = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_massdensity0_freepts_extraporder2_paramset1   = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityx0_freepts_extraporder2_paramset1= malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityy0_freepts_extraporder2_paramset1= malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityz0_freepts_extraporder2_paramset1= malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lbdyphi0_freepts_extraporder2_paramset1                 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));   
	                        maxquasiset_tt0_freepts_extraporder2_paramset1          = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_tchi0_freepts_extraporder2_paramset1        = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_txi0_freepts_extraporder2_paramset1         = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_chichi0_freepts_extraporder2_paramset1      = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_chixi0_freepts_extraporder2_paramset1       = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_xixi0_freepts_extraporder2_paramset1        = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_trace0_freepts_extraporder2_paramset1       = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_massdensity0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityx0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityy0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityz0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxbdyphi0_freepts_extraporder2_paramset1               = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));   
	                        minquasiset_tt0_freepts_extraporder2_paramset1          = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_tchi0_freepts_extraporder2_paramset1        = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_txi0_freepts_extraporder2_paramset1         = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_chichi0_freepts_extraporder2_paramset1      = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_chixi0_freepts_extraporder2_paramset1       = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_xixi0_freepts_extraporder2_paramset1        = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_trace0_freepts_extraporder2_paramset1       = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_massdensity0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityx0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityy0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityz0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minbdyphi0_freepts_extraporder2_paramset1               = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));   
	                        quasiset_tt0_freepts_extraporder2_paramset1             = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_tchi0_freepts_extraporder2_paramset1           = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_txi0_freepts_extraporder2_paramset1            = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_chichi0_freepts_extraporder2_paramset1         = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_chixi0_freepts_extraporder2_paramset1          = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_xixi0_freepts_extraporder2_paramset1           = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_trace0_freepts_extraporder2_paramset1          = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_massdensity0_freepts_extraporder2_paramset1    = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        AdS_mass0_freepts_extraporder2_paramset1                = malloc(sizeof(real));
	                        bdyphi0_freepts_extraporder2_paramset1                  = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));    
	                        xpbdy0_freepts_extraporder2_paramset1              = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        ypbdy0_freepts_extraporder2_paramset1              = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        zpbdy0_freepts_extraporder2_paramset1              = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));   
	                       	x_outermostpt0_freepts_extraporder2_paramset1           = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                       	y_outermostpt0_freepts_extraporder2_paramset1           = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                       	z_outermostpt0_freepts_extraporder2_paramset1           = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));   
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_freepts_extraporder2_paramset1=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_freepts_extraporder2_paramset1=vecbdypoints_freepts_extraporder2_paramset1[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_freepts_extraporder2_paramset1=is_bdy_freepts_extraporder2_paramset1+vecbdypoints_freepts_extraporder2_paramset1[j];
	                            }
	                            ie_bdy_freepts_extraporder2_paramset1=is_bdy_freepts_extraporder2_paramset1+vecbdypoints_freepts_extraporder2_paramset1[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_freepts_extraporder2_paramset1[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_freepts_extraporder2_paramset1[i]=dsplsbdypoints_freepts_extraporder2_paramset1[i]+vecbdypoints_freepts_extraporder2_paramset1[j];
	                                }
	                            }
	                        }   
	
	                        if (rad_extrap)
							{
								xyz_bdy_out_radextrap_(xpbdy_freepts_extraporder2_paramset1,ypbdy_freepts_extraporder2_paramset1,zpbdy_freepts_extraporder2_paramset1,
	                        						x_outermostpt_freepts_extraporder2_paramset1,y_outermostpt_freepts_extraporder2_paramset1,z_outermostpt_freepts_extraporder2_paramset1,
	                        						chrbdy_freepts_extraporder2_paramset1,&numbdypoints_freepts_extraporder2_paramset1,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
							}
	                    	else
	                    	{
	                        	xyz_extrap_outermost_(xpbdy_freepts_extraporder2_paramset1,ypbdy_freepts_extraporder2_paramset1,zpbdy_freepts_extraporder2_paramset1,
	                        						x_outermostpt_freepts_extraporder2_paramset1,y_outermostpt_freepts_extraporder2_paramset1,z_outermostpt_freepts_extraporder2_paramset1,
	                        						chrbdy_freepts_extraporder2_paramset1,&numbdypoints_freepts_extraporder2_paramset1,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	                        }
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_freepts_extraporder2_paramset1,numbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,xpbdy0_freepts_extraporder2_paramset1,vecbdypoints_freepts_extraporder2_paramset1,dsplsbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_freepts_extraporder2_paramset1,numbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,ypbdy0_freepts_extraporder2_paramset1,vecbdypoints_freepts_extraporder2_paramset1,dsplsbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_freepts_extraporder2_paramset1,numbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,zpbdy0_freepts_extraporder2_paramset1,vecbdypoints_freepts_extraporder2_paramset1,dsplsbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_freepts_extraporder2_paramset1,numbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,x_outermostpt0_freepts_extraporder2_paramset1,vecbdypoints_freepts_extraporder2_paramset1,dsplsbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_freepts_extraporder2_paramset1,numbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,y_outermostpt0_freepts_extraporder2_paramset1,vecbdypoints_freepts_extraporder2_paramset1,dsplsbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_freepts_extraporder2_paramset1,numbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,z_outermostpt0_freepts_extraporder2_paramset1,vecbdypoints_freepts_extraporder2_paramset1,dsplsbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_freepts_extraporder2_paramset1 = malloc(sizeof(real));
	                                chiextrap0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                                xiextrap0_freepts_extraporder2_paramset1  = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_freepts_extraporder2_paramset1,chiextrap0_freepts_extraporder2_paramset1,xiextrap0_freepts_extraporder2_paramset1,xpbdy0_freepts_extraporder2_paramset1,ypbdy0_freepts_extraporder2_paramset1,zpbdy0_freepts_extraporder2_paramset1,&basenumbdypoints_freepts_extraporder2_paramset1);  
	                                basebdy_Nchi_freepts_extraporder2_paramset1=0;//initialize
	                                basebdy_Nxi_freepts_extraporder2_paramset1=0; //initialize
	                                bdyn_(&basebdy_Nchi_freepts_extraporder2_paramset1,&basebdy_Nxi_freepts_extraporder2_paramset1,&basenumbdypoints_freepts_extraporder2_paramset1,chiextrap0_freepts_extraporder2_paramset1,xiextrap0_freepts_extraporder2_paramset1);  
	                                rhobdy0_freepts_extraporder2_paramset1 = malloc(sizeof(real));
	                                chibdy0_freepts_extraporder2_paramset1 = malloc(basebdy_Nchi_freepts_extraporder2_paramset1*sizeof(real));
	                                xibdy0_freepts_extraporder2_paramset1  = malloc(basebdy_Nxi_freepts_extraporder2_paramset1*sizeof(real));   
	                            }
	                        }
	
	
							if (rad_extrap)
	                		{
	
	                			bdyphi_radextrap_(bdyphi_freepts_extraporder2_paramset1,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder2_paramset1,ypbdy_freepts_extraporder2_paramset1,zpbdy_freepts_extraporder2_paramset1,
	                                        chrbdy_freepts_extraporder2_paramset1,&numbdypoints_freepts_extraporder2_paramset1,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        	quasiset_radextrap_(quasiset_tt_freepts_extraporder2_paramset1,quasiset_tchi_freepts_extraporder2_paramset1,quasiset_txi_freepts_extraporder2_paramset1,
	                                quasiset_chichi_freepts_extraporder2_paramset1,quasiset_chixi_freepts_extraporder2_paramset1,
	                                quasiset_xixi_freepts_extraporder2_paramset1,
	                                quasiset_trace_freepts_extraporder2_paramset1,
	                                quasiset_massdensity_freepts_extraporder2_paramset1,
	                                quasiset_angmomdensityx_freepts_extraporder2_paramset1,
	                                quasiset_angmomdensityy_freepts_extraporder2_paramset1,
	                                quasiset_angmomdensityz_freepts_extraporder2_paramset1,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder2_paramset1,ypbdy_freepts_extraporder2_paramset1,zpbdy_freepts_extraporder2_paramset1,
	                                chrbdy_freepts_extraporder2_paramset1,&numbdypoints_freepts_extraporder2_paramset1,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                		}
	                		else
	                		{   
	                        	extrap_bdyphi_freepts_(bdyphi_freepts_extraporder2_paramset1,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder2_paramset1,ypbdy_freepts_extraporder2_paramset1,zpbdy_freepts_extraporder2_paramset1,
	                                        chrbdy_freepts_extraporder2_paramset1,&numbdypoints_freepts_extraporder2_paramset1,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        	extrap_quasiset_freepts_(quasiset_tt_freepts_extraporder2_paramset1,quasiset_tchi_freepts_extraporder2_paramset1,quasiset_txi_freepts_extraporder2_paramset1,
	                                quasiset_chichi_freepts_extraporder2_paramset1,quasiset_chixi_freepts_extraporder2_paramset1,
	                                quasiset_xixi_freepts_extraporder2_paramset1,
	                                quasiset_trace_freepts_extraporder2_paramset1,
	                                quasiset_massdensity_freepts_extraporder2_paramset1,
	                                quasiset_angmomdensityx_freepts_extraporder2_paramset1,
	                                quasiset_angmomdensityy_freepts_extraporder2_paramset1,
	                                quasiset_angmomdensityz_freepts_extraporder2_paramset1,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder2_paramset1,ypbdy_freepts_extraporder2_paramset1,zpbdy_freepts_extraporder2_paramset1,
	                                chrbdy_freepts_extraporder2_paramset1,&numbdypoints_freepts_extraporder2_paramset1,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                        } 
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_freepts_extraporder2_paramset1; i<ie_bdy_freepts_extraporder2_paramset1; i++)
	                        {
	                            lquasiset_tt0_freepts_extraporder2_paramset1           [i] = quasiset_tt_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_tchi0_freepts_extraporder2_paramset1         [i] = quasiset_tchi_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_txi0_freepts_extraporder2_paramset1          [i] = quasiset_txi_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_chichi0_freepts_extraporder2_paramset1       [i] = quasiset_chichi_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_chixi0_freepts_extraporder2_paramset1        [i] = quasiset_chixi_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_xixi0_freepts_extraporder2_paramset1         [i] = quasiset_xixi_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_trace0_freepts_extraporder2_paramset1        [i] = quasiset_trace_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_massdensity0_freepts_extraporder2_paramset1  [i] = quasiset_massdensity_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_angmomdensityx0_freepts_extraporder2_paramset1 [i] = quasiset_angmomdensityx_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_angmomdensityy0_freepts_extraporder2_paramset1 [i] = quasiset_angmomdensityy_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_angmomdensityz0_freepts_extraporder2_paramset1 [i] = quasiset_angmomdensityz_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lbdyphi0_freepts_extraporder2_paramset1                [i] = bdyphi_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                        }   
	
							//PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder2_paramset1,          maxquasiset_tt0_freepts_extraporder2_paramset1,          basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder2_paramset1,        maxquasiset_tchi0_freepts_extraporder2_paramset1,        basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder2_paramset1,         maxquasiset_txi0_freepts_extraporder2_paramset1,         basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder2_paramset1,      maxquasiset_chichi0_freepts_extraporder2_paramset1,      basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder2_paramset1,       maxquasiset_chixi0_freepts_extraporder2_paramset1,       basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder2_paramset1,        maxquasiset_xixi0_freepts_extraporder2_paramset1,        basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder2_paramset1,       maxquasiset_trace0_freepts_extraporder2_paramset1,       basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder2_paramset1, maxquasiset_massdensity0_freepts_extraporder2_paramset1, basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder2_paramset1, maxquasiset_angmomdensityx0_freepts_extraporder2_paramset1, basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder2_paramset1, maxquasiset_angmomdensityy0_freepts_extraporder2_paramset1, basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder2_paramset1, maxquasiset_angmomdensityz0_freepts_extraporder2_paramset1, basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder2_paramset1,               maxbdyphi0_freepts_extraporder2_paramset1,               basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder2_paramset1,          minquasiset_tt0_freepts_extraporder2_paramset1,          basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder2_paramset1,        minquasiset_tchi0_freepts_extraporder2_paramset1,        basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder2_paramset1,         minquasiset_txi0_freepts_extraporder2_paramset1,         basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder2_paramset1,      minquasiset_chichi0_freepts_extraporder2_paramset1,      basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder2_paramset1,       minquasiset_chixi0_freepts_extraporder2_paramset1,       basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder2_paramset1,        minquasiset_xixi0_freepts_extraporder2_paramset1,        basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder2_paramset1,       minquasiset_trace0_freepts_extraporder2_paramset1,       basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder2_paramset1, minquasiset_massdensity0_freepts_extraporder2_paramset1, basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder2_paramset1, minquasiset_angmomdensityx0_freepts_extraporder2_paramset1, basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder2_paramset1, minquasiset_angmomdensityy0_freepts_extraporder2_paramset1, basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder2_paramset1, minquasiset_angmomdensityz0_freepts_extraporder2_paramset1, basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder2_paramset1,               minbdyphi0_freepts_extraporder2_paramset1,               basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_freepts_extraporder2_paramset1; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_freepts_extraporder2_paramset1          [i] = maxquasiset_tt0_freepts_extraporder2_paramset1          [i] + minquasiset_tt0_freepts_extraporder2_paramset1          [i];
	                                    quasiset_tchi0_freepts_extraporder2_paramset1        [i] = maxquasiset_tchi0_freepts_extraporder2_paramset1        [i] + minquasiset_tchi0_freepts_extraporder2_paramset1        [i];
	                                    quasiset_txi0_freepts_extraporder2_paramset1         [i] = maxquasiset_txi0_freepts_extraporder2_paramset1         [i] + minquasiset_txi0_freepts_extraporder2_paramset1         [i];
	                                    quasiset_chichi0_freepts_extraporder2_paramset1      [i] = maxquasiset_chichi0_freepts_extraporder2_paramset1      [i] + minquasiset_chichi0_freepts_extraporder2_paramset1      [i];
	                                    quasiset_chixi0_freepts_extraporder2_paramset1       [i] = maxquasiset_chixi0_freepts_extraporder2_paramset1       [i] + minquasiset_chixi0_freepts_extraporder2_paramset1       [i];
	                                    quasiset_xixi0_freepts_extraporder2_paramset1        [i] = maxquasiset_xixi0_freepts_extraporder2_paramset1        [i] + minquasiset_xixi0_freepts_extraporder2_paramset1        [i];
	                                    quasiset_trace0_freepts_extraporder2_paramset1       [i] = maxquasiset_trace0_freepts_extraporder2_paramset1       [i] + minquasiset_trace0_freepts_extraporder2_paramset1       [i];
	                                    quasiset_massdensity0_freepts_extraporder2_paramset1 [i] = maxquasiset_massdensity0_freepts_extraporder2_paramset1 [i] + minquasiset_massdensity0_freepts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityx0_freepts_extraporder2_paramset1 [i] + minquasiset_angmomdensityx0_freepts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityy0_freepts_extraporder2_paramset1 [i] + minquasiset_angmomdensityy0_freepts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityz0_freepts_extraporder2_paramset1 [i] + minquasiset_angmomdensityz0_freepts_extraporder2_paramset1 [i];
	                                    bdyphi0_freepts_extraporder2_paramset1               [i] = maxbdyphi0_freepts_extraporder2_paramset1               [i] + minbdyphi0_freepts_extraporder2_paramset1               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_freepts_extraporder2_paramset1          [i] = maxquasiset_tt0_freepts_extraporder2_paramset1          [i];
	                                    quasiset_tchi0_freepts_extraporder2_paramset1        [i] = maxquasiset_tchi0_freepts_extraporder2_paramset1        [i];
	                                    quasiset_txi0_freepts_extraporder2_paramset1         [i] = maxquasiset_txi0_freepts_extraporder2_paramset1         [i];
	                                    quasiset_chichi0_freepts_extraporder2_paramset1      [i] = maxquasiset_chichi0_freepts_extraporder2_paramset1      [i];
	                                    quasiset_chixi0_freepts_extraporder2_paramset1       [i] = maxquasiset_chixi0_freepts_extraporder2_paramset1       [i];
	                                    quasiset_xixi0_freepts_extraporder2_paramset1        [i] = maxquasiset_xixi0_freepts_extraporder2_paramset1        [i];
	                                    quasiset_trace0_freepts_extraporder2_paramset1       [i] = maxquasiset_trace0_freepts_extraporder2_paramset1       [i];
	                                    quasiset_massdensity0_freepts_extraporder2_paramset1 [i] = maxquasiset_massdensity0_freepts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityx0_freepts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityy0_freepts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityz0_freepts_extraporder2_paramset1 [i];
	                                    bdyphi0_freepts_extraporder2_paramset1               [i] = maxbdyphi0_freepts_extraporder2_paramset1               [i];
	                                }  
	                        }       
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {     
	                            			size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder2_paramset1[j],ypbdy0_freepts_extraporder2_paramset1[j],zpbdy0_freepts_extraporder2_paramset1[j],j);
		                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder2_paramset1[j],ypbdy0_freepts_extraporder2_paramset1[j],zpbdy0_freepts_extraporder2_paramset1[j],j);
		                                    }
		                                    fclose(fp);
		                                    free(name);

		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder2_paramset1[j],ypbdy0_freepts_extraporder2_paramset1[j],zpbdy0_freepts_extraporder2_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }  

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder2_paramset1 - in PRINT BOUNDARY QUANTITIES - post print xext   \n"); fflush(stdout);}  


	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder2_paramset1[j],y_outermostpt0_freepts_extraporder2_paramset1[j],z_outermostpt0_freepts_extraporder2_paramset1[j],j);
	                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder2_paramset1[j],y_outermostpt0_freepts_extraporder2_paramset1[j],z_outermostpt0_freepts_extraporder2_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder2_paramset1[j],y_outermostpt0_freepts_extraporder2_paramset1[j],z_outermostpt0_freepts_extraporder2_paramset1[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name);
	                                	}   
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder2_paramset1 - in PRINT BOUNDARY QUANTITIES - post print xout   \n"); fflush(stdout);} 

	                                if(output_bdyphi)
	                                {
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder2_paramset1[j],j);
		                                    }
		                                    fclose(fp); 
		                                    free(name);
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder2_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                } 
	                                }    

	                                    // save quasiset_ll as ascii
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder2_paramset1[j],quasiset_tchi0_freepts_extraporder2_paramset1[j],quasiset_txi0_freepts_extraporder2_paramset1[j],quasiset_chichi0_freepts_extraporder2_paramset1[j],quasiset_chixi0_freepts_extraporder2_paramset1[j],quasiset_xixi0_freepts_extraporder2_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder2_paramset1[j],quasiset_tchi0_freepts_extraporder2_paramset1[j],quasiset_txi0_freepts_extraporder2_paramset1[j],quasiset_chichi0_freepts_extraporder2_paramset1[j],quasiset_chixi0_freepts_extraporder2_paramset1[j],quasiset_xixi0_freepts_extraporder2_paramset1[j],
	                                                    j_red);
	                                            //printf("%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                            //        ct,
	                                            //        quasiset_tt0_freepts_extraporder2_paramset1[j],quasiset_tchi0_freepts_extraporder2_paramset1[j],quasiset_txi0_freepts_extraporder2_paramset1[j],quasiset_chichi0_freepts_extraporder2_paramset1[j],quasiset_chixi0_freepts_extraporder2_paramset1[j],quasiset_xixi0_freepts_extraporder2_paramset1[j],
	                                            //        j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder2_paramset1 - in PRINT BOUNDARY QUANTITIES - post print quasisetll  \n"); fflush(stdout);} 

	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_freepts_extraporder2_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_freepts_extraporder2_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {   
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_freepts_extraporder2_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);  
	                                    free(name); 
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_freepts_extraporder2_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {

		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
			                            	sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder2_paramset1[j],quasiset_angmomdensityy0_freepts_extraporder2_paramset1[j],quasiset_angmomdensityz0_freepts_extraporder2_paramset1[j],
		                                                    j);
		                                    }
		                                    fclose(fp);
		                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder2_paramset1[j],quasiset_angmomdensityy0_freepts_extraporder2_paramset1[j],quasiset_angmomdensityz0_freepts_extraporder2_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_freepts_extraporder2_paramset1=1;
	                                chibdy_xibdy_(chibdy0_freepts_extraporder2_paramset1,xibdy0_freepts_extraporder2_paramset1,xpbdy0_freepts_extraporder2_paramset1,ypbdy0_freepts_extraporder2_paramset1,zpbdy0_freepts_extraporder2_paramset1,&basenumbdypoints_freepts_extraporder2_paramset1,chiextrap0_freepts_extraporder2_paramset1,xiextrap0_freepts_extraporder2_paramset1,&basebdy_Nchi_freepts_extraporder2_paramset1,&basebdy_Nxi_freepts_extraporder2_paramset1);    
	                                doubleintegralonsphere_(AdS_mass0_freepts_extraporder2_paramset1,quasiset_massdensity0_freepts_extraporder2_paramset1,xpbdy0_freepts_extraporder2_paramset1,ypbdy0_freepts_extraporder2_paramset1,zpbdy0_freepts_extraporder2_paramset1,&basenumbdypoints_freepts_extraporder2_paramset1,rhobdy0_freepts_extraporder2_paramset1,chibdy0_freepts_extraporder2_paramset1,xibdy0_freepts_extraporder2_paramset1,&basebdy_Nchi_freepts_extraporder2_paramset1,&basebdy_Nxi_freepts_extraporder2_paramset1);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_%st_AdSmass.txt",AMRD_save_tag) + 1;
    								name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_freepts_extraporder2_paramset1);
	                                fclose(fp);
	                                free(name);
	                            }
	                        }

	                        free(vecbdypoints_freepts_extraporder2_paramset1);
	                        free(dsplsbdypoints_freepts_extraporder2_paramset1);
	                        free(quasiset_tt_freepts_extraporder2_paramset1);
	                        free(quasiset_tchi_freepts_extraporder2_paramset1);
	                        free(quasiset_txi_freepts_extraporder2_paramset1);
	                        free(quasiset_chichi_freepts_extraporder2_paramset1);
	                        free(quasiset_chixi_freepts_extraporder2_paramset1);
	                        free(quasiset_xixi_freepts_extraporder2_paramset1);
	                        free(quasiset_trace_freepts_extraporder2_paramset1);
	                        free(quasiset_massdensity_freepts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityx_freepts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityy_freepts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityz_freepts_extraporder2_paramset1);
	                        free(bdyphi_freepts_extraporder2_paramset1);  
	                        free(xpbdy_freepts_extraporder2_paramset1);
	                        free(ypbdy_freepts_extraporder2_paramset1);
	                        free(zpbdy_freepts_extraporder2_paramset1);   
	                       	free(x_outermostpt_freepts_extraporder2_paramset1);
	                       	free(y_outermostpt_freepts_extraporder2_paramset1);
	                       	free(z_outermostpt_freepts_extraporder2_paramset1);   
	
	                        free(lquasiset_tt0_freepts_extraporder2_paramset1);        
	                        free(lquasiset_tchi0_freepts_extraporder2_paramset1);
	                        free(lquasiset_txi0_freepts_extraporder2_paramset1);
	                        free(lquasiset_chichi0_freepts_extraporder2_paramset1);
	                        free(lquasiset_chixi0_freepts_extraporder2_paramset1);
	                        free(lquasiset_xixi0_freepts_extraporder2_paramset1);
	                        free(lquasiset_trace0_freepts_extraporder2_paramset1);
	                        free(lquasiset_massdensity0_freepts_extraporder2_paramset1);
	                        free(lquasiset_angmomdensityx0_freepts_extraporder2_paramset1);
	                        free(lquasiset_angmomdensityy0_freepts_extraporder2_paramset1);
	                        free(lquasiset_angmomdensityz0_freepts_extraporder2_paramset1);
	                        free(lbdyphi0_freepts_extraporder2_paramset1);      
	                        free(maxquasiset_tt0_freepts_extraporder2_paramset1);        
	                        free(maxquasiset_tchi0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_txi0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_chichi0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_chixi0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_xixi0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_trace0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_massdensity0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_angmomdensityx0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_angmomdensityy0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_angmomdensityz0_freepts_extraporder2_paramset1);
	                        free(maxbdyphi0_freepts_extraporder2_paramset1);    
	                        free(minquasiset_tt0_freepts_extraporder2_paramset1);
	                        free(minquasiset_tchi0_freepts_extraporder2_paramset1);
	                        free(minquasiset_txi0_freepts_extraporder2_paramset1);
	                        free(minquasiset_chichi0_freepts_extraporder2_paramset1);
	                        free(minquasiset_chixi0_freepts_extraporder2_paramset1);
	                        free(minquasiset_xixi0_freepts_extraporder2_paramset1);
	                        free(minquasiset_trace0_freepts_extraporder2_paramset1);
	                        free(minquasiset_massdensity0_freepts_extraporder2_paramset1);
	                        free(minquasiset_angmomdensityx0_freepts_extraporder2_paramset1);
	                        free(minquasiset_angmomdensityy0_freepts_extraporder2_paramset1);
	                        free(minquasiset_angmomdensityz0_freepts_extraporder2_paramset1);
	                        free(minbdyphi0_freepts_extraporder2_paramset1);    
	                        free(quasiset_tt0_freepts_extraporder2_paramset1);
	                        free(quasiset_tchi0_freepts_extraporder2_paramset1);
	                        free(quasiset_txi0_freepts_extraporder2_paramset1);
	                        free(quasiset_chichi0_freepts_extraporder2_paramset1);
	                        free(quasiset_chixi0_freepts_extraporder2_paramset1);
	                        free(quasiset_xixi0_freepts_extraporder2_paramset1);
	                        free(quasiset_trace0_freepts_extraporder2_paramset1);
	                        free(quasiset_massdensity0_freepts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityx0_freepts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityy0_freepts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityz0_freepts_extraporder2_paramset1);
	                        free(bdyphi0_freepts_extraporder2_paramset1);
	                        free(AdS_mass0_freepts_extraporder2_paramset1);     
	                        free(xpbdy0_freepts_extraporder2_paramset1);
	                        free(ypbdy0_freepts_extraporder2_paramset1);
	                        free(zpbdy0_freepts_extraporder2_paramset1);
	                       	free(x_outermostpt0_freepts_extraporder2_paramset1);
	                       	free(y_outermostpt0_freepts_extraporder2_paramset1);
	                       	free(z_outermostpt0_freepts_extraporder2_paramset1);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_freepts_extraporder2_paramset1);
	                            free(chiextrap0_freepts_extraporder2_paramset1);
	                            free(xiextrap0_freepts_extraporder2_paramset1);             
	                            free(rhobdy0_freepts_extraporder2_paramset1);
	                            free(chibdy0_freepts_extraporder2_paramset1);
	                            free(xibdy0_freepts_extraporder2_paramset1);    
	                        }   	
	            		}//closes condition on output_bdy_extraporder2_paramset1

	            		//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_freepts 2nd order extrap paramset1\n"); fflush(stdout);}

	            		//THIRD ORDER EXTRAPOLATION
		            	if (output_bdy_extraporder3_paramset1)
		            	{
		                	bdy_extrap_order=3; 
	
		                	//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
		                    nexttobdypoints_freepts_(chrbdy_freepts_extraporder3_paramset1,&numbdypoints_freepts_extraporder3_paramset1,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset1,&half_steps_from_bdy_int_paramset1,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	
	
		                	//PERFORM EXTRAPOLATION
	                        vecbdypoints_freepts_extraporder3_paramset1 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_freepts_extraporder3_paramset1 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_freepts_extraporder3_paramset1,1,MPI_INT,vecbdypoints_freepts_extraporder3_paramset1,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_freepts_extraporder3_paramset1,&basenumbdypoints_freepts_extraporder3_paramset1,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_freepts_extraporder3_paramset1=%i\n",numbdypoints_freepts_extraporder3_paramset1);
	                        //fflush(stdout); 
	                        quasiset_tt_freepts_extraporder3_paramset1              = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_tchi_freepts_extraporder3_paramset1            = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_txi_freepts_extraporder3_paramset1             = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_chichi_freepts_extraporder3_paramset1          = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_chixi_freepts_extraporder3_paramset1           = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_xixi_freepts_extraporder3_paramset1            = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_trace_freepts_extraporder3_paramset1           = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_massdensity_freepts_extraporder3_paramset1     = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx_freepts_extraporder3_paramset1  = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy_freepts_extraporder3_paramset1  = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz_freepts_extraporder3_paramset1  = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        bdyphi_freepts_extraporder3_paramset1                   = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));   
	                        xpbdy_freepts_extraporder3_paramset1               = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        ypbdy_freepts_extraporder3_paramset1               = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        zpbdy_freepts_extraporder3_paramset1               = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));  
	                        x_outermostpt_freepts_extraporder3_paramset1            = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        y_outermostpt_freepts_extraporder3_paramset1            = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        z_outermostpt_freepts_extraporder3_paramset1            = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real)); 
	
	                        lquasiset_tt0_freepts_extraporder3_paramset1            = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_tchi0_freepts_extraporder3_paramset1          = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_txi0_freepts_extraporder3_paramset1           = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_chichi0_freepts_extraporder3_paramset1        = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_chixi0_freepts_extraporder3_paramset1         = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_xixi0_freepts_extraporder3_paramset1          = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_trace0_freepts_extraporder3_paramset1         = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_massdensity0_freepts_extraporder3_paramset1   = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityx0_freepts_extraporder3_paramset1= malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityy0_freepts_extraporder3_paramset1= malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityz0_freepts_extraporder3_paramset1= malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lbdyphi0_freepts_extraporder3_paramset1                 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));   
	                        maxquasiset_tt0_freepts_extraporder3_paramset1          = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_tchi0_freepts_extraporder3_paramset1        = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_txi0_freepts_extraporder3_paramset1         = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_chichi0_freepts_extraporder3_paramset1      = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_chixi0_freepts_extraporder3_paramset1       = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_xixi0_freepts_extraporder3_paramset1        = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_trace0_freepts_extraporder3_paramset1       = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_massdensity0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityx0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityy0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityz0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxbdyphi0_freepts_extraporder3_paramset1               = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));   
	                        minquasiset_tt0_freepts_extraporder3_paramset1          = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_tchi0_freepts_extraporder3_paramset1        = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_txi0_freepts_extraporder3_paramset1         = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_chichi0_freepts_extraporder3_paramset1      = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_chixi0_freepts_extraporder3_paramset1       = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_xixi0_freepts_extraporder3_paramset1        = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_trace0_freepts_extraporder3_paramset1       = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_massdensity0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityx0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityy0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityz0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minbdyphi0_freepts_extraporder3_paramset1               = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));   
	                        quasiset_tt0_freepts_extraporder3_paramset1             = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_tchi0_freepts_extraporder3_paramset1           = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_txi0_freepts_extraporder3_paramset1            = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_chichi0_freepts_extraporder3_paramset1         = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_chixi0_freepts_extraporder3_paramset1          = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_xixi0_freepts_extraporder3_paramset1           = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_trace0_freepts_extraporder3_paramset1          = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_massdensity0_freepts_extraporder3_paramset1    = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        AdS_mass0_freepts_extraporder3_paramset1                = malloc(sizeof(real));
	                        bdyphi0_freepts_extraporder3_paramset1                  = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));    
	                        xpbdy0_freepts_extraporder3_paramset1              = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        ypbdy0_freepts_extraporder3_paramset1              = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        zpbdy0_freepts_extraporder3_paramset1              = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));   
	                        x_outermostpt0_freepts_extraporder3_paramset1           = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        y_outermostpt0_freepts_extraporder3_paramset1           = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        z_outermostpt0_freepts_extraporder3_paramset1           = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));   
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_freepts_extraporder3_paramset1=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_freepts_extraporder3_paramset1=vecbdypoints_freepts_extraporder3_paramset1[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_freepts_extraporder3_paramset1=is_bdy_freepts_extraporder3_paramset1+vecbdypoints_freepts_extraporder3_paramset1[j];
	                            }
	                            ie_bdy_freepts_extraporder3_paramset1=is_bdy_freepts_extraporder3_paramset1+vecbdypoints_freepts_extraporder3_paramset1[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_freepts_extraporder3_paramset1[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_freepts_extraporder3_paramset1[i]=dsplsbdypoints_freepts_extraporder3_paramset1[i]+vecbdypoints_freepts_extraporder3_paramset1[j];
	                                }
	                            }
	                        }   
	
	                        xyz_extrap_outermost_(xpbdy_freepts_extraporder3_paramset1,ypbdy_freepts_extraporder3_paramset1,zpbdy_freepts_extraporder3_paramset1,
	                                                                        x_outermostpt_freepts_extraporder3_paramset1,y_outermostpt_freepts_extraporder3_paramset1,z_outermostpt_freepts_extraporder3_paramset1,
	                                                                        chrbdy_freepts_extraporder3_paramset1,&numbdypoints_freepts_extraporder3_paramset1,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_freepts_extraporder3_paramset1,numbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,xpbdy0_freepts_extraporder3_paramset1,vecbdypoints_freepts_extraporder3_paramset1,dsplsbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_freepts_extraporder3_paramset1,numbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,ypbdy0_freepts_extraporder3_paramset1,vecbdypoints_freepts_extraporder3_paramset1,dsplsbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_freepts_extraporder3_paramset1,numbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,zpbdy0_freepts_extraporder3_paramset1,vecbdypoints_freepts_extraporder3_paramset1,dsplsbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                                MPI_Allgatherv(x_outermostpt_freepts_extraporder3_paramset1,numbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,x_outermostpt0_freepts_extraporder3_paramset1,vecbdypoints_freepts_extraporder3_paramset1,dsplsbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                                MPI_Allgatherv(y_outermostpt_freepts_extraporder3_paramset1,numbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,y_outermostpt0_freepts_extraporder3_paramset1,vecbdypoints_freepts_extraporder3_paramset1,dsplsbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                                MPI_Allgatherv(z_outermostpt_freepts_extraporder3_paramset1,numbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,z_outermostpt0_freepts_extraporder3_paramset1,vecbdypoints_freepts_extraporder3_paramset1,dsplsbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_freepts_extraporder3_paramset1 = malloc(sizeof(real));
	                                chiextrap0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                                xiextrap0_freepts_extraporder3_paramset1  = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_freepts_extraporder3_paramset1,chiextrap0_freepts_extraporder3_paramset1,xiextrap0_freepts_extraporder3_paramset1,xpbdy0_freepts_extraporder3_paramset1,ypbdy0_freepts_extraporder3_paramset1,zpbdy0_freepts_extraporder3_paramset1,&basenumbdypoints_freepts_extraporder3_paramset1);  
	                                basebdy_Nchi_freepts_extraporder3_paramset1=0;//initialize
	                                basebdy_Nxi_freepts_extraporder3_paramset1=0; //initialize
	                                bdyn_(&basebdy_Nchi_freepts_extraporder3_paramset1,&basebdy_Nxi_freepts_extraporder3_paramset1,&basenumbdypoints_freepts_extraporder3_paramset1,chiextrap0_freepts_extraporder3_paramset1,xiextrap0_freepts_extraporder3_paramset1);  
	                                rhobdy0_freepts_extraporder3_paramset1 = malloc(sizeof(real));
	                                chibdy0_freepts_extraporder3_paramset1 = malloc(basebdy_Nchi_freepts_extraporder3_paramset1*sizeof(real));
	                                xibdy0_freepts_extraporder3_paramset1  = malloc(basebdy_Nxi_freepts_extraporder3_paramset1*sizeof(real));   
	                            }
	                        }
	
	
	                        extrap_bdyphi_freepts_(bdyphi_freepts_extraporder3_paramset1,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder3_paramset1,ypbdy_freepts_extraporder3_paramset1,zpbdy_freepts_extraporder3_paramset1,
	                                        chrbdy_freepts_extraporder3_paramset1,&numbdypoints_freepts_extraporder3_paramset1,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        extrap_quasiset_freepts_(quasiset_tt_freepts_extraporder3_paramset1,quasiset_tchi_freepts_extraporder3_paramset1,quasiset_txi_freepts_extraporder3_paramset1,
	                                quasiset_chichi_freepts_extraporder3_paramset1,quasiset_chixi_freepts_extraporder3_paramset1,
	                                quasiset_xixi_freepts_extraporder3_paramset1,
	                                quasiset_trace_freepts_extraporder3_paramset1,
	                                quasiset_massdensity_freepts_extraporder3_paramset1,
	                                quasiset_angmomdensityx_freepts_extraporder3_paramset1,
	                                quasiset_angmomdensityy_freepts_extraporder3_paramset1,
	                                quasiset_angmomdensityz_freepts_extraporder3_paramset1,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder3_paramset1,ypbdy_freepts_extraporder3_paramset1,zpbdy_freepts_extraporder3_paramset1,
	                                chrbdy_freepts_extraporder3_paramset1,&numbdypoints_freepts_extraporder3_paramset1,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_freepts_extraporder3_paramset1; i<ie_bdy_freepts_extraporder3_paramset1; i++)
	                        {
	                            lquasiset_tt0_freepts_extraporder3_paramset1           [i] = quasiset_tt_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_tchi0_freepts_extraporder3_paramset1         [i] = quasiset_tchi_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_txi0_freepts_extraporder3_paramset1          [i] = quasiset_txi_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_chichi0_freepts_extraporder3_paramset1       [i] = quasiset_chichi_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_chixi0_freepts_extraporder3_paramset1        [i] = quasiset_chixi_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_xixi0_freepts_extraporder3_paramset1         [i] = quasiset_xixi_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_trace0_freepts_extraporder3_paramset1        [i] = quasiset_trace_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_massdensity0_freepts_extraporder3_paramset1  [i] = quasiset_massdensity_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_angmomdensityx0_freepts_extraporder3_paramset1 [i] = quasiset_angmomdensityx_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_angmomdensityy0_freepts_extraporder3_paramset1 [i] = quasiset_angmomdensityy_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_angmomdensityz0_freepts_extraporder3_paramset1 [i] = quasiset_angmomdensityz_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lbdyphi0_freepts_extraporder3_paramset1                [i] = bdyphi_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                        }   
	
	                        //PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder3_paramset1,          maxquasiset_tt0_freepts_extraporder3_paramset1,          basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder3_paramset1,        maxquasiset_tchi0_freepts_extraporder3_paramset1,        basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder3_paramset1,         maxquasiset_txi0_freepts_extraporder3_paramset1,         basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder3_paramset1,      maxquasiset_chichi0_freepts_extraporder3_paramset1,      basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder3_paramset1,       maxquasiset_chixi0_freepts_extraporder3_paramset1,       basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder3_paramset1,        maxquasiset_xixi0_freepts_extraporder3_paramset1,        basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder3_paramset1,       maxquasiset_trace0_freepts_extraporder3_paramset1,       basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder3_paramset1, maxquasiset_massdensity0_freepts_extraporder3_paramset1, basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder3_paramset1, maxquasiset_angmomdensityx0_freepts_extraporder3_paramset1, basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder3_paramset1, maxquasiset_angmomdensityy0_freepts_extraporder3_paramset1, basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder3_paramset1, maxquasiset_angmomdensityz0_freepts_extraporder3_paramset1, basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder3_paramset1,               maxbdyphi0_freepts_extraporder3_paramset1,               basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder3_paramset1,          minquasiset_tt0_freepts_extraporder3_paramset1,          basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder3_paramset1,        minquasiset_tchi0_freepts_extraporder3_paramset1,        basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder3_paramset1,         minquasiset_txi0_freepts_extraporder3_paramset1,         basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder3_paramset1,      minquasiset_chichi0_freepts_extraporder3_paramset1,      basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder3_paramset1,       minquasiset_chixi0_freepts_extraporder3_paramset1,       basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder3_paramset1,        minquasiset_xixi0_freepts_extraporder3_paramset1,        basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder3_paramset1,       minquasiset_trace0_freepts_extraporder3_paramset1,       basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder3_paramset1, minquasiset_massdensity0_freepts_extraporder3_paramset1, basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder3_paramset1, minquasiset_angmomdensityx0_freepts_extraporder3_paramset1, basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder3_paramset1, minquasiset_angmomdensityy0_freepts_extraporder3_paramset1, basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder3_paramset1, minquasiset_angmomdensityz0_freepts_extraporder3_paramset1, basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder3_paramset1,               minbdyphi0_freepts_extraporder3_paramset1,               basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_freepts_extraporder3_paramset1; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_freepts_extraporder3_paramset1          [i] = maxquasiset_tt0_freepts_extraporder3_paramset1          [i] + minquasiset_tt0_freepts_extraporder3_paramset1          [i];
	                                    quasiset_tchi0_freepts_extraporder3_paramset1        [i] = maxquasiset_tchi0_freepts_extraporder3_paramset1        [i] + minquasiset_tchi0_freepts_extraporder3_paramset1        [i];
	                                    quasiset_txi0_freepts_extraporder3_paramset1         [i] = maxquasiset_txi0_freepts_extraporder3_paramset1         [i] + minquasiset_txi0_freepts_extraporder3_paramset1         [i];
	                                    quasiset_chichi0_freepts_extraporder3_paramset1      [i] = maxquasiset_chichi0_freepts_extraporder3_paramset1      [i] + minquasiset_chichi0_freepts_extraporder3_paramset1      [i];
	                                    quasiset_chixi0_freepts_extraporder3_paramset1       [i] = maxquasiset_chixi0_freepts_extraporder3_paramset1       [i] + minquasiset_chixi0_freepts_extraporder3_paramset1       [i];
	                                    quasiset_xixi0_freepts_extraporder3_paramset1        [i] = maxquasiset_xixi0_freepts_extraporder3_paramset1        [i] + minquasiset_xixi0_freepts_extraporder3_paramset1        [i];
	                                    quasiset_trace0_freepts_extraporder3_paramset1       [i] = maxquasiset_trace0_freepts_extraporder3_paramset1       [i] + minquasiset_trace0_freepts_extraporder3_paramset1       [i];
	                                    quasiset_massdensity0_freepts_extraporder3_paramset1 [i] = maxquasiset_massdensity0_freepts_extraporder3_paramset1 [i] + minquasiset_massdensity0_freepts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityx0_freepts_extraporder3_paramset1 [i] + minquasiset_angmomdensityx0_freepts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityy0_freepts_extraporder3_paramset1 [i] + minquasiset_angmomdensityy0_freepts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityz0_freepts_extraporder3_paramset1 [i] + minquasiset_angmomdensityz0_freepts_extraporder3_paramset1 [i];
	                                    bdyphi0_freepts_extraporder3_paramset1               [i] = maxbdyphi0_freepts_extraporder3_paramset1               [i] + minbdyphi0_freepts_extraporder3_paramset1               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_freepts_extraporder3_paramset1          [i] = maxquasiset_tt0_freepts_extraporder3_paramset1          [i];
	                                    quasiset_tchi0_freepts_extraporder3_paramset1        [i] = maxquasiset_tchi0_freepts_extraporder3_paramset1        [i];
	                                    quasiset_txi0_freepts_extraporder3_paramset1         [i] = maxquasiset_txi0_freepts_extraporder3_paramset1         [i];
	                                    quasiset_chichi0_freepts_extraporder3_paramset1      [i] = maxquasiset_chichi0_freepts_extraporder3_paramset1      [i];
	                                    quasiset_chixi0_freepts_extraporder3_paramset1       [i] = maxquasiset_chixi0_freepts_extraporder3_paramset1       [i];
	                                    quasiset_xixi0_freepts_extraporder3_paramset1        [i] = maxquasiset_xixi0_freepts_extraporder3_paramset1        [i];
	                                    quasiset_trace0_freepts_extraporder3_paramset1       [i] = maxquasiset_trace0_freepts_extraporder3_paramset1       [i];
	                                    quasiset_massdensity0_freepts_extraporder3_paramset1 [i] = maxquasiset_massdensity0_freepts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityx0_freepts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityy0_freepts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityz0_freepts_extraporder3_paramset1 [i];
	                                    bdyphi0_freepts_extraporder3_paramset1               [i] = maxbdyphi0_freepts_extraporder3_paramset1               [i];
	                                }  
	                        }       
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {     
	                            			size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder3_paramset1[j],ypbdy0_freepts_extraporder3_paramset1[j],zpbdy0_freepts_extraporder3_paramset1[j],j);
		                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder3_paramset1[j],ypbdy0_freepts_extraporder3_paramset1[j],zpbdy0_freepts_extraporder3_paramset1[j],j);
		                                    }
		                                    fclose(fp);
		                                    free(name);

		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder3_paramset1[j],ypbdy0_freepts_extraporder3_paramset1[j],zpbdy0_freepts_extraporder3_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }  

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder3_paramset1 - in PRINT BOUNDARY QUANTITIES - post print xext   \n"); fflush(stdout);}  


	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder3_paramset1[j],y_outermostpt0_freepts_extraporder3_paramset1[j],z_outermostpt0_freepts_extraporder3_paramset1[j],j);
	                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder3_paramset1[j],y_outermostpt0_freepts_extraporder3_paramset1[j],z_outermostpt0_freepts_extraporder3_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder3_paramset1[j],y_outermostpt0_freepts_extraporder3_paramset1[j],z_outermostpt0_freepts_extraporder3_paramset1[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name);
	                                	}   
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder3_paramset1 - in PRINT BOUNDARY QUANTITIES - post print xout   \n"); fflush(stdout);} 

	                                if(output_bdyphi)
	                                {
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder3_paramset1[j],j);
		                                    }
		                                    fclose(fp); 
		                                    free(name);
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder3_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                } 
	                                }    

	                                    // save quasiset_ll as ascii
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder3_paramset1[j],quasiset_tchi0_freepts_extraporder3_paramset1[j],quasiset_txi0_freepts_extraporder3_paramset1[j],quasiset_chichi0_freepts_extraporder3_paramset1[j],quasiset_chixi0_freepts_extraporder3_paramset1[j],quasiset_xixi0_freepts_extraporder3_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder3_paramset1[j],quasiset_tchi0_freepts_extraporder3_paramset1[j],quasiset_txi0_freepts_extraporder3_paramset1[j],quasiset_chichi0_freepts_extraporder3_paramset1[j],quasiset_chixi0_freepts_extraporder3_paramset1[j],quasiset_xixi0_freepts_extraporder3_paramset1[j],
	                                                    j_red);
	                                            //printf("%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                            //        ct,
	                                            //        quasiset_tt0_freepts_extraporder3_paramset1[j],quasiset_tchi0_freepts_extraporder3_paramset1[j],quasiset_txi0_freepts_extraporder3_paramset1[j],quasiset_chichi0_freepts_extraporder3_paramset1[j],quasiset_chixi0_freepts_extraporder3_paramset1[j],quasiset_xixi0_freepts_extraporder3_paramset1[j],
	                                            //        j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder3_paramset1 - in PRINT BOUNDARY QUANTITIES - post print quasisetll  \n"); fflush(stdout);} 

	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_freepts_extraporder3_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_freepts_extraporder3_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {   
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_freepts_extraporder3_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);  
	                                    free(name); 
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_freepts_extraporder3_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {

		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
			                            	sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder3_paramset1[j],quasiset_angmomdensityy0_freepts_extraporder3_paramset1[j],quasiset_angmomdensityz0_freepts_extraporder3_paramset1[j],
		                                                    j);
		                                    }
		                                    fclose(fp);
		                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder3_paramset1[j],quasiset_angmomdensityy0_freepts_extraporder3_paramset1[j],quasiset_angmomdensityz0_freepts_extraporder3_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_freepts_extraporder3_paramset1=1;
	                                chibdy_xibdy_(chibdy0_freepts_extraporder3_paramset1,xibdy0_freepts_extraporder3_paramset1,xpbdy0_freepts_extraporder3_paramset1,ypbdy0_freepts_extraporder3_paramset1,zpbdy0_freepts_extraporder3_paramset1,&basenumbdypoints_freepts_extraporder3_paramset1,chiextrap0_freepts_extraporder3_paramset1,xiextrap0_freepts_extraporder3_paramset1,&basebdy_Nchi_freepts_extraporder3_paramset1,&basebdy_Nxi_freepts_extraporder3_paramset1);    
	                                doubleintegralonsphere_(AdS_mass0_freepts_extraporder3_paramset1,quasiset_massdensity0_freepts_extraporder3_paramset1,xpbdy0_freepts_extraporder3_paramset1,ypbdy0_freepts_extraporder3_paramset1,zpbdy0_freepts_extraporder3_paramset1,&basenumbdypoints_freepts_extraporder3_paramset1,rhobdy0_freepts_extraporder3_paramset1,chibdy0_freepts_extraporder3_paramset1,xibdy0_freepts_extraporder3_paramset1,&basebdy_Nchi_freepts_extraporder3_paramset1,&basebdy_Nxi_freepts_extraporder3_paramset1);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_%st_AdSmass.txt",AMRD_save_tag) + 1;
    								name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_freepts_extraporder3_paramset1);
	                                fclose(fp);
	                                free(name);
	                            }
	                        }

	                        free(vecbdypoints_freepts_extraporder3_paramset1);
	                        free(dsplsbdypoints_freepts_extraporder3_paramset1);
	                        free(quasiset_tt_freepts_extraporder3_paramset1);
	                        free(quasiset_tchi_freepts_extraporder3_paramset1);
	                        free(quasiset_txi_freepts_extraporder3_paramset1);
	                        free(quasiset_chichi_freepts_extraporder3_paramset1);
	                        free(quasiset_chixi_freepts_extraporder3_paramset1);
	                        free(quasiset_xixi_freepts_extraporder3_paramset1);
	                        free(quasiset_trace_freepts_extraporder3_paramset1);
	                        free(quasiset_massdensity_freepts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityx_freepts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityy_freepts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityz_freepts_extraporder3_paramset1);
	                        free(bdyphi_freepts_extraporder3_paramset1);  
	                        free(xpbdy_freepts_extraporder3_paramset1);
	                        free(ypbdy_freepts_extraporder3_paramset1);
	                        free(zpbdy_freepts_extraporder3_paramset1);   
	                       	free(x_outermostpt_freepts_extraporder3_paramset1);
	                       	free(y_outermostpt_freepts_extraporder3_paramset1);
	                       	free(z_outermostpt_freepts_extraporder3_paramset1);   
	
	                        free(lquasiset_tt0_freepts_extraporder3_paramset1);        
	                        free(lquasiset_tchi0_freepts_extraporder3_paramset1);
	                        free(lquasiset_txi0_freepts_extraporder3_paramset1);
	                        free(lquasiset_chichi0_freepts_extraporder3_paramset1);
	                        free(lquasiset_chixi0_freepts_extraporder3_paramset1);
	                        free(lquasiset_xixi0_freepts_extraporder3_paramset1);
	                        free(lquasiset_trace0_freepts_extraporder3_paramset1);
	                        free(lquasiset_massdensity0_freepts_extraporder3_paramset1);
	                        free(lquasiset_angmomdensityx0_freepts_extraporder3_paramset1);
	                        free(lquasiset_angmomdensityy0_freepts_extraporder3_paramset1);
	                        free(lquasiset_angmomdensityz0_freepts_extraporder3_paramset1);
	                        free(lbdyphi0_freepts_extraporder3_paramset1);      
	                        free(maxquasiset_tt0_freepts_extraporder3_paramset1);        
	                        free(maxquasiset_tchi0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_txi0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_chichi0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_chixi0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_xixi0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_trace0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_massdensity0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_angmomdensityx0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_angmomdensityy0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_angmomdensityz0_freepts_extraporder3_paramset1);
	                        free(maxbdyphi0_freepts_extraporder3_paramset1);    
	                        free(minquasiset_tt0_freepts_extraporder3_paramset1);
	                        free(minquasiset_tchi0_freepts_extraporder3_paramset1);
	                        free(minquasiset_txi0_freepts_extraporder3_paramset1);
	                        free(minquasiset_chichi0_freepts_extraporder3_paramset1);
	                        free(minquasiset_chixi0_freepts_extraporder3_paramset1);
	                        free(minquasiset_xixi0_freepts_extraporder3_paramset1);
	                        free(minquasiset_trace0_freepts_extraporder3_paramset1);
	                        free(minquasiset_massdensity0_freepts_extraporder3_paramset1);
	                        free(minquasiset_angmomdensityx0_freepts_extraporder3_paramset1);
	                        free(minquasiset_angmomdensityy0_freepts_extraporder3_paramset1);
	                        free(minquasiset_angmomdensityz0_freepts_extraporder3_paramset1);
	                        free(minbdyphi0_freepts_extraporder3_paramset1);    
	                        free(quasiset_tt0_freepts_extraporder3_paramset1);
	                        free(quasiset_tchi0_freepts_extraporder3_paramset1);
	                        free(quasiset_txi0_freepts_extraporder3_paramset1);
	                        free(quasiset_chichi0_freepts_extraporder3_paramset1);
	                        free(quasiset_chixi0_freepts_extraporder3_paramset1);
	                        free(quasiset_xixi0_freepts_extraporder3_paramset1);
	                        free(quasiset_trace0_freepts_extraporder3_paramset1);
	                        free(quasiset_massdensity0_freepts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityx0_freepts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityy0_freepts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityz0_freepts_extraporder3_paramset1);
	                        free(bdyphi0_freepts_extraporder3_paramset1);
	                        free(AdS_mass0_freepts_extraporder3_paramset1);     
	                        free(xpbdy0_freepts_extraporder3_paramset1);
	                        free(ypbdy0_freepts_extraporder3_paramset1);
	                        free(zpbdy0_freepts_extraporder3_paramset1);
	                       	free(x_outermostpt0_freepts_extraporder3_paramset1);
	                       	free(y_outermostpt0_freepts_extraporder3_paramset1);
	                       	free(z_outermostpt0_freepts_extraporder3_paramset1);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_freepts_extraporder3_paramset1);
	                            free(chiextrap0_freepts_extraporder3_paramset1);
	                            free(xiextrap0_freepts_extraporder3_paramset1);             
	                            free(rhobdy0_freepts_extraporder3_paramset1);
	                            free(chibdy0_freepts_extraporder3_paramset1);
	                            free(xibdy0_freepts_extraporder3_paramset1);    
	                        }   	
		                }//closes condition on output_bdy_extraporder3_paramset1

		                //MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_freepts 3rd order extrap paramset1\n"); fflush(stdout);}

	            		//EXTRAPOLATION WITH SECOND SET OF PARAMETERS (denoted by index 2 at the end)

		        		//FIRST ORDER EXTRAPOLATION
		            	if (output_bdy_extraporder1_paramset2)
	            		{
							bdy_extrap_order=1;
	
							//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
							if (rad_extrap)
		                	{
	    	            		if (my_rank==0) printf("%i-th order radial extrapolation of boundary quantities using paramset2 parameters - saved in freepts_extraporder1_paramset2*.txt files\n",bdy_extrap_order);
	        	        		nexttobdypoints_radextrap_(chrbdy_freepts_extraporder1_paramset2,&numbdypoints_freepts_extraporder1_paramset2,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset2,&half_steps_from_bdy_int_paramset2,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	            	    	}
	                		else
	                		{
	                			nexttobdypoints_freepts_(chrbdy_freepts_extraporder1_paramset2,&numbdypoints_freepts_extraporder1_paramset2,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset2,&half_steps_from_bdy_int_paramset2,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                		}
	
								//MPI_Barrier(MPI_COMM_WORLD);
								//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset2 - POST COMPUTE NUMBER OF BOUNDARY QUANTITIES   \n"); fflush(stdout);}
	
	                		//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_freepts_extraporder1_paramset2 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_freepts_extraporder1_paramset2 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_freepts_extraporder1_paramset2,1,MPI_INT,vecbdypoints_freepts_extraporder1_paramset2,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_freepts_extraporder1_paramset2,&basenumbdypoints_freepts_extraporder1_paramset2,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_freepts_extraporder1_paramset2=%i\n",numbdypoints_freepts_extraporder1_paramset2);
	                        //fflush(stdout); 
	                        quasiset_tt_freepts_extraporder1_paramset2              = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_tchi_freepts_extraporder1_paramset2            = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_txi_freepts_extraporder1_paramset2             = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_chichi_freepts_extraporder1_paramset2          = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_chixi_freepts_extraporder1_paramset2           = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_xixi_freepts_extraporder1_paramset2            = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_trace_freepts_extraporder1_paramset2           = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_massdensity_freepts_extraporder1_paramset2     = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx_freepts_extraporder1_paramset2  = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy_freepts_extraporder1_paramset2  = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz_freepts_extraporder1_paramset2  = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        bdyphi_freepts_extraporder1_paramset2                   = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));   
	                        xpbdy_freepts_extraporder1_paramset2               = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        ypbdy_freepts_extraporder1_paramset2               = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        zpbdy_freepts_extraporder1_paramset2               = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));  
	                       	x_outermostpt_freepts_extraporder1_paramset2            = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                       	y_outermostpt_freepts_extraporder1_paramset2            = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                       	z_outermostpt_freepts_extraporder1_paramset2            = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real)); 
	
	                        lquasiset_tt0_freepts_extraporder1_paramset2            = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_tchi0_freepts_extraporder1_paramset2          = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_txi0_freepts_extraporder1_paramset2           = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_chichi0_freepts_extraporder1_paramset2        = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_chixi0_freepts_extraporder1_paramset2         = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_xixi0_freepts_extraporder1_paramset2          = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_trace0_freepts_extraporder1_paramset2         = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_massdensity0_freepts_extraporder1_paramset2   = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityx0_freepts_extraporder1_paramset2= malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityy0_freepts_extraporder1_paramset2= malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityz0_freepts_extraporder1_paramset2= malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lbdyphi0_freepts_extraporder1_paramset2                 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));   
	                        maxquasiset_tt0_freepts_extraporder1_paramset2          = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_tchi0_freepts_extraporder1_paramset2        = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_txi0_freepts_extraporder1_paramset2         = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_chichi0_freepts_extraporder1_paramset2      = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_chixi0_freepts_extraporder1_paramset2       = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_xixi0_freepts_extraporder1_paramset2        = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_trace0_freepts_extraporder1_paramset2       = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_massdensity0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityx0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityy0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityz0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxbdyphi0_freepts_extraporder1_paramset2               = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));   
	                        minquasiset_tt0_freepts_extraporder1_paramset2          = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_tchi0_freepts_extraporder1_paramset2        = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_txi0_freepts_extraporder1_paramset2         = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_chichi0_freepts_extraporder1_paramset2      = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_chixi0_freepts_extraporder1_paramset2       = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_xixi0_freepts_extraporder1_paramset2        = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_trace0_freepts_extraporder1_paramset2       = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_massdensity0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityx0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityy0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityz0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minbdyphi0_freepts_extraporder1_paramset2               = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));   
	                        quasiset_tt0_freepts_extraporder1_paramset2             = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_tchi0_freepts_extraporder1_paramset2           = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_txi0_freepts_extraporder1_paramset2            = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_chichi0_freepts_extraporder1_paramset2         = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_chixi0_freepts_extraporder1_paramset2          = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_xixi0_freepts_extraporder1_paramset2           = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_trace0_freepts_extraporder1_paramset2          = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_massdensity0_freepts_extraporder1_paramset2    = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        AdS_mass0_freepts_extraporder1_paramset2                = malloc(sizeof(real));
	                        bdyphi0_freepts_extraporder1_paramset2                  = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));    
	                        xpbdy0_freepts_extraporder1_paramset2              = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        ypbdy0_freepts_extraporder1_paramset2              = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        zpbdy0_freepts_extraporder1_paramset2              = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));   
	                       	x_outermostpt0_freepts_extraporder1_paramset2           = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                       	y_outermostpt0_freepts_extraporder1_paramset2           = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                       	z_outermostpt0_freepts_extraporder1_paramset2           = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_freepts_extraporder1_paramset2=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_freepts_extraporder1_paramset2=vecbdypoints_freepts_extraporder1_paramset2[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_freepts_extraporder1_paramset2=is_bdy_freepts_extraporder1_paramset2+vecbdypoints_freepts_extraporder1_paramset2[j];
	                            }
	                            ie_bdy_freepts_extraporder1_paramset2=is_bdy_freepts_extraporder1_paramset2+vecbdypoints_freepts_extraporder1_paramset2[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_freepts_extraporder1_paramset2[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_freepts_extraporder1_paramset2[i]=dsplsbdypoints_freepts_extraporder1_paramset2[i]+vecbdypoints_freepts_extraporder1_paramset2[j];
	                                }
	                            }
	                        }   
	
	                        if (rad_extrap)
							{
								xyz_bdy_out_radextrap_(xpbdy_freepts_extraporder1_paramset2,ypbdy_freepts_extraporder1_paramset2,zpbdy_freepts_extraporder1_paramset2,
	                        						x_outermostpt_freepts_extraporder1_paramset2,y_outermostpt_freepts_extraporder1_paramset2,z_outermostpt_freepts_extraporder1_paramset2,
	                        						chrbdy_freepts_extraporder1_paramset2,&numbdypoints_freepts_extraporder1_paramset2,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
							}
	                    	else
	                    	{
	                        	xyz_extrap_outermost_(xpbdy_freepts_extraporder1_paramset2,ypbdy_freepts_extraporder1_paramset2,zpbdy_freepts_extraporder1_paramset2,
	                        						x_outermostpt_freepts_extraporder1_paramset2,y_outermostpt_freepts_extraporder1_paramset2,z_outermostpt_freepts_extraporder1_paramset2,
	                        						chrbdy_freepts_extraporder1_paramset2,&numbdypoints_freepts_extraporder1_paramset2,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	                        }
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_freepts_extraporder1_paramset2,numbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,xpbdy0_freepts_extraporder1_paramset2,vecbdypoints_freepts_extraporder1_paramset2,dsplsbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_freepts_extraporder1_paramset2,numbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,ypbdy0_freepts_extraporder1_paramset2,vecbdypoints_freepts_extraporder1_paramset2,dsplsbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_freepts_extraporder1_paramset2,numbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,zpbdy0_freepts_extraporder1_paramset2,vecbdypoints_freepts_extraporder1_paramset2,dsplsbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_freepts_extraporder1_paramset2,numbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,x_outermostpt0_freepts_extraporder1_paramset2,vecbdypoints_freepts_extraporder1_paramset2,dsplsbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_freepts_extraporder1_paramset2,numbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,y_outermostpt0_freepts_extraporder1_paramset2,vecbdypoints_freepts_extraporder1_paramset2,dsplsbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_freepts_extraporder1_paramset2,numbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,z_outermostpt0_freepts_extraporder1_paramset2,vecbdypoints_freepts_extraporder1_paramset2,dsplsbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_freepts_extraporder1_paramset2 = malloc(sizeof(real));
	                                chiextrap0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                                xiextrap0_freepts_extraporder1_paramset2  = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_freepts_extraporder1_paramset2,chiextrap0_freepts_extraporder1_paramset2,xiextrap0_freepts_extraporder1_paramset2,xpbdy0_freepts_extraporder1_paramset2,ypbdy0_freepts_extraporder1_paramset2,zpbdy0_freepts_extraporder1_paramset2,&basenumbdypoints_freepts_extraporder1_paramset2);  
	                                basebdy_Nchi_freepts_extraporder1_paramset2=0;//initialize
	                                basebdy_Nxi_freepts_extraporder1_paramset2=0; //initialize
	                                bdyn_(&basebdy_Nchi_freepts_extraporder1_paramset2,&basebdy_Nxi_freepts_extraporder1_paramset2,&basenumbdypoints_freepts_extraporder1_paramset2,chiextrap0_freepts_extraporder1_paramset2,xiextrap0_freepts_extraporder1_paramset2);  
	                                rhobdy0_freepts_extraporder1_paramset2 = malloc(sizeof(real));
	                                chibdy0_freepts_extraporder1_paramset2 = malloc(basebdy_Nchi_freepts_extraporder1_paramset2*sizeof(real));
	                                xibdy0_freepts_extraporder1_paramset2  = malloc(basebdy_Nxi_freepts_extraporder1_paramset2*sizeof(real));   
	                            }
	                        }
	
	
							if (rad_extrap)
	                		{
	
	                			bdyphi_radextrap_(bdyphi_freepts_extraporder1_paramset2,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder1_paramset2,ypbdy_freepts_extraporder1_paramset2,zpbdy_freepts_extraporder1_paramset2,
	                                        chrbdy_freepts_extraporder1_paramset2,&numbdypoints_freepts_extraporder1_paramset2,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        	quasiset_radextrap_(quasiset_tt_freepts_extraporder1_paramset2,quasiset_tchi_freepts_extraporder1_paramset2,quasiset_txi_freepts_extraporder1_paramset2,
	                                quasiset_chichi_freepts_extraporder1_paramset2,quasiset_chixi_freepts_extraporder1_paramset2,
	                                quasiset_xixi_freepts_extraporder1_paramset2,
	                                quasiset_trace_freepts_extraporder1_paramset2,
	                                quasiset_massdensity_freepts_extraporder1_paramset2,
	                                quasiset_angmomdensityx_freepts_extraporder1_paramset2,
	                                quasiset_angmomdensityy_freepts_extraporder1_paramset2,
	                                quasiset_angmomdensityz_freepts_extraporder1_paramset2,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder1_paramset2,ypbdy_freepts_extraporder1_paramset2,zpbdy_freepts_extraporder1_paramset2,
	                                chrbdy_freepts_extraporder1_paramset2,&numbdypoints_freepts_extraporder1_paramset2,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                		}
	                		else
	                		{   
	                        	extrap_bdyphi_freepts_(bdyphi_freepts_extraporder1_paramset2,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder1_paramset2,ypbdy_freepts_extraporder1_paramset2,zpbdy_freepts_extraporder1_paramset2,
	                                        chrbdy_freepts_extraporder1_paramset2,&numbdypoints_freepts_extraporder1_paramset2,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        	extrap_quasiset_freepts_(quasiset_tt_freepts_extraporder1_paramset2,quasiset_tchi_freepts_extraporder1_paramset2,quasiset_txi_freepts_extraporder1_paramset2,
	                                quasiset_chichi_freepts_extraporder1_paramset2,quasiset_chixi_freepts_extraporder1_paramset2,
	                                quasiset_xixi_freepts_extraporder1_paramset2,
	                                quasiset_trace_freepts_extraporder1_paramset2,
	                                quasiset_massdensity_freepts_extraporder1_paramset2,
	                                quasiset_angmomdensityx_freepts_extraporder1_paramset2,
	                                quasiset_angmomdensityy_freepts_extraporder1_paramset2,
	                                quasiset_angmomdensityz_freepts_extraporder1_paramset2,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder1_paramset2,ypbdy_freepts_extraporder1_paramset2,zpbdy_freepts_extraporder1_paramset2,
	                                chrbdy_freepts_extraporder1_paramset2,&numbdypoints_freepts_extraporder1_paramset2,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                        } 
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_freepts_extraporder1_paramset2; i<ie_bdy_freepts_extraporder1_paramset2; i++)
	                        {
	                            lquasiset_tt0_freepts_extraporder1_paramset2           [i] = quasiset_tt_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_tchi0_freepts_extraporder1_paramset2         [i] = quasiset_tchi_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_txi0_freepts_extraporder1_paramset2          [i] = quasiset_txi_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_chichi0_freepts_extraporder1_paramset2       [i] = quasiset_chichi_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_chixi0_freepts_extraporder1_paramset2        [i] = quasiset_chixi_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_xixi0_freepts_extraporder1_paramset2         [i] = quasiset_xixi_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_trace0_freepts_extraporder1_paramset2        [i] = quasiset_trace_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_massdensity0_freepts_extraporder1_paramset2  [i] = quasiset_massdensity_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_angmomdensityx0_freepts_extraporder1_paramset2 [i] = quasiset_angmomdensityx_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_angmomdensityy0_freepts_extraporder1_paramset2 [i] = quasiset_angmomdensityy_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_angmomdensityz0_freepts_extraporder1_paramset2 [i] = quasiset_angmomdensityz_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lbdyphi0_freepts_extraporder1_paramset2                [i] = bdyphi_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                        }   

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset2 - POST PERFORM EXTRAPOLATION BOUNDARY QUANTITIES   \n"); fflush(stdout);}
	
							//PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder1_paramset2,          maxquasiset_tt0_freepts_extraporder1_paramset2,          basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder1_paramset2,        maxquasiset_tchi0_freepts_extraporder1_paramset2,        basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder1_paramset2,         maxquasiset_txi0_freepts_extraporder1_paramset2,         basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder1_paramset2,      maxquasiset_chichi0_freepts_extraporder1_paramset2,      basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder1_paramset2,       maxquasiset_chixi0_freepts_extraporder1_paramset2,       basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder1_paramset2,        maxquasiset_xixi0_freepts_extraporder1_paramset2,        basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder1_paramset2,       maxquasiset_trace0_freepts_extraporder1_paramset2,       basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder1_paramset2, maxquasiset_massdensity0_freepts_extraporder1_paramset2, basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder1_paramset2, maxquasiset_angmomdensityx0_freepts_extraporder1_paramset2, basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder1_paramset2, maxquasiset_angmomdensityy0_freepts_extraporder1_paramset2, basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder1_paramset2, maxquasiset_angmomdensityz0_freepts_extraporder1_paramset2, basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder1_paramset2,               maxbdyphi0_freepts_extraporder1_paramset2,               basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder1_paramset2,          minquasiset_tt0_freepts_extraporder1_paramset2,          basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder1_paramset2,        minquasiset_tchi0_freepts_extraporder1_paramset2,        basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder1_paramset2,         minquasiset_txi0_freepts_extraporder1_paramset2,         basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder1_paramset2,      minquasiset_chichi0_freepts_extraporder1_paramset2,      basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder1_paramset2,       minquasiset_chixi0_freepts_extraporder1_paramset2,       basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder1_paramset2,        minquasiset_xixi0_freepts_extraporder1_paramset2,        basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder1_paramset2,       minquasiset_trace0_freepts_extraporder1_paramset2,       basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder1_paramset2, minquasiset_massdensity0_freepts_extraporder1_paramset2, basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder1_paramset2, minquasiset_angmomdensityx0_freepts_extraporder1_paramset2, basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder1_paramset2, minquasiset_angmomdensityy0_freepts_extraporder1_paramset2, basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder1_paramset2, minquasiset_angmomdensityz0_freepts_extraporder1_paramset2, basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder1_paramset2,               minbdyphi0_freepts_extraporder1_paramset2,               basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset2 - in PRINT BOUNDARY QUANTITIES - POST MPI_Allreduce   \n"); fflush(stdout);}

	                        for (i=0; i<basenumbdypoints_freepts_extraporder1_paramset2; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_freepts_extraporder1_paramset2          [i] = maxquasiset_tt0_freepts_extraporder1_paramset2          [i] + minquasiset_tt0_freepts_extraporder1_paramset2          [i];
	                                    quasiset_tchi0_freepts_extraporder1_paramset2        [i] = maxquasiset_tchi0_freepts_extraporder1_paramset2        [i] + minquasiset_tchi0_freepts_extraporder1_paramset2        [i];
	                                    quasiset_txi0_freepts_extraporder1_paramset2         [i] = maxquasiset_txi0_freepts_extraporder1_paramset2         [i] + minquasiset_txi0_freepts_extraporder1_paramset2         [i];
	                                    quasiset_chichi0_freepts_extraporder1_paramset2      [i] = maxquasiset_chichi0_freepts_extraporder1_paramset2      [i] + minquasiset_chichi0_freepts_extraporder1_paramset2      [i];
	                                    quasiset_chixi0_freepts_extraporder1_paramset2       [i] = maxquasiset_chixi0_freepts_extraporder1_paramset2       [i] + minquasiset_chixi0_freepts_extraporder1_paramset2       [i];
	                                    quasiset_xixi0_freepts_extraporder1_paramset2        [i] = maxquasiset_xixi0_freepts_extraporder1_paramset2        [i] + minquasiset_xixi0_freepts_extraporder1_paramset2        [i];
	                                    quasiset_trace0_freepts_extraporder1_paramset2       [i] = maxquasiset_trace0_freepts_extraporder1_paramset2       [i] + minquasiset_trace0_freepts_extraporder1_paramset2       [i];
	                                    quasiset_massdensity0_freepts_extraporder1_paramset2 [i] = maxquasiset_massdensity0_freepts_extraporder1_paramset2 [i] + minquasiset_massdensity0_freepts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityx0_freepts_extraporder1_paramset2 [i] + minquasiset_angmomdensityx0_freepts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityy0_freepts_extraporder1_paramset2 [i] + minquasiset_angmomdensityy0_freepts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityz0_freepts_extraporder1_paramset2 [i] + minquasiset_angmomdensityz0_freepts_extraporder1_paramset2 [i];
	                                    bdyphi0_freepts_extraporder1_paramset2               [i] = maxbdyphi0_freepts_extraporder1_paramset2               [i] + minbdyphi0_freepts_extraporder1_paramset2               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_freepts_extraporder1_paramset2          [i] = maxquasiset_tt0_freepts_extraporder1_paramset2          [i];
	                                    quasiset_tchi0_freepts_extraporder1_paramset2        [i] = maxquasiset_tchi0_freepts_extraporder1_paramset2        [i];
	                                    quasiset_txi0_freepts_extraporder1_paramset2         [i] = maxquasiset_txi0_freepts_extraporder1_paramset2         [i];
	                                    quasiset_chichi0_freepts_extraporder1_paramset2      [i] = maxquasiset_chichi0_freepts_extraporder1_paramset2      [i];
	                                    quasiset_chixi0_freepts_extraporder1_paramset2       [i] = maxquasiset_chixi0_freepts_extraporder1_paramset2       [i];
	                                    quasiset_xixi0_freepts_extraporder1_paramset2        [i] = maxquasiset_xixi0_freepts_extraporder1_paramset2        [i];
	                                    quasiset_trace0_freepts_extraporder1_paramset2       [i] = maxquasiset_trace0_freepts_extraporder1_paramset2       [i];
	                                    quasiset_massdensity0_freepts_extraporder1_paramset2 [i] = maxquasiset_massdensity0_freepts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityx0_freepts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityy0_freepts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityz0_freepts_extraporder1_paramset2 [i];
	                                    bdyphi0_freepts_extraporder1_paramset2               [i] = maxbdyphi0_freepts_extraporder1_paramset2               [i];
	                                }  
	                        }      

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset2 - in PRINT BOUNDARY QUANTITIES - PRE print   \n"); fflush(stdout);} 
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {     
	                            			size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder1_paramset2[j],ypbdy0_freepts_extraporder1_paramset2[j],zpbdy0_freepts_extraporder1_paramset2[j],j);
		                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder1_paramset2[j],ypbdy0_freepts_extraporder1_paramset2[j],zpbdy0_freepts_extraporder1_paramset2[j],j);
		                                    }
		                                    fclose(fp);
		                                    free(name);

		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder1_paramset2[j],ypbdy0_freepts_extraporder1_paramset2[j],zpbdy0_freepts_extraporder1_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }  

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset2 - in PRINT BOUNDARY QUANTITIES - post print xext   \n"); fflush(stdout);}  


	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder1_paramset2[j],y_outermostpt0_freepts_extraporder1_paramset2[j],z_outermostpt0_freepts_extraporder1_paramset2[j],j);
	                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder1_paramset2[j],y_outermostpt0_freepts_extraporder1_paramset2[j],z_outermostpt0_freepts_extraporder1_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder1_paramset2[j],y_outermostpt0_freepts_extraporder1_paramset2[j],z_outermostpt0_freepts_extraporder1_paramset2[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name);
	                                	}   
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset2 - in PRINT BOUNDARY QUANTITIES - post print xout   \n"); fflush(stdout);} 

	                                if(output_bdyphi)
	                                {
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder1_paramset2[j],j);
		                                    }
		                                    fclose(fp); 
		                                    free(name);
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder1_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                } 
	                                }    

	                                    // save quasiset_ll as ascii
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder1_paramset2[j],quasiset_tchi0_freepts_extraporder1_paramset2[j],quasiset_txi0_freepts_extraporder1_paramset2[j],quasiset_chichi0_freepts_extraporder1_paramset2[j],quasiset_chixi0_freepts_extraporder1_paramset2[j],quasiset_xixi0_freepts_extraporder1_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder1_paramset2[j],quasiset_tchi0_freepts_extraporder1_paramset2[j],quasiset_txi0_freepts_extraporder1_paramset2[j],quasiset_chichi0_freepts_extraporder1_paramset2[j],quasiset_chixi0_freepts_extraporder1_paramset2[j],quasiset_xixi0_freepts_extraporder1_paramset2[j],
	                                                    j_red);
	                                            //printf("%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                            //        ct,
	                                            //        quasiset_tt0_freepts_extraporder1_paramset2[j],quasiset_tchi0_freepts_extraporder1_paramset2[j],quasiset_txi0_freepts_extraporder1_paramset2[j],quasiset_chichi0_freepts_extraporder1_paramset2[j],quasiset_chixi0_freepts_extraporder1_paramset2[j],quasiset_xixi0_freepts_extraporder1_paramset2[j],
	                                            //        j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset2 - in PRINT BOUNDARY QUANTITIES - post print quasisetll  \n"); fflush(stdout);} 

	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_freepts_extraporder1_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_freepts_extraporder1_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {   
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_freepts_extraporder1_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);  
	                                    free(name); 
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_freepts_extraporder1_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {

		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
			                            	sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder1_paramset2[j],quasiset_angmomdensityy0_freepts_extraporder1_paramset2[j],quasiset_angmomdensityz0_freepts_extraporder1_paramset2[j],
		                                                    j);
		                                    }
		                                    fclose(fp);
		                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder1_paramset2[j],quasiset_angmomdensityy0_freepts_extraporder1_paramset2[j],quasiset_angmomdensityz0_freepts_extraporder1_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_freepts_extraporder1_paramset2=1;
	                                chibdy_xibdy_(chibdy0_freepts_extraporder1_paramset2,xibdy0_freepts_extraporder1_paramset2,xpbdy0_freepts_extraporder1_paramset2,ypbdy0_freepts_extraporder1_paramset2,zpbdy0_freepts_extraporder1_paramset2,&basenumbdypoints_freepts_extraporder1_paramset2,chiextrap0_freepts_extraporder1_paramset2,xiextrap0_freepts_extraporder1_paramset2,&basebdy_Nchi_freepts_extraporder1_paramset2,&basebdy_Nxi_freepts_extraporder1_paramset2);    
	                                doubleintegralonsphere_(AdS_mass0_freepts_extraporder1_paramset2,quasiset_massdensity0_freepts_extraporder1_paramset2,xpbdy0_freepts_extraporder1_paramset2,ypbdy0_freepts_extraporder1_paramset2,zpbdy0_freepts_extraporder1_paramset2,&basenumbdypoints_freepts_extraporder1_paramset2,rhobdy0_freepts_extraporder1_paramset2,chibdy0_freepts_extraporder1_paramset2,xibdy0_freepts_extraporder1_paramset2,&basebdy_Nchi_freepts_extraporder1_paramset2,&basebdy_Nxi_freepts_extraporder1_paramset2);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_%st_AdSmass.txt",AMRD_save_tag) + 1;
    								name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_freepts_extraporder1_paramset2);
	                                fclose(fp);
	                                free(name);
	                            }
	                        }

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset2 - POST PRINT BOUNDARY QUANTITIES   \n"); fflush(stdout);}

	                        free(vecbdypoints_freepts_extraporder1_paramset2);
	                        free(dsplsbdypoints_freepts_extraporder1_paramset2);
	                        free(quasiset_tt_freepts_extraporder1_paramset2);
	                        free(quasiset_tchi_freepts_extraporder1_paramset2);
	                        free(quasiset_txi_freepts_extraporder1_paramset2);
	                        free(quasiset_chichi_freepts_extraporder1_paramset2);
	                        free(quasiset_chixi_freepts_extraporder1_paramset2);
	                        free(quasiset_xixi_freepts_extraporder1_paramset2);
	                        free(quasiset_trace_freepts_extraporder1_paramset2);
	                        free(quasiset_massdensity_freepts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityx_freepts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityy_freepts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityz_freepts_extraporder1_paramset2);
	                        free(bdyphi_freepts_extraporder1_paramset2);  
	                        free(xpbdy_freepts_extraporder1_paramset2);
	                        free(ypbdy_freepts_extraporder1_paramset2);
	                        free(zpbdy_freepts_extraporder1_paramset2);   
	                       	free(x_outermostpt_freepts_extraporder1_paramset2);
	                       	free(y_outermostpt_freepts_extraporder1_paramset2);
	                       	free(z_outermostpt_freepts_extraporder1_paramset2);   
	
	                        free(lquasiset_tt0_freepts_extraporder1_paramset2);        
	                        free(lquasiset_tchi0_freepts_extraporder1_paramset2);
	                        free(lquasiset_txi0_freepts_extraporder1_paramset2);
	                        free(lquasiset_chichi0_freepts_extraporder1_paramset2);
	                        free(lquasiset_chixi0_freepts_extraporder1_paramset2);
	                        free(lquasiset_xixi0_freepts_extraporder1_paramset2);
	                        free(lquasiset_trace0_freepts_extraporder1_paramset2);
	                        free(lquasiset_massdensity0_freepts_extraporder1_paramset2);
	                        free(lquasiset_angmomdensityx0_freepts_extraporder1_paramset2);
	                        free(lquasiset_angmomdensityy0_freepts_extraporder1_paramset2);
	                        free(lquasiset_angmomdensityz0_freepts_extraporder1_paramset2);
	                        free(lbdyphi0_freepts_extraporder1_paramset2);      
	                        free(maxquasiset_tt0_freepts_extraporder1_paramset2);        
	                        free(maxquasiset_tchi0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_txi0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_chichi0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_chixi0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_xixi0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_trace0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_massdensity0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_angmomdensityx0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_angmomdensityy0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_angmomdensityz0_freepts_extraporder1_paramset2);
	                        free(maxbdyphi0_freepts_extraporder1_paramset2);    
	                        free(minquasiset_tt0_freepts_extraporder1_paramset2);
	                        free(minquasiset_tchi0_freepts_extraporder1_paramset2);
	                        free(minquasiset_txi0_freepts_extraporder1_paramset2);
	                        free(minquasiset_chichi0_freepts_extraporder1_paramset2);
	                        free(minquasiset_chixi0_freepts_extraporder1_paramset2);
	                        free(minquasiset_xixi0_freepts_extraporder1_paramset2);
	                        free(minquasiset_trace0_freepts_extraporder1_paramset2);
	                        free(minquasiset_massdensity0_freepts_extraporder1_paramset2);
	                        free(minquasiset_angmomdensityx0_freepts_extraporder1_paramset2);
	                        free(minquasiset_angmomdensityy0_freepts_extraporder1_paramset2);
	                        free(minquasiset_angmomdensityz0_freepts_extraporder1_paramset2);
	                        free(minbdyphi0_freepts_extraporder1_paramset2);    
	                        free(quasiset_tt0_freepts_extraporder1_paramset2);
	                        free(quasiset_tchi0_freepts_extraporder1_paramset2);
	                        free(quasiset_txi0_freepts_extraporder1_paramset2);
	                        free(quasiset_chichi0_freepts_extraporder1_paramset2);
	                        free(quasiset_chixi0_freepts_extraporder1_paramset2);
	                        free(quasiset_xixi0_freepts_extraporder1_paramset2);
	                        free(quasiset_trace0_freepts_extraporder1_paramset2);
	                        free(quasiset_massdensity0_freepts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityx0_freepts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityy0_freepts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityz0_freepts_extraporder1_paramset2);
	                        free(bdyphi0_freepts_extraporder1_paramset2);
	                        free(AdS_mass0_freepts_extraporder1_paramset2);     
	                        free(xpbdy0_freepts_extraporder1_paramset2);
	                        free(ypbdy0_freepts_extraporder1_paramset2);
	                        free(zpbdy0_freepts_extraporder1_paramset2);
	                       	free(x_outermostpt0_freepts_extraporder1_paramset2);
	                       	free(y_outermostpt0_freepts_extraporder1_paramset2);
	                       	free(z_outermostpt0_freepts_extraporder1_paramset2);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_freepts_extraporder1_paramset2);
	                            free(chiextrap0_freepts_extraporder1_paramset2);
	                            free(xiextrap0_freepts_extraporder1_paramset2);             
	                            free(rhobdy0_freepts_extraporder1_paramset2);
	                            free(chibdy0_freepts_extraporder1_paramset2);
	                            free(xibdy0_freepts_extraporder1_paramset2);    
	                        }	
	            		}//closes condition on output_bdy_extraporder1_paramset2

	            		//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_freepts 1st order extrap paramset2\n"); fflush(stdout);}

	            		//SECOND ORDER EXTRAPOLATION
		            	if (output_bdy_extraporder2_paramset2)
	            		{
							bdy_extrap_order=2;
	
							//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
                			if (rad_extrap)
	                		{
    	            			if (my_rank==0) printf("%i-th order radial extrapolation of boundary quantities using paramset2 parameters - saved in freepts_extraporder2_paramset2*.txt files\n",bdy_extrap_order);
        	        			nexttobdypoints_radextrap_(chrbdy_freepts_extraporder2_paramset2,&numbdypoints_freepts_extraporder2_paramset2,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset2,&half_steps_from_bdy_int_paramset2,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
            	    		}
                			else
                			{
                				nexttobdypoints_freepts_(chrbdy_freepts_extraporder2_paramset2,&numbdypoints_freepts_extraporder2_paramset2,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset2,&half_steps_from_bdy_int_paramset2,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
                			}
	
	
	                		//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_freepts_extraporder2_paramset2 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_freepts_extraporder2_paramset2 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_freepts_extraporder2_paramset2,1,MPI_INT,vecbdypoints_freepts_extraporder2_paramset2,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_freepts_extraporder2_paramset2,&basenumbdypoints_freepts_extraporder2_paramset2,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_freepts_extraporder2_paramset2=%i\n",numbdypoints_freepts_extraporder2_paramset2);
	                        //fflush(stdout); 
	                        quasiset_tt_freepts_extraporder2_paramset2              = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_tchi_freepts_extraporder2_paramset2            = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_txi_freepts_extraporder2_paramset2             = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_chichi_freepts_extraporder2_paramset2          = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_chixi_freepts_extraporder2_paramset2           = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_xixi_freepts_extraporder2_paramset2            = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_trace_freepts_extraporder2_paramset2           = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_massdensity_freepts_extraporder2_paramset2     = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx_freepts_extraporder2_paramset2  = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy_freepts_extraporder2_paramset2  = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz_freepts_extraporder2_paramset2  = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        bdyphi_freepts_extraporder2_paramset2                   = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));   
	                        xpbdy_freepts_extraporder2_paramset2               = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        ypbdy_freepts_extraporder2_paramset2               = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        zpbdy_freepts_extraporder2_paramset2               = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));  
	                       	x_outermostpt_freepts_extraporder2_paramset2            = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                       	y_outermostpt_freepts_extraporder2_paramset2            = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                       	z_outermostpt_freepts_extraporder2_paramset2            = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real)); 
	
	                        lquasiset_tt0_freepts_extraporder2_paramset2            = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_tchi0_freepts_extraporder2_paramset2          = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_txi0_freepts_extraporder2_paramset2           = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_chichi0_freepts_extraporder2_paramset2        = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_chixi0_freepts_extraporder2_paramset2         = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_xixi0_freepts_extraporder2_paramset2          = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_trace0_freepts_extraporder2_paramset2         = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_massdensity0_freepts_extraporder2_paramset2   = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityx0_freepts_extraporder2_paramset2= malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityy0_freepts_extraporder2_paramset2= malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityz0_freepts_extraporder2_paramset2= malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lbdyphi0_freepts_extraporder2_paramset2                 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));   
	                        maxquasiset_tt0_freepts_extraporder2_paramset2          = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_tchi0_freepts_extraporder2_paramset2        = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_txi0_freepts_extraporder2_paramset2         = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_chichi0_freepts_extraporder2_paramset2      = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_chixi0_freepts_extraporder2_paramset2       = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_xixi0_freepts_extraporder2_paramset2        = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_trace0_freepts_extraporder2_paramset2       = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_massdensity0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityx0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityy0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityz0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxbdyphi0_freepts_extraporder2_paramset2               = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));   
	                        minquasiset_tt0_freepts_extraporder2_paramset2          = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_tchi0_freepts_extraporder2_paramset2        = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_txi0_freepts_extraporder2_paramset2         = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_chichi0_freepts_extraporder2_paramset2      = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_chixi0_freepts_extraporder2_paramset2       = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_xixi0_freepts_extraporder2_paramset2        = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_trace0_freepts_extraporder2_paramset2       = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_massdensity0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityx0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityy0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityz0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minbdyphi0_freepts_extraporder2_paramset2               = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));   
	                        quasiset_tt0_freepts_extraporder2_paramset2             = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_tchi0_freepts_extraporder2_paramset2           = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_txi0_freepts_extraporder2_paramset2            = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_chichi0_freepts_extraporder2_paramset2         = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_chixi0_freepts_extraporder2_paramset2          = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_xixi0_freepts_extraporder2_paramset2           = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_trace0_freepts_extraporder2_paramset2          = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_massdensity0_freepts_extraporder2_paramset2    = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        AdS_mass0_freepts_extraporder2_paramset2                = malloc(sizeof(real));
	                        bdyphi0_freepts_extraporder2_paramset2                  = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));    
	                        xpbdy0_freepts_extraporder2_paramset2              = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        ypbdy0_freepts_extraporder2_paramset2              = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        zpbdy0_freepts_extraporder2_paramset2              = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));   
	                       	x_outermostpt0_freepts_extraporder2_paramset2           = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                       	y_outermostpt0_freepts_extraporder2_paramset2           = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                       	z_outermostpt0_freepts_extraporder2_paramset2           = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));   
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_freepts_extraporder2_paramset2=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_freepts_extraporder2_paramset2=vecbdypoints_freepts_extraporder2_paramset2[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_freepts_extraporder2_paramset2=is_bdy_freepts_extraporder2_paramset2+vecbdypoints_freepts_extraporder2_paramset2[j];
	                            }
	                            ie_bdy_freepts_extraporder2_paramset2=is_bdy_freepts_extraporder2_paramset2+vecbdypoints_freepts_extraporder2_paramset2[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_freepts_extraporder2_paramset2[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_freepts_extraporder2_paramset2[i]=dsplsbdypoints_freepts_extraporder2_paramset2[i]+vecbdypoints_freepts_extraporder2_paramset2[j];
	                                }
	                            }
	                        }   
	
	                        if (rad_extrap)
							{
								xyz_bdy_out_radextrap_(xpbdy_freepts_extraporder2_paramset2,ypbdy_freepts_extraporder2_paramset2,zpbdy_freepts_extraporder2_paramset2,
	                        						x_outermostpt_freepts_extraporder2_paramset2,y_outermostpt_freepts_extraporder2_paramset2,z_outermostpt_freepts_extraporder2_paramset2,
	                        						chrbdy_freepts_extraporder2_paramset2,&numbdypoints_freepts_extraporder2_paramset2,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
							}
	                    	else
	                    	{
	                        	xyz_extrap_outermost_(xpbdy_freepts_extraporder2_paramset2,ypbdy_freepts_extraporder2_paramset2,zpbdy_freepts_extraporder2_paramset2,
	                        						x_outermostpt_freepts_extraporder2_paramset2,y_outermostpt_freepts_extraporder2_paramset2,z_outermostpt_freepts_extraporder2_paramset2,
	                        						chrbdy_freepts_extraporder2_paramset2,&numbdypoints_freepts_extraporder2_paramset2,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	                        }
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_freepts_extraporder2_paramset2,numbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,xpbdy0_freepts_extraporder2_paramset2,vecbdypoints_freepts_extraporder2_paramset2,dsplsbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_freepts_extraporder2_paramset2,numbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,ypbdy0_freepts_extraporder2_paramset2,vecbdypoints_freepts_extraporder2_paramset2,dsplsbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_freepts_extraporder2_paramset2,numbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,zpbdy0_freepts_extraporder2_paramset2,vecbdypoints_freepts_extraporder2_paramset2,dsplsbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_freepts_extraporder2_paramset2,numbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,x_outermostpt0_freepts_extraporder2_paramset2,vecbdypoints_freepts_extraporder2_paramset2,dsplsbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_freepts_extraporder2_paramset2,numbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,y_outermostpt0_freepts_extraporder2_paramset2,vecbdypoints_freepts_extraporder2_paramset2,dsplsbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_freepts_extraporder2_paramset2,numbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,z_outermostpt0_freepts_extraporder2_paramset2,vecbdypoints_freepts_extraporder2_paramset2,dsplsbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_freepts_extraporder2_paramset2 = malloc(sizeof(real));
	                                chiextrap0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                                xiextrap0_freepts_extraporder2_paramset2  = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_freepts_extraporder2_paramset2,chiextrap0_freepts_extraporder2_paramset2,xiextrap0_freepts_extraporder2_paramset2,xpbdy0_freepts_extraporder2_paramset2,ypbdy0_freepts_extraporder2_paramset2,zpbdy0_freepts_extraporder2_paramset2,&basenumbdypoints_freepts_extraporder2_paramset2);  
	                                basebdy_Nchi_freepts_extraporder2_paramset2=0;//initialize
	                                basebdy_Nxi_freepts_extraporder2_paramset2=0; //initialize
	                                bdyn_(&basebdy_Nchi_freepts_extraporder2_paramset2,&basebdy_Nxi_freepts_extraporder2_paramset2,&basenumbdypoints_freepts_extraporder2_paramset2,chiextrap0_freepts_extraporder2_paramset2,xiextrap0_freepts_extraporder2_paramset2);  
	                                rhobdy0_freepts_extraporder2_paramset2 = malloc(sizeof(real));
	                                chibdy0_freepts_extraporder2_paramset2 = malloc(basebdy_Nchi_freepts_extraporder2_paramset2*sizeof(real));
	                                xibdy0_freepts_extraporder2_paramset2  = malloc(basebdy_Nxi_freepts_extraporder2_paramset2*sizeof(real));   
	                            }
	                        }
	
	
							if (rad_extrap)
	                		{
	
	                			bdyphi_radextrap_(bdyphi_freepts_extraporder2_paramset2,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder2_paramset2,ypbdy_freepts_extraporder2_paramset2,zpbdy_freepts_extraporder2_paramset2,
	                                        chrbdy_freepts_extraporder2_paramset2,&numbdypoints_freepts_extraporder2_paramset2,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        	quasiset_radextrap_(quasiset_tt_freepts_extraporder2_paramset2,quasiset_tchi_freepts_extraporder2_paramset2,quasiset_txi_freepts_extraporder2_paramset2,
	                                quasiset_chichi_freepts_extraporder2_paramset2,quasiset_chixi_freepts_extraporder2_paramset2,
	                                quasiset_xixi_freepts_extraporder2_paramset2,
	                                quasiset_trace_freepts_extraporder2_paramset2,
	                                quasiset_massdensity_freepts_extraporder2_paramset2,
	                                quasiset_angmomdensityx_freepts_extraporder2_paramset2,
	                                quasiset_angmomdensityy_freepts_extraporder2_paramset2,
	                                quasiset_angmomdensityz_freepts_extraporder2_paramset2,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder2_paramset2,ypbdy_freepts_extraporder2_paramset2,zpbdy_freepts_extraporder2_paramset2,
	                                chrbdy_freepts_extraporder2_paramset2,&numbdypoints_freepts_extraporder2_paramset2,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                		}
	                		else
	                		{   
	                        	extrap_bdyphi_freepts_(bdyphi_freepts_extraporder2_paramset2,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder2_paramset2,ypbdy_freepts_extraporder2_paramset2,zpbdy_freepts_extraporder2_paramset2,
	                                        chrbdy_freepts_extraporder2_paramset2,&numbdypoints_freepts_extraporder2_paramset2,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        	extrap_quasiset_freepts_(quasiset_tt_freepts_extraporder2_paramset2,quasiset_tchi_freepts_extraporder2_paramset2,quasiset_txi_freepts_extraporder2_paramset2,
	                                quasiset_chichi_freepts_extraporder2_paramset2,quasiset_chixi_freepts_extraporder2_paramset2,
	                                quasiset_xixi_freepts_extraporder2_paramset2,
	                                quasiset_trace_freepts_extraporder2_paramset2,
	                                quasiset_massdensity_freepts_extraporder2_paramset2,
	                                quasiset_angmomdensityx_freepts_extraporder2_paramset2,
	                                quasiset_angmomdensityy_freepts_extraporder2_paramset2,
	                                quasiset_angmomdensityz_freepts_extraporder2_paramset2,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder2_paramset2,ypbdy_freepts_extraporder2_paramset2,zpbdy_freepts_extraporder2_paramset2,
	                                chrbdy_freepts_extraporder2_paramset2,&numbdypoints_freepts_extraporder2_paramset2,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                        } 
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_freepts_extraporder2_paramset2; i<ie_bdy_freepts_extraporder2_paramset2; i++)
	                        {
	                            lquasiset_tt0_freepts_extraporder2_paramset2           [i] = quasiset_tt_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_tchi0_freepts_extraporder2_paramset2         [i] = quasiset_tchi_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_txi0_freepts_extraporder2_paramset2          [i] = quasiset_txi_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_chichi0_freepts_extraporder2_paramset2       [i] = quasiset_chichi_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_chixi0_freepts_extraporder2_paramset2        [i] = quasiset_chixi_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_xixi0_freepts_extraporder2_paramset2         [i] = quasiset_xixi_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_trace0_freepts_extraporder2_paramset2        [i] = quasiset_trace_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_massdensity0_freepts_extraporder2_paramset2  [i] = quasiset_massdensity_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_angmomdensityx0_freepts_extraporder2_paramset2 [i] = quasiset_angmomdensityx_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_angmomdensityy0_freepts_extraporder2_paramset2 [i] = quasiset_angmomdensityy_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_angmomdensityz0_freepts_extraporder2_paramset2 [i] = quasiset_angmomdensityz_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lbdyphi0_freepts_extraporder2_paramset2                [i] = bdyphi_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                        }   
	
							//PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder2_paramset2,          maxquasiset_tt0_freepts_extraporder2_paramset2,          basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder2_paramset2,        maxquasiset_tchi0_freepts_extraporder2_paramset2,        basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder2_paramset2,         maxquasiset_txi0_freepts_extraporder2_paramset2,         basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder2_paramset2,      maxquasiset_chichi0_freepts_extraporder2_paramset2,      basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder2_paramset2,       maxquasiset_chixi0_freepts_extraporder2_paramset2,       basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder2_paramset2,        maxquasiset_xixi0_freepts_extraporder2_paramset2,        basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder2_paramset2,       maxquasiset_trace0_freepts_extraporder2_paramset2,       basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder2_paramset2, maxquasiset_massdensity0_freepts_extraporder2_paramset2, basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder2_paramset2, maxquasiset_angmomdensityx0_freepts_extraporder2_paramset2, basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder2_paramset2, maxquasiset_angmomdensityy0_freepts_extraporder2_paramset2, basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder2_paramset2, maxquasiset_angmomdensityz0_freepts_extraporder2_paramset2, basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder2_paramset2,               maxbdyphi0_freepts_extraporder2_paramset2,               basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder2_paramset2,          minquasiset_tt0_freepts_extraporder2_paramset2,          basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder2_paramset2,        minquasiset_tchi0_freepts_extraporder2_paramset2,        basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder2_paramset2,         minquasiset_txi0_freepts_extraporder2_paramset2,         basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder2_paramset2,      minquasiset_chichi0_freepts_extraporder2_paramset2,      basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder2_paramset2,       minquasiset_chixi0_freepts_extraporder2_paramset2,       basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder2_paramset2,        minquasiset_xixi0_freepts_extraporder2_paramset2,        basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder2_paramset2,       minquasiset_trace0_freepts_extraporder2_paramset2,       basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder2_paramset2, minquasiset_massdensity0_freepts_extraporder2_paramset2, basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder2_paramset2, minquasiset_angmomdensityx0_freepts_extraporder2_paramset2, basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder2_paramset2, minquasiset_angmomdensityy0_freepts_extraporder2_paramset2, basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder2_paramset2, minquasiset_angmomdensityz0_freepts_extraporder2_paramset2, basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder2_paramset2,               minbdyphi0_freepts_extraporder2_paramset2,               basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_freepts_extraporder2_paramset2; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_freepts_extraporder2_paramset2          [i] = maxquasiset_tt0_freepts_extraporder2_paramset2          [i] + minquasiset_tt0_freepts_extraporder2_paramset2          [i];
	                                    quasiset_tchi0_freepts_extraporder2_paramset2        [i] = maxquasiset_tchi0_freepts_extraporder2_paramset2        [i] + minquasiset_tchi0_freepts_extraporder2_paramset2        [i];
	                                    quasiset_txi0_freepts_extraporder2_paramset2         [i] = maxquasiset_txi0_freepts_extraporder2_paramset2         [i] + minquasiset_txi0_freepts_extraporder2_paramset2         [i];
	                                    quasiset_chichi0_freepts_extraporder2_paramset2      [i] = maxquasiset_chichi0_freepts_extraporder2_paramset2      [i] + minquasiset_chichi0_freepts_extraporder2_paramset2      [i];
	                                    quasiset_chixi0_freepts_extraporder2_paramset2       [i] = maxquasiset_chixi0_freepts_extraporder2_paramset2       [i] + minquasiset_chixi0_freepts_extraporder2_paramset2       [i];
	                                    quasiset_xixi0_freepts_extraporder2_paramset2        [i] = maxquasiset_xixi0_freepts_extraporder2_paramset2        [i] + minquasiset_xixi0_freepts_extraporder2_paramset2        [i];
	                                    quasiset_trace0_freepts_extraporder2_paramset2       [i] = maxquasiset_trace0_freepts_extraporder2_paramset2       [i] + minquasiset_trace0_freepts_extraporder2_paramset2       [i];
	                                    quasiset_massdensity0_freepts_extraporder2_paramset2 [i] = maxquasiset_massdensity0_freepts_extraporder2_paramset2 [i] + minquasiset_massdensity0_freepts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityx0_freepts_extraporder2_paramset2 [i] + minquasiset_angmomdensityx0_freepts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityy0_freepts_extraporder2_paramset2 [i] + minquasiset_angmomdensityy0_freepts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityz0_freepts_extraporder2_paramset2 [i] + minquasiset_angmomdensityz0_freepts_extraporder2_paramset2 [i];
	                                    bdyphi0_freepts_extraporder2_paramset2               [i] = maxbdyphi0_freepts_extraporder2_paramset2               [i] + minbdyphi0_freepts_extraporder2_paramset2               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_freepts_extraporder2_paramset2          [i] = maxquasiset_tt0_freepts_extraporder2_paramset2          [i];
	                                    quasiset_tchi0_freepts_extraporder2_paramset2        [i] = maxquasiset_tchi0_freepts_extraporder2_paramset2        [i];
	                                    quasiset_txi0_freepts_extraporder2_paramset2         [i] = maxquasiset_txi0_freepts_extraporder2_paramset2         [i];
	                                    quasiset_chichi0_freepts_extraporder2_paramset2      [i] = maxquasiset_chichi0_freepts_extraporder2_paramset2      [i];
	                                    quasiset_chixi0_freepts_extraporder2_paramset2       [i] = maxquasiset_chixi0_freepts_extraporder2_paramset2       [i];
	                                    quasiset_xixi0_freepts_extraporder2_paramset2        [i] = maxquasiset_xixi0_freepts_extraporder2_paramset2        [i];
	                                    quasiset_trace0_freepts_extraporder2_paramset2       [i] = maxquasiset_trace0_freepts_extraporder2_paramset2       [i];
	                                    quasiset_massdensity0_freepts_extraporder2_paramset2 [i] = maxquasiset_massdensity0_freepts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityx0_freepts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityy0_freepts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityz0_freepts_extraporder2_paramset2 [i];
	                                    bdyphi0_freepts_extraporder2_paramset2               [i] = maxbdyphi0_freepts_extraporder2_paramset2               [i];
	                                }  
	                        }       
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {     
	                            			size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder2_paramset2[j],ypbdy0_freepts_extraporder2_paramset2[j],zpbdy0_freepts_extraporder2_paramset2[j],j);
		                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder2_paramset2[j],ypbdy0_freepts_extraporder2_paramset2[j],zpbdy0_freepts_extraporder2_paramset2[j],j);
		                                    }
		                                    fclose(fp);
		                                    free(name);

		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder2_paramset2[j],ypbdy0_freepts_extraporder2_paramset2[j],zpbdy0_freepts_extraporder2_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }  

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder2_paramset2 - in PRINT BOUNDARY QUANTITIES - post print xext   \n"); fflush(stdout);}  


	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder2_paramset2[j],y_outermostpt0_freepts_extraporder2_paramset2[j],z_outermostpt0_freepts_extraporder2_paramset2[j],j);
	                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder2_paramset2[j],y_outermostpt0_freepts_extraporder2_paramset2[j],z_outermostpt0_freepts_extraporder2_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder2_paramset2[j],y_outermostpt0_freepts_extraporder2_paramset2[j],z_outermostpt0_freepts_extraporder2_paramset2[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name);
	                                	}   
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder2_paramset2 - in PRINT BOUNDARY QUANTITIES - post print xout   \n"); fflush(stdout);} 

	                                if(output_bdyphi)
	                                {
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder2_paramset2[j],j);
		                                    }
		                                    fclose(fp); 
		                                    free(name);
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder2_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                } 
	                                }    

	                                    // save quasiset_ll as ascii
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder2_paramset2[j],quasiset_tchi0_freepts_extraporder2_paramset2[j],quasiset_txi0_freepts_extraporder2_paramset2[j],quasiset_chichi0_freepts_extraporder2_paramset2[j],quasiset_chixi0_freepts_extraporder2_paramset2[j],quasiset_xixi0_freepts_extraporder2_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder2_paramset2[j],quasiset_tchi0_freepts_extraporder2_paramset2[j],quasiset_txi0_freepts_extraporder2_paramset2[j],quasiset_chichi0_freepts_extraporder2_paramset2[j],quasiset_chixi0_freepts_extraporder2_paramset2[j],quasiset_xixi0_freepts_extraporder2_paramset2[j],
	                                                    j_red);
	                                            //printf("%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                            //        ct,
	                                            //        quasiset_tt0_freepts_extraporder2_paramset2[j],quasiset_tchi0_freepts_extraporder2_paramset2[j],quasiset_txi0_freepts_extraporder2_paramset2[j],quasiset_chichi0_freepts_extraporder2_paramset2[j],quasiset_chixi0_freepts_extraporder2_paramset2[j],quasiset_xixi0_freepts_extraporder2_paramset2[j],
	                                            //        j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder2_paramset2 - in PRINT BOUNDARY QUANTITIES - post print quasisetll  \n"); fflush(stdout);} 

	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_freepts_extraporder2_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_freepts_extraporder2_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {   
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_freepts_extraporder2_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);  
	                                    free(name); 
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_freepts_extraporder2_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {

		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
			                            	sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder2_paramset2[j],quasiset_angmomdensityy0_freepts_extraporder2_paramset2[j],quasiset_angmomdensityz0_freepts_extraporder2_paramset2[j],
		                                                    j);
		                                    }
		                                    fclose(fp);
		                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder2_paramset2[j],quasiset_angmomdensityy0_freepts_extraporder2_paramset2[j],quasiset_angmomdensityz0_freepts_extraporder2_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_freepts_extraporder2_paramset2=1;
	                                chibdy_xibdy_(chibdy0_freepts_extraporder2_paramset2,xibdy0_freepts_extraporder2_paramset2,xpbdy0_freepts_extraporder2_paramset2,ypbdy0_freepts_extraporder2_paramset2,zpbdy0_freepts_extraporder2_paramset2,&basenumbdypoints_freepts_extraporder2_paramset2,chiextrap0_freepts_extraporder2_paramset2,xiextrap0_freepts_extraporder2_paramset2,&basebdy_Nchi_freepts_extraporder2_paramset2,&basebdy_Nxi_freepts_extraporder2_paramset2);    
	                                doubleintegralonsphere_(AdS_mass0_freepts_extraporder2_paramset2,quasiset_massdensity0_freepts_extraporder2_paramset2,xpbdy0_freepts_extraporder2_paramset2,ypbdy0_freepts_extraporder2_paramset2,zpbdy0_freepts_extraporder2_paramset2,&basenumbdypoints_freepts_extraporder2_paramset2,rhobdy0_freepts_extraporder2_paramset2,chibdy0_freepts_extraporder2_paramset2,xibdy0_freepts_extraporder2_paramset2,&basebdy_Nchi_freepts_extraporder2_paramset2,&basebdy_Nxi_freepts_extraporder2_paramset2);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_%st_AdSmass.txt",AMRD_save_tag) + 1;
    								name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_freepts_extraporder2_paramset2);
	                                fclose(fp);
	                                free(name);
	                            }
	                        }
	                        
	                        free(vecbdypoints_freepts_extraporder2_paramset2);
	                        free(dsplsbdypoints_freepts_extraporder2_paramset2);
	                        free(quasiset_tt_freepts_extraporder2_paramset2);
	                        free(quasiset_tchi_freepts_extraporder2_paramset2);
	                        free(quasiset_txi_freepts_extraporder2_paramset2);
	                        free(quasiset_chichi_freepts_extraporder2_paramset2);
	                        free(quasiset_chixi_freepts_extraporder2_paramset2);
	                        free(quasiset_xixi_freepts_extraporder2_paramset2);
	                        free(quasiset_trace_freepts_extraporder2_paramset2);
	                        free(quasiset_massdensity_freepts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityx_freepts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityy_freepts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityz_freepts_extraporder2_paramset2);
	                        free(bdyphi_freepts_extraporder2_paramset2);  
	                        free(xpbdy_freepts_extraporder2_paramset2);
	                        free(ypbdy_freepts_extraporder2_paramset2);
	                        free(zpbdy_freepts_extraporder2_paramset2);   
	                       	free(x_outermostpt_freepts_extraporder2_paramset2);
	                       	free(y_outermostpt_freepts_extraporder2_paramset2);
	                       	free(z_outermostpt_freepts_extraporder2_paramset2);   
	
	                        free(lquasiset_tt0_freepts_extraporder2_paramset2);        
	                        free(lquasiset_tchi0_freepts_extraporder2_paramset2);
	                        free(lquasiset_txi0_freepts_extraporder2_paramset2);
	                        free(lquasiset_chichi0_freepts_extraporder2_paramset2);
	                        free(lquasiset_chixi0_freepts_extraporder2_paramset2);
	                        free(lquasiset_xixi0_freepts_extraporder2_paramset2);
	                        free(lquasiset_trace0_freepts_extraporder2_paramset2);
	                        free(lquasiset_massdensity0_freepts_extraporder2_paramset2);
	                        free(lquasiset_angmomdensityx0_freepts_extraporder2_paramset2);
	                        free(lquasiset_angmomdensityy0_freepts_extraporder2_paramset2);
	                        free(lquasiset_angmomdensityz0_freepts_extraporder2_paramset2);
	                        free(lbdyphi0_freepts_extraporder2_paramset2);      
	                        free(maxquasiset_tt0_freepts_extraporder2_paramset2);        
	                        free(maxquasiset_tchi0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_txi0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_chichi0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_chixi0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_xixi0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_trace0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_massdensity0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_angmomdensityx0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_angmomdensityy0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_angmomdensityz0_freepts_extraporder2_paramset2);
	                        free(maxbdyphi0_freepts_extraporder2_paramset2);    
	                        free(minquasiset_tt0_freepts_extraporder2_paramset2);
	                        free(minquasiset_tchi0_freepts_extraporder2_paramset2);
	                        free(minquasiset_txi0_freepts_extraporder2_paramset2);
	                        free(minquasiset_chichi0_freepts_extraporder2_paramset2);
	                        free(minquasiset_chixi0_freepts_extraporder2_paramset2);
	                        free(minquasiset_xixi0_freepts_extraporder2_paramset2);
	                        free(minquasiset_trace0_freepts_extraporder2_paramset2);
	                        free(minquasiset_massdensity0_freepts_extraporder2_paramset2);
	                        free(minquasiset_angmomdensityx0_freepts_extraporder2_paramset2);
	                        free(minquasiset_angmomdensityy0_freepts_extraporder2_paramset2);
	                        free(minquasiset_angmomdensityz0_freepts_extraporder2_paramset2);
	                        free(minbdyphi0_freepts_extraporder2_paramset2);    
	                        free(quasiset_tt0_freepts_extraporder2_paramset2);
	                        free(quasiset_tchi0_freepts_extraporder2_paramset2);
	                        free(quasiset_txi0_freepts_extraporder2_paramset2);
	                        free(quasiset_chichi0_freepts_extraporder2_paramset2);
	                        free(quasiset_chixi0_freepts_extraporder2_paramset2);
	                        free(quasiset_xixi0_freepts_extraporder2_paramset2);
	                        free(quasiset_trace0_freepts_extraporder2_paramset2);
	                        free(quasiset_massdensity0_freepts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityx0_freepts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityy0_freepts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityz0_freepts_extraporder2_paramset2);
	                        free(bdyphi0_freepts_extraporder2_paramset2);
	                        free(AdS_mass0_freepts_extraporder2_paramset2);     
	                        free(xpbdy0_freepts_extraporder2_paramset2);
	                        free(ypbdy0_freepts_extraporder2_paramset2);
	                        free(zpbdy0_freepts_extraporder2_paramset2);
	                       	free(x_outermostpt0_freepts_extraporder2_paramset2);
	                       	free(y_outermostpt0_freepts_extraporder2_paramset2);
	                       	free(z_outermostpt0_freepts_extraporder2_paramset2);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_freepts_extraporder2_paramset2);
	                            free(chiextrap0_freepts_extraporder2_paramset2);
	                            free(xiextrap0_freepts_extraporder2_paramset2);             
	                            free(rhobdy0_freepts_extraporder2_paramset2);
	                            free(chibdy0_freepts_extraporder2_paramset2);
	                            free(xibdy0_freepts_extraporder2_paramset2);    
	                        }   	
	            		}//closes condition on output_bdy_extraporder2_paramset2

	            		//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_freepts 2nd order extrap paramset2\n"); fflush(stdout);}

	            		//THIRD ORDER EXTRAPOLATION
		            	if (output_bdy_extraporder3_paramset2)
		            	{
		                	bdy_extrap_order=3; 
	
		                	//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
		                    nexttobdypoints_freepts_(chrbdy_freepts_extraporder3_paramset2,&numbdypoints_freepts_extraporder3_paramset2,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset2,&half_steps_from_bdy_int_paramset2,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	
	
		                	//PERFORM EXTRAPOLATION
	                        vecbdypoints_freepts_extraporder3_paramset2 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_freepts_extraporder3_paramset2 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_freepts_extraporder3_paramset2,1,MPI_INT,vecbdypoints_freepts_extraporder3_paramset2,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_freepts_extraporder3_paramset2,&basenumbdypoints_freepts_extraporder3_paramset2,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_freepts_extraporder3_paramset2=%i\n",numbdypoints_freepts_extraporder3_paramset2);
	                        //fflush(stdout); 
	                        quasiset_tt_freepts_extraporder3_paramset2              = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_tchi_freepts_extraporder3_paramset2            = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_txi_freepts_extraporder3_paramset2             = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_chichi_freepts_extraporder3_paramset2          = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_chixi_freepts_extraporder3_paramset2           = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_xixi_freepts_extraporder3_paramset2            = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_trace_freepts_extraporder3_paramset2           = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_massdensity_freepts_extraporder3_paramset2     = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx_freepts_extraporder3_paramset2  = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy_freepts_extraporder3_paramset2  = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz_freepts_extraporder3_paramset2  = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        bdyphi_freepts_extraporder3_paramset2                   = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));   
	                        xpbdy_freepts_extraporder3_paramset2               = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        ypbdy_freepts_extraporder3_paramset2               = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        zpbdy_freepts_extraporder3_paramset2               = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));  
	                        x_outermostpt_freepts_extraporder3_paramset2            = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        y_outermostpt_freepts_extraporder3_paramset2            = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        z_outermostpt_freepts_extraporder3_paramset2            = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real)); 
	
	                        lquasiset_tt0_freepts_extraporder3_paramset2            = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_tchi0_freepts_extraporder3_paramset2          = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_txi0_freepts_extraporder3_paramset2           = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_chichi0_freepts_extraporder3_paramset2        = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_chixi0_freepts_extraporder3_paramset2         = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_xixi0_freepts_extraporder3_paramset2          = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_trace0_freepts_extraporder3_paramset2         = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_massdensity0_freepts_extraporder3_paramset2   = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityx0_freepts_extraporder3_paramset2= malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityy0_freepts_extraporder3_paramset2= malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityz0_freepts_extraporder3_paramset2= malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lbdyphi0_freepts_extraporder3_paramset2                 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));   
	                        maxquasiset_tt0_freepts_extraporder3_paramset2          = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_tchi0_freepts_extraporder3_paramset2        = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_txi0_freepts_extraporder3_paramset2         = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_chichi0_freepts_extraporder3_paramset2      = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_chixi0_freepts_extraporder3_paramset2       = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_xixi0_freepts_extraporder3_paramset2        = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_trace0_freepts_extraporder3_paramset2       = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_massdensity0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityx0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityy0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityz0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxbdyphi0_freepts_extraporder3_paramset2               = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));   
	                        minquasiset_tt0_freepts_extraporder3_paramset2          = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_tchi0_freepts_extraporder3_paramset2        = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_txi0_freepts_extraporder3_paramset2         = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_chichi0_freepts_extraporder3_paramset2      = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_chixi0_freepts_extraporder3_paramset2       = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_xixi0_freepts_extraporder3_paramset2        = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_trace0_freepts_extraporder3_paramset2       = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_massdensity0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityx0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityy0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityz0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minbdyphi0_freepts_extraporder3_paramset2               = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));   
	                        quasiset_tt0_freepts_extraporder3_paramset2             = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_tchi0_freepts_extraporder3_paramset2           = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_txi0_freepts_extraporder3_paramset2            = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_chichi0_freepts_extraporder3_paramset2         = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_chixi0_freepts_extraporder3_paramset2          = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_xixi0_freepts_extraporder3_paramset2           = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_trace0_freepts_extraporder3_paramset2          = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_massdensity0_freepts_extraporder3_paramset2    = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        AdS_mass0_freepts_extraporder3_paramset2                = malloc(sizeof(real));
	                        bdyphi0_freepts_extraporder3_paramset2                  = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));    
	                        xpbdy0_freepts_extraporder3_paramset2              = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        ypbdy0_freepts_extraporder3_paramset2              = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        zpbdy0_freepts_extraporder3_paramset2              = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));   
	                        x_outermostpt0_freepts_extraporder3_paramset2           = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        y_outermostpt0_freepts_extraporder3_paramset2           = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        z_outermostpt0_freepts_extraporder3_paramset2           = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));   
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_freepts_extraporder3_paramset2=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_freepts_extraporder3_paramset2=vecbdypoints_freepts_extraporder3_paramset2[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_freepts_extraporder3_paramset2=is_bdy_freepts_extraporder3_paramset2+vecbdypoints_freepts_extraporder3_paramset2[j];
	                            }
	                            ie_bdy_freepts_extraporder3_paramset2=is_bdy_freepts_extraporder3_paramset2+vecbdypoints_freepts_extraporder3_paramset2[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_freepts_extraporder3_paramset2[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_freepts_extraporder3_paramset2[i]=dsplsbdypoints_freepts_extraporder3_paramset2[i]+vecbdypoints_freepts_extraporder3_paramset2[j];
	                                }
	                            }
	                        }   
	
	                        xyz_extrap_outermost_(xpbdy_freepts_extraporder3_paramset2,ypbdy_freepts_extraporder3_paramset2,zpbdy_freepts_extraporder3_paramset2,
	                                                                        x_outermostpt_freepts_extraporder3_paramset2,y_outermostpt_freepts_extraporder3_paramset2,z_outermostpt_freepts_extraporder3_paramset2,
	                                                                        chrbdy_freepts_extraporder3_paramset2,&numbdypoints_freepts_extraporder3_paramset2,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_freepts_extraporder3_paramset2,numbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,xpbdy0_freepts_extraporder3_paramset2,vecbdypoints_freepts_extraporder3_paramset2,dsplsbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_freepts_extraporder3_paramset2,numbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,ypbdy0_freepts_extraporder3_paramset2,vecbdypoints_freepts_extraporder3_paramset2,dsplsbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_freepts_extraporder3_paramset2,numbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,zpbdy0_freepts_extraporder3_paramset2,vecbdypoints_freepts_extraporder3_paramset2,dsplsbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                                MPI_Allgatherv(x_outermostpt_freepts_extraporder3_paramset2,numbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,x_outermostpt0_freepts_extraporder3_paramset2,vecbdypoints_freepts_extraporder3_paramset2,dsplsbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                                MPI_Allgatherv(y_outermostpt_freepts_extraporder3_paramset2,numbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,y_outermostpt0_freepts_extraporder3_paramset2,vecbdypoints_freepts_extraporder3_paramset2,dsplsbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                                MPI_Allgatherv(z_outermostpt_freepts_extraporder3_paramset2,numbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,z_outermostpt0_freepts_extraporder3_paramset2,vecbdypoints_freepts_extraporder3_paramset2,dsplsbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_freepts_extraporder3_paramset2 = malloc(sizeof(real));
	                                chiextrap0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                                xiextrap0_freepts_extraporder3_paramset2  = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_freepts_extraporder3_paramset2,chiextrap0_freepts_extraporder3_paramset2,xiextrap0_freepts_extraporder3_paramset2,xpbdy0_freepts_extraporder3_paramset2,ypbdy0_freepts_extraporder3_paramset2,zpbdy0_freepts_extraporder3_paramset2,&basenumbdypoints_freepts_extraporder3_paramset2);  
	                                basebdy_Nchi_freepts_extraporder3_paramset2=0;//initialize
	                                basebdy_Nxi_freepts_extraporder3_paramset2=0; //initialize
	                                bdyn_(&basebdy_Nchi_freepts_extraporder3_paramset2,&basebdy_Nxi_freepts_extraporder3_paramset2,&basenumbdypoints_freepts_extraporder3_paramset2,chiextrap0_freepts_extraporder3_paramset2,xiextrap0_freepts_extraporder3_paramset2);  
	                                rhobdy0_freepts_extraporder3_paramset2 = malloc(sizeof(real));
	                                chibdy0_freepts_extraporder3_paramset2 = malloc(basebdy_Nchi_freepts_extraporder3_paramset2*sizeof(real));
	                                xibdy0_freepts_extraporder3_paramset2  = malloc(basebdy_Nxi_freepts_extraporder3_paramset2*sizeof(real));   
	                            }
	                        }
	
	
	                        extrap_bdyphi_freepts_(bdyphi_freepts_extraporder3_paramset2,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder3_paramset2,ypbdy_freepts_extraporder3_paramset2,zpbdy_freepts_extraporder3_paramset2,
	                                        chrbdy_freepts_extraporder3_paramset2,&numbdypoints_freepts_extraporder3_paramset2,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        extrap_quasiset_freepts_(quasiset_tt_freepts_extraporder3_paramset2,quasiset_tchi_freepts_extraporder3_paramset2,quasiset_txi_freepts_extraporder3_paramset2,
	                                quasiset_chichi_freepts_extraporder3_paramset2,quasiset_chixi_freepts_extraporder3_paramset2,
	                                quasiset_xixi_freepts_extraporder3_paramset2,
	                                quasiset_trace_freepts_extraporder3_paramset2,
	                                quasiset_massdensity_freepts_extraporder3_paramset2,
	                                quasiset_angmomdensityx_freepts_extraporder3_paramset2,
	                                quasiset_angmomdensityy_freepts_extraporder3_paramset2,
	                                quasiset_angmomdensityz_freepts_extraporder3_paramset2,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder3_paramset2,ypbdy_freepts_extraporder3_paramset2,zpbdy_freepts_extraporder3_paramset2,
	                                chrbdy_freepts_extraporder3_paramset2,&numbdypoints_freepts_extraporder3_paramset2,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_freepts_extraporder3_paramset2; i<ie_bdy_freepts_extraporder3_paramset2; i++)
	                        {
	                            lquasiset_tt0_freepts_extraporder3_paramset2           [i] = quasiset_tt_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_tchi0_freepts_extraporder3_paramset2         [i] = quasiset_tchi_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_txi0_freepts_extraporder3_paramset2          [i] = quasiset_txi_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_chichi0_freepts_extraporder3_paramset2       [i] = quasiset_chichi_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_chixi0_freepts_extraporder3_paramset2        [i] = quasiset_chixi_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_xixi0_freepts_extraporder3_paramset2         [i] = quasiset_xixi_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_trace0_freepts_extraporder3_paramset2        [i] = quasiset_trace_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_massdensity0_freepts_extraporder3_paramset2  [i] = quasiset_massdensity_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_angmomdensityx0_freepts_extraporder3_paramset2 [i] = quasiset_angmomdensityx_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_angmomdensityy0_freepts_extraporder3_paramset2 [i] = quasiset_angmomdensityy_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_angmomdensityz0_freepts_extraporder3_paramset2 [i] = quasiset_angmomdensityz_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lbdyphi0_freepts_extraporder3_paramset2                [i] = bdyphi_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                        }   
	
	                        //PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder3_paramset2,          maxquasiset_tt0_freepts_extraporder3_paramset2,          basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder3_paramset2,        maxquasiset_tchi0_freepts_extraporder3_paramset2,        basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder3_paramset2,         maxquasiset_txi0_freepts_extraporder3_paramset2,         basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder3_paramset2,      maxquasiset_chichi0_freepts_extraporder3_paramset2,      basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder3_paramset2,       maxquasiset_chixi0_freepts_extraporder3_paramset2,       basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder3_paramset2,        maxquasiset_xixi0_freepts_extraporder3_paramset2,        basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder3_paramset2,       maxquasiset_trace0_freepts_extraporder3_paramset2,       basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder3_paramset2, maxquasiset_massdensity0_freepts_extraporder3_paramset2, basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder3_paramset2, maxquasiset_angmomdensityx0_freepts_extraporder3_paramset2, basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder3_paramset2, maxquasiset_angmomdensityy0_freepts_extraporder3_paramset2, basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder3_paramset2, maxquasiset_angmomdensityz0_freepts_extraporder3_paramset2, basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder3_paramset2,               maxbdyphi0_freepts_extraporder3_paramset2,               basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder3_paramset2,          minquasiset_tt0_freepts_extraporder3_paramset2,          basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder3_paramset2,        minquasiset_tchi0_freepts_extraporder3_paramset2,        basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder3_paramset2,         minquasiset_txi0_freepts_extraporder3_paramset2,         basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder3_paramset2,      minquasiset_chichi0_freepts_extraporder3_paramset2,      basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder3_paramset2,       minquasiset_chixi0_freepts_extraporder3_paramset2,       basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder3_paramset2,        minquasiset_xixi0_freepts_extraporder3_paramset2,        basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder3_paramset2,       minquasiset_trace0_freepts_extraporder3_paramset2,       basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder3_paramset2, minquasiset_massdensity0_freepts_extraporder3_paramset2, basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder3_paramset2, minquasiset_angmomdensityx0_freepts_extraporder3_paramset2, basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder3_paramset2, minquasiset_angmomdensityy0_freepts_extraporder3_paramset2, basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder3_paramset2, minquasiset_angmomdensityz0_freepts_extraporder3_paramset2, basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder3_paramset2,               minbdyphi0_freepts_extraporder3_paramset2,               basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_freepts_extraporder3_paramset2; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_freepts_extraporder3_paramset2          [i] = maxquasiset_tt0_freepts_extraporder3_paramset2          [i] + minquasiset_tt0_freepts_extraporder3_paramset2          [i];
	                                    quasiset_tchi0_freepts_extraporder3_paramset2        [i] = maxquasiset_tchi0_freepts_extraporder3_paramset2        [i] + minquasiset_tchi0_freepts_extraporder3_paramset2        [i];
	                                    quasiset_txi0_freepts_extraporder3_paramset2         [i] = maxquasiset_txi0_freepts_extraporder3_paramset2         [i] + minquasiset_txi0_freepts_extraporder3_paramset2         [i];
	                                    quasiset_chichi0_freepts_extraporder3_paramset2      [i] = maxquasiset_chichi0_freepts_extraporder3_paramset2      [i] + minquasiset_chichi0_freepts_extraporder3_paramset2      [i];
	                                    quasiset_chixi0_freepts_extraporder3_paramset2       [i] = maxquasiset_chixi0_freepts_extraporder3_paramset2       [i] + minquasiset_chixi0_freepts_extraporder3_paramset2       [i];
	                                    quasiset_xixi0_freepts_extraporder3_paramset2        [i] = maxquasiset_xixi0_freepts_extraporder3_paramset2        [i] + minquasiset_xixi0_freepts_extraporder3_paramset2        [i];
	                                    quasiset_trace0_freepts_extraporder3_paramset2       [i] = maxquasiset_trace0_freepts_extraporder3_paramset2       [i] + minquasiset_trace0_freepts_extraporder3_paramset2       [i];
	                                    quasiset_massdensity0_freepts_extraporder3_paramset2 [i] = maxquasiset_massdensity0_freepts_extraporder3_paramset2 [i] + minquasiset_massdensity0_freepts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityx0_freepts_extraporder3_paramset2 [i] + minquasiset_angmomdensityx0_freepts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityy0_freepts_extraporder3_paramset2 [i] + minquasiset_angmomdensityy0_freepts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityz0_freepts_extraporder3_paramset2 [i] + minquasiset_angmomdensityz0_freepts_extraporder3_paramset2 [i];
	                                    bdyphi0_freepts_extraporder3_paramset2               [i] = maxbdyphi0_freepts_extraporder3_paramset2               [i] + minbdyphi0_freepts_extraporder3_paramset2               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_freepts_extraporder3_paramset2          [i] = maxquasiset_tt0_freepts_extraporder3_paramset2          [i];
	                                    quasiset_tchi0_freepts_extraporder3_paramset2        [i] = maxquasiset_tchi0_freepts_extraporder3_paramset2        [i];
	                                    quasiset_txi0_freepts_extraporder3_paramset2         [i] = maxquasiset_txi0_freepts_extraporder3_paramset2         [i];
	                                    quasiset_chichi0_freepts_extraporder3_paramset2      [i] = maxquasiset_chichi0_freepts_extraporder3_paramset2      [i];
	                                    quasiset_chixi0_freepts_extraporder3_paramset2       [i] = maxquasiset_chixi0_freepts_extraporder3_paramset2       [i];
	                                    quasiset_xixi0_freepts_extraporder3_paramset2        [i] = maxquasiset_xixi0_freepts_extraporder3_paramset2        [i];
	                                    quasiset_trace0_freepts_extraporder3_paramset2       [i] = maxquasiset_trace0_freepts_extraporder3_paramset2       [i];
	                                    quasiset_massdensity0_freepts_extraporder3_paramset2 [i] = maxquasiset_massdensity0_freepts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityx0_freepts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityy0_freepts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityz0_freepts_extraporder3_paramset2 [i];
	                                    bdyphi0_freepts_extraporder3_paramset2               [i] = maxbdyphi0_freepts_extraporder3_paramset2               [i];
	                                }  
	                        }       
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {     
	                            			size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder3_paramset2[j],ypbdy0_freepts_extraporder3_paramset2[j],zpbdy0_freepts_extraporder3_paramset2[j],j);
		                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder3_paramset2[j],ypbdy0_freepts_extraporder3_paramset2[j],zpbdy0_freepts_extraporder3_paramset2[j],j);
		                                    }
		                                    fclose(fp);
		                                    free(name);

		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder3_paramset2[j],ypbdy0_freepts_extraporder3_paramset2[j],zpbdy0_freepts_extraporder3_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }  

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder3_paramset2 - in PRINT BOUNDARY QUANTITIES - post print xext   \n"); fflush(stdout);}  


	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder3_paramset2[j],y_outermostpt0_freepts_extraporder3_paramset2[j],z_outermostpt0_freepts_extraporder3_paramset2[j],j);
	                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder3_paramset2[j],y_outermostpt0_freepts_extraporder3_paramset2[j],z_outermostpt0_freepts_extraporder3_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder3_paramset2[j],y_outermostpt0_freepts_extraporder3_paramset2[j],z_outermostpt0_freepts_extraporder3_paramset2[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name);
	                                	}   
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder3_paramset2 - in PRINT BOUNDARY QUANTITIES - post print xout   \n"); fflush(stdout);} 

	                                if(output_bdyphi)
	                                {
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder3_paramset2[j],j);
		                                    }
		                                    fclose(fp); 
		                                    free(name);
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder3_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                } 
	                                }    

	                                    // save quasiset_ll as ascii
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder3_paramset2[j],quasiset_tchi0_freepts_extraporder3_paramset2[j],quasiset_txi0_freepts_extraporder3_paramset2[j],quasiset_chichi0_freepts_extraporder3_paramset2[j],quasiset_chixi0_freepts_extraporder3_paramset2[j],quasiset_xixi0_freepts_extraporder3_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder3_paramset2[j],quasiset_tchi0_freepts_extraporder3_paramset2[j],quasiset_txi0_freepts_extraporder3_paramset2[j],quasiset_chichi0_freepts_extraporder3_paramset2[j],quasiset_chixi0_freepts_extraporder3_paramset2[j],quasiset_xixi0_freepts_extraporder3_paramset2[j],
	                                                    j_red);
	                                            //printf("%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                            //        ct,
	                                            //        quasiset_tt0_freepts_extraporder3_paramset2[j],quasiset_tchi0_freepts_extraporder3_paramset2[j],quasiset_txi0_freepts_extraporder3_paramset2[j],quasiset_chichi0_freepts_extraporder3_paramset2[j],quasiset_chixi0_freepts_extraporder3_paramset2[j],quasiset_xixi0_freepts_extraporder3_paramset2[j],
	                                            //        j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder3_paramset2 - in PRINT BOUNDARY QUANTITIES - post print quasisetll  \n"); fflush(stdout);} 

	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_freepts_extraporder3_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_freepts_extraporder3_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {   
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_freepts_extraporder3_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);  
	                                    free(name); 
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_freepts_extraporder3_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {

		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
			                            	sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder3_paramset2[j],quasiset_angmomdensityy0_freepts_extraporder3_paramset2[j],quasiset_angmomdensityz0_freepts_extraporder3_paramset2[j],
		                                                    j);
		                                    }
		                                    fclose(fp);
		                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder3_paramset2[j],quasiset_angmomdensityy0_freepts_extraporder3_paramset2[j],quasiset_angmomdensityz0_freepts_extraporder3_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_freepts_extraporder3_paramset2=1;
	                                chibdy_xibdy_(chibdy0_freepts_extraporder3_paramset2,xibdy0_freepts_extraporder3_paramset2,xpbdy0_freepts_extraporder3_paramset2,ypbdy0_freepts_extraporder3_paramset2,zpbdy0_freepts_extraporder3_paramset2,&basenumbdypoints_freepts_extraporder3_paramset2,chiextrap0_freepts_extraporder3_paramset2,xiextrap0_freepts_extraporder3_paramset2,&basebdy_Nchi_freepts_extraporder3_paramset2,&basebdy_Nxi_freepts_extraporder3_paramset2);    
	                                doubleintegralonsphere_(AdS_mass0_freepts_extraporder3_paramset2,quasiset_massdensity0_freepts_extraporder3_paramset2,xpbdy0_freepts_extraporder3_paramset2,ypbdy0_freepts_extraporder3_paramset2,zpbdy0_freepts_extraporder3_paramset2,&basenumbdypoints_freepts_extraporder3_paramset2,rhobdy0_freepts_extraporder3_paramset2,chibdy0_freepts_extraporder3_paramset2,xibdy0_freepts_extraporder3_paramset2,&basebdy_Nchi_freepts_extraporder3_paramset2,&basebdy_Nxi_freepts_extraporder3_paramset2);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_%st_AdSmass.txt",AMRD_save_tag) + 1;
    								name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_freepts_extraporder3_paramset2);
	                                fclose(fp);
	                                free(name);
	                            }
	                        }

	                        free(vecbdypoints_freepts_extraporder3_paramset2);
	                        free(dsplsbdypoints_freepts_extraporder3_paramset2);
	                        free(quasiset_tt_freepts_extraporder3_paramset2);
	                        free(quasiset_tchi_freepts_extraporder3_paramset2);
	                        free(quasiset_txi_freepts_extraporder3_paramset2);
	                        free(quasiset_chichi_freepts_extraporder3_paramset2);
	                        free(quasiset_chixi_freepts_extraporder3_paramset2);
	                        free(quasiset_xixi_freepts_extraporder3_paramset2);
	                        free(quasiset_trace_freepts_extraporder3_paramset2);
	                        free(quasiset_massdensity_freepts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityx_freepts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityy_freepts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityz_freepts_extraporder3_paramset2);
	                        free(bdyphi_freepts_extraporder3_paramset2);  
	                        free(xpbdy_freepts_extraporder3_paramset2);
	                        free(ypbdy_freepts_extraporder3_paramset2);
	                        free(zpbdy_freepts_extraporder3_paramset2);   
	                       	free(x_outermostpt_freepts_extraporder3_paramset2);
	                       	free(y_outermostpt_freepts_extraporder3_paramset2);
	                       	free(z_outermostpt_freepts_extraporder3_paramset2);   
	
	                        free(lquasiset_tt0_freepts_extraporder3_paramset2);        
	                        free(lquasiset_tchi0_freepts_extraporder3_paramset2);
	                        free(lquasiset_txi0_freepts_extraporder3_paramset2);
	                        free(lquasiset_chichi0_freepts_extraporder3_paramset2);
	                        free(lquasiset_chixi0_freepts_extraporder3_paramset2);
	                        free(lquasiset_xixi0_freepts_extraporder3_paramset2);
	                        free(lquasiset_trace0_freepts_extraporder3_paramset2);
	                        free(lquasiset_massdensity0_freepts_extraporder3_paramset2);
	                        free(lquasiset_angmomdensityx0_freepts_extraporder3_paramset2);
	                        free(lquasiset_angmomdensityy0_freepts_extraporder3_paramset2);
	                        free(lquasiset_angmomdensityz0_freepts_extraporder3_paramset2);
	                        free(lbdyphi0_freepts_extraporder3_paramset2);      
	                        free(maxquasiset_tt0_freepts_extraporder3_paramset2);        
	                        free(maxquasiset_tchi0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_txi0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_chichi0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_chixi0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_xixi0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_trace0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_massdensity0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_angmomdensityx0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_angmomdensityy0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_angmomdensityz0_freepts_extraporder3_paramset2);
	                        free(maxbdyphi0_freepts_extraporder3_paramset2);    
	                        free(minquasiset_tt0_freepts_extraporder3_paramset2);
	                        free(minquasiset_tchi0_freepts_extraporder3_paramset2);
	                        free(minquasiset_txi0_freepts_extraporder3_paramset2);
	                        free(minquasiset_chichi0_freepts_extraporder3_paramset2);
	                        free(minquasiset_chixi0_freepts_extraporder3_paramset2);
	                        free(minquasiset_xixi0_freepts_extraporder3_paramset2);
	                        free(minquasiset_trace0_freepts_extraporder3_paramset2);
	                        free(minquasiset_massdensity0_freepts_extraporder3_paramset2);
	                        free(minquasiset_angmomdensityx0_freepts_extraporder3_paramset2);
	                        free(minquasiset_angmomdensityy0_freepts_extraporder3_paramset2);
	                        free(minquasiset_angmomdensityz0_freepts_extraporder3_paramset2);
	                        free(minbdyphi0_freepts_extraporder3_paramset2);    
	                        free(quasiset_tt0_freepts_extraporder3_paramset2);
	                        free(quasiset_tchi0_freepts_extraporder3_paramset2);
	                        free(quasiset_txi0_freepts_extraporder3_paramset2);
	                        free(quasiset_chichi0_freepts_extraporder3_paramset2);
	                        free(quasiset_chixi0_freepts_extraporder3_paramset2);
	                        free(quasiset_xixi0_freepts_extraporder3_paramset2);
	                        free(quasiset_trace0_freepts_extraporder3_paramset2);
	                        free(quasiset_massdensity0_freepts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityx0_freepts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityy0_freepts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityz0_freepts_extraporder3_paramset2);
	                        free(bdyphi0_freepts_extraporder3_paramset2);
	                        free(AdS_mass0_freepts_extraporder3_paramset2);     
	                        free(xpbdy0_freepts_extraporder3_paramset2);
	                        free(ypbdy0_freepts_extraporder3_paramset2);
	                        free(zpbdy0_freepts_extraporder3_paramset2);
	                       	free(x_outermostpt0_freepts_extraporder3_paramset2);
	                       	free(y_outermostpt0_freepts_extraporder3_paramset2);
	                       	free(z_outermostpt0_freepts_extraporder3_paramset2);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_freepts_extraporder3_paramset2);
	                            free(chiextrap0_freepts_extraporder3_paramset2);
	                            free(xiextrap0_freepts_extraporder3_paramset2);             
	                            free(rhobdy0_freepts_extraporder3_paramset2);
	                            free(chibdy0_freepts_extraporder3_paramset2);
	                            free(xibdy0_freepts_extraporder3_paramset2);    
	                        }   	
		                }//closes condition on output_bdy_extraporder3_paramset2

		                //MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_freepts 3rd order extrap paramset2\n"); fflush(stdout);}

		            }//closes condition on bdy_freepts_extrap


		            	//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: pre_fixedpts extrap\n"); fflush(stdout);}

		            //FIXED POINTS EXTRAPOLATION
		        	if (bdy_extrap_fixedpts)
		        	{   

	            		//set fixed_coords, i.e. the values (fixed for all resolutions) of coordinates of points that we use for use boundary extrapolation
	            		if(AMRD_cp_restart&&(init_fixed_coords==0))
	            		{
	            			for (i=0;i<num_fixed_coords;i++)
	            			{
								fixed_coords[i]=-1+i*ind_distance_fixedpts*dx;
	            			}
	            			init_fixed_coords=1;
	            		}

		        		//EXTRAPOLATION WITH FIRST SET OF PARAMETERS (denoted by index 1 at the end)
	
		        		//FIRST ORDER EXTRAPOLATION
            			if (output_bdy_extraporder1_paramset1)
            			{
                			bdy_extrap_order=1;

                			//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
	                        nexttobdypoints_fixedpts_(chrbdy_fixedpts_extraporder1_paramset1,&numbdypoints_fixedpts_extraporder1_paramset1,&bdy_extrap_order,&ind_distance_fixedpts,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset1,&half_steps_from_bdy_int_paramset1,&num_fixed_coords,fixed_coords,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);

	                    	//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_fixedpts_extraporder1_paramset1 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_fixedpts_extraporder1_paramset1 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_fixedpts_extraporder1_paramset1,1,MPI_INT,vecbdypoints_fixedpts_extraporder1_paramset1,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_fixedpts_extraporder1_paramset1,&basenumbdypoints_fixedpts_extraporder1_paramset1,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_fixedpts_extraporder1_paramset1=%i\n",numbdypoints_fixedpts_extraporder1_paramset1);
	                        //fflush(stdout); 
	                        quasiset_tt_fixedpts_extraporder1_paramset1              = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_tchi_fixedpts_extraporder1_paramset1            = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_txi_fixedpts_extraporder1_paramset1             = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_chichi_fixedpts_extraporder1_paramset1          = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_chixi_fixedpts_extraporder1_paramset1           = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_xixi_fixedpts_extraporder1_paramset1            = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_trace_fixedpts_extraporder1_paramset1           = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_massdensity_fixedpts_extraporder1_paramset1     = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx_fixedpts_extraporder1_paramset1  = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy_fixedpts_extraporder1_paramset1  = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz_fixedpts_extraporder1_paramset1  = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        bdyphi_fixedpts_extraporder1_paramset1                   = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));   
	                        xpbdy_fixedpts_extraporder1_paramset1               = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        ypbdy_fixedpts_extraporder1_paramset1               = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        zpbdy_fixedpts_extraporder1_paramset1               = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));  
	                       	x_outermostpt_fixedpts_extraporder1_paramset1            = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                       	y_outermostpt_fixedpts_extraporder1_paramset1            = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                       	z_outermostpt_fixedpts_extraporder1_paramset1            = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real)); 
	
	                        lquasiset_tt0_fixedpts_extraporder1_paramset1            = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_tchi0_fixedpts_extraporder1_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_txi0_fixedpts_extraporder1_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_chichi0_fixedpts_extraporder1_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_chixi0_fixedpts_extraporder1_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_xixi0_fixedpts_extraporder1_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_trace0_fixedpts_extraporder1_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_massdensity0_fixedpts_extraporder1_paramset1   = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1= malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1= malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1= malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lbdyphi0_fixedpts_extraporder1_paramset1                 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));   
	                        maxquasiset_tt0_fixedpts_extraporder1_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_tchi0_fixedpts_extraporder1_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_txi0_fixedpts_extraporder1_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_chichi0_fixedpts_extraporder1_paramset1      = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_chixi0_fixedpts_extraporder1_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_xixi0_fixedpts_extraporder1_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_trace0_fixedpts_extraporder1_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_massdensity0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxbdyphi0_fixedpts_extraporder1_paramset1               = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));   
	                        minquasiset_tt0_fixedpts_extraporder1_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_tchi0_fixedpts_extraporder1_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_txi0_fixedpts_extraporder1_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_chichi0_fixedpts_extraporder1_paramset1      = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_chixi0_fixedpts_extraporder1_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_xixi0_fixedpts_extraporder1_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_trace0_fixedpts_extraporder1_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_massdensity0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minbdyphi0_fixedpts_extraporder1_paramset1               = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));   
	                        quasiset_tt0_fixedpts_extraporder1_paramset1             = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_tchi0_fixedpts_extraporder1_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_txi0_fixedpts_extraporder1_paramset1            = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_chichi0_fixedpts_extraporder1_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_chixi0_fixedpts_extraporder1_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_xixi0_fixedpts_extraporder1_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_trace0_fixedpts_extraporder1_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_massdensity0_fixedpts_extraporder1_paramset1    = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        AdS_mass0_fixedpts_extraporder1_paramset1                = malloc(sizeof(real));
	                        bdyphi0_fixedpts_extraporder1_paramset1                  = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));    
	                        xpbdy0_fixedpts_extraporder1_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        ypbdy0_fixedpts_extraporder1_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        zpbdy0_fixedpts_extraporder1_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));   
	                       	x_outermostpt0_fixedpts_extraporder1_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                       	y_outermostpt0_fixedpts_extraporder1_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                       	z_outermostpt0_fixedpts_extraporder1_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));   
	
	
	                        //initialize
	                        for (i=0;i<numbdypoints_fixedpts_extraporder1_paramset1;i++)
	                        {
	                            quasiset_tt_fixedpts_extraporder1_paramset1              [i] = 0;
	                            quasiset_tchi_fixedpts_extraporder1_paramset1            [i] = 0;
	                            quasiset_txi_fixedpts_extraporder1_paramset1             [i] = 0;
	                            quasiset_chichi_fixedpts_extraporder1_paramset1          [i] = 0;
	                            quasiset_chixi_fixedpts_extraporder1_paramset1           [i] = 0;
	                            quasiset_xixi_fixedpts_extraporder1_paramset1            [i] = 0;
	                            quasiset_trace_fixedpts_extraporder1_paramset1           [i] = 0;
	                            quasiset_massdensity_fixedpts_extraporder1_paramset1     [i] = 0;
	                            quasiset_angmomdensityx_fixedpts_extraporder1_paramset1  [i] = 0;
	                            quasiset_angmomdensityy_fixedpts_extraporder1_paramset1  [i] = 0;
	                            quasiset_angmomdensityz_fixedpts_extraporder1_paramset1  [i] = 0;
	                            bdyphi_fixedpts_extraporder1_paramset1                   [i] = 0;   
	                            xpbdy_fixedpts_extraporder1_paramset1               [i] = 0;
	                            ypbdy_fixedpts_extraporder1_paramset1               [i] = 0;
	                            zpbdy_fixedpts_extraporder1_paramset1               [i] = 0;
	                           	x_outermostpt_fixedpts_extraporder1_paramset1            [i] = 0;
	                           	y_outermostpt_fixedpts_extraporder1_paramset1            [i] = 0;
	                           	z_outermostpt_fixedpts_extraporder1_paramset1            [i] = 0;
	
	                        }   
	                        for (i=0;i<basenumbdypoints_fixedpts_extraporder1_paramset1;i++)
	                        {   
	                            lquasiset_tt0_fixedpts_extraporder1_paramset1            [i] = 0;
	                            lquasiset_tchi0_fixedpts_extraporder1_paramset1          [i] = 0;
	                            lquasiset_txi0_fixedpts_extraporder1_paramset1           [i] = 0;
	                            lquasiset_chichi0_fixedpts_extraporder1_paramset1        [i] = 0;
	                            lquasiset_chixi0_fixedpts_extraporder1_paramset1         [i] = 0;
	                            lquasiset_xixi0_fixedpts_extraporder1_paramset1          [i] = 0;
	                            lquasiset_trace0_fixedpts_extraporder1_paramset1         [i] = 0;
	                            lquasiset_massdensity0_fixedpts_extraporder1_paramset1   [i] = 0;
	                            lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1[i] = 0;
	                            lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1[i] = 0;
	                            lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1[i] = 0;
	                            lbdyphi0_fixedpts_extraporder1_paramset1                 [i] = 0;             
	                            maxquasiset_tt0_fixedpts_extraporder1_paramset1          [i] = 0;
	                            maxquasiset_tchi0_fixedpts_extraporder1_paramset1        [i] = 0;
	                            maxquasiset_txi0_fixedpts_extraporder1_paramset1         [i] = 0;
	                            maxquasiset_chichi0_fixedpts_extraporder1_paramset1      [i] = 0;
	                            maxquasiset_chixi0_fixedpts_extraporder1_paramset1       [i] = 0;
	                            maxquasiset_xixi0_fixedpts_extraporder1_paramset1        [i] = 0;
	                            maxquasiset_trace0_fixedpts_extraporder1_paramset1       [i] = 0;
	                            maxquasiset_massdensity0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            maxbdyphi0_fixedpts_extraporder1_paramset1               [i] = 0;  
	                            minquasiset_tt0_fixedpts_extraporder1_paramset1          [i] = 0;
	                            minquasiset_tchi0_fixedpts_extraporder1_paramset1        [i] = 0;
	                            minquasiset_txi0_fixedpts_extraporder1_paramset1         [i] = 0;
	                            minquasiset_chichi0_fixedpts_extraporder1_paramset1      [i] = 0;
	                            minquasiset_chixi0_fixedpts_extraporder1_paramset1       [i] = 0;
	                            minquasiset_xixi0_fixedpts_extraporder1_paramset1        [i] = 0;
	                            minquasiset_trace0_fixedpts_extraporder1_paramset1       [i] = 0;
	                            minquasiset_massdensity0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            minbdyphi0_fixedpts_extraporder1_paramset1               [i] = 0;  
	                            quasiset_tt0_fixedpts_extraporder1_paramset1             [i] = 0;
	                            quasiset_tchi0_fixedpts_extraporder1_paramset1           [i] = 0;
	                            quasiset_txi0_fixedpts_extraporder1_paramset1            [i] = 0;
	                            quasiset_chichi0_fixedpts_extraporder1_paramset1         [i] = 0;
	                            quasiset_chixi0_fixedpts_extraporder1_paramset1          [i] = 0;
	                            quasiset_xixi0_fixedpts_extraporder1_paramset1           [i] = 0;
	                            quasiset_trace0_fixedpts_extraporder1_paramset1          [i] = 0;
	                            quasiset_massdensity0_fixedpts_extraporder1_paramset1    [i] = 0;
	                            quasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            quasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            quasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            bdyphi0_fixedpts_extraporder1_paramset1                  [i] = 0;   
	                            xpbdy0_fixedpts_extraporder1_paramset1              [i] = 0;
	                            ypbdy0_fixedpts_extraporder1_paramset1              [i] = 0;
	                            zpbdy0_fixedpts_extraporder1_paramset1              [i] = 0;  
	                           	x_outermostpt0_fixedpts_extraporder1_paramset1           [i] = 0;
	                           	y_outermostpt0_fixedpts_extraporder1_paramset1           [i] = 0;
	                           	z_outermostpt0_fixedpts_extraporder1_paramset1           [i] = 0;
	
	                        }
	                        *AdS_mass0_fixedpts_extraporder1_paramset1                    = 0; 
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_fixedpts_extraporder1_paramset1=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_fixedpts_extraporder1_paramset1=vecbdypoints_fixedpts_extraporder1_paramset1[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_fixedpts_extraporder1_paramset1=is_bdy_fixedpts_extraporder1_paramset1+vecbdypoints_fixedpts_extraporder1_paramset1[j];
	                            }
	                            ie_bdy_fixedpts_extraporder1_paramset1=is_bdy_fixedpts_extraporder1_paramset1+vecbdypoints_fixedpts_extraporder1_paramset1[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_fixedpts_extraporder1_paramset1[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_fixedpts_extraporder1_paramset1[i]=dsplsbdypoints_fixedpts_extraporder1_paramset1[i]+vecbdypoints_fixedpts_extraporder1_paramset1[j];
	                                }
	                            }
	                        }   
	
	                        xyz_extrap_outermost_(xpbdy_fixedpts_extraporder1_paramset1,ypbdy_fixedpts_extraporder1_paramset1,zpbdy_fixedpts_extraporder1_paramset1,
	                        						x_outermostpt_fixedpts_extraporder1_paramset1,y_outermostpt_fixedpts_extraporder1_paramset1,z_outermostpt_fixedpts_extraporder1_paramset1,
	                        						chrbdy_fixedpts_extraporder1_paramset1,&numbdypoints_fixedpts_extraporder1_paramset1,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_fixedpts_extraporder1_paramset1,numbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,xpbdy0_fixedpts_extraporder1_paramset1,vecbdypoints_fixedpts_extraporder1_paramset1,dsplsbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_fixedpts_extraporder1_paramset1,numbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,ypbdy0_fixedpts_extraporder1_paramset1,vecbdypoints_fixedpts_extraporder1_paramset1,dsplsbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_fixedpts_extraporder1_paramset1,numbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,zpbdy0_fixedpts_extraporder1_paramset1,vecbdypoints_fixedpts_extraporder1_paramset1,dsplsbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_fixedpts_extraporder1_paramset1,numbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,x_outermostpt0_fixedpts_extraporder1_paramset1,vecbdypoints_fixedpts_extraporder1_paramset1,dsplsbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_fixedpts_extraporder1_paramset1,numbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,y_outermostpt0_fixedpts_extraporder1_paramset1,vecbdypoints_fixedpts_extraporder1_paramset1,dsplsbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_fixedpts_extraporder1_paramset1,numbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,z_outermostpt0_fixedpts_extraporder1_paramset1,vecbdypoints_fixedpts_extraporder1_paramset1,dsplsbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_fixedpts_extraporder1_paramset1 = malloc(sizeof(real));
	                                chiextrap0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                                xiextrap0_fixedpts_extraporder1_paramset1  = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_fixedpts_extraporder1_paramset1,chiextrap0_fixedpts_extraporder1_paramset1,xiextrap0_fixedpts_extraporder1_paramset1,xpbdy0_fixedpts_extraporder1_paramset1,ypbdy0_fixedpts_extraporder1_paramset1,zpbdy0_fixedpts_extraporder1_paramset1,&basenumbdypoints_fixedpts_extraporder1_paramset1);  
	                                basebdy_Nchi_fixedpts_extraporder1_paramset1=0;//initialize
	                                basebdy_Nxi_fixedpts_extraporder1_paramset1=0; //initialize
	                                bdyn_(&basebdy_Nchi_fixedpts_extraporder1_paramset1,&basebdy_Nxi_fixedpts_extraporder1_paramset1,&basenumbdypoints_fixedpts_extraporder1_paramset1,chiextrap0_fixedpts_extraporder1_paramset1,xiextrap0_fixedpts_extraporder1_paramset1);  
	                                rhobdy0_fixedpts_extraporder1_paramset1 = malloc(sizeof(real));
	                                chibdy0_fixedpts_extraporder1_paramset1 = malloc(basebdy_Nchi_fixedpts_extraporder1_paramset1*sizeof(real));
	                                xibdy0_fixedpts_extraporder1_paramset1  = malloc(basebdy_Nxi_fixedpts_extraporder1_paramset1*sizeof(real));   
	                            }
	                        }
	
	
	                        extrap_bdyphi_fixedpts_(bdyphi_fixedpts_extraporder1_paramset1,
	                                        leadordcoeff_phi1,
	                                        xpbdy_fixedpts_extraporder1_paramset1,ypbdy_fixedpts_extraporder1_paramset1,zpbdy_fixedpts_extraporder1_paramset1,
	                                        chrbdy_fixedpts_extraporder1_paramset1,&numbdypoints_fixedpts_extraporder1_paramset1,
	                                        &bdy_extrap_order,
	                                        &ind_distance_fixedpts,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);

	                        extrap_quasiset_fixedpts_(
	                        	quasiset_tt_fixedpts_extraporder1_paramset1,
	                        	quasiset_tchi_fixedpts_extraporder1_paramset1,
	                        	quasiset_txi_fixedpts_extraporder1_paramset1,
	                            quasiset_chichi_fixedpts_extraporder1_paramset1,
	                            quasiset_chixi_fixedpts_extraporder1_paramset1,
	                            quasiset_xixi_fixedpts_extraporder1_paramset1,
	                            quasiset_trace_fixedpts_extraporder1_paramset1,
	                            quasiset_massdensity_fixedpts_extraporder1_paramset1,
	                            quasiset_angmomdensityx_fixedpts_extraporder1_paramset1,
	                            quasiset_angmomdensityy_fixedpts_extraporder1_paramset1,
	                            quasiset_angmomdensityz_fixedpts_extraporder1_paramset1,
	                            quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                            quasiset_chichi_ll,quasiset_chixi_ll,
	                            quasiset_xixi_ll,
	                            quasiset_tracell,
	                            quasiset_massdensityll,
	                            quasiset_angmomdensityxll,
	                            quasiset_angmomdensityyll,
	                            quasiset_angmomdensityzll,
	                            xpbdy_fixedpts_extraporder1_paramset1,ypbdy_fixedpts_extraporder1_paramset1,zpbdy_fixedpts_extraporder1_paramset1,
	                            chrbdy_fixedpts_extraporder1_paramset1,&numbdypoints_fixedpts_extraporder1_paramset1,
	                            &bdy_extrap_order,
	                            &ind_distance_fixedpts,
	                            x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);

	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_fixedpts_extraporder1_paramset1; i<ie_bdy_fixedpts_extraporder1_paramset1; i++)
	                        {
	                            lquasiset_tt0_fixedpts_extraporder1_paramset1           [i] = quasiset_tt_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_tchi0_fixedpts_extraporder1_paramset1         [i] = quasiset_tchi_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_txi0_fixedpts_extraporder1_paramset1          [i] = quasiset_txi_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_chichi0_fixedpts_extraporder1_paramset1       [i] = quasiset_chichi_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_chixi0_fixedpts_extraporder1_paramset1        [i] = quasiset_chixi_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_xixi0_fixedpts_extraporder1_paramset1         [i] = quasiset_xixi_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_trace0_fixedpts_extraporder1_paramset1        [i] = quasiset_trace_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_massdensity0_fixedpts_extraporder1_paramset1  [i] = quasiset_massdensity_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i] = quasiset_angmomdensityx_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i] = quasiset_angmomdensityy_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i] = quasiset_angmomdensityz_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lbdyphi0_fixedpts_extraporder1_paramset1                [i] = bdyphi_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                        }   

	                        //PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder1_paramset1,          maxquasiset_tt0_fixedpts_extraporder1_paramset1,          basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder1_paramset1,        maxquasiset_tchi0_fixedpts_extraporder1_paramset1,        basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder1_paramset1,         maxquasiset_txi0_fixedpts_extraporder1_paramset1,         basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder1_paramset1,      maxquasiset_chichi0_fixedpts_extraporder1_paramset1,      basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder1_paramset1,       maxquasiset_chixi0_fixedpts_extraporder1_paramset1,       basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder1_paramset1,        maxquasiset_xixi0_fixedpts_extraporder1_paramset1,        basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder1_paramset1,       maxquasiset_trace0_fixedpts_extraporder1_paramset1,       basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder1_paramset1, maxquasiset_massdensity0_fixedpts_extraporder1_paramset1, basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1, maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1, basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1, maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1, basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1, maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1, basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder1_paramset1,               maxbdyphi0_fixedpts_extraporder1_paramset1,               basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder1_paramset1,          minquasiset_tt0_fixedpts_extraporder1_paramset1,          basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder1_paramset1,        minquasiset_tchi0_fixedpts_extraporder1_paramset1,        basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder1_paramset1,         minquasiset_txi0_fixedpts_extraporder1_paramset1,         basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder1_paramset1,      minquasiset_chichi0_fixedpts_extraporder1_paramset1,      basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder1_paramset1,       minquasiset_chixi0_fixedpts_extraporder1_paramset1,       basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder1_paramset1,        minquasiset_xixi0_fixedpts_extraporder1_paramset1,        basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder1_paramset1,       minquasiset_trace0_fixedpts_extraporder1_paramset1,       basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder1_paramset1, minquasiset_massdensity0_fixedpts_extraporder1_paramset1, basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1, minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1, basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1, minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1, basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1, minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1, basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder1_paramset1,               minbdyphi0_fixedpts_extraporder1_paramset1,               basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_fixedpts_extraporder1_paramset1; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_fixedpts_extraporder1_paramset1          [i] = maxquasiset_tt0_fixedpts_extraporder1_paramset1          [i] + minquasiset_tt0_fixedpts_extraporder1_paramset1          [i];
	                                    quasiset_tchi0_fixedpts_extraporder1_paramset1        [i] = maxquasiset_tchi0_fixedpts_extraporder1_paramset1        [i] + minquasiset_tchi0_fixedpts_extraporder1_paramset1        [i];
	                                    quasiset_txi0_fixedpts_extraporder1_paramset1         [i] = maxquasiset_txi0_fixedpts_extraporder1_paramset1         [i] + minquasiset_txi0_fixedpts_extraporder1_paramset1         [i];
	                                    quasiset_chichi0_fixedpts_extraporder1_paramset1      [i] = maxquasiset_chichi0_fixedpts_extraporder1_paramset1      [i] + minquasiset_chichi0_fixedpts_extraporder1_paramset1      [i];
	                                    quasiset_chixi0_fixedpts_extraporder1_paramset1       [i] = maxquasiset_chixi0_fixedpts_extraporder1_paramset1       [i] + minquasiset_chixi0_fixedpts_extraporder1_paramset1       [i];
	                                    quasiset_xixi0_fixedpts_extraporder1_paramset1        [i] = maxquasiset_xixi0_fixedpts_extraporder1_paramset1        [i] + minquasiset_xixi0_fixedpts_extraporder1_paramset1        [i];
	                                    quasiset_trace0_fixedpts_extraporder1_paramset1       [i] = maxquasiset_trace0_fixedpts_extraporder1_paramset1       [i] + minquasiset_trace0_fixedpts_extraporder1_paramset1       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder1_paramset1 [i] = maxquasiset_massdensity0_fixedpts_extraporder1_paramset1 [i] + minquasiset_massdensity0_fixedpts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i] + minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i] + minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i] + minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i];
	                                    bdyphi0_fixedpts_extraporder1_paramset1               [i] = maxbdyphi0_fixedpts_extraporder1_paramset1               [i] + minbdyphi0_fixedpts_extraporder1_paramset1               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_fixedpts_extraporder1_paramset1          [i] = maxquasiset_tt0_fixedpts_extraporder1_paramset1          [i];
	                                    quasiset_tchi0_fixedpts_extraporder1_paramset1        [i] = maxquasiset_tchi0_fixedpts_extraporder1_paramset1        [i];
	                                    quasiset_txi0_fixedpts_extraporder1_paramset1         [i] = maxquasiset_txi0_fixedpts_extraporder1_paramset1         [i];
	                                    quasiset_chichi0_fixedpts_extraporder1_paramset1      [i] = maxquasiset_chichi0_fixedpts_extraporder1_paramset1      [i];
	                                    quasiset_chixi0_fixedpts_extraporder1_paramset1       [i] = maxquasiset_chixi0_fixedpts_extraporder1_paramset1       [i];
	                                    quasiset_xixi0_fixedpts_extraporder1_paramset1        [i] = maxquasiset_xixi0_fixedpts_extraporder1_paramset1        [i];
	                                    quasiset_trace0_fixedpts_extraporder1_paramset1       [i] = maxquasiset_trace0_fixedpts_extraporder1_paramset1       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder1_paramset1 [i] = maxquasiset_massdensity0_fixedpts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i];
	                                    bdyphi0_fixedpts_extraporder1_paramset1               [i] = maxbdyphi0_fixedpts_extraporder1_paramset1               [i];
	                                }  
	                        }       
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {
	                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    								name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder1_paramset1[j],ypbdy0_fixedpts_extraporder1_paramset1[j],zpbdy0_fixedpts_extraporder1_paramset1[j],j);
                                    }
                                    fclose(fp);
                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder1_paramset1[j],ypbdy0_fixedpts_extraporder1_paramset1[j],zpbdy0_fixedpts_extraporder1_paramset1[j],j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }   
	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder1_paramset1[j],y_outermostpt0_fixedpts_extraporder1_paramset1[j],z_outermostpt0_fixedpts_extraporder1_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder1_paramset1[j],y_outermostpt0_fixedpts_extraporder1_paramset1[j],z_outermostpt0_fixedpts_extraporder1_paramset1[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name); 
	                                	}   
	                                }
	                                if(output_bdyphi)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
                                    	sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder1_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder1_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                } 
	                                }    

                                    // save quasiset_ll as ascii
                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   									name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
                                                    ct,
                                                    quasiset_tt0_fixedpts_extraporder1_paramset1[j],quasiset_tchi0_fixedpts_extraporder1_paramset1[j],quasiset_txi0_fixedpts_extraporder1_paramset1[j],quasiset_chichi0_fixedpts_extraporder1_paramset1[j],quasiset_chixi0_fixedpts_extraporder1_paramset1[j],quasiset_xixi0_fixedpts_extraporder1_paramset1[j],
                                                    j);
                                    }
                                    fclose(fp);
                                    free(name);  
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_fixedpts_extraporder1_paramset1[j],quasiset_tchi0_fixedpts_extraporder1_paramset1[j],quasiset_txi0_fixedpts_extraporder1_paramset1[j],quasiset_chichi0_fixedpts_extraporder1_paramset1[j],quasiset_chixi0_fixedpts_extraporder1_paramset1[j],quasiset_xixi0_fixedpts_extraporder1_paramset1[j],
	                                                    j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }
	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_fixedpts_extraporder1_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_fixedpts_extraporder1_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_fixedpts_extraporder1_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_fixedpts_extraporder1_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {
		                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
		                            	sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_angmomdensityx0_fixedpts_extraporder1_paramset1[j],quasiset_angmomdensityy0_fixedpts_extraporder1_paramset1[j],quasiset_angmomdensityz0_fixedpts_extraporder1_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);   
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_fixedpts_extraporder1_paramset1[j],quasiset_angmomdensityy0_fixedpts_extraporder1_paramset1[j],quasiset_angmomdensityz0_fixedpts_extraporder1_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_fixedpts_extraporder1_paramset1=1;
	                                chibdy_xibdy_(chibdy0_fixedpts_extraporder1_paramset1,xibdy0_fixedpts_extraporder1_paramset1,xpbdy0_fixedpts_extraporder1_paramset1,ypbdy0_fixedpts_extraporder1_paramset1,zpbdy0_fixedpts_extraporder1_paramset1,&basenumbdypoints_fixedpts_extraporder1_paramset1,chiextrap0_fixedpts_extraporder1_paramset1,xiextrap0_fixedpts_extraporder1_paramset1,&basebdy_Nchi_fixedpts_extraporder1_paramset1,&basebdy_Nxi_fixedpts_extraporder1_paramset1);    
	                                doubleintegralonsphere_(AdS_mass0_fixedpts_extraporder1_paramset1,quasiset_massdensity0_fixedpts_extraporder1_paramset1,xpbdy0_fixedpts_extraporder1_paramset1,ypbdy0_fixedpts_extraporder1_paramset1,zpbdy0_fixedpts_extraporder1_paramset1,&basenumbdypoints_fixedpts_extraporder1_paramset1,rhobdy0_fixedpts_extraporder1_paramset1,chibdy0_fixedpts_extraporder1_paramset1,xibdy0_fixedpts_extraporder1_paramset1,&basebdy_Nchi_fixedpts_extraporder1_paramset1,&basebdy_Nxi_fixedpts_extraporder1_paramset1);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_%st_AdSmass.txt",AMRD_save_tag) + 1;
   									name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_fixedpts_extraporder1_paramset1);
	                                fclose(fp);
	                                free(name); 
	                            }
	                        }      

	                        free(vecbdypoints_fixedpts_extraporder1_paramset1);
	                        free(dsplsbdypoints_fixedpts_extraporder1_paramset1);
	                        free(quasiset_tt_fixedpts_extraporder1_paramset1);
	                        free(quasiset_tchi_fixedpts_extraporder1_paramset1);
	                        free(quasiset_txi_fixedpts_extraporder1_paramset1);
	                        free(quasiset_chichi_fixedpts_extraporder1_paramset1);
	                        free(quasiset_chixi_fixedpts_extraporder1_paramset1);
	                        free(quasiset_xixi_fixedpts_extraporder1_paramset1);
	                        free(quasiset_trace_fixedpts_extraporder1_paramset1);
	                        free(quasiset_massdensity_fixedpts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityx_fixedpts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityy_fixedpts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityz_fixedpts_extraporder1_paramset1);
	                        free(bdyphi_fixedpts_extraporder1_paramset1);  
	                        free(xpbdy_fixedpts_extraporder1_paramset1);
	                        free(ypbdy_fixedpts_extraporder1_paramset1);
	                        free(zpbdy_fixedpts_extraporder1_paramset1);   
	                        free(x_outermostpt_fixedpts_extraporder1_paramset1);
	                        free(y_outermostpt_fixedpts_extraporder1_paramset1);
	                        free(z_outermostpt_fixedpts_extraporder1_paramset1);   
	
	                        free(lquasiset_tt0_fixedpts_extraporder1_paramset1);        
	                        free(lquasiset_tchi0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_txi0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_chichi0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_chixi0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_xixi0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_trace0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_massdensity0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1);
	                        free(lbdyphi0_fixedpts_extraporder1_paramset1);      
	                        free(maxquasiset_tt0_fixedpts_extraporder1_paramset1);        
	                        free(maxquasiset_tchi0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_txi0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_chichi0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_chixi0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_xixi0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_trace0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_massdensity0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1);
	                        free(maxbdyphi0_fixedpts_extraporder1_paramset1);    
	                        free(minquasiset_tt0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_tchi0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_txi0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_chichi0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_chixi0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_xixi0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_trace0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_massdensity0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1);
	                        free(minbdyphi0_fixedpts_extraporder1_paramset1);    
	                        free(quasiset_tt0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_tchi0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_txi0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_chichi0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_chixi0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_xixi0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_trace0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_massdensity0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityx0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityy0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityz0_fixedpts_extraporder1_paramset1);
	                        free(bdyphi0_fixedpts_extraporder1_paramset1);
	                        free(AdS_mass0_fixedpts_extraporder1_paramset1);     
	                        free(xpbdy0_fixedpts_extraporder1_paramset1);
	                        free(ypbdy0_fixedpts_extraporder1_paramset1);
	                        free(zpbdy0_fixedpts_extraporder1_paramset1);
	                        free(x_outermostpt0_fixedpts_extraporder1_paramset1);
	                        free(y_outermostpt0_fixedpts_extraporder1_paramset1);
	                        free(z_outermostpt0_fixedpts_extraporder1_paramset1);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_fixedpts_extraporder1_paramset1);
	                            free(chiextrap0_fixedpts_extraporder1_paramset1);
	                            free(xiextrap0_fixedpts_extraporder1_paramset1);             
	                            free(rhobdy0_fixedpts_extraporder1_paramset1);
	                            free(chibdy0_fixedpts_extraporder1_paramset1);
	                            free(xibdy0_fixedpts_extraporder1_paramset1);    
	                        }   
                		}//closes condition on output_bdy_extraporder1_paramset1

		            	//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_fixedpts 1st order extrap paramset1\n"); fflush(stdout);}

	            		//SECOND ORDER EXTRAPOLATION
						if (output_bdy_extraporder2_paramset1)
            			{
                			bdy_extrap_order=2;

                			//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
	                        nexttobdypoints_fixedpts_(chrbdy_fixedpts_extraporder2_paramset1,&numbdypoints_fixedpts_extraporder2_paramset1,&bdy_extrap_order,&ind_distance_fixedpts,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset1,&half_steps_from_bdy_int_paramset1,&num_fixed_coords,fixed_coords,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);

	                    	//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_fixedpts_extraporder2_paramset1 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_fixedpts_extraporder2_paramset1 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_fixedpts_extraporder2_paramset1,1,MPI_INT,vecbdypoints_fixedpts_extraporder2_paramset1,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_fixedpts_extraporder2_paramset1,&basenumbdypoints_fixedpts_extraporder2_paramset1,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_fixedpts_extraporder2_paramset1=%i\n",numbdypoints_fixedpts_extraporder2_paramset1);
	                        //fflush(stdout); 
	                        quasiset_tt_fixedpts_extraporder2_paramset1              = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_tchi_fixedpts_extraporder2_paramset1            = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_txi_fixedpts_extraporder2_paramset1             = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_chichi_fixedpts_extraporder2_paramset1          = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_chixi_fixedpts_extraporder2_paramset1           = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_xixi_fixedpts_extraporder2_paramset1            = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_trace_fixedpts_extraporder2_paramset1           = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_massdensity_fixedpts_extraporder2_paramset1     = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx_fixedpts_extraporder2_paramset1  = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy_fixedpts_extraporder2_paramset1  = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz_fixedpts_extraporder2_paramset1  = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        bdyphi_fixedpts_extraporder2_paramset1                   = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));   
	                        xpbdy_fixedpts_extraporder2_paramset1               = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        ypbdy_fixedpts_extraporder2_paramset1               = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        zpbdy_fixedpts_extraporder2_paramset1               = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));  
	                       	x_outermostpt_fixedpts_extraporder2_paramset1            = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                       	y_outermostpt_fixedpts_extraporder2_paramset1            = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                       	z_outermostpt_fixedpts_extraporder2_paramset1            = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real)); 
	
	                        lquasiset_tt0_fixedpts_extraporder2_paramset1            = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_tchi0_fixedpts_extraporder2_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_txi0_fixedpts_extraporder2_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_chichi0_fixedpts_extraporder2_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_chixi0_fixedpts_extraporder2_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_xixi0_fixedpts_extraporder2_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_trace0_fixedpts_extraporder2_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_massdensity0_fixedpts_extraporder2_paramset1   = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1= malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1= malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1= malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lbdyphi0_fixedpts_extraporder2_paramset1                 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));   
	                        maxquasiset_tt0_fixedpts_extraporder2_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_tchi0_fixedpts_extraporder2_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_txi0_fixedpts_extraporder2_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_chichi0_fixedpts_extraporder2_paramset1      = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_chixi0_fixedpts_extraporder2_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_xixi0_fixedpts_extraporder2_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_trace0_fixedpts_extraporder2_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_massdensity0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxbdyphi0_fixedpts_extraporder2_paramset1               = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));   
	                        minquasiset_tt0_fixedpts_extraporder2_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_tchi0_fixedpts_extraporder2_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_txi0_fixedpts_extraporder2_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_chichi0_fixedpts_extraporder2_paramset1      = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_chixi0_fixedpts_extraporder2_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_xixi0_fixedpts_extraporder2_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_trace0_fixedpts_extraporder2_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_massdensity0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minbdyphi0_fixedpts_extraporder2_paramset1               = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));   
	                        quasiset_tt0_fixedpts_extraporder2_paramset1             = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_tchi0_fixedpts_extraporder2_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_txi0_fixedpts_extraporder2_paramset1            = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_chichi0_fixedpts_extraporder2_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_chixi0_fixedpts_extraporder2_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_xixi0_fixedpts_extraporder2_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_trace0_fixedpts_extraporder2_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_massdensity0_fixedpts_extraporder2_paramset1    = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        AdS_mass0_fixedpts_extraporder2_paramset1                = malloc(sizeof(real));
	                        bdyphi0_fixedpts_extraporder2_paramset1                  = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));    
	                        xpbdy0_fixedpts_extraporder2_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        ypbdy0_fixedpts_extraporder2_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        zpbdy0_fixedpts_extraporder2_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));   
	                       	x_outermostpt0_fixedpts_extraporder2_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                       	y_outermostpt0_fixedpts_extraporder2_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                       	z_outermostpt0_fixedpts_extraporder2_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));   
	
	
	                        //initialize
	                        for (i=0;i<numbdypoints_fixedpts_extraporder2_paramset1;i++)
	                        {
	                            quasiset_tt_fixedpts_extraporder2_paramset1              [i] = 0;
	                            quasiset_tchi_fixedpts_extraporder2_paramset1            [i] = 0;
	                            quasiset_txi_fixedpts_extraporder2_paramset1             [i] = 0;
	                            quasiset_chichi_fixedpts_extraporder2_paramset1          [i] = 0;
	                            quasiset_chixi_fixedpts_extraporder2_paramset1           [i] = 0;
	                            quasiset_xixi_fixedpts_extraporder2_paramset1            [i] = 0;
	                            quasiset_trace_fixedpts_extraporder2_paramset1           [i] = 0;
	                            quasiset_massdensity_fixedpts_extraporder2_paramset1     [i] = 0;
	                            quasiset_angmomdensityx_fixedpts_extraporder2_paramset1  [i] = 0;
	                            quasiset_angmomdensityy_fixedpts_extraporder2_paramset1  [i] = 0;
	                            quasiset_angmomdensityz_fixedpts_extraporder2_paramset1  [i] = 0;
	                            bdyphi_fixedpts_extraporder2_paramset1                   [i] = 0;   
	                            xpbdy_fixedpts_extraporder2_paramset1               [i] = 0;
	                            ypbdy_fixedpts_extraporder2_paramset1               [i] = 0;
	                            zpbdy_fixedpts_extraporder2_paramset1               [i] = 0;
	                           	x_outermostpt_fixedpts_extraporder2_paramset1            [i] = 0;
	                           	y_outermostpt_fixedpts_extraporder2_paramset1            [i] = 0;
	                           	z_outermostpt_fixedpts_extraporder2_paramset1            [i] = 0;
	
	                        }   
	                        for (i=0;i<basenumbdypoints_fixedpts_extraporder2_paramset1;i++)
	                        {   
	                            lquasiset_tt0_fixedpts_extraporder2_paramset1            [i] = 0;
	                            lquasiset_tchi0_fixedpts_extraporder2_paramset1          [i] = 0;
	                            lquasiset_txi0_fixedpts_extraporder2_paramset1           [i] = 0;
	                            lquasiset_chichi0_fixedpts_extraporder2_paramset1        [i] = 0;
	                            lquasiset_chixi0_fixedpts_extraporder2_paramset1         [i] = 0;
	                            lquasiset_xixi0_fixedpts_extraporder2_paramset1          [i] = 0;
	                            lquasiset_trace0_fixedpts_extraporder2_paramset1         [i] = 0;
	                            lquasiset_massdensity0_fixedpts_extraporder2_paramset1   [i] = 0;
	                            lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1[i] = 0;
	                            lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1[i] = 0;
	                            lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1[i] = 0;
	                            lbdyphi0_fixedpts_extraporder2_paramset1                 [i] = 0;             
	                            maxquasiset_tt0_fixedpts_extraporder2_paramset1          [i] = 0;
	                            maxquasiset_tchi0_fixedpts_extraporder2_paramset1        [i] = 0;
	                            maxquasiset_txi0_fixedpts_extraporder2_paramset1         [i] = 0;
	                            maxquasiset_chichi0_fixedpts_extraporder2_paramset1      [i] = 0;
	                            maxquasiset_chixi0_fixedpts_extraporder2_paramset1       [i] = 0;
	                            maxquasiset_xixi0_fixedpts_extraporder2_paramset1        [i] = 0;
	                            maxquasiset_trace0_fixedpts_extraporder2_paramset1       [i] = 0;
	                            maxquasiset_massdensity0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            maxbdyphi0_fixedpts_extraporder2_paramset1               [i] = 0;  
	                            minquasiset_tt0_fixedpts_extraporder2_paramset1          [i] = 0;
	                            minquasiset_tchi0_fixedpts_extraporder2_paramset1        [i] = 0;
	                            minquasiset_txi0_fixedpts_extraporder2_paramset1         [i] = 0;
	                            minquasiset_chichi0_fixedpts_extraporder2_paramset1      [i] = 0;
	                            minquasiset_chixi0_fixedpts_extraporder2_paramset1       [i] = 0;
	                            minquasiset_xixi0_fixedpts_extraporder2_paramset1        [i] = 0;
	                            minquasiset_trace0_fixedpts_extraporder2_paramset1       [i] = 0;
	                            minquasiset_massdensity0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            minbdyphi0_fixedpts_extraporder2_paramset1               [i] = 0;  
	                            quasiset_tt0_fixedpts_extraporder2_paramset1             [i] = 0;
	                            quasiset_tchi0_fixedpts_extraporder2_paramset1           [i] = 0;
	                            quasiset_txi0_fixedpts_extraporder2_paramset1            [i] = 0;
	                            quasiset_chichi0_fixedpts_extraporder2_paramset1         [i] = 0;
	                            quasiset_chixi0_fixedpts_extraporder2_paramset1          [i] = 0;
	                            quasiset_xixi0_fixedpts_extraporder2_paramset1           [i] = 0;
	                            quasiset_trace0_fixedpts_extraporder2_paramset1          [i] = 0;
	                            quasiset_massdensity0_fixedpts_extraporder2_paramset1    [i] = 0;
	                            quasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            quasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            quasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            bdyphi0_fixedpts_extraporder2_paramset1                  [i] = 0;   
	                            xpbdy0_fixedpts_extraporder2_paramset1              [i] = 0;
	                            ypbdy0_fixedpts_extraporder2_paramset1              [i] = 0;
	                            zpbdy0_fixedpts_extraporder2_paramset1              [i] = 0;  
	                           	x_outermostpt0_fixedpts_extraporder2_paramset1           [i] = 0;
	                           	y_outermostpt0_fixedpts_extraporder2_paramset1           [i] = 0;
	                           	z_outermostpt0_fixedpts_extraporder2_paramset1           [i] = 0;
	
	                        }
	                        *AdS_mass0_fixedpts_extraporder2_paramset1                    = 0; 
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_fixedpts_extraporder2_paramset1=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_fixedpts_extraporder2_paramset1=vecbdypoints_fixedpts_extraporder2_paramset1[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_fixedpts_extraporder2_paramset1=is_bdy_fixedpts_extraporder2_paramset1+vecbdypoints_fixedpts_extraporder2_paramset1[j];
	                            }
	                            ie_bdy_fixedpts_extraporder2_paramset1=is_bdy_fixedpts_extraporder2_paramset1+vecbdypoints_fixedpts_extraporder2_paramset1[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_fixedpts_extraporder2_paramset1[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_fixedpts_extraporder2_paramset1[i]=dsplsbdypoints_fixedpts_extraporder2_paramset1[i]+vecbdypoints_fixedpts_extraporder2_paramset1[j];
	                                }
	                            }
	                        }   
	
	                        xyz_extrap_outermost_(xpbdy_fixedpts_extraporder2_paramset1,ypbdy_fixedpts_extraporder2_paramset1,zpbdy_fixedpts_extraporder2_paramset1,
	                        						x_outermostpt_fixedpts_extraporder2_paramset1,y_outermostpt_fixedpts_extraporder2_paramset1,z_outermostpt_fixedpts_extraporder2_paramset1,
	                        						chrbdy_fixedpts_extraporder2_paramset1,&numbdypoints_fixedpts_extraporder2_paramset1,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_fixedpts_extraporder2_paramset1,numbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,xpbdy0_fixedpts_extraporder2_paramset1,vecbdypoints_fixedpts_extraporder2_paramset1,dsplsbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_fixedpts_extraporder2_paramset1,numbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,ypbdy0_fixedpts_extraporder2_paramset1,vecbdypoints_fixedpts_extraporder2_paramset1,dsplsbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_fixedpts_extraporder2_paramset1,numbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,zpbdy0_fixedpts_extraporder2_paramset1,vecbdypoints_fixedpts_extraporder2_paramset1,dsplsbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_fixedpts_extraporder2_paramset1,numbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,x_outermostpt0_fixedpts_extraporder2_paramset1,vecbdypoints_fixedpts_extraporder2_paramset1,dsplsbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_fixedpts_extraporder2_paramset1,numbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,y_outermostpt0_fixedpts_extraporder2_paramset1,vecbdypoints_fixedpts_extraporder2_paramset1,dsplsbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_fixedpts_extraporder2_paramset1,numbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,z_outermostpt0_fixedpts_extraporder2_paramset1,vecbdypoints_fixedpts_extraporder2_paramset1,dsplsbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_fixedpts_extraporder2_paramset1 = malloc(sizeof(real));
	                                chiextrap0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                                xiextrap0_fixedpts_extraporder2_paramset1  = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_fixedpts_extraporder2_paramset1,chiextrap0_fixedpts_extraporder2_paramset1,xiextrap0_fixedpts_extraporder2_paramset1,xpbdy0_fixedpts_extraporder2_paramset1,ypbdy0_fixedpts_extraporder2_paramset1,zpbdy0_fixedpts_extraporder2_paramset1,&basenumbdypoints_fixedpts_extraporder2_paramset1);  
	                                basebdy_Nchi_fixedpts_extraporder2_paramset1=0;//initialize
	                                basebdy_Nxi_fixedpts_extraporder2_paramset1=0; //initialize
	                                bdyn_(&basebdy_Nchi_fixedpts_extraporder2_paramset1,&basebdy_Nxi_fixedpts_extraporder2_paramset1,&basenumbdypoints_fixedpts_extraporder2_paramset1,chiextrap0_fixedpts_extraporder2_paramset1,xiextrap0_fixedpts_extraporder2_paramset1);  
	                                rhobdy0_fixedpts_extraporder2_paramset1 = malloc(sizeof(real));
	                                chibdy0_fixedpts_extraporder2_paramset1 = malloc(basebdy_Nchi_fixedpts_extraporder2_paramset1*sizeof(real));
	                                xibdy0_fixedpts_extraporder2_paramset1  = malloc(basebdy_Nxi_fixedpts_extraporder2_paramset1*sizeof(real));   
	                            }
	                        }
	
	
	                        extrap_bdyphi_fixedpts_(bdyphi_fixedpts_extraporder2_paramset1,
	                                        leadordcoeff_phi1,
	                                        xpbdy_fixedpts_extraporder2_paramset1,ypbdy_fixedpts_extraporder2_paramset1,zpbdy_fixedpts_extraporder2_paramset1,
	                                        chrbdy_fixedpts_extraporder2_paramset1,&numbdypoints_fixedpts_extraporder2_paramset1,
	                                        &bdy_extrap_order,
	                                        &ind_distance_fixedpts,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        extrap_quasiset_fixedpts_(quasiset_tt_fixedpts_extraporder2_paramset1,quasiset_tchi_fixedpts_extraporder2_paramset1,quasiset_txi_fixedpts_extraporder2_paramset1,
	                                quasiset_chichi_fixedpts_extraporder2_paramset1,quasiset_chixi_fixedpts_extraporder2_paramset1,
	                                quasiset_xixi_fixedpts_extraporder2_paramset1,
	                                quasiset_trace_fixedpts_extraporder2_paramset1,
	                                quasiset_massdensity_fixedpts_extraporder2_paramset1,
	                                quasiset_angmomdensityx_fixedpts_extraporder2_paramset1,
	                                quasiset_angmomdensityy_fixedpts_extraporder2_paramset1,
	                                quasiset_angmomdensityz_fixedpts_extraporder2_paramset1,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_fixedpts_extraporder2_paramset1,ypbdy_fixedpts_extraporder2_paramset1,zpbdy_fixedpts_extraporder2_paramset1,
	                                chrbdy_fixedpts_extraporder2_paramset1,&numbdypoints_fixedpts_extraporder2_paramset1,
	                                &bdy_extrap_order,
	                                &ind_distance_fixedpts,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_fixedpts_extraporder2_paramset1; i<ie_bdy_fixedpts_extraporder2_paramset1; i++)
	                        {
	                            lquasiset_tt0_fixedpts_extraporder2_paramset1           [i] = quasiset_tt_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_tchi0_fixedpts_extraporder2_paramset1         [i] = quasiset_tchi_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_txi0_fixedpts_extraporder2_paramset1          [i] = quasiset_txi_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_chichi0_fixedpts_extraporder2_paramset1       [i] = quasiset_chichi_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_chixi0_fixedpts_extraporder2_paramset1        [i] = quasiset_chixi_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_xixi0_fixedpts_extraporder2_paramset1         [i] = quasiset_xixi_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_trace0_fixedpts_extraporder2_paramset1        [i] = quasiset_trace_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_massdensity0_fixedpts_extraporder2_paramset1  [i] = quasiset_massdensity_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i] = quasiset_angmomdensityx_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i] = quasiset_angmomdensityy_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i] = quasiset_angmomdensityz_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lbdyphi0_fixedpts_extraporder2_paramset1                [i] = bdyphi_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                        }   

	                        //PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder2_paramset1,          maxquasiset_tt0_fixedpts_extraporder2_paramset1,          basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder2_paramset1,        maxquasiset_tchi0_fixedpts_extraporder2_paramset1,        basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder2_paramset1,         maxquasiset_txi0_fixedpts_extraporder2_paramset1,         basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder2_paramset1,      maxquasiset_chichi0_fixedpts_extraporder2_paramset1,      basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder2_paramset1,       maxquasiset_chixi0_fixedpts_extraporder2_paramset1,       basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder2_paramset1,        maxquasiset_xixi0_fixedpts_extraporder2_paramset1,        basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder2_paramset1,       maxquasiset_trace0_fixedpts_extraporder2_paramset1,       basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder2_paramset1, maxquasiset_massdensity0_fixedpts_extraporder2_paramset1, basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1, maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1, basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1, maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1, basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1, maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1, basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder2_paramset1,               maxbdyphi0_fixedpts_extraporder2_paramset1,               basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder2_paramset1,          minquasiset_tt0_fixedpts_extraporder2_paramset1,          basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder2_paramset1,        minquasiset_tchi0_fixedpts_extraporder2_paramset1,        basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder2_paramset1,         minquasiset_txi0_fixedpts_extraporder2_paramset1,         basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder2_paramset1,      minquasiset_chichi0_fixedpts_extraporder2_paramset1,      basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder2_paramset1,       minquasiset_chixi0_fixedpts_extraporder2_paramset1,       basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder2_paramset1,        minquasiset_xixi0_fixedpts_extraporder2_paramset1,        basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder2_paramset1,       minquasiset_trace0_fixedpts_extraporder2_paramset1,       basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder2_paramset1, minquasiset_massdensity0_fixedpts_extraporder2_paramset1, basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1, minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1, basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1, minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1, basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1, minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1, basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder2_paramset1,               minbdyphi0_fixedpts_extraporder2_paramset1,               basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_fixedpts_extraporder2_paramset1; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_fixedpts_extraporder2_paramset1          [i] = maxquasiset_tt0_fixedpts_extraporder2_paramset1          [i] + minquasiset_tt0_fixedpts_extraporder2_paramset1          [i];
	                                    quasiset_tchi0_fixedpts_extraporder2_paramset1        [i] = maxquasiset_tchi0_fixedpts_extraporder2_paramset1        [i] + minquasiset_tchi0_fixedpts_extraporder2_paramset1        [i];
	                                    quasiset_txi0_fixedpts_extraporder2_paramset1         [i] = maxquasiset_txi0_fixedpts_extraporder2_paramset1         [i] + minquasiset_txi0_fixedpts_extraporder2_paramset1         [i];
	                                    quasiset_chichi0_fixedpts_extraporder2_paramset1      [i] = maxquasiset_chichi0_fixedpts_extraporder2_paramset1      [i] + minquasiset_chichi0_fixedpts_extraporder2_paramset1      [i];
	                                    quasiset_chixi0_fixedpts_extraporder2_paramset1       [i] = maxquasiset_chixi0_fixedpts_extraporder2_paramset1       [i] + minquasiset_chixi0_fixedpts_extraporder2_paramset1       [i];
	                                    quasiset_xixi0_fixedpts_extraporder2_paramset1        [i] = maxquasiset_xixi0_fixedpts_extraporder2_paramset1        [i] + minquasiset_xixi0_fixedpts_extraporder2_paramset1        [i];
	                                    quasiset_trace0_fixedpts_extraporder2_paramset1       [i] = maxquasiset_trace0_fixedpts_extraporder2_paramset1       [i] + minquasiset_trace0_fixedpts_extraporder2_paramset1       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder2_paramset1 [i] = maxquasiset_massdensity0_fixedpts_extraporder2_paramset1 [i] + minquasiset_massdensity0_fixedpts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i] + minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i] + minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i] + minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i];
	                                    bdyphi0_fixedpts_extraporder2_paramset1               [i] = maxbdyphi0_fixedpts_extraporder2_paramset1               [i] + minbdyphi0_fixedpts_extraporder2_paramset1               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_fixedpts_extraporder2_paramset1          [i] = maxquasiset_tt0_fixedpts_extraporder2_paramset1          [i];
	                                    quasiset_tchi0_fixedpts_extraporder2_paramset1        [i] = maxquasiset_tchi0_fixedpts_extraporder2_paramset1        [i];
	                                    quasiset_txi0_fixedpts_extraporder2_paramset1         [i] = maxquasiset_txi0_fixedpts_extraporder2_paramset1         [i];
	                                    quasiset_chichi0_fixedpts_extraporder2_paramset1      [i] = maxquasiset_chichi0_fixedpts_extraporder2_paramset1      [i];
	                                    quasiset_chixi0_fixedpts_extraporder2_paramset1       [i] = maxquasiset_chixi0_fixedpts_extraporder2_paramset1       [i];
	                                    quasiset_xixi0_fixedpts_extraporder2_paramset1        [i] = maxquasiset_xixi0_fixedpts_extraporder2_paramset1        [i];
	                                    quasiset_trace0_fixedpts_extraporder2_paramset1       [i] = maxquasiset_trace0_fixedpts_extraporder2_paramset1       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder2_paramset1 [i] = maxquasiset_massdensity0_fixedpts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i];
	                                    bdyphi0_fixedpts_extraporder2_paramset1               [i] = maxbdyphi0_fixedpts_extraporder2_paramset1               [i];
	                                }  
	                        }       
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {
	                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    								name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder2_paramset1[j],ypbdy0_fixedpts_extraporder2_paramset1[j],zpbdy0_fixedpts_extraporder2_paramset1[j],j);
                                    }
                                    fclose(fp);
                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder2_paramset1[j],ypbdy0_fixedpts_extraporder2_paramset1[j],zpbdy0_fixedpts_extraporder2_paramset1[j],j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }   
	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder2_paramset1[j],y_outermostpt0_fixedpts_extraporder2_paramset1[j],z_outermostpt0_fixedpts_extraporder2_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder2_paramset1[j],y_outermostpt0_fixedpts_extraporder2_paramset1[j],z_outermostpt0_fixedpts_extraporder2_paramset1[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name); 
	                                	}   
	                                }
	                                if(output_bdyphi)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
                                    	sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder2_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder2_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                } 
	                                }    

                                    // save quasiset_ll as ascii
                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   									name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
                                                    ct,
                                                    quasiset_tt0_fixedpts_extraporder2_paramset1[j],quasiset_tchi0_fixedpts_extraporder2_paramset1[j],quasiset_txi0_fixedpts_extraporder2_paramset1[j],quasiset_chichi0_fixedpts_extraporder2_paramset1[j],quasiset_chixi0_fixedpts_extraporder2_paramset1[j],quasiset_xixi0_fixedpts_extraporder2_paramset1[j],
                                                    j);
                                    }
                                    fclose(fp);
                                    free(name);  
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_fixedpts_extraporder2_paramset1[j],quasiset_tchi0_fixedpts_extraporder2_paramset1[j],quasiset_txi0_fixedpts_extraporder2_paramset1[j],quasiset_chichi0_fixedpts_extraporder2_paramset1[j],quasiset_chixi0_fixedpts_extraporder2_paramset1[j],quasiset_xixi0_fixedpts_extraporder2_paramset1[j],
	                                                    j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }
	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_fixedpts_extraporder2_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_fixedpts_extraporder2_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_fixedpts_extraporder2_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_fixedpts_extraporder2_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {
		                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
		                            	sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_angmomdensityx0_fixedpts_extraporder2_paramset1[j],quasiset_angmomdensityy0_fixedpts_extraporder2_paramset1[j],quasiset_angmomdensityz0_fixedpts_extraporder2_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);   
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_fixedpts_extraporder2_paramset1[j],quasiset_angmomdensityy0_fixedpts_extraporder2_paramset1[j],quasiset_angmomdensityz0_fixedpts_extraporder2_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_fixedpts_extraporder2_paramset1=1;
	                                chibdy_xibdy_(chibdy0_fixedpts_extraporder2_paramset1,xibdy0_fixedpts_extraporder2_paramset1,xpbdy0_fixedpts_extraporder2_paramset1,ypbdy0_fixedpts_extraporder2_paramset1,zpbdy0_fixedpts_extraporder2_paramset1,&basenumbdypoints_fixedpts_extraporder2_paramset1,chiextrap0_fixedpts_extraporder2_paramset1,xiextrap0_fixedpts_extraporder2_paramset1,&basebdy_Nchi_fixedpts_extraporder2_paramset1,&basebdy_Nxi_fixedpts_extraporder2_paramset1);    
	                                doubleintegralonsphere_(AdS_mass0_fixedpts_extraporder2_paramset1,quasiset_massdensity0_fixedpts_extraporder2_paramset1,xpbdy0_fixedpts_extraporder2_paramset1,ypbdy0_fixedpts_extraporder2_paramset1,zpbdy0_fixedpts_extraporder2_paramset1,&basenumbdypoints_fixedpts_extraporder2_paramset1,rhobdy0_fixedpts_extraporder2_paramset1,chibdy0_fixedpts_extraporder2_paramset1,xibdy0_fixedpts_extraporder2_paramset1,&basebdy_Nchi_fixedpts_extraporder2_paramset1,&basebdy_Nxi_fixedpts_extraporder2_paramset1);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_%st_AdSmass.txt",AMRD_save_tag) + 1;
   									name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_fixedpts_extraporder2_paramset1);
	                                fclose(fp);
	                                free(name); 
	                            }
	                        }     

	                        free(vecbdypoints_fixedpts_extraporder2_paramset1);
	                        free(dsplsbdypoints_fixedpts_extraporder2_paramset1);
	                        free(quasiset_tt_fixedpts_extraporder2_paramset1);
	                        free(quasiset_tchi_fixedpts_extraporder2_paramset1);
	                        free(quasiset_txi_fixedpts_extraporder2_paramset1);
	                        free(quasiset_chichi_fixedpts_extraporder2_paramset1);
	                        free(quasiset_chixi_fixedpts_extraporder2_paramset1);
	                        free(quasiset_xixi_fixedpts_extraporder2_paramset1);
	                        free(quasiset_trace_fixedpts_extraporder2_paramset1);
	                        free(quasiset_massdensity_fixedpts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityx_fixedpts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityy_fixedpts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityz_fixedpts_extraporder2_paramset1);
	                        free(bdyphi_fixedpts_extraporder2_paramset1);  
	                        free(xpbdy_fixedpts_extraporder2_paramset1);
	                        free(ypbdy_fixedpts_extraporder2_paramset1);
	                        free(zpbdy_fixedpts_extraporder2_paramset1);   
	                        free(x_outermostpt_fixedpts_extraporder2_paramset1);
	                        free(y_outermostpt_fixedpts_extraporder2_paramset1);
	                        free(z_outermostpt_fixedpts_extraporder2_paramset1);   
	
	                        free(lquasiset_tt0_fixedpts_extraporder2_paramset1);        
	                        free(lquasiset_tchi0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_txi0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_chichi0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_chixi0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_xixi0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_trace0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_massdensity0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1);
	                        free(lbdyphi0_fixedpts_extraporder2_paramset1);      
	                        free(maxquasiset_tt0_fixedpts_extraporder2_paramset1);        
	                        free(maxquasiset_tchi0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_txi0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_chichi0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_chixi0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_xixi0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_trace0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_massdensity0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1);
	                        free(maxbdyphi0_fixedpts_extraporder2_paramset1);    
	                        free(minquasiset_tt0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_tchi0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_txi0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_chichi0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_chixi0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_xixi0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_trace0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_massdensity0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1);
	                        free(minbdyphi0_fixedpts_extraporder2_paramset1);    
	                        free(quasiset_tt0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_tchi0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_txi0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_chichi0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_chixi0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_xixi0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_trace0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_massdensity0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityx0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityy0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityz0_fixedpts_extraporder2_paramset1);
	                        free(bdyphi0_fixedpts_extraporder2_paramset1);
	                        free(AdS_mass0_fixedpts_extraporder2_paramset1);     
	                        free(xpbdy0_fixedpts_extraporder2_paramset1);
	                        free(ypbdy0_fixedpts_extraporder2_paramset1);
	                        free(zpbdy0_fixedpts_extraporder2_paramset1);
	                        free(x_outermostpt0_fixedpts_extraporder2_paramset1);
	                        free(y_outermostpt0_fixedpts_extraporder2_paramset1);
	                        free(z_outermostpt0_fixedpts_extraporder2_paramset1);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_fixedpts_extraporder2_paramset1);
	                            free(chiextrap0_fixedpts_extraporder2_paramset1);
	                            free(xiextrap0_fixedpts_extraporder2_paramset1);             
	                            free(rhobdy0_fixedpts_extraporder2_paramset1);
	                            free(chibdy0_fixedpts_extraporder2_paramset1);
	                            free(xibdy0_fixedpts_extraporder2_paramset1);    
	                        }   
                		}//closes condition on output_bdy_extraporder2_paramset1

                		//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_fixedpts 2nd order extrap paramset1\n"); fflush(stdout);}

	            		//THIRD ORDER EXTRAPOLATION
						if (output_bdy_extraporder3_paramset1)
            			{
                			bdy_extrap_order=3;

                			//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
							nexttobdypoints_fixedpts_(chrbdy_fixedpts_extraporder3_paramset1,&numbdypoints_fixedpts_extraporder3_paramset1,&bdy_extrap_order,&ind_distance_fixedpts,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset1,&half_steps_from_bdy_int_paramset1,&num_fixed_coords,fixed_coords,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width); 

	                    	//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_fixedpts_extraporder3_paramset1 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_fixedpts_extraporder3_paramset1 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_fixedpts_extraporder3_paramset1,1,MPI_INT,vecbdypoints_fixedpts_extraporder3_paramset1,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_fixedpts_extraporder3_paramset1,&basenumbdypoints_fixedpts_extraporder3_paramset1,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_fixedpts_extraporder3_paramset1=%i\n",numbdypoints_fixedpts_extraporder3_paramset1);
	                        //fflush(stdout); 
	                        quasiset_tt_fixedpts_extraporder3_paramset1              = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_tchi_fixedpts_extraporder3_paramset1            = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_txi_fixedpts_extraporder3_paramset1             = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_chichi_fixedpts_extraporder3_paramset1          = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_chixi_fixedpts_extraporder3_paramset1           = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_xixi_fixedpts_extraporder3_paramset1            = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_trace_fixedpts_extraporder3_paramset1           = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_massdensity_fixedpts_extraporder3_paramset1     = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx_fixedpts_extraporder3_paramset1  = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy_fixedpts_extraporder3_paramset1  = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz_fixedpts_extraporder3_paramset1  = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        bdyphi_fixedpts_extraporder3_paramset1                   = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));   
	                        xpbdy_fixedpts_extraporder3_paramset1               = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        ypbdy_fixedpts_extraporder3_paramset1               = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        zpbdy_fixedpts_extraporder3_paramset1               = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));  
	                       	x_outermostpt_fixedpts_extraporder3_paramset1            = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                       	y_outermostpt_fixedpts_extraporder3_paramset1            = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                       	z_outermostpt_fixedpts_extraporder3_paramset1            = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real)); 
	
	                        lquasiset_tt0_fixedpts_extraporder3_paramset1            = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_tchi0_fixedpts_extraporder3_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_txi0_fixedpts_extraporder3_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_chichi0_fixedpts_extraporder3_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_chixi0_fixedpts_extraporder3_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_xixi0_fixedpts_extraporder3_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_trace0_fixedpts_extraporder3_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_massdensity0_fixedpts_extraporder3_paramset1   = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1= malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1= malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1= malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lbdyphi0_fixedpts_extraporder3_paramset1                 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));   
	                        maxquasiset_tt0_fixedpts_extraporder3_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_tchi0_fixedpts_extraporder3_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_txi0_fixedpts_extraporder3_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_chichi0_fixedpts_extraporder3_paramset1      = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_chixi0_fixedpts_extraporder3_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_xixi0_fixedpts_extraporder3_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_trace0_fixedpts_extraporder3_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_massdensity0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxbdyphi0_fixedpts_extraporder3_paramset1               = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));   
	                        minquasiset_tt0_fixedpts_extraporder3_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_tchi0_fixedpts_extraporder3_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_txi0_fixedpts_extraporder3_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_chichi0_fixedpts_extraporder3_paramset1      = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_chixi0_fixedpts_extraporder3_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_xixi0_fixedpts_extraporder3_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_trace0_fixedpts_extraporder3_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_massdensity0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minbdyphi0_fixedpts_extraporder3_paramset1               = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));   
	                        quasiset_tt0_fixedpts_extraporder3_paramset1             = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_tchi0_fixedpts_extraporder3_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_txi0_fixedpts_extraporder3_paramset1            = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_chichi0_fixedpts_extraporder3_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_chixi0_fixedpts_extraporder3_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_xixi0_fixedpts_extraporder3_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_trace0_fixedpts_extraporder3_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_massdensity0_fixedpts_extraporder3_paramset1    = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        AdS_mass0_fixedpts_extraporder3_paramset1                = malloc(sizeof(real));
	                        bdyphi0_fixedpts_extraporder3_paramset1                  = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));    
	                        xpbdy0_fixedpts_extraporder3_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        ypbdy0_fixedpts_extraporder3_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        zpbdy0_fixedpts_extraporder3_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));   
	                       	x_outermostpt0_fixedpts_extraporder3_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                       	y_outermostpt0_fixedpts_extraporder3_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                       	z_outermostpt0_fixedpts_extraporder3_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));   
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_fixedpts_extraporder3_paramset1=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_fixedpts_extraporder3_paramset1=vecbdypoints_fixedpts_extraporder3_paramset1[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_fixedpts_extraporder3_paramset1=is_bdy_fixedpts_extraporder3_paramset1+vecbdypoints_fixedpts_extraporder3_paramset1[j];
	                            }
	                            ie_bdy_fixedpts_extraporder3_paramset1=is_bdy_fixedpts_extraporder3_paramset1+vecbdypoints_fixedpts_extraporder3_paramset1[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_fixedpts_extraporder3_paramset1[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_fixedpts_extraporder3_paramset1[i]=dsplsbdypoints_fixedpts_extraporder3_paramset1[i]+vecbdypoints_fixedpts_extraporder3_paramset1[j];
	                                }
	                            }
	                        }   
	
	                        xyz_extrap_outermost_(xpbdy_fixedpts_extraporder3_paramset1,ypbdy_fixedpts_extraporder3_paramset1,zpbdy_fixedpts_extraporder3_paramset1,
	                        						x_outermostpt_fixedpts_extraporder3_paramset1,y_outermostpt_fixedpts_extraporder3_paramset1,z_outermostpt_fixedpts_extraporder3_paramset1,
	                        						chrbdy_fixedpts_extraporder3_paramset1,&numbdypoints_fixedpts_extraporder3_paramset1,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_fixedpts_extraporder3_paramset1,numbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,xpbdy0_fixedpts_extraporder3_paramset1,vecbdypoints_fixedpts_extraporder3_paramset1,dsplsbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_fixedpts_extraporder3_paramset1,numbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,ypbdy0_fixedpts_extraporder3_paramset1,vecbdypoints_fixedpts_extraporder3_paramset1,dsplsbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_fixedpts_extraporder3_paramset1,numbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,zpbdy0_fixedpts_extraporder3_paramset1,vecbdypoints_fixedpts_extraporder3_paramset1,dsplsbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_fixedpts_extraporder3_paramset1,numbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,x_outermostpt0_fixedpts_extraporder3_paramset1,vecbdypoints_fixedpts_extraporder3_paramset1,dsplsbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_fixedpts_extraporder3_paramset1,numbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,y_outermostpt0_fixedpts_extraporder3_paramset1,vecbdypoints_fixedpts_extraporder3_paramset1,dsplsbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_fixedpts_extraporder3_paramset1,numbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,z_outermostpt0_fixedpts_extraporder3_paramset1,vecbdypoints_fixedpts_extraporder3_paramset1,dsplsbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_fixedpts_extraporder3_paramset1 = malloc(sizeof(real));
	                                chiextrap0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                                xiextrap0_fixedpts_extraporder3_paramset1  = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_fixedpts_extraporder3_paramset1,chiextrap0_fixedpts_extraporder3_paramset1,xiextrap0_fixedpts_extraporder3_paramset1,xpbdy0_fixedpts_extraporder3_paramset1,ypbdy0_fixedpts_extraporder3_paramset1,zpbdy0_fixedpts_extraporder3_paramset1,&basenumbdypoints_fixedpts_extraporder3_paramset1);  
	                                basebdy_Nchi_fixedpts_extraporder3_paramset1=0;//initialize
	                                basebdy_Nxi_fixedpts_extraporder3_paramset1=0; //initialize
	                                bdyn_(&basebdy_Nchi_fixedpts_extraporder3_paramset1,&basebdy_Nxi_fixedpts_extraporder3_paramset1,&basenumbdypoints_fixedpts_extraporder3_paramset1,chiextrap0_fixedpts_extraporder3_paramset1,xiextrap0_fixedpts_extraporder3_paramset1);  
	                                rhobdy0_fixedpts_extraporder3_paramset1 = malloc(sizeof(real));
	                                chibdy0_fixedpts_extraporder3_paramset1 = malloc(basebdy_Nchi_fixedpts_extraporder3_paramset1*sizeof(real));
	                                xibdy0_fixedpts_extraporder3_paramset1  = malloc(basebdy_Nxi_fixedpts_extraporder3_paramset1*sizeof(real));   
	                            }
	                        }
	
	
	                        extrap_bdyphi_fixedpts_(bdyphi_fixedpts_extraporder3_paramset1,
	                                        leadordcoeff_phi1,
	                                        xpbdy_fixedpts_extraporder3_paramset1,ypbdy_fixedpts_extraporder3_paramset1,zpbdy_fixedpts_extraporder3_paramset1,
	                                        chrbdy_fixedpts_extraporder3_paramset1,&numbdypoints_fixedpts_extraporder3_paramset1,
	                                        &bdy_extrap_order,
	                                        &ind_distance_fixedpts,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        extrap_quasiset_fixedpts_(quasiset_tt_fixedpts_extraporder3_paramset1,quasiset_tchi_fixedpts_extraporder3_paramset1,quasiset_txi_fixedpts_extraporder3_paramset1,
	                                quasiset_chichi_fixedpts_extraporder3_paramset1,quasiset_chixi_fixedpts_extraporder3_paramset1,
	                                quasiset_xixi_fixedpts_extraporder3_paramset1,
	                                quasiset_trace_fixedpts_extraporder3_paramset1,
	                                quasiset_massdensity_fixedpts_extraporder3_paramset1,
	                                quasiset_angmomdensityx_fixedpts_extraporder3_paramset1,
	                                quasiset_angmomdensityy_fixedpts_extraporder3_paramset1,
	                                quasiset_angmomdensityz_fixedpts_extraporder3_paramset1,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_fixedpts_extraporder3_paramset1,ypbdy_fixedpts_extraporder3_paramset1,zpbdy_fixedpts_extraporder3_paramset1,
	                                chrbdy_fixedpts_extraporder3_paramset1,&numbdypoints_fixedpts_extraporder3_paramset1,
	                                &bdy_extrap_order,
	                                &ind_distance_fixedpts,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_fixedpts_extraporder3_paramset1; i<ie_bdy_fixedpts_extraporder3_paramset1; i++)
	                        {
	                            lquasiset_tt0_fixedpts_extraporder3_paramset1           [i] = quasiset_tt_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_tchi0_fixedpts_extraporder3_paramset1         [i] = quasiset_tchi_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_txi0_fixedpts_extraporder3_paramset1          [i] = quasiset_txi_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_chichi0_fixedpts_extraporder3_paramset1       [i] = quasiset_chichi_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_chixi0_fixedpts_extraporder3_paramset1        [i] = quasiset_chixi_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_xixi0_fixedpts_extraporder3_paramset1         [i] = quasiset_xixi_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_trace0_fixedpts_extraporder3_paramset1        [i] = quasiset_trace_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_massdensity0_fixedpts_extraporder3_paramset1  [i] = quasiset_massdensity_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 [i] = quasiset_angmomdensityx_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 [i] = quasiset_angmomdensityy_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 [i] = quasiset_angmomdensityz_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lbdyphi0_fixedpts_extraporder3_paramset1                [i] = bdyphi_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                        }   

	                        //PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder3_paramset1,          maxquasiset_tt0_fixedpts_extraporder3_paramset1,          basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder3_paramset1,        maxquasiset_tchi0_fixedpts_extraporder3_paramset1,        basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder3_paramset1,         maxquasiset_txi0_fixedpts_extraporder3_paramset1,         basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder3_paramset1,      maxquasiset_chichi0_fixedpts_extraporder3_paramset1,      basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder3_paramset1,       maxquasiset_chixi0_fixedpts_extraporder3_paramset1,       basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder3_paramset1,        maxquasiset_xixi0_fixedpts_extraporder3_paramset1,        basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder3_paramset1,       maxquasiset_trace0_fixedpts_extraporder3_paramset1,       basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder3_paramset1, maxquasiset_massdensity0_fixedpts_extraporder3_paramset1, basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1, maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1, basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1, maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1, basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1, maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1, basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder3_paramset1,               maxbdyphi0_fixedpts_extraporder3_paramset1,               basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder3_paramset1,          minquasiset_tt0_fixedpts_extraporder3_paramset1,          basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder3_paramset1,        minquasiset_tchi0_fixedpts_extraporder3_paramset1,        basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder3_paramset1,         minquasiset_txi0_fixedpts_extraporder3_paramset1,         basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder3_paramset1,      minquasiset_chichi0_fixedpts_extraporder3_paramset1,      basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder3_paramset1,       minquasiset_chixi0_fixedpts_extraporder3_paramset1,       basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder3_paramset1,        minquasiset_xixi0_fixedpts_extraporder3_paramset1,        basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder3_paramset1,       minquasiset_trace0_fixedpts_extraporder3_paramset1,       basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder3_paramset1, minquasiset_massdensity0_fixedpts_extraporder3_paramset1, basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1, minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1, basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1, minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1, basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1, minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1, basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder3_paramset1,               minbdyphi0_fixedpts_extraporder3_paramset1,               basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_fixedpts_extraporder3_paramset1; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_fixedpts_extraporder3_paramset1          [i] = maxquasiset_tt0_fixedpts_extraporder3_paramset1          [i] + minquasiset_tt0_fixedpts_extraporder3_paramset1          [i];
	                                    quasiset_tchi0_fixedpts_extraporder3_paramset1        [i] = maxquasiset_tchi0_fixedpts_extraporder3_paramset1        [i] + minquasiset_tchi0_fixedpts_extraporder3_paramset1        [i];
	                                    quasiset_txi0_fixedpts_extraporder3_paramset1         [i] = maxquasiset_txi0_fixedpts_extraporder3_paramset1         [i] + minquasiset_txi0_fixedpts_extraporder3_paramset1         [i];
	                                    quasiset_chichi0_fixedpts_extraporder3_paramset1      [i] = maxquasiset_chichi0_fixedpts_extraporder3_paramset1      [i] + minquasiset_chichi0_fixedpts_extraporder3_paramset1      [i];
	                                    quasiset_chixi0_fixedpts_extraporder3_paramset1       [i] = maxquasiset_chixi0_fixedpts_extraporder3_paramset1       [i] + minquasiset_chixi0_fixedpts_extraporder3_paramset1       [i];
	                                    quasiset_xixi0_fixedpts_extraporder3_paramset1        [i] = maxquasiset_xixi0_fixedpts_extraporder3_paramset1        [i] + minquasiset_xixi0_fixedpts_extraporder3_paramset1        [i];
	                                    quasiset_trace0_fixedpts_extraporder3_paramset1       [i] = maxquasiset_trace0_fixedpts_extraporder3_paramset1       [i] + minquasiset_trace0_fixedpts_extraporder3_paramset1       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder3_paramset1 [i] = maxquasiset_massdensity0_fixedpts_extraporder3_paramset1 [i] + minquasiset_massdensity0_fixedpts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 [i] + minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 [i] + minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 [i] + minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 [i];
	                                    bdyphi0_fixedpts_extraporder3_paramset1               [i] = maxbdyphi0_fixedpts_extraporder3_paramset1               [i] + minbdyphi0_fixedpts_extraporder3_paramset1               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_fixedpts_extraporder3_paramset1          [i] = maxquasiset_tt0_fixedpts_extraporder3_paramset1          [i];
	                                    quasiset_tchi0_fixedpts_extraporder3_paramset1        [i] = maxquasiset_tchi0_fixedpts_extraporder3_paramset1        [i];
	                                    quasiset_txi0_fixedpts_extraporder3_paramset1         [i] = maxquasiset_txi0_fixedpts_extraporder3_paramset1         [i];
	                                    quasiset_chichi0_fixedpts_extraporder3_paramset1      [i] = maxquasiset_chichi0_fixedpts_extraporder3_paramset1      [i];
	                                    quasiset_chixi0_fixedpts_extraporder3_paramset1       [i] = maxquasiset_chixi0_fixedpts_extraporder3_paramset1       [i];
	                                    quasiset_xixi0_fixedpts_extraporder3_paramset1        [i] = maxquasiset_xixi0_fixedpts_extraporder3_paramset1        [i];
	                                    quasiset_trace0_fixedpts_extraporder3_paramset1       [i] = maxquasiset_trace0_fixedpts_extraporder3_paramset1       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder3_paramset1 [i] = maxquasiset_massdensity0_fixedpts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 [i];
	                                    bdyphi0_fixedpts_extraporder3_paramset1               [i] = maxbdyphi0_fixedpts_extraporder3_paramset1               [i];
	                                }  
	                        } 
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {
	                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    								name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder3_paramset1[j],ypbdy0_fixedpts_extraporder3_paramset1[j],zpbdy0_fixedpts_extraporder3_paramset1[j],j);
                                    }
                                    fclose(fp);
                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder3_paramset1[j],ypbdy0_fixedpts_extraporder3_paramset1[j],zpbdy0_fixedpts_extraporder3_paramset1[j],j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }   
	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder3_paramset1[j],y_outermostpt0_fixedpts_extraporder3_paramset1[j],z_outermostpt0_fixedpts_extraporder3_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder3_paramset1[j],y_outermostpt0_fixedpts_extraporder3_paramset1[j],z_outermostpt0_fixedpts_extraporder3_paramset1[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name); 
	                                	}   
	                                }
	                                if(output_bdyphi)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
                                    	sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder3_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder3_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                } 
	                                }    

                                    // save quasiset_ll as ascii
                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   									name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
                                                    ct,
                                                    quasiset_tt0_fixedpts_extraporder3_paramset1[j],quasiset_tchi0_fixedpts_extraporder3_paramset1[j],quasiset_txi0_fixedpts_extraporder3_paramset1[j],quasiset_chichi0_fixedpts_extraporder3_paramset1[j],quasiset_chixi0_fixedpts_extraporder3_paramset1[j],quasiset_xixi0_fixedpts_extraporder3_paramset1[j],
                                                    j);
                                    }
                                    fclose(fp);
                                    free(name);  
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_fixedpts_extraporder3_paramset1[j],quasiset_tchi0_fixedpts_extraporder3_paramset1[j],quasiset_txi0_fixedpts_extraporder3_paramset1[j],quasiset_chichi0_fixedpts_extraporder3_paramset1[j],quasiset_chixi0_fixedpts_extraporder3_paramset1[j],quasiset_xixi0_fixedpts_extraporder3_paramset1[j],
	                                                    j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }
	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_fixedpts_extraporder3_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_fixedpts_extraporder3_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_fixedpts_extraporder3_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_fixedpts_extraporder3_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {
		                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
		                            	sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_angmomdensityx0_fixedpts_extraporder3_paramset1[j],quasiset_angmomdensityy0_fixedpts_extraporder3_paramset1[j],quasiset_angmomdensityz0_fixedpts_extraporder3_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);   
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_fixedpts_extraporder3_paramset1[j],quasiset_angmomdensityy0_fixedpts_extraporder3_paramset1[j],quasiset_angmomdensityz0_fixedpts_extraporder3_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_fixedpts_extraporder3_paramset1=1;
	                                chibdy_xibdy_(chibdy0_fixedpts_extraporder3_paramset1,xibdy0_fixedpts_extraporder3_paramset1,xpbdy0_fixedpts_extraporder3_paramset1,ypbdy0_fixedpts_extraporder3_paramset1,zpbdy0_fixedpts_extraporder3_paramset1,&basenumbdypoints_fixedpts_extraporder3_paramset1,chiextrap0_fixedpts_extraporder3_paramset1,xiextrap0_fixedpts_extraporder3_paramset1,&basebdy_Nchi_fixedpts_extraporder3_paramset1,&basebdy_Nxi_fixedpts_extraporder3_paramset1);    
	                                doubleintegralonsphere_(AdS_mass0_fixedpts_extraporder3_paramset1,quasiset_massdensity0_fixedpts_extraporder3_paramset1,xpbdy0_fixedpts_extraporder3_paramset1,ypbdy0_fixedpts_extraporder3_paramset1,zpbdy0_fixedpts_extraporder3_paramset1,&basenumbdypoints_fixedpts_extraporder3_paramset1,rhobdy0_fixedpts_extraporder3_paramset1,chibdy0_fixedpts_extraporder3_paramset1,xibdy0_fixedpts_extraporder3_paramset1,&basebdy_Nchi_fixedpts_extraporder3_paramset1,&basebdy_Nxi_fixedpts_extraporder3_paramset1);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_%st_AdSmass.txt",AMRD_save_tag) + 1;
   									name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_fixedpts_extraporder3_paramset1);
	                                fclose(fp);
	                                free(name); 
	                            }
	                        }     

	                        free(vecbdypoints_fixedpts_extraporder3_paramset1);
	                        free(dsplsbdypoints_fixedpts_extraporder3_paramset1);
	                        free(quasiset_tt_fixedpts_extraporder3_paramset1);
	                        free(quasiset_tchi_fixedpts_extraporder3_paramset1);
	                        free(quasiset_txi_fixedpts_extraporder3_paramset1);
	                        free(quasiset_chichi_fixedpts_extraporder3_paramset1);
	                        free(quasiset_chixi_fixedpts_extraporder3_paramset1);
	                        free(quasiset_xixi_fixedpts_extraporder3_paramset1);
	                        free(quasiset_trace_fixedpts_extraporder3_paramset1);
	                        free(quasiset_massdensity_fixedpts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityx_fixedpts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityy_fixedpts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityz_fixedpts_extraporder3_paramset1);
	                        free(bdyphi_fixedpts_extraporder3_paramset1);  
	                        free(xpbdy_fixedpts_extraporder3_paramset1);
	                        free(ypbdy_fixedpts_extraporder3_paramset1);
	                        free(zpbdy_fixedpts_extraporder3_paramset1);   
	                        free(x_outermostpt_fixedpts_extraporder3_paramset1);
	                        free(y_outermostpt_fixedpts_extraporder3_paramset1);
	                        free(z_outermostpt_fixedpts_extraporder3_paramset1);   
	
	                        free(lquasiset_tt0_fixedpts_extraporder3_paramset1);        
	                        free(lquasiset_tchi0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_txi0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_chichi0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_chixi0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_xixi0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_trace0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_massdensity0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1);
	                        free(lbdyphi0_fixedpts_extraporder3_paramset1);      
	                        free(maxquasiset_tt0_fixedpts_extraporder3_paramset1);        
	                        free(maxquasiset_tchi0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_txi0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_chichi0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_chixi0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_xixi0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_trace0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_massdensity0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1);
	                        free(maxbdyphi0_fixedpts_extraporder3_paramset1);    
	                        free(minquasiset_tt0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_tchi0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_txi0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_chichi0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_chixi0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_xixi0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_trace0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_massdensity0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1);
	                        free(minbdyphi0_fixedpts_extraporder3_paramset1);    
	                        free(quasiset_tt0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_tchi0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_txi0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_chichi0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_chixi0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_xixi0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_trace0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_massdensity0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityx0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityy0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityz0_fixedpts_extraporder3_paramset1);
	                        free(bdyphi0_fixedpts_extraporder3_paramset1);
	                        free(AdS_mass0_fixedpts_extraporder3_paramset1);     
	                        free(xpbdy0_fixedpts_extraporder3_paramset1);
	                        free(ypbdy0_fixedpts_extraporder3_paramset1);
	                        free(zpbdy0_fixedpts_extraporder3_paramset1);
	                        free(x_outermostpt0_fixedpts_extraporder3_paramset1);
	                        free(y_outermostpt0_fixedpts_extraporder3_paramset1);
	                        free(z_outermostpt0_fixedpts_extraporder3_paramset1);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_fixedpts_extraporder3_paramset1);
	                            free(chiextrap0_fixedpts_extraporder3_paramset1);
	                            free(xiextrap0_fixedpts_extraporder3_paramset1);             
	                            free(rhobdy0_fixedpts_extraporder3_paramset1);
	                            free(chibdy0_fixedpts_extraporder3_paramset1);
	                            free(xibdy0_fixedpts_extraporder3_paramset1);    
	                        }   
                		}//closes condition on output_bdy_extraporder3_paramset1

                		//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_fixedpts 3rd order extrap paramset1\n"); fflush(stdout);}

	            		//EXTRAPOLATION WITH SECOND SET OF PARAMETERS (denoted by index 2 at the end)

		        		//FIRST ORDER EXTRAPOLATION
            			if (output_bdy_extraporder1_paramset2)
            			{
                			bdy_extrap_order=1;

                			//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
	                        nexttobdypoints_fixedpts_(chrbdy_fixedpts_extraporder1_paramset2,&numbdypoints_fixedpts_extraporder1_paramset2,&bdy_extrap_order,&ind_distance_fixedpts,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset2,&half_steps_from_bdy_int_paramset2,&num_fixed_coords,fixed_coords,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);

	                    	//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_fixedpts_extraporder1_paramset2 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_fixedpts_extraporder1_paramset2 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_fixedpts_extraporder1_paramset2,1,MPI_INT,vecbdypoints_fixedpts_extraporder1_paramset2,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_fixedpts_extraporder1_paramset2,&basenumbdypoints_fixedpts_extraporder1_paramset2,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_fixedpts_extraporder1_paramset2=%i\n",numbdypoints_fixedpts_extraporder1_paramset2);
	                        //fflush(stdout); 
	                        quasiset_tt_fixedpts_extraporder1_paramset2              = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_tchi_fixedpts_extraporder1_paramset2            = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_txi_fixedpts_extraporder1_paramset2             = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_chichi_fixedpts_extraporder1_paramset2          = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_chixi_fixedpts_extraporder1_paramset2           = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_xixi_fixedpts_extraporder1_paramset2            = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_trace_fixedpts_extraporder1_paramset2           = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_massdensity_fixedpts_extraporder1_paramset2     = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx_fixedpts_extraporder1_paramset2  = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy_fixedpts_extraporder1_paramset2  = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz_fixedpts_extraporder1_paramset2  = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        bdyphi_fixedpts_extraporder1_paramset2                   = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));   
	                        xpbdy_fixedpts_extraporder1_paramset2               = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        ypbdy_fixedpts_extraporder1_paramset2               = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        zpbdy_fixedpts_extraporder1_paramset2               = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));  
	                       	x_outermostpt_fixedpts_extraporder1_paramset2            = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                       	y_outermostpt_fixedpts_extraporder1_paramset2            = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                       	z_outermostpt_fixedpts_extraporder1_paramset2            = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real)); 
	
	                        lquasiset_tt0_fixedpts_extraporder1_paramset2            = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_tchi0_fixedpts_extraporder1_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_txi0_fixedpts_extraporder1_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_chichi0_fixedpts_extraporder1_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_chixi0_fixedpts_extraporder1_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_xixi0_fixedpts_extraporder1_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_trace0_fixedpts_extraporder1_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_massdensity0_fixedpts_extraporder1_paramset2   = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2= malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2= malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2= malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lbdyphi0_fixedpts_extraporder1_paramset2                 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));   
	                        maxquasiset_tt0_fixedpts_extraporder1_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_tchi0_fixedpts_extraporder1_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_txi0_fixedpts_extraporder1_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_chichi0_fixedpts_extraporder1_paramset2      = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_chixi0_fixedpts_extraporder1_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_xixi0_fixedpts_extraporder1_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_trace0_fixedpts_extraporder1_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_massdensity0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxbdyphi0_fixedpts_extraporder1_paramset2               = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));   
	                        minquasiset_tt0_fixedpts_extraporder1_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_tchi0_fixedpts_extraporder1_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_txi0_fixedpts_extraporder1_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_chichi0_fixedpts_extraporder1_paramset2      = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_chixi0_fixedpts_extraporder1_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_xixi0_fixedpts_extraporder1_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_trace0_fixedpts_extraporder1_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_massdensity0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minbdyphi0_fixedpts_extraporder1_paramset2               = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));   
	                        quasiset_tt0_fixedpts_extraporder1_paramset2             = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_tchi0_fixedpts_extraporder1_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_txi0_fixedpts_extraporder1_paramset2            = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_chichi0_fixedpts_extraporder1_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_chixi0_fixedpts_extraporder1_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_xixi0_fixedpts_extraporder1_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_trace0_fixedpts_extraporder1_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_massdensity0_fixedpts_extraporder1_paramset2    = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        AdS_mass0_fixedpts_extraporder1_paramset2                = malloc(sizeof(real));
	                        bdyphi0_fixedpts_extraporder1_paramset2                  = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));    
	                        xpbdy0_fixedpts_extraporder1_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        ypbdy0_fixedpts_extraporder1_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        zpbdy0_fixedpts_extraporder1_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));   
	                       	x_outermostpt0_fixedpts_extraporder1_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                       	y_outermostpt0_fixedpts_extraporder1_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                       	z_outermostpt0_fixedpts_extraporder1_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));   
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_fixedpts_extraporder1_paramset2=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_fixedpts_extraporder1_paramset2=vecbdypoints_fixedpts_extraporder1_paramset2[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_fixedpts_extraporder1_paramset2=is_bdy_fixedpts_extraporder1_paramset2+vecbdypoints_fixedpts_extraporder1_paramset2[j];
	                            }
	                            ie_bdy_fixedpts_extraporder1_paramset2=is_bdy_fixedpts_extraporder1_paramset2+vecbdypoints_fixedpts_extraporder1_paramset2[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_fixedpts_extraporder1_paramset2[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_fixedpts_extraporder1_paramset2[i]=dsplsbdypoints_fixedpts_extraporder1_paramset2[i]+vecbdypoints_fixedpts_extraporder1_paramset2[j];
	                                }
	                            }
	                        }   
	
	                        xyz_extrap_outermost_(xpbdy_fixedpts_extraporder1_paramset2,ypbdy_fixedpts_extraporder1_paramset2,zpbdy_fixedpts_extraporder1_paramset2,
	                        						x_outermostpt_fixedpts_extraporder1_paramset2,y_outermostpt_fixedpts_extraporder1_paramset2,z_outermostpt_fixedpts_extraporder1_paramset2,
	                        						chrbdy_fixedpts_extraporder1_paramset2,&numbdypoints_fixedpts_extraporder1_paramset2,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_fixedpts_extraporder1_paramset2,numbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,xpbdy0_fixedpts_extraporder1_paramset2,vecbdypoints_fixedpts_extraporder1_paramset2,dsplsbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_fixedpts_extraporder1_paramset2,numbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,ypbdy0_fixedpts_extraporder1_paramset2,vecbdypoints_fixedpts_extraporder1_paramset2,dsplsbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_fixedpts_extraporder1_paramset2,numbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,zpbdy0_fixedpts_extraporder1_paramset2,vecbdypoints_fixedpts_extraporder1_paramset2,dsplsbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_fixedpts_extraporder1_paramset2,numbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,x_outermostpt0_fixedpts_extraporder1_paramset2,vecbdypoints_fixedpts_extraporder1_paramset2,dsplsbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_fixedpts_extraporder1_paramset2,numbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,y_outermostpt0_fixedpts_extraporder1_paramset2,vecbdypoints_fixedpts_extraporder1_paramset2,dsplsbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_fixedpts_extraporder1_paramset2,numbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,z_outermostpt0_fixedpts_extraporder1_paramset2,vecbdypoints_fixedpts_extraporder1_paramset2,dsplsbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_fixedpts_extraporder1_paramset2 = malloc(sizeof(real));
	                                chiextrap0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                                xiextrap0_fixedpts_extraporder1_paramset2  = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_fixedpts_extraporder1_paramset2,chiextrap0_fixedpts_extraporder1_paramset2,xiextrap0_fixedpts_extraporder1_paramset2,xpbdy0_fixedpts_extraporder1_paramset2,ypbdy0_fixedpts_extraporder1_paramset2,zpbdy0_fixedpts_extraporder1_paramset2,&basenumbdypoints_fixedpts_extraporder1_paramset2);  
	                                basebdy_Nchi_fixedpts_extraporder1_paramset2=0;//initialize
	                                basebdy_Nxi_fixedpts_extraporder1_paramset2=0; //initialize
	                                bdyn_(&basebdy_Nchi_fixedpts_extraporder1_paramset2,&basebdy_Nxi_fixedpts_extraporder1_paramset2,&basenumbdypoints_fixedpts_extraporder1_paramset2,chiextrap0_fixedpts_extraporder1_paramset2,xiextrap0_fixedpts_extraporder1_paramset2);  
	                                rhobdy0_fixedpts_extraporder1_paramset2 = malloc(sizeof(real));
	                                chibdy0_fixedpts_extraporder1_paramset2 = malloc(basebdy_Nchi_fixedpts_extraporder1_paramset2*sizeof(real));
	                                xibdy0_fixedpts_extraporder1_paramset2  = malloc(basebdy_Nxi_fixedpts_extraporder1_paramset2*sizeof(real));   
	                            }
	                        }
	
	
	                        extrap_bdyphi_fixedpts_(bdyphi_fixedpts_extraporder1_paramset2,
	                                        leadordcoeff_phi1,
	                                        xpbdy_fixedpts_extraporder1_paramset2,ypbdy_fixedpts_extraporder1_paramset2,zpbdy_fixedpts_extraporder1_paramset2,
	                                        chrbdy_fixedpts_extraporder1_paramset2,&numbdypoints_fixedpts_extraporder1_paramset2,
	                                        &bdy_extrap_order,
	                                        &ind_distance_fixedpts,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        extrap_quasiset_fixedpts_(quasiset_tt_fixedpts_extraporder1_paramset2,quasiset_tchi_fixedpts_extraporder1_paramset2,quasiset_txi_fixedpts_extraporder1_paramset2,
	                                quasiset_chichi_fixedpts_extraporder1_paramset2,quasiset_chixi_fixedpts_extraporder1_paramset2,
	                                quasiset_xixi_fixedpts_extraporder1_paramset2,
	                                quasiset_trace_fixedpts_extraporder1_paramset2,
	                                quasiset_massdensity_fixedpts_extraporder1_paramset2,
	                                quasiset_angmomdensityx_fixedpts_extraporder1_paramset2,
	                                quasiset_angmomdensityy_fixedpts_extraporder1_paramset2,
	                                quasiset_angmomdensityz_fixedpts_extraporder1_paramset2,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_fixedpts_extraporder1_paramset2,ypbdy_fixedpts_extraporder1_paramset2,zpbdy_fixedpts_extraporder1_paramset2,
	                                chrbdy_fixedpts_extraporder1_paramset2,&numbdypoints_fixedpts_extraporder1_paramset2,
	                                &bdy_extrap_order,
	                                &ind_distance_fixedpts,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_fixedpts_extraporder1_paramset2; i<ie_bdy_fixedpts_extraporder1_paramset2; i++)
	                        {
	                            lquasiset_tt0_fixedpts_extraporder1_paramset2           [i] = quasiset_tt_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_tchi0_fixedpts_extraporder1_paramset2         [i] = quasiset_tchi_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_txi0_fixedpts_extraporder1_paramset2          [i] = quasiset_txi_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_chichi0_fixedpts_extraporder1_paramset2       [i] = quasiset_chichi_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_chixi0_fixedpts_extraporder1_paramset2        [i] = quasiset_chixi_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_xixi0_fixedpts_extraporder1_paramset2         [i] = quasiset_xixi_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_trace0_fixedpts_extraporder1_paramset2        [i] = quasiset_trace_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_massdensity0_fixedpts_extraporder1_paramset2  [i] = quasiset_massdensity_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 [i] = quasiset_angmomdensityx_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 [i] = quasiset_angmomdensityy_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 [i] = quasiset_angmomdensityz_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lbdyphi0_fixedpts_extraporder1_paramset2                [i] = bdyphi_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                        }   

	                        //PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder1_paramset2,          maxquasiset_tt0_fixedpts_extraporder1_paramset2,          basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder1_paramset2,        maxquasiset_tchi0_fixedpts_extraporder1_paramset2,        basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder1_paramset2,         maxquasiset_txi0_fixedpts_extraporder1_paramset2,         basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder1_paramset2,      maxquasiset_chichi0_fixedpts_extraporder1_paramset2,      basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder1_paramset2,       maxquasiset_chixi0_fixedpts_extraporder1_paramset2,       basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder1_paramset2,        maxquasiset_xixi0_fixedpts_extraporder1_paramset2,        basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder1_paramset2,       maxquasiset_trace0_fixedpts_extraporder1_paramset2,       basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder1_paramset2, maxquasiset_massdensity0_fixedpts_extraporder1_paramset2, basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2, maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2, basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2, maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2, basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2, maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2, basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder1_paramset2,               maxbdyphi0_fixedpts_extraporder1_paramset2,               basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder1_paramset2,          minquasiset_tt0_fixedpts_extraporder1_paramset2,          basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder1_paramset2,        minquasiset_tchi0_fixedpts_extraporder1_paramset2,        basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder1_paramset2,         minquasiset_txi0_fixedpts_extraporder1_paramset2,         basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder1_paramset2,      minquasiset_chichi0_fixedpts_extraporder1_paramset2,      basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder1_paramset2,       minquasiset_chixi0_fixedpts_extraporder1_paramset2,       basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder1_paramset2,        minquasiset_xixi0_fixedpts_extraporder1_paramset2,        basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder1_paramset2,       minquasiset_trace0_fixedpts_extraporder1_paramset2,       basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder1_paramset2, minquasiset_massdensity0_fixedpts_extraporder1_paramset2, basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2, minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2, basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2, minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2, basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2, minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2, basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder1_paramset2,               minbdyphi0_fixedpts_extraporder1_paramset2,               basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_fixedpts_extraporder1_paramset2; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_fixedpts_extraporder1_paramset2          [i] = maxquasiset_tt0_fixedpts_extraporder1_paramset2          [i] + minquasiset_tt0_fixedpts_extraporder1_paramset2          [i];
	                                    quasiset_tchi0_fixedpts_extraporder1_paramset2        [i] = maxquasiset_tchi0_fixedpts_extraporder1_paramset2        [i] + minquasiset_tchi0_fixedpts_extraporder1_paramset2        [i];
	                                    quasiset_txi0_fixedpts_extraporder1_paramset2         [i] = maxquasiset_txi0_fixedpts_extraporder1_paramset2         [i] + minquasiset_txi0_fixedpts_extraporder1_paramset2         [i];
	                                    quasiset_chichi0_fixedpts_extraporder1_paramset2      [i] = maxquasiset_chichi0_fixedpts_extraporder1_paramset2      [i] + minquasiset_chichi0_fixedpts_extraporder1_paramset2      [i];
	                                    quasiset_chixi0_fixedpts_extraporder1_paramset2       [i] = maxquasiset_chixi0_fixedpts_extraporder1_paramset2       [i] + minquasiset_chixi0_fixedpts_extraporder1_paramset2       [i];
	                                    quasiset_xixi0_fixedpts_extraporder1_paramset2        [i] = maxquasiset_xixi0_fixedpts_extraporder1_paramset2        [i] + minquasiset_xixi0_fixedpts_extraporder1_paramset2        [i];
	                                    quasiset_trace0_fixedpts_extraporder1_paramset2       [i] = maxquasiset_trace0_fixedpts_extraporder1_paramset2       [i] + minquasiset_trace0_fixedpts_extraporder1_paramset2       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder1_paramset2 [i] = maxquasiset_massdensity0_fixedpts_extraporder1_paramset2 [i] + minquasiset_massdensity0_fixedpts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 [i] + minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 [i] + minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 [i] + minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 [i];
	                                    bdyphi0_fixedpts_extraporder1_paramset2               [i] = maxbdyphi0_fixedpts_extraporder1_paramset2               [i] + minbdyphi0_fixedpts_extraporder1_paramset2               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_fixedpts_extraporder1_paramset2          [i] = maxquasiset_tt0_fixedpts_extraporder1_paramset2          [i];
	                                    quasiset_tchi0_fixedpts_extraporder1_paramset2        [i] = maxquasiset_tchi0_fixedpts_extraporder1_paramset2        [i];
	                                    quasiset_txi0_fixedpts_extraporder1_paramset2         [i] = maxquasiset_txi0_fixedpts_extraporder1_paramset2         [i];
	                                    quasiset_chichi0_fixedpts_extraporder1_paramset2      [i] = maxquasiset_chichi0_fixedpts_extraporder1_paramset2      [i];
	                                    quasiset_chixi0_fixedpts_extraporder1_paramset2       [i] = maxquasiset_chixi0_fixedpts_extraporder1_paramset2       [i];
	                                    quasiset_xixi0_fixedpts_extraporder1_paramset2        [i] = maxquasiset_xixi0_fixedpts_extraporder1_paramset2        [i];
	                                    quasiset_trace0_fixedpts_extraporder1_paramset2       [i] = maxquasiset_trace0_fixedpts_extraporder1_paramset2       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder1_paramset2 [i] = maxquasiset_massdensity0_fixedpts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 [i];
	                                    bdyphi0_fixedpts_extraporder1_paramset2               [i] = maxbdyphi0_fixedpts_extraporder1_paramset2               [i];
	                                }  
	                        }       
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {
	                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    								name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder1_paramset2[j],ypbdy0_fixedpts_extraporder1_paramset2[j],zpbdy0_fixedpts_extraporder1_paramset2[j],j);
                                    }
                                    fclose(fp);
                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder1_paramset2[j],ypbdy0_fixedpts_extraporder1_paramset2[j],zpbdy0_fixedpts_extraporder1_paramset2[j],j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }   
	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder1_paramset2[j],y_outermostpt0_fixedpts_extraporder1_paramset2[j],z_outermostpt0_fixedpts_extraporder1_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder1_paramset2[j],y_outermostpt0_fixedpts_extraporder1_paramset2[j],z_outermostpt0_fixedpts_extraporder1_paramset2[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name); 
	                                	}   
	                                }
	                                if(output_bdyphi)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
                                    	sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder1_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder1_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                } 
	                                }    

                                    // save quasiset_ll as ascii
                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   									name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
                                                    ct,
                                                    quasiset_tt0_fixedpts_extraporder1_paramset2[j],quasiset_tchi0_fixedpts_extraporder1_paramset2[j],quasiset_txi0_fixedpts_extraporder1_paramset2[j],quasiset_chichi0_fixedpts_extraporder1_paramset2[j],quasiset_chixi0_fixedpts_extraporder1_paramset2[j],quasiset_xixi0_fixedpts_extraporder1_paramset2[j],
                                                    j);
                                    }
                                    fclose(fp);
                                    free(name);  
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_fixedpts_extraporder1_paramset2[j],quasiset_tchi0_fixedpts_extraporder1_paramset2[j],quasiset_txi0_fixedpts_extraporder1_paramset2[j],quasiset_chichi0_fixedpts_extraporder1_paramset2[j],quasiset_chixi0_fixedpts_extraporder1_paramset2[j],quasiset_xixi0_fixedpts_extraporder1_paramset2[j],
	                                                    j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }
	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_fixedpts_extraporder1_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_fixedpts_extraporder1_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_fixedpts_extraporder1_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_fixedpts_extraporder1_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {
		                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
		                            	sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_angmomdensityx0_fixedpts_extraporder1_paramset2[j],quasiset_angmomdensityy0_fixedpts_extraporder1_paramset2[j],quasiset_angmomdensityz0_fixedpts_extraporder1_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);   
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_fixedpts_extraporder1_paramset2[j],quasiset_angmomdensityy0_fixedpts_extraporder1_paramset2[j],quasiset_angmomdensityz0_fixedpts_extraporder1_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_fixedpts_extraporder1_paramset2=1;
	                                chibdy_xibdy_(chibdy0_fixedpts_extraporder1_paramset2,xibdy0_fixedpts_extraporder1_paramset2,xpbdy0_fixedpts_extraporder1_paramset2,ypbdy0_fixedpts_extraporder1_paramset2,zpbdy0_fixedpts_extraporder1_paramset2,&basenumbdypoints_fixedpts_extraporder1_paramset2,chiextrap0_fixedpts_extraporder1_paramset2,xiextrap0_fixedpts_extraporder1_paramset2,&basebdy_Nchi_fixedpts_extraporder1_paramset2,&basebdy_Nxi_fixedpts_extraporder1_paramset2);    
	                                doubleintegralonsphere_(AdS_mass0_fixedpts_extraporder1_paramset2,quasiset_massdensity0_fixedpts_extraporder1_paramset2,xpbdy0_fixedpts_extraporder1_paramset2,ypbdy0_fixedpts_extraporder1_paramset2,zpbdy0_fixedpts_extraporder1_paramset2,&basenumbdypoints_fixedpts_extraporder1_paramset2,rhobdy0_fixedpts_extraporder1_paramset2,chibdy0_fixedpts_extraporder1_paramset2,xibdy0_fixedpts_extraporder1_paramset2,&basebdy_Nchi_fixedpts_extraporder1_paramset2,&basebdy_Nxi_fixedpts_extraporder1_paramset2);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_%st_AdSmass.txt",AMRD_save_tag) + 1;
   									name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_fixedpts_extraporder1_paramset2);
	                                fclose(fp);
	                                free(name); 
	                            }
	                        }      

	                        free(vecbdypoints_fixedpts_extraporder1_paramset2);
	                        free(dsplsbdypoints_fixedpts_extraporder1_paramset2);
	                        free(quasiset_tt_fixedpts_extraporder1_paramset2);
	                        free(quasiset_tchi_fixedpts_extraporder1_paramset2);
	                        free(quasiset_txi_fixedpts_extraporder1_paramset2);
	                        free(quasiset_chichi_fixedpts_extraporder1_paramset2);
	                        free(quasiset_chixi_fixedpts_extraporder1_paramset2);
	                        free(quasiset_xixi_fixedpts_extraporder1_paramset2);
	                        free(quasiset_trace_fixedpts_extraporder1_paramset2);
	                        free(quasiset_massdensity_fixedpts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityx_fixedpts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityy_fixedpts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityz_fixedpts_extraporder1_paramset2);
	                        free(bdyphi_fixedpts_extraporder1_paramset2);  
	                        free(xpbdy_fixedpts_extraporder1_paramset2);
	                        free(ypbdy_fixedpts_extraporder1_paramset2);
	                        free(zpbdy_fixedpts_extraporder1_paramset2);   
	                        free(x_outermostpt_fixedpts_extraporder1_paramset2);
	                        free(y_outermostpt_fixedpts_extraporder1_paramset2);
	                        free(z_outermostpt_fixedpts_extraporder1_paramset2);   
	
	                        free(lquasiset_tt0_fixedpts_extraporder1_paramset2);        
	                        free(lquasiset_tchi0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_txi0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_chichi0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_chixi0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_xixi0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_trace0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_massdensity0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2);
	                        free(lbdyphi0_fixedpts_extraporder1_paramset2);      
	                        free(maxquasiset_tt0_fixedpts_extraporder1_paramset2);        
	                        free(maxquasiset_tchi0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_txi0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_chichi0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_chixi0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_xixi0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_trace0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_massdensity0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2);
	                        free(maxbdyphi0_fixedpts_extraporder1_paramset2);    
	                        free(minquasiset_tt0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_tchi0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_txi0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_chichi0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_chixi0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_xixi0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_trace0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_massdensity0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2);
	                        free(minbdyphi0_fixedpts_extraporder1_paramset2);    
	                        free(quasiset_tt0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_tchi0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_txi0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_chichi0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_chixi0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_xixi0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_trace0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_massdensity0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityx0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityy0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityz0_fixedpts_extraporder1_paramset2);
	                        free(bdyphi0_fixedpts_extraporder1_paramset2);
	                        free(AdS_mass0_fixedpts_extraporder1_paramset2);     
	                        free(xpbdy0_fixedpts_extraporder1_paramset2);
	                        free(ypbdy0_fixedpts_extraporder1_paramset2);
	                        free(zpbdy0_fixedpts_extraporder1_paramset2);
	                        free(x_outermostpt0_fixedpts_extraporder1_paramset2);
	                        free(y_outermostpt0_fixedpts_extraporder1_paramset2);
	                        free(z_outermostpt0_fixedpts_extraporder1_paramset2);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_fixedpts_extraporder1_paramset2);
	                            free(chiextrap0_fixedpts_extraporder1_paramset2);
	                            free(xiextrap0_fixedpts_extraporder1_paramset2);             
	                            free(rhobdy0_fixedpts_extraporder1_paramset2);
	                            free(chibdy0_fixedpts_extraporder1_paramset2);
	                            free(xibdy0_fixedpts_extraporder1_paramset2);    
	                        }   
                		}//closes condition on output_bdy_extraporder1_paramset2

		            	//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_fixedpts 1st order extrap paramset2\n"); fflush(stdout);}

	            		//SECOND ORDER EXTRAPOLATION
						if (output_bdy_extraporder2_paramset2)
            			{
                			bdy_extrap_order=2;

                			//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
	                        nexttobdypoints_fixedpts_(chrbdy_fixedpts_extraporder2_paramset2,&numbdypoints_fixedpts_extraporder2_paramset2,&bdy_extrap_order,&ind_distance_fixedpts,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset2,&half_steps_from_bdy_int_paramset2,&num_fixed_coords,fixed_coords,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);

	                    	//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_fixedpts_extraporder2_paramset2 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_fixedpts_extraporder2_paramset2 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_fixedpts_extraporder2_paramset2,1,MPI_INT,vecbdypoints_fixedpts_extraporder2_paramset2,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_fixedpts_extraporder2_paramset2,&basenumbdypoints_fixedpts_extraporder2_paramset2,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_fixedpts_extraporder2_paramset2=%i\n",numbdypoints_fixedpts_extraporder2_paramset2);
	                        //fflush(stdout); 
	                        quasiset_tt_fixedpts_extraporder2_paramset2              = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_tchi_fixedpts_extraporder2_paramset2            = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_txi_fixedpts_extraporder2_paramset2             = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_chichi_fixedpts_extraporder2_paramset2          = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_chixi_fixedpts_extraporder2_paramset2           = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_xixi_fixedpts_extraporder2_paramset2            = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_trace_fixedpts_extraporder2_paramset2           = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_massdensity_fixedpts_extraporder2_paramset2     = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx_fixedpts_extraporder2_paramset2  = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy_fixedpts_extraporder2_paramset2  = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz_fixedpts_extraporder2_paramset2  = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        bdyphi_fixedpts_extraporder2_paramset2                   = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));   
	                        xpbdy_fixedpts_extraporder2_paramset2               = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        ypbdy_fixedpts_extraporder2_paramset2               = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        zpbdy_fixedpts_extraporder2_paramset2               = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));  
	                       	x_outermostpt_fixedpts_extraporder2_paramset2            = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                       	y_outermostpt_fixedpts_extraporder2_paramset2            = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                       	z_outermostpt_fixedpts_extraporder2_paramset2            = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real)); 
	
	                        lquasiset_tt0_fixedpts_extraporder2_paramset2            = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_tchi0_fixedpts_extraporder2_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_txi0_fixedpts_extraporder2_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_chichi0_fixedpts_extraporder2_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_chixi0_fixedpts_extraporder2_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_xixi0_fixedpts_extraporder2_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_trace0_fixedpts_extraporder2_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_massdensity0_fixedpts_extraporder2_paramset2   = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2= malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2= malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2= malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lbdyphi0_fixedpts_extraporder2_paramset2                 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));   
	                        maxquasiset_tt0_fixedpts_extraporder2_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_tchi0_fixedpts_extraporder2_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_txi0_fixedpts_extraporder2_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_chichi0_fixedpts_extraporder2_paramset2      = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_chixi0_fixedpts_extraporder2_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_xixi0_fixedpts_extraporder2_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_trace0_fixedpts_extraporder2_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_massdensity0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxbdyphi0_fixedpts_extraporder2_paramset2               = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));   
	                        minquasiset_tt0_fixedpts_extraporder2_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_tchi0_fixedpts_extraporder2_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_txi0_fixedpts_extraporder2_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_chichi0_fixedpts_extraporder2_paramset2      = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_chixi0_fixedpts_extraporder2_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_xixi0_fixedpts_extraporder2_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_trace0_fixedpts_extraporder2_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_massdensity0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minbdyphi0_fixedpts_extraporder2_paramset2               = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));   
	                        quasiset_tt0_fixedpts_extraporder2_paramset2             = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_tchi0_fixedpts_extraporder2_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_txi0_fixedpts_extraporder2_paramset2            = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_chichi0_fixedpts_extraporder2_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_chixi0_fixedpts_extraporder2_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_xixi0_fixedpts_extraporder2_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_trace0_fixedpts_extraporder2_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_massdensity0_fixedpts_extraporder2_paramset2    = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        AdS_mass0_fixedpts_extraporder2_paramset2                = malloc(sizeof(real));
	                        bdyphi0_fixedpts_extraporder2_paramset2                  = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));    
	                        xpbdy0_fixedpts_extraporder2_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        ypbdy0_fixedpts_extraporder2_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        zpbdy0_fixedpts_extraporder2_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));   
	                       	x_outermostpt0_fixedpts_extraporder2_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                       	y_outermostpt0_fixedpts_extraporder2_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                       	z_outermostpt0_fixedpts_extraporder2_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));   
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_fixedpts_extraporder2_paramset2=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_fixedpts_extraporder2_paramset2=vecbdypoints_fixedpts_extraporder2_paramset2[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_fixedpts_extraporder2_paramset2=is_bdy_fixedpts_extraporder2_paramset2+vecbdypoints_fixedpts_extraporder2_paramset2[j];
	                            }
	                            ie_bdy_fixedpts_extraporder2_paramset2=is_bdy_fixedpts_extraporder2_paramset2+vecbdypoints_fixedpts_extraporder2_paramset2[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_fixedpts_extraporder2_paramset2[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_fixedpts_extraporder2_paramset2[i]=dsplsbdypoints_fixedpts_extraporder2_paramset2[i]+vecbdypoints_fixedpts_extraporder2_paramset2[j];
	                                }
	                            }
	                        }   
	
	                        xyz_extrap_outermost_(xpbdy_fixedpts_extraporder2_paramset2,ypbdy_fixedpts_extraporder2_paramset2,zpbdy_fixedpts_extraporder2_paramset2,
	                        						x_outermostpt_fixedpts_extraporder2_paramset2,y_outermostpt_fixedpts_extraporder2_paramset2,z_outermostpt_fixedpts_extraporder2_paramset2,
	                        						chrbdy_fixedpts_extraporder2_paramset2,&numbdypoints_fixedpts_extraporder2_paramset2,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_fixedpts_extraporder2_paramset2,numbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,xpbdy0_fixedpts_extraporder2_paramset2,vecbdypoints_fixedpts_extraporder2_paramset2,dsplsbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_fixedpts_extraporder2_paramset2,numbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,ypbdy0_fixedpts_extraporder2_paramset2,vecbdypoints_fixedpts_extraporder2_paramset2,dsplsbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_fixedpts_extraporder2_paramset2,numbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,zpbdy0_fixedpts_extraporder2_paramset2,vecbdypoints_fixedpts_extraporder2_paramset2,dsplsbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_fixedpts_extraporder2_paramset2,numbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,x_outermostpt0_fixedpts_extraporder2_paramset2,vecbdypoints_fixedpts_extraporder2_paramset2,dsplsbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_fixedpts_extraporder2_paramset2,numbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,y_outermostpt0_fixedpts_extraporder2_paramset2,vecbdypoints_fixedpts_extraporder2_paramset2,dsplsbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_fixedpts_extraporder2_paramset2,numbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,z_outermostpt0_fixedpts_extraporder2_paramset2,vecbdypoints_fixedpts_extraporder2_paramset2,dsplsbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_fixedpts_extraporder2_paramset2 = malloc(sizeof(real));
	                                chiextrap0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                                xiextrap0_fixedpts_extraporder2_paramset2  = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_fixedpts_extraporder2_paramset2,chiextrap0_fixedpts_extraporder2_paramset2,xiextrap0_fixedpts_extraporder2_paramset2,xpbdy0_fixedpts_extraporder2_paramset2,ypbdy0_fixedpts_extraporder2_paramset2,zpbdy0_fixedpts_extraporder2_paramset2,&basenumbdypoints_fixedpts_extraporder2_paramset2);  
	                                basebdy_Nchi_fixedpts_extraporder2_paramset2=0;//initialize
	                                basebdy_Nxi_fixedpts_extraporder2_paramset2=0; //initialize
	                                bdyn_(&basebdy_Nchi_fixedpts_extraporder2_paramset2,&basebdy_Nxi_fixedpts_extraporder2_paramset2,&basenumbdypoints_fixedpts_extraporder2_paramset2,chiextrap0_fixedpts_extraporder2_paramset2,xiextrap0_fixedpts_extraporder2_paramset2);  
	                                rhobdy0_fixedpts_extraporder2_paramset2 = malloc(sizeof(real));
	                                chibdy0_fixedpts_extraporder2_paramset2 = malloc(basebdy_Nchi_fixedpts_extraporder2_paramset2*sizeof(real));
	                                xibdy0_fixedpts_extraporder2_paramset2  = malloc(basebdy_Nxi_fixedpts_extraporder2_paramset2*sizeof(real));   
	                            }
	                        }
	
	
	                        extrap_bdyphi_fixedpts_(bdyphi_fixedpts_extraporder2_paramset2,
	                                        leadordcoeff_phi1,
	                                        xpbdy_fixedpts_extraporder2_paramset2,ypbdy_fixedpts_extraporder2_paramset2,zpbdy_fixedpts_extraporder2_paramset2,
	                                        chrbdy_fixedpts_extraporder2_paramset2,&numbdypoints_fixedpts_extraporder2_paramset2,
	                                        &bdy_extrap_order,
	                                        &ind_distance_fixedpts,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        extrap_quasiset_fixedpts_(quasiset_tt_fixedpts_extraporder2_paramset2,quasiset_tchi_fixedpts_extraporder2_paramset2,quasiset_txi_fixedpts_extraporder2_paramset2,
	                                quasiset_chichi_fixedpts_extraporder2_paramset2,quasiset_chixi_fixedpts_extraporder2_paramset2,
	                                quasiset_xixi_fixedpts_extraporder2_paramset2,
	                                quasiset_trace_fixedpts_extraporder2_paramset2,
	                                quasiset_massdensity_fixedpts_extraporder2_paramset2,
	                                quasiset_angmomdensityx_fixedpts_extraporder2_paramset2,
	                                quasiset_angmomdensityy_fixedpts_extraporder2_paramset2,
	                                quasiset_angmomdensityz_fixedpts_extraporder2_paramset2,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_fixedpts_extraporder2_paramset2,ypbdy_fixedpts_extraporder2_paramset2,zpbdy_fixedpts_extraporder2_paramset2,
	                                chrbdy_fixedpts_extraporder2_paramset2,&numbdypoints_fixedpts_extraporder2_paramset2,
	                                &bdy_extrap_order,
	                                &ind_distance_fixedpts,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_fixedpts_extraporder2_paramset2; i<ie_bdy_fixedpts_extraporder2_paramset2; i++)
	                        {
	                            lquasiset_tt0_fixedpts_extraporder2_paramset2           [i] = quasiset_tt_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_tchi0_fixedpts_extraporder2_paramset2         [i] = quasiset_tchi_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_txi0_fixedpts_extraporder2_paramset2          [i] = quasiset_txi_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_chichi0_fixedpts_extraporder2_paramset2       [i] = quasiset_chichi_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_chixi0_fixedpts_extraporder2_paramset2        [i] = quasiset_chixi_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_xixi0_fixedpts_extraporder2_paramset2         [i] = quasiset_xixi_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_trace0_fixedpts_extraporder2_paramset2        [i] = quasiset_trace_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_massdensity0_fixedpts_extraporder2_paramset2  [i] = quasiset_massdensity_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 [i] = quasiset_angmomdensityx_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 [i] = quasiset_angmomdensityy_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 [i] = quasiset_angmomdensityz_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lbdyphi0_fixedpts_extraporder2_paramset2                [i] = bdyphi_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                        }   

	                        //PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder2_paramset2,          maxquasiset_tt0_fixedpts_extraporder2_paramset2,          basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder2_paramset2,        maxquasiset_tchi0_fixedpts_extraporder2_paramset2,        basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder2_paramset2,         maxquasiset_txi0_fixedpts_extraporder2_paramset2,         basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder2_paramset2,      maxquasiset_chichi0_fixedpts_extraporder2_paramset2,      basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder2_paramset2,       maxquasiset_chixi0_fixedpts_extraporder2_paramset2,       basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder2_paramset2,        maxquasiset_xixi0_fixedpts_extraporder2_paramset2,        basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder2_paramset2,       maxquasiset_trace0_fixedpts_extraporder2_paramset2,       basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder2_paramset2, maxquasiset_massdensity0_fixedpts_extraporder2_paramset2, basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2, maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2, basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2, maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2, basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2, maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2, basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder2_paramset2,               maxbdyphi0_fixedpts_extraporder2_paramset2,               basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder2_paramset2,          minquasiset_tt0_fixedpts_extraporder2_paramset2,          basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder2_paramset2,        minquasiset_tchi0_fixedpts_extraporder2_paramset2,        basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder2_paramset2,         minquasiset_txi0_fixedpts_extraporder2_paramset2,         basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder2_paramset2,      minquasiset_chichi0_fixedpts_extraporder2_paramset2,      basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder2_paramset2,       minquasiset_chixi0_fixedpts_extraporder2_paramset2,       basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder2_paramset2,        minquasiset_xixi0_fixedpts_extraporder2_paramset2,        basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder2_paramset2,       minquasiset_trace0_fixedpts_extraporder2_paramset2,       basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder2_paramset2, minquasiset_massdensity0_fixedpts_extraporder2_paramset2, basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2, minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2, basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2, minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2, basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2, minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2, basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder2_paramset2,               minbdyphi0_fixedpts_extraporder2_paramset2,               basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_fixedpts_extraporder2_paramset2; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_fixedpts_extraporder2_paramset2          [i] = maxquasiset_tt0_fixedpts_extraporder2_paramset2          [i] + minquasiset_tt0_fixedpts_extraporder2_paramset2          [i];
	                                    quasiset_tchi0_fixedpts_extraporder2_paramset2        [i] = maxquasiset_tchi0_fixedpts_extraporder2_paramset2        [i] + minquasiset_tchi0_fixedpts_extraporder2_paramset2        [i];
	                                    quasiset_txi0_fixedpts_extraporder2_paramset2         [i] = maxquasiset_txi0_fixedpts_extraporder2_paramset2         [i] + minquasiset_txi0_fixedpts_extraporder2_paramset2         [i];
	                                    quasiset_chichi0_fixedpts_extraporder2_paramset2      [i] = maxquasiset_chichi0_fixedpts_extraporder2_paramset2      [i] + minquasiset_chichi0_fixedpts_extraporder2_paramset2      [i];
	                                    quasiset_chixi0_fixedpts_extraporder2_paramset2       [i] = maxquasiset_chixi0_fixedpts_extraporder2_paramset2       [i] + minquasiset_chixi0_fixedpts_extraporder2_paramset2       [i];
	                                    quasiset_xixi0_fixedpts_extraporder2_paramset2        [i] = maxquasiset_xixi0_fixedpts_extraporder2_paramset2        [i] + minquasiset_xixi0_fixedpts_extraporder2_paramset2        [i];
	                                    quasiset_trace0_fixedpts_extraporder2_paramset2       [i] = maxquasiset_trace0_fixedpts_extraporder2_paramset2       [i] + minquasiset_trace0_fixedpts_extraporder2_paramset2       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder2_paramset2 [i] = maxquasiset_massdensity0_fixedpts_extraporder2_paramset2 [i] + minquasiset_massdensity0_fixedpts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 [i] + minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 [i] + minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 [i] + minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 [i];
	                                    bdyphi0_fixedpts_extraporder2_paramset2               [i] = maxbdyphi0_fixedpts_extraporder2_paramset2               [i] + minbdyphi0_fixedpts_extraporder2_paramset2               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_fixedpts_extraporder2_paramset2          [i] = maxquasiset_tt0_fixedpts_extraporder2_paramset2          [i];
	                                    quasiset_tchi0_fixedpts_extraporder2_paramset2        [i] = maxquasiset_tchi0_fixedpts_extraporder2_paramset2        [i];
	                                    quasiset_txi0_fixedpts_extraporder2_paramset2         [i] = maxquasiset_txi0_fixedpts_extraporder2_paramset2         [i];
	                                    quasiset_chichi0_fixedpts_extraporder2_paramset2      [i] = maxquasiset_chichi0_fixedpts_extraporder2_paramset2      [i];
	                                    quasiset_chixi0_fixedpts_extraporder2_paramset2       [i] = maxquasiset_chixi0_fixedpts_extraporder2_paramset2       [i];
	                                    quasiset_xixi0_fixedpts_extraporder2_paramset2        [i] = maxquasiset_xixi0_fixedpts_extraporder2_paramset2        [i];
	                                    quasiset_trace0_fixedpts_extraporder2_paramset2       [i] = maxquasiset_trace0_fixedpts_extraporder2_paramset2       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder2_paramset2 [i] = maxquasiset_massdensity0_fixedpts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 [i];
	                                    bdyphi0_fixedpts_extraporder2_paramset2               [i] = maxbdyphi0_fixedpts_extraporder2_paramset2               [i];
	                                }  
	                        }       
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {
	                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    								name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder2_paramset2[j],ypbdy0_fixedpts_extraporder2_paramset2[j],zpbdy0_fixedpts_extraporder2_paramset2[j],j);
                                    }
                                    fclose(fp);
                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder2_paramset2[j],ypbdy0_fixedpts_extraporder2_paramset2[j],zpbdy0_fixedpts_extraporder2_paramset2[j],j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }   
	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder2_paramset2[j],y_outermostpt0_fixedpts_extraporder2_paramset2[j],z_outermostpt0_fixedpts_extraporder2_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder2_paramset2[j],y_outermostpt0_fixedpts_extraporder2_paramset2[j],z_outermostpt0_fixedpts_extraporder2_paramset2[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name); 
	                                	}   
	                                }
	                                if(output_bdyphi)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
                                    	sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder2_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder2_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                } 
	                                }    

                                    // save quasiset_ll as ascii
                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   									name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
                                                    ct,
                                                    quasiset_tt0_fixedpts_extraporder2_paramset2[j],quasiset_tchi0_fixedpts_extraporder2_paramset2[j],quasiset_txi0_fixedpts_extraporder2_paramset2[j],quasiset_chichi0_fixedpts_extraporder2_paramset2[j],quasiset_chixi0_fixedpts_extraporder2_paramset2[j],quasiset_xixi0_fixedpts_extraporder2_paramset2[j],
                                                    j);
                                    }
                                    fclose(fp);
                                    free(name);  
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_fixedpts_extraporder2_paramset2[j],quasiset_tchi0_fixedpts_extraporder2_paramset2[j],quasiset_txi0_fixedpts_extraporder2_paramset2[j],quasiset_chichi0_fixedpts_extraporder2_paramset2[j],quasiset_chixi0_fixedpts_extraporder2_paramset2[j],quasiset_xixi0_fixedpts_extraporder2_paramset2[j],
	                                                    j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }
	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_fixedpts_extraporder2_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_fixedpts_extraporder2_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_fixedpts_extraporder2_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_fixedpts_extraporder2_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {
		                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
		                            	sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_angmomdensityx0_fixedpts_extraporder2_paramset2[j],quasiset_angmomdensityy0_fixedpts_extraporder2_paramset2[j],quasiset_angmomdensityz0_fixedpts_extraporder2_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);   
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_fixedpts_extraporder2_paramset2[j],quasiset_angmomdensityy0_fixedpts_extraporder2_paramset2[j],quasiset_angmomdensityz0_fixedpts_extraporder2_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_fixedpts_extraporder2_paramset2=1;
	                                chibdy_xibdy_(chibdy0_fixedpts_extraporder2_paramset2,xibdy0_fixedpts_extraporder2_paramset2,xpbdy0_fixedpts_extraporder2_paramset2,ypbdy0_fixedpts_extraporder2_paramset2,zpbdy0_fixedpts_extraporder2_paramset2,&basenumbdypoints_fixedpts_extraporder2_paramset2,chiextrap0_fixedpts_extraporder2_paramset2,xiextrap0_fixedpts_extraporder2_paramset2,&basebdy_Nchi_fixedpts_extraporder2_paramset2,&basebdy_Nxi_fixedpts_extraporder2_paramset2);    
	                                doubleintegralonsphere_(AdS_mass0_fixedpts_extraporder2_paramset2,quasiset_massdensity0_fixedpts_extraporder2_paramset2,xpbdy0_fixedpts_extraporder2_paramset2,ypbdy0_fixedpts_extraporder2_paramset2,zpbdy0_fixedpts_extraporder2_paramset2,&basenumbdypoints_fixedpts_extraporder2_paramset2,rhobdy0_fixedpts_extraporder2_paramset2,chibdy0_fixedpts_extraporder2_paramset2,xibdy0_fixedpts_extraporder2_paramset2,&basebdy_Nchi_fixedpts_extraporder2_paramset2,&basebdy_Nxi_fixedpts_extraporder2_paramset2);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_%st_AdSmass.txt",AMRD_save_tag) + 1;
   									name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_fixedpts_extraporder2_paramset2);
	                                fclose(fp);
	                                free(name); 
	                            }
	                        }     

	                        free(vecbdypoints_fixedpts_extraporder2_paramset2);
	                        free(dsplsbdypoints_fixedpts_extraporder2_paramset2);
	                        free(quasiset_tt_fixedpts_extraporder2_paramset2);
	                        free(quasiset_tchi_fixedpts_extraporder2_paramset2);
	                        free(quasiset_txi_fixedpts_extraporder2_paramset2);
	                        free(quasiset_chichi_fixedpts_extraporder2_paramset2);
	                        free(quasiset_chixi_fixedpts_extraporder2_paramset2);
	                        free(quasiset_xixi_fixedpts_extraporder2_paramset2);
	                        free(quasiset_trace_fixedpts_extraporder2_paramset2);
	                        free(quasiset_massdensity_fixedpts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityx_fixedpts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityy_fixedpts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityz_fixedpts_extraporder2_paramset2);
	                        free(bdyphi_fixedpts_extraporder2_paramset2);  
	                        free(xpbdy_fixedpts_extraporder2_paramset2);
	                        free(ypbdy_fixedpts_extraporder2_paramset2);
	                        free(zpbdy_fixedpts_extraporder2_paramset2);   
	                        free(x_outermostpt_fixedpts_extraporder2_paramset2);
	                        free(y_outermostpt_fixedpts_extraporder2_paramset2);
	                        free(z_outermostpt_fixedpts_extraporder2_paramset2);   
	
	                        free(lquasiset_tt0_fixedpts_extraporder2_paramset2);        
	                        free(lquasiset_tchi0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_txi0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_chichi0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_chixi0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_xixi0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_trace0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_massdensity0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2);
	                        free(lbdyphi0_fixedpts_extraporder2_paramset2);      
	                        free(maxquasiset_tt0_fixedpts_extraporder2_paramset2);        
	                        free(maxquasiset_tchi0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_txi0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_chichi0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_chixi0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_xixi0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_trace0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_massdensity0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2);
	                        free(maxbdyphi0_fixedpts_extraporder2_paramset2);    
	                        free(minquasiset_tt0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_tchi0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_txi0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_chichi0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_chixi0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_xixi0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_trace0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_massdensity0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2);
	                        free(minbdyphi0_fixedpts_extraporder2_paramset2);    
	                        free(quasiset_tt0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_tchi0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_txi0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_chichi0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_chixi0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_xixi0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_trace0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_massdensity0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityx0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityy0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityz0_fixedpts_extraporder2_paramset2);
	                        free(bdyphi0_fixedpts_extraporder2_paramset2);
	                        free(AdS_mass0_fixedpts_extraporder2_paramset2);     
	                        free(xpbdy0_fixedpts_extraporder2_paramset2);
	                        free(ypbdy0_fixedpts_extraporder2_paramset2);
	                        free(zpbdy0_fixedpts_extraporder2_paramset2);
	                        free(x_outermostpt0_fixedpts_extraporder2_paramset2);
	                        free(y_outermostpt0_fixedpts_extraporder2_paramset2);
	                        free(z_outermostpt0_fixedpts_extraporder2_paramset2);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_fixedpts_extraporder2_paramset2);
	                            free(chiextrap0_fixedpts_extraporder2_paramset2);
	                            free(xiextrap0_fixedpts_extraporder2_paramset2);             
	                            free(rhobdy0_fixedpts_extraporder2_paramset2);
	                            free(chibdy0_fixedpts_extraporder2_paramset2);
	                            free(xibdy0_fixedpts_extraporder2_paramset2);    
	                        }   
                		}//closes condition on output_bdy_extraporder2_paramset2

                		//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_fixedpts 2nd order extrap paramset2\n"); fflush(stdout);}

	            		//THIRD ORDER EXTRAPOLATION
						if (output_bdy_extraporder3_paramset2)
            			{
                			bdy_extrap_order=3;

                			//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
							nexttobdypoints_fixedpts_(chrbdy_fixedpts_extraporder3_paramset2,&numbdypoints_fixedpts_extraporder3_paramset2,&bdy_extrap_order,&ind_distance_fixedpts,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset2,&half_steps_from_bdy_int_paramset2,&num_fixed_coords,fixed_coords,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width); 

	                    	//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_fixedpts_extraporder3_paramset2 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_fixedpts_extraporder3_paramset2 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_fixedpts_extraporder3_paramset2,1,MPI_INT,vecbdypoints_fixedpts_extraporder3_paramset2,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_fixedpts_extraporder3_paramset2,&basenumbdypoints_fixedpts_extraporder3_paramset2,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_fixedpts_extraporder3_paramset2=%i\n",numbdypoints_fixedpts_extraporder3_paramset2);
	                        //fflush(stdout); 
	                        quasiset_tt_fixedpts_extraporder3_paramset2              = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_tchi_fixedpts_extraporder3_paramset2            = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_txi_fixedpts_extraporder3_paramset2             = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_chichi_fixedpts_extraporder3_paramset2          = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_chixi_fixedpts_extraporder3_paramset2           = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_xixi_fixedpts_extraporder3_paramset2            = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_trace_fixedpts_extraporder3_paramset2           = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_massdensity_fixedpts_extraporder3_paramset2     = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx_fixedpts_extraporder3_paramset2  = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy_fixedpts_extraporder3_paramset2  = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz_fixedpts_extraporder3_paramset2  = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        bdyphi_fixedpts_extraporder3_paramset2                   = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));   
	                        xpbdy_fixedpts_extraporder3_paramset2               = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        ypbdy_fixedpts_extraporder3_paramset2               = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        zpbdy_fixedpts_extraporder3_paramset2               = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));  
	                       	x_outermostpt_fixedpts_extraporder3_paramset2            = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                       	y_outermostpt_fixedpts_extraporder3_paramset2            = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                       	z_outermostpt_fixedpts_extraporder3_paramset2            = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real)); 
	
	                        lquasiset_tt0_fixedpts_extraporder3_paramset2            = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_tchi0_fixedpts_extraporder3_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_txi0_fixedpts_extraporder3_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_chichi0_fixedpts_extraporder3_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_chixi0_fixedpts_extraporder3_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_xixi0_fixedpts_extraporder3_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_trace0_fixedpts_extraporder3_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_massdensity0_fixedpts_extraporder3_paramset2   = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2= malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2= malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2= malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lbdyphi0_fixedpts_extraporder3_paramset2                 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));   
	                        maxquasiset_tt0_fixedpts_extraporder3_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_tchi0_fixedpts_extraporder3_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_txi0_fixedpts_extraporder3_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_chichi0_fixedpts_extraporder3_paramset2      = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_chixi0_fixedpts_extraporder3_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_xixi0_fixedpts_extraporder3_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_trace0_fixedpts_extraporder3_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_massdensity0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxbdyphi0_fixedpts_extraporder3_paramset2               = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));   
	                        minquasiset_tt0_fixedpts_extraporder3_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_tchi0_fixedpts_extraporder3_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_txi0_fixedpts_extraporder3_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_chichi0_fixedpts_extraporder3_paramset2      = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_chixi0_fixedpts_extraporder3_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_xixi0_fixedpts_extraporder3_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_trace0_fixedpts_extraporder3_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_massdensity0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minbdyphi0_fixedpts_extraporder3_paramset2               = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));   
	                        quasiset_tt0_fixedpts_extraporder3_paramset2             = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_tchi0_fixedpts_extraporder3_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_txi0_fixedpts_extraporder3_paramset2            = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_chichi0_fixedpts_extraporder3_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_chixi0_fixedpts_extraporder3_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_xixi0_fixedpts_extraporder3_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_trace0_fixedpts_extraporder3_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_massdensity0_fixedpts_extraporder3_paramset2    = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        AdS_mass0_fixedpts_extraporder3_paramset2                = malloc(sizeof(real));
	                        bdyphi0_fixedpts_extraporder3_paramset2                  = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));    
	                        xpbdy0_fixedpts_extraporder3_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        ypbdy0_fixedpts_extraporder3_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        zpbdy0_fixedpts_extraporder3_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));   
	                       	x_outermostpt0_fixedpts_extraporder3_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                       	y_outermostpt0_fixedpts_extraporder3_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                       	z_outermostpt0_fixedpts_extraporder3_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));   
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_fixedpts_extraporder3_paramset2=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_fixedpts_extraporder3_paramset2=vecbdypoints_fixedpts_extraporder3_paramset2[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_fixedpts_extraporder3_paramset2=is_bdy_fixedpts_extraporder3_paramset2+vecbdypoints_fixedpts_extraporder3_paramset2[j];
	                            }
	                            ie_bdy_fixedpts_extraporder3_paramset2=is_bdy_fixedpts_extraporder3_paramset2+vecbdypoints_fixedpts_extraporder3_paramset2[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_fixedpts_extraporder3_paramset2[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_fixedpts_extraporder3_paramset2[i]=dsplsbdypoints_fixedpts_extraporder3_paramset2[i]+vecbdypoints_fixedpts_extraporder3_paramset2[j];
	                                }
	                            }
	                        }   
	
	                        xyz_extrap_outermost_(xpbdy_fixedpts_extraporder3_paramset2,ypbdy_fixedpts_extraporder3_paramset2,zpbdy_fixedpts_extraporder3_paramset2,
	                        						x_outermostpt_fixedpts_extraporder3_paramset2,y_outermostpt_fixedpts_extraporder3_paramset2,z_outermostpt_fixedpts_extraporder3_paramset2,
	                        						chrbdy_fixedpts_extraporder3_paramset2,&numbdypoints_fixedpts_extraporder3_paramset2,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_fixedpts_extraporder3_paramset2,numbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,xpbdy0_fixedpts_extraporder3_paramset2,vecbdypoints_fixedpts_extraporder3_paramset2,dsplsbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_fixedpts_extraporder3_paramset2,numbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,ypbdy0_fixedpts_extraporder3_paramset2,vecbdypoints_fixedpts_extraporder3_paramset2,dsplsbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_fixedpts_extraporder3_paramset2,numbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,zpbdy0_fixedpts_extraporder3_paramset2,vecbdypoints_fixedpts_extraporder3_paramset2,dsplsbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_fixedpts_extraporder3_paramset2,numbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,x_outermostpt0_fixedpts_extraporder3_paramset2,vecbdypoints_fixedpts_extraporder3_paramset2,dsplsbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_fixedpts_extraporder3_paramset2,numbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,y_outermostpt0_fixedpts_extraporder3_paramset2,vecbdypoints_fixedpts_extraporder3_paramset2,dsplsbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_fixedpts_extraporder3_paramset2,numbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,z_outermostpt0_fixedpts_extraporder3_paramset2,vecbdypoints_fixedpts_extraporder3_paramset2,dsplsbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_fixedpts_extraporder3_paramset2 = malloc(sizeof(real));
	                                chiextrap0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                                xiextrap0_fixedpts_extraporder3_paramset2  = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_fixedpts_extraporder3_paramset2,chiextrap0_fixedpts_extraporder3_paramset2,xiextrap0_fixedpts_extraporder3_paramset2,xpbdy0_fixedpts_extraporder3_paramset2,ypbdy0_fixedpts_extraporder3_paramset2,zpbdy0_fixedpts_extraporder3_paramset2,&basenumbdypoints_fixedpts_extraporder3_paramset2);  
	                                basebdy_Nchi_fixedpts_extraporder3_paramset2=0;//initialize
	                                basebdy_Nxi_fixedpts_extraporder3_paramset2=0; //initialize
	                                bdyn_(&basebdy_Nchi_fixedpts_extraporder3_paramset2,&basebdy_Nxi_fixedpts_extraporder3_paramset2,&basenumbdypoints_fixedpts_extraporder3_paramset2,chiextrap0_fixedpts_extraporder3_paramset2,xiextrap0_fixedpts_extraporder3_paramset2);  
	                                rhobdy0_fixedpts_extraporder3_paramset2 = malloc(sizeof(real));
	                                chibdy0_fixedpts_extraporder3_paramset2 = malloc(basebdy_Nchi_fixedpts_extraporder3_paramset2*sizeof(real));
	                                xibdy0_fixedpts_extraporder3_paramset2  = malloc(basebdy_Nxi_fixedpts_extraporder3_paramset2*sizeof(real));   
	                            }
	                        }
	
	
	                        extrap_bdyphi_fixedpts_(bdyphi_fixedpts_extraporder3_paramset2,
	                                        leadordcoeff_phi1,
	                                        xpbdy_fixedpts_extraporder3_paramset2,ypbdy_fixedpts_extraporder3_paramset2,zpbdy_fixedpts_extraporder3_paramset2,
	                                        chrbdy_fixedpts_extraporder3_paramset2,&numbdypoints_fixedpts_extraporder3_paramset2,
	                                        &bdy_extrap_order,
	                                        &ind_distance_fixedpts,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        extrap_quasiset_fixedpts_(quasiset_tt_fixedpts_extraporder3_paramset2,quasiset_tchi_fixedpts_extraporder3_paramset2,quasiset_txi_fixedpts_extraporder3_paramset2,
	                                quasiset_chichi_fixedpts_extraporder3_paramset2,quasiset_chixi_fixedpts_extraporder3_paramset2,
	                                quasiset_xixi_fixedpts_extraporder3_paramset2,
	                                quasiset_trace_fixedpts_extraporder3_paramset2,
	                                quasiset_massdensity_fixedpts_extraporder3_paramset2,
	                                quasiset_angmomdensityx_fixedpts_extraporder3_paramset2,
	                                quasiset_angmomdensityy_fixedpts_extraporder3_paramset2,
	                                quasiset_angmomdensityz_fixedpts_extraporder3_paramset2,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_fixedpts_extraporder3_paramset2,ypbdy_fixedpts_extraporder3_paramset2,zpbdy_fixedpts_extraporder3_paramset2,
	                                chrbdy_fixedpts_extraporder3_paramset2,&numbdypoints_fixedpts_extraporder3_paramset2,
	                                &bdy_extrap_order,
	                                &ind_distance_fixedpts,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_fixedpts_extraporder3_paramset2; i<ie_bdy_fixedpts_extraporder3_paramset2; i++)
	                        {
	                            lquasiset_tt0_fixedpts_extraporder3_paramset2           [i] = quasiset_tt_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_tchi0_fixedpts_extraporder3_paramset2         [i] = quasiset_tchi_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_txi0_fixedpts_extraporder3_paramset2          [i] = quasiset_txi_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_chichi0_fixedpts_extraporder3_paramset2       [i] = quasiset_chichi_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_chixi0_fixedpts_extraporder3_paramset2        [i] = quasiset_chixi_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_xixi0_fixedpts_extraporder3_paramset2         [i] = quasiset_xixi_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_trace0_fixedpts_extraporder3_paramset2        [i] = quasiset_trace_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_massdensity0_fixedpts_extraporder3_paramset2  [i] = quasiset_massdensity_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 [i] = quasiset_angmomdensityx_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 [i] = quasiset_angmomdensityy_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 [i] = quasiset_angmomdensityz_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lbdyphi0_fixedpts_extraporder3_paramset2                [i] = bdyphi_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                        }   

	                        //PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder3_paramset2,          maxquasiset_tt0_fixedpts_extraporder3_paramset2,          basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder3_paramset2,        maxquasiset_tchi0_fixedpts_extraporder3_paramset2,        basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder3_paramset2,         maxquasiset_txi0_fixedpts_extraporder3_paramset2,         basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder3_paramset2,      maxquasiset_chichi0_fixedpts_extraporder3_paramset2,      basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder3_paramset2,       maxquasiset_chixi0_fixedpts_extraporder3_paramset2,       basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder3_paramset2,        maxquasiset_xixi0_fixedpts_extraporder3_paramset2,        basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder3_paramset2,       maxquasiset_trace0_fixedpts_extraporder3_paramset2,       basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder3_paramset2, maxquasiset_massdensity0_fixedpts_extraporder3_paramset2, basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2, maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2, basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2, maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2, basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2, maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2, basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder3_paramset2,               maxbdyphi0_fixedpts_extraporder3_paramset2,               basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder3_paramset2,          minquasiset_tt0_fixedpts_extraporder3_paramset2,          basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder3_paramset2,        minquasiset_tchi0_fixedpts_extraporder3_paramset2,        basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder3_paramset2,         minquasiset_txi0_fixedpts_extraporder3_paramset2,         basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder3_paramset2,      minquasiset_chichi0_fixedpts_extraporder3_paramset2,      basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder3_paramset2,       minquasiset_chixi0_fixedpts_extraporder3_paramset2,       basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder3_paramset2,        minquasiset_xixi0_fixedpts_extraporder3_paramset2,        basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder3_paramset2,       minquasiset_trace0_fixedpts_extraporder3_paramset2,       basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder3_paramset2, minquasiset_massdensity0_fixedpts_extraporder3_paramset2, basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2, minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2, basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2, minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2, basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2, minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2, basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder3_paramset2,               minbdyphi0_fixedpts_extraporder3_paramset2,               basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_fixedpts_extraporder3_paramset2; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_fixedpts_extraporder3_paramset2          [i] = maxquasiset_tt0_fixedpts_extraporder3_paramset2          [i] + minquasiset_tt0_fixedpts_extraporder3_paramset2          [i];
	                                    quasiset_tchi0_fixedpts_extraporder3_paramset2        [i] = maxquasiset_tchi0_fixedpts_extraporder3_paramset2        [i] + minquasiset_tchi0_fixedpts_extraporder3_paramset2        [i];
	                                    quasiset_txi0_fixedpts_extraporder3_paramset2         [i] = maxquasiset_txi0_fixedpts_extraporder3_paramset2         [i] + minquasiset_txi0_fixedpts_extraporder3_paramset2         [i];
	                                    quasiset_chichi0_fixedpts_extraporder3_paramset2      [i] = maxquasiset_chichi0_fixedpts_extraporder3_paramset2      [i] + minquasiset_chichi0_fixedpts_extraporder3_paramset2      [i];
	                                    quasiset_chixi0_fixedpts_extraporder3_paramset2       [i] = maxquasiset_chixi0_fixedpts_extraporder3_paramset2       [i] + minquasiset_chixi0_fixedpts_extraporder3_paramset2       [i];
	                                    quasiset_xixi0_fixedpts_extraporder3_paramset2        [i] = maxquasiset_xixi0_fixedpts_extraporder3_paramset2        [i] + minquasiset_xixi0_fixedpts_extraporder3_paramset2        [i];
	                                    quasiset_trace0_fixedpts_extraporder3_paramset2       [i] = maxquasiset_trace0_fixedpts_extraporder3_paramset2       [i] + minquasiset_trace0_fixedpts_extraporder3_paramset2       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder3_paramset2 [i] = maxquasiset_massdensity0_fixedpts_extraporder3_paramset2 [i] + minquasiset_massdensity0_fixedpts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 [i] + minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 [i] + minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 [i] + minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 [i];
	                                    bdyphi0_fixedpts_extraporder3_paramset2               [i] = maxbdyphi0_fixedpts_extraporder3_paramset2               [i] + minbdyphi0_fixedpts_extraporder3_paramset2               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_fixedpts_extraporder3_paramset2          [i] = maxquasiset_tt0_fixedpts_extraporder3_paramset2          [i];
	                                    quasiset_tchi0_fixedpts_extraporder3_paramset2        [i] = maxquasiset_tchi0_fixedpts_extraporder3_paramset2        [i];
	                                    quasiset_txi0_fixedpts_extraporder3_paramset2         [i] = maxquasiset_txi0_fixedpts_extraporder3_paramset2         [i];
	                                    quasiset_chichi0_fixedpts_extraporder3_paramset2      [i] = maxquasiset_chichi0_fixedpts_extraporder3_paramset2      [i];
	                                    quasiset_chixi0_fixedpts_extraporder3_paramset2       [i] = maxquasiset_chixi0_fixedpts_extraporder3_paramset2       [i];
	                                    quasiset_xixi0_fixedpts_extraporder3_paramset2        [i] = maxquasiset_xixi0_fixedpts_extraporder3_paramset2        [i];
	                                    quasiset_trace0_fixedpts_extraporder3_paramset2       [i] = maxquasiset_trace0_fixedpts_extraporder3_paramset2       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder3_paramset2 [i] = maxquasiset_massdensity0_fixedpts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 [i];
	                                    bdyphi0_fixedpts_extraporder3_paramset2               [i] = maxbdyphi0_fixedpts_extraporder3_paramset2               [i];
	                                }  
	                        } 
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {
	                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    								name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder3_paramset2[j],ypbdy0_fixedpts_extraporder3_paramset2[j],zpbdy0_fixedpts_extraporder3_paramset2[j],j);
                                    }
                                    fclose(fp);
                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder3_paramset2[j],ypbdy0_fixedpts_extraporder3_paramset2[j],zpbdy0_fixedpts_extraporder3_paramset2[j],j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }   
	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder3_paramset2[j],y_outermostpt0_fixedpts_extraporder3_paramset2[j],z_outermostpt0_fixedpts_extraporder3_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder3_paramset2[j],y_outermostpt0_fixedpts_extraporder3_paramset2[j],z_outermostpt0_fixedpts_extraporder3_paramset2[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name); 
	                                	}   
	                                }
	                                if(output_bdyphi)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
                                    	sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder3_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder3_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                } 
	                                }    

                                    // save quasiset_ll as ascii
                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   									name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
                                                    ct,
                                                    quasiset_tt0_fixedpts_extraporder3_paramset2[j],quasiset_tchi0_fixedpts_extraporder3_paramset2[j],quasiset_txi0_fixedpts_extraporder3_paramset2[j],quasiset_chichi0_fixedpts_extraporder3_paramset2[j],quasiset_chixi0_fixedpts_extraporder3_paramset2[j],quasiset_xixi0_fixedpts_extraporder3_paramset2[j],
                                                    j);
                                    }
                                    fclose(fp);
                                    free(name);  
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_fixedpts_extraporder3_paramset2[j],quasiset_tchi0_fixedpts_extraporder3_paramset2[j],quasiset_txi0_fixedpts_extraporder3_paramset2[j],quasiset_chichi0_fixedpts_extraporder3_paramset2[j],quasiset_chixi0_fixedpts_extraporder3_paramset2[j],quasiset_xixi0_fixedpts_extraporder3_paramset2[j],
	                                                    j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }
	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_fixedpts_extraporder3_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_fixedpts_extraporder3_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_fixedpts_extraporder3_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_fixedpts_extraporder3_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {
		                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
		                            	sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_angmomdensityx0_fixedpts_extraporder3_paramset2[j],quasiset_angmomdensityy0_fixedpts_extraporder3_paramset2[j],quasiset_angmomdensityz0_fixedpts_extraporder3_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);   
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_fixedpts_extraporder3_paramset2[j],quasiset_angmomdensityy0_fixedpts_extraporder3_paramset2[j],quasiset_angmomdensityz0_fixedpts_extraporder3_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_fixedpts_extraporder3_paramset2=1;
	                                chibdy_xibdy_(chibdy0_fixedpts_extraporder3_paramset2,xibdy0_fixedpts_extraporder3_paramset2,xpbdy0_fixedpts_extraporder3_paramset2,ypbdy0_fixedpts_extraporder3_paramset2,zpbdy0_fixedpts_extraporder3_paramset2,&basenumbdypoints_fixedpts_extraporder3_paramset2,chiextrap0_fixedpts_extraporder3_paramset2,xiextrap0_fixedpts_extraporder3_paramset2,&basebdy_Nchi_fixedpts_extraporder3_paramset2,&basebdy_Nxi_fixedpts_extraporder3_paramset2);    
	                                doubleintegralonsphere_(AdS_mass0_fixedpts_extraporder3_paramset2,quasiset_massdensity0_fixedpts_extraporder3_paramset2,xpbdy0_fixedpts_extraporder3_paramset2,ypbdy0_fixedpts_extraporder3_paramset2,zpbdy0_fixedpts_extraporder3_paramset2,&basenumbdypoints_fixedpts_extraporder3_paramset2,rhobdy0_fixedpts_extraporder3_paramset2,chibdy0_fixedpts_extraporder3_paramset2,xibdy0_fixedpts_extraporder3_paramset2,&basebdy_Nchi_fixedpts_extraporder3_paramset2,&basebdy_Nxi_fixedpts_extraporder3_paramset2);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_%st_AdSmass.txt",AMRD_save_tag) + 1;
   									name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_fixedpts_extraporder3_paramset2);
	                                fclose(fp);
	                                free(name); 
	                            }
	                        }     

	                        free(vecbdypoints_fixedpts_extraporder3_paramset2);
	                        free(dsplsbdypoints_fixedpts_extraporder3_paramset2);
	                        free(quasiset_tt_fixedpts_extraporder3_paramset2);
	                        free(quasiset_tchi_fixedpts_extraporder3_paramset2);
	                        free(quasiset_txi_fixedpts_extraporder3_paramset2);
	                        free(quasiset_chichi_fixedpts_extraporder3_paramset2);
	                        free(quasiset_chixi_fixedpts_extraporder3_paramset2);
	                        free(quasiset_xixi_fixedpts_extraporder3_paramset2);
	                        free(quasiset_trace_fixedpts_extraporder3_paramset2);
	                        free(quasiset_massdensity_fixedpts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityx_fixedpts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityy_fixedpts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityz_fixedpts_extraporder3_paramset2);
	                        free(bdyphi_fixedpts_extraporder3_paramset2);  
	                        free(xpbdy_fixedpts_extraporder3_paramset2);
	                        free(ypbdy_fixedpts_extraporder3_paramset2);
	                        free(zpbdy_fixedpts_extraporder3_paramset2);   
	                        free(x_outermostpt_fixedpts_extraporder3_paramset2);
	                        free(y_outermostpt_fixedpts_extraporder3_paramset2);
	                        free(z_outermostpt_fixedpts_extraporder3_paramset2);   
	
	                        free(lquasiset_tt0_fixedpts_extraporder3_paramset2);        
	                        free(lquasiset_tchi0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_txi0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_chichi0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_chixi0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_xixi0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_trace0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_massdensity0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2);
	                        free(lbdyphi0_fixedpts_extraporder3_paramset2);      
	                        free(maxquasiset_tt0_fixedpts_extraporder3_paramset2);        
	                        free(maxquasiset_tchi0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_txi0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_chichi0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_chixi0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_xixi0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_trace0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_massdensity0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2);
	                        free(maxbdyphi0_fixedpts_extraporder3_paramset2);    
	                        free(minquasiset_tt0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_tchi0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_txi0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_chichi0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_chixi0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_xixi0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_trace0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_massdensity0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2);
	                        free(minbdyphi0_fixedpts_extraporder3_paramset2);    
	                        free(quasiset_tt0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_tchi0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_txi0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_chichi0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_chixi0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_xixi0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_trace0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_massdensity0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityx0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityy0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityz0_fixedpts_extraporder3_paramset2);
	                        free(bdyphi0_fixedpts_extraporder3_paramset2);
	                        free(AdS_mass0_fixedpts_extraporder3_paramset2);     
	                        free(xpbdy0_fixedpts_extraporder3_paramset2);
	                        free(ypbdy0_fixedpts_extraporder3_paramset2);
	                        free(zpbdy0_fixedpts_extraporder3_paramset2);
	                        free(x_outermostpt0_fixedpts_extraporder3_paramset2);
	                        free(y_outermostpt0_fixedpts_extraporder3_paramset2);
	                        free(z_outermostpt0_fixedpts_extraporder3_paramset2);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_fixedpts_extraporder3_paramset2);
	                            free(chiextrap0_fixedpts_extraporder3_paramset2);
	                            free(xiextrap0_fixedpts_extraporder3_paramset2);             
	                            free(rhobdy0_fixedpts_extraporder3_paramset2);
	                            free(chibdy0_fixedpts_extraporder3_paramset2);
	                            free(xibdy0_fixedpts_extraporder3_paramset2);    
	                        }   
                		}//closes condition on output_bdy_extraporder3_paramset2

                		//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_fixedpts 3rd order extrap paramset2\n"); fflush(stdout);}


		            }//closes condition on bdy_fixedpts_extrap


	            }//closes condition on (lsteps%AMRD_save_ivec0[3]==0)&&(lsteps!=0)
	        }//closes condition on output_bdyquantities	
	           
	   	}//closes condition on (g_L==bdy_L) && (fabs(coarse_t-ct)<pow(10,-10))


        // output independent residual
        if (output_ires)
        {   
            ires_(efe_all_ires,
                efe_tt_ires,efe_tx_ires,efe_ty_ires,
                efe_tz_ires,
                efe_xx_ires,efe_xy_ires,
                efe_xz_ires,
                efe_yy_ires,
                efe_yz_ires,
                efe_zz_ires,
                kg_ires,
                gb_tt_n,gb_tt_nm1,gb_tt_np1,
                gb_tx_n,gb_tx_nm1,gb_tx_np1,
                gb_ty_n,gb_ty_nm1,gb_ty_np1,
                gb_tz_n,gb_tz_nm1,gb_tz_np1,
                gb_xx_n,gb_xx_nm1,gb_xx_np1,
                gb_xy_n,gb_xy_nm1,gb_xy_np1,
                gb_xz_n,gb_xz_nm1,gb_xz_np1,
                gb_yy_n,gb_yy_nm1,gb_yy_np1,
                gb_yz_n,gb_yz_nm1,gb_yz_np1,
                gb_zz_n,gb_zz_nm1,gb_zz_np1,
                Hb_t_n,Hb_t_nm1,Hb_t_np1,
                Hb_x_n,Hb_x_nm1,Hb_x_np1,
                Hb_y_n,Hb_y_nm1,Hb_y_np1,
                Hb_z_n,Hb_z_nm1,Hb_z_np1,
                phi1_n,phi1_nm1,phi1_np1,
                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width,
                &ief_bh_r0,&a_rot0,&kerrads_background);    
        }   
    }//closes condition ct!=0
    else //in the following ct==0
    {

        //(NOTE: for t=t0, have *not* cycled time sequence, so still np1,n,nm1,
        // so here, time level np1 is the most advanced time level) 
        
        if (g_L==Lc)
        {
        	//we save here the values of the Kretschmann scalar at the centre of the grid at times greater than 0, computed at the end of g_evo_opt 
            if (output_kretschcentregrid)
            {
                *lkretschcentregrid0= *kretschcentregrid;
            }

            if (lsteps==0)
        	{   
            	if (output_kretsch && output_kretschcentregrid)
            	{
					MPI_Allreduce((lkretschcentregrid0),(maxkretschcentregrid0),1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                MPI_Allreduce((lkretschcentregrid0),(minkretschcentregrid0),1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                if (uniSize>1)
	                {
	                    *kretschcentregrid0=*maxkretschcentregrid0+*minkretschcentregrid0;
	                }
	                else
	                {
	                    *kretschcentregrid0=*maxkretschcentregrid0;
	                }

	                if (my_rank==0)
	                {
	                    // save kretschcentregrid as ascii
	                    
	                    size_name = snprintf(NULL, 0, "%st_kretschcentregrid.txt",AMRD_save_tag) + 1;
    					name = malloc(size_name); 
	                    sprintf(name,"%st_kretschcentregrid.txt",AMRD_save_tag);
	                    fp = fopen(name, "a+");
	                    fprintf(fp,"%24.16e %24.16e \n",ct,*kretschcentregrid0);
	                    fclose(fp);
	                    free(name);
	                }
	            }
	        }//closes condition on lsteps==0
	    }//closes condition on g_L==Lc

		if ((g_L==bdy_L)&& (fabs(coarse_t-ct)<pow(10,-10)))
		{
			if (my_rank==0) {printf("\nOn level grid L=%i, at time ct=%lf, coarse time=%lf (coarse time step=%i)\n",g_L,ct,coarse_t,lsteps);}

	        if (output_bdyquantities)
	        {  

	            calc_leadordcoeff_phi1_(leadordcoeff_phi1,
	                                    phi1_np1,phi1_n,phi1_nm1,
	                                    x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	            calc_quasiset_ll_(
	                        quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                        quasiset_chichi_ll,quasiset_chixi_ll,
	                        quasiset_xixi_ll,
	                        quasiset_tracell,
	                        quasiset_massdensityll,
	                        quasiset_angmomdensityxll,
	                        quasiset_angmomdensityyll,
	                        quasiset_angmomdensityzll,
	                        gb_tt_np1,gb_tt_n,gb_tt_nm1,
	                        gb_tx_np1,gb_tx_n,gb_tx_nm1,
	                        gb_ty_np1,gb_ty_n,gb_ty_nm1,
	                        gb_tz_np1,gb_tz_n,gb_tz_nm1,
	                        gb_xx_np1,gb_xx_n,gb_xx_nm1,
	                        gb_xy_np1,gb_xy_n,gb_xy_nm1,
	                        gb_xz_np1,gb_xz_n,gb_xz_nm1,
	                        gb_yy_np1,gb_yy_n,gb_yy_nm1,
	                        gb_yz_np1,gb_yz_n,gb_yz_nm1,
	                        gb_zz_np1,gb_zz_n,gb_zz_nm1,
	                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width,
	                        &ief_bh_r0,&a_rot0,&kerrads_background);

                if (lsteps==0)
        		{ 

		            //FREE POINTS EXTRAPOLATION
		        	if (bdy_extrap_freepts)
		        	{   
	
		        		//EXTRAPOLATION WITH FIRST SET OF PARAMETERS (denoted by index 1 at the end)
	
		        		//FIRST ORDER EXTRAPOLATION
		            	if (output_bdy_extraporder1_paramset1)
	            		{
							bdy_extrap_order=1;
	
							//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
							if (rad_extrap)
		                	{
	    	            		if (my_rank==0) printf("%i-th order radial extrapolation of boundary quantities using paramset1 parameters - saved in freepts_extraporder1_paramset1*.txt files\n",bdy_extrap_order);
	        	        		nexttobdypoints_radextrap_(chrbdy_freepts_extraporder1_paramset1,&numbdypoints_freepts_extraporder1_paramset1,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset1,&half_steps_from_bdy_int_paramset1,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	            	    	}
	                		else
	                		{
	                			nexttobdypoints_freepts_(chrbdy_freepts_extraporder1_paramset1,&numbdypoints_freepts_extraporder1_paramset1,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset1,&half_steps_from_bdy_int_paramset1,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                		}
	
								//MPI_Barrier(MPI_COMM_WORLD);
								//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset1 - POST COMPUTE NUMBER OF BOUNDARY QUANTITIES   \n"); fflush(stdout);}
	
	                		//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_freepts_extraporder1_paramset1 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_freepts_extraporder1_paramset1 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_freepts_extraporder1_paramset1,1,MPI_INT,vecbdypoints_freepts_extraporder1_paramset1,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_freepts_extraporder1_paramset1,&basenumbdypoints_freepts_extraporder1_paramset1,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_freepts_extraporder1_paramset1=%i\n",numbdypoints_freepts_extraporder1_paramset1);
	                        //fflush(stdout); 
	                        quasiset_tt_freepts_extraporder1_paramset1              = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_tchi_freepts_extraporder1_paramset1            = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_txi_freepts_extraporder1_paramset1             = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_chichi_freepts_extraporder1_paramset1          = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_chixi_freepts_extraporder1_paramset1           = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_xixi_freepts_extraporder1_paramset1            = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_trace_freepts_extraporder1_paramset1           = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_massdensity_freepts_extraporder1_paramset1     = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx_freepts_extraporder1_paramset1  = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy_freepts_extraporder1_paramset1  = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz_freepts_extraporder1_paramset1  = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        bdyphi_freepts_extraporder1_paramset1                   = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));   
	                        xpbdy_freepts_extraporder1_paramset1               = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        ypbdy_freepts_extraporder1_paramset1               = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        zpbdy_freepts_extraporder1_paramset1               = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));  
	                       	x_outermostpt_freepts_extraporder1_paramset1            = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                       	y_outermostpt_freepts_extraporder1_paramset1            = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                       	z_outermostpt_freepts_extraporder1_paramset1            = malloc((numbdypoints_freepts_extraporder1_paramset1)*sizeof(real)); 
	
	                        lquasiset_tt0_freepts_extraporder1_paramset1            = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_tchi0_freepts_extraporder1_paramset1          = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_txi0_freepts_extraporder1_paramset1           = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_chichi0_freepts_extraporder1_paramset1        = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_chixi0_freepts_extraporder1_paramset1         = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_xixi0_freepts_extraporder1_paramset1          = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_trace0_freepts_extraporder1_paramset1         = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_massdensity0_freepts_extraporder1_paramset1   = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityx0_freepts_extraporder1_paramset1= malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityy0_freepts_extraporder1_paramset1= malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityz0_freepts_extraporder1_paramset1= malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        lbdyphi0_freepts_extraporder1_paramset1                 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));   
	                        maxquasiset_tt0_freepts_extraporder1_paramset1          = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_tchi0_freepts_extraporder1_paramset1        = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_txi0_freepts_extraporder1_paramset1         = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_chichi0_freepts_extraporder1_paramset1      = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_chixi0_freepts_extraporder1_paramset1       = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_xixi0_freepts_extraporder1_paramset1        = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_trace0_freepts_extraporder1_paramset1       = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_massdensity0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityx0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityy0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityz0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        maxbdyphi0_freepts_extraporder1_paramset1               = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));   
	                        minquasiset_tt0_freepts_extraporder1_paramset1          = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_tchi0_freepts_extraporder1_paramset1        = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_txi0_freepts_extraporder1_paramset1         = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_chichi0_freepts_extraporder1_paramset1      = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_chixi0_freepts_extraporder1_paramset1       = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_xixi0_freepts_extraporder1_paramset1        = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_trace0_freepts_extraporder1_paramset1       = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_massdensity0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityx0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityy0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityz0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        minbdyphi0_freepts_extraporder1_paramset1               = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));   
	                        quasiset_tt0_freepts_extraporder1_paramset1             = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_tchi0_freepts_extraporder1_paramset1           = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_txi0_freepts_extraporder1_paramset1            = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_chichi0_freepts_extraporder1_paramset1         = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_chixi0_freepts_extraporder1_paramset1          = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_xixi0_freepts_extraporder1_paramset1           = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_trace0_freepts_extraporder1_paramset1          = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_massdensity0_freepts_extraporder1_paramset1    = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        AdS_mass0_freepts_extraporder1_paramset1                = malloc(sizeof(real));
	                        bdyphi0_freepts_extraporder1_paramset1                  = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));    
	                        xpbdy0_freepts_extraporder1_paramset1              = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        ypbdy0_freepts_extraporder1_paramset1              = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                        zpbdy0_freepts_extraporder1_paramset1              = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));   
	                       	x_outermostpt0_freepts_extraporder1_paramset1           = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                       	y_outermostpt0_freepts_extraporder1_paramset1           = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                       	z_outermostpt0_freepts_extraporder1_paramset1           = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_freepts_extraporder1_paramset1=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_freepts_extraporder1_paramset1=vecbdypoints_freepts_extraporder1_paramset1[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_freepts_extraporder1_paramset1=is_bdy_freepts_extraporder1_paramset1+vecbdypoints_freepts_extraporder1_paramset1[j];
	                            }
	                            ie_bdy_freepts_extraporder1_paramset1=is_bdy_freepts_extraporder1_paramset1+vecbdypoints_freepts_extraporder1_paramset1[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_freepts_extraporder1_paramset1[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_freepts_extraporder1_paramset1[i]=dsplsbdypoints_freepts_extraporder1_paramset1[i]+vecbdypoints_freepts_extraporder1_paramset1[j];
	                                }
	                            }
	                        }   
	
	                        if (rad_extrap)
							{
								xyz_bdy_out_radextrap_(xpbdy_freepts_extraporder1_paramset1,ypbdy_freepts_extraporder1_paramset1,zpbdy_freepts_extraporder1_paramset1,
	                        						x_outermostpt_freepts_extraporder1_paramset1,y_outermostpt_freepts_extraporder1_paramset1,z_outermostpt_freepts_extraporder1_paramset1,
	                        						chrbdy_freepts_extraporder1_paramset1,&numbdypoints_freepts_extraporder1_paramset1,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
							}
	                    	else
	                    	{
	                        	xyz_extrap_outermost_(xpbdy_freepts_extraporder1_paramset1,ypbdy_freepts_extraporder1_paramset1,zpbdy_freepts_extraporder1_paramset1,
	                        						x_outermostpt_freepts_extraporder1_paramset1,y_outermostpt_freepts_extraporder1_paramset1,z_outermostpt_freepts_extraporder1_paramset1,
	                        						chrbdy_freepts_extraporder1_paramset1,&numbdypoints_freepts_extraporder1_paramset1,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	                        }
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_freepts_extraporder1_paramset1,numbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,xpbdy0_freepts_extraporder1_paramset1,vecbdypoints_freepts_extraporder1_paramset1,dsplsbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_freepts_extraporder1_paramset1,numbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,ypbdy0_freepts_extraporder1_paramset1,vecbdypoints_freepts_extraporder1_paramset1,dsplsbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_freepts_extraporder1_paramset1,numbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,zpbdy0_freepts_extraporder1_paramset1,vecbdypoints_freepts_extraporder1_paramset1,dsplsbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_freepts_extraporder1_paramset1,numbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,x_outermostpt0_freepts_extraporder1_paramset1,vecbdypoints_freepts_extraporder1_paramset1,dsplsbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_freepts_extraporder1_paramset1,numbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,y_outermostpt0_freepts_extraporder1_paramset1,vecbdypoints_freepts_extraporder1_paramset1,dsplsbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_freepts_extraporder1_paramset1,numbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,z_outermostpt0_freepts_extraporder1_paramset1,vecbdypoints_freepts_extraporder1_paramset1,dsplsbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_freepts_extraporder1_paramset1 = malloc(sizeof(real));
	                                chiextrap0_freepts_extraporder1_paramset1 = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real));
	                                xiextrap0_freepts_extraporder1_paramset1  = malloc((basenumbdypoints_freepts_extraporder1_paramset1)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_freepts_extraporder1_paramset1,chiextrap0_freepts_extraporder1_paramset1,xiextrap0_freepts_extraporder1_paramset1,xpbdy0_freepts_extraporder1_paramset1,ypbdy0_freepts_extraporder1_paramset1,zpbdy0_freepts_extraporder1_paramset1,&basenumbdypoints_freepts_extraporder1_paramset1);  
	                                basebdy_Nchi_freepts_extraporder1_paramset1=0;//initialize
	                                basebdy_Nxi_freepts_extraporder1_paramset1=0; //initialize
	                                bdyn_(&basebdy_Nchi_freepts_extraporder1_paramset1,&basebdy_Nxi_freepts_extraporder1_paramset1,&basenumbdypoints_freepts_extraporder1_paramset1,chiextrap0_freepts_extraporder1_paramset1,xiextrap0_freepts_extraporder1_paramset1);  
	                                rhobdy0_freepts_extraporder1_paramset1 = malloc(sizeof(real));
	                                chibdy0_freepts_extraporder1_paramset1 = malloc(basebdy_Nchi_freepts_extraporder1_paramset1*sizeof(real));
	                                xibdy0_freepts_extraporder1_paramset1  = malloc(basebdy_Nxi_freepts_extraporder1_paramset1*sizeof(real));   
	                            }
	                        }
	
	
							if (rad_extrap)
	                		{
	
	                			bdyphi_radextrap_(bdyphi_freepts_extraporder1_paramset1,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder1_paramset1,ypbdy_freepts_extraporder1_paramset1,zpbdy_freepts_extraporder1_paramset1,
	                                        chrbdy_freepts_extraporder1_paramset1,&numbdypoints_freepts_extraporder1_paramset1,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        	quasiset_radextrap_(quasiset_tt_freepts_extraporder1_paramset1,quasiset_tchi_freepts_extraporder1_paramset1,quasiset_txi_freepts_extraporder1_paramset1,
	                                quasiset_chichi_freepts_extraporder1_paramset1,quasiset_chixi_freepts_extraporder1_paramset1,
	                                quasiset_xixi_freepts_extraporder1_paramset1,
	                                quasiset_trace_freepts_extraporder1_paramset1,
	                                quasiset_massdensity_freepts_extraporder1_paramset1,
	                                quasiset_angmomdensityx_freepts_extraporder1_paramset1,
	                                quasiset_angmomdensityy_freepts_extraporder1_paramset1,
	                                quasiset_angmomdensityz_freepts_extraporder1_paramset1,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder1_paramset1,ypbdy_freepts_extraporder1_paramset1,zpbdy_freepts_extraporder1_paramset1,
	                                chrbdy_freepts_extraporder1_paramset1,&numbdypoints_freepts_extraporder1_paramset1,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                		}
	                		else
	                		{   
	                        	extrap_bdyphi_freepts_(bdyphi_freepts_extraporder1_paramset1,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder1_paramset1,ypbdy_freepts_extraporder1_paramset1,zpbdy_freepts_extraporder1_paramset1,
	                                        chrbdy_freepts_extraporder1_paramset1,&numbdypoints_freepts_extraporder1_paramset1,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        	extrap_quasiset_freepts_(quasiset_tt_freepts_extraporder1_paramset1,quasiset_tchi_freepts_extraporder1_paramset1,quasiset_txi_freepts_extraporder1_paramset1,
	                                quasiset_chichi_freepts_extraporder1_paramset1,quasiset_chixi_freepts_extraporder1_paramset1,
	                                quasiset_xixi_freepts_extraporder1_paramset1,
	                                quasiset_trace_freepts_extraporder1_paramset1,
	                                quasiset_massdensity_freepts_extraporder1_paramset1,
	                                quasiset_angmomdensityx_freepts_extraporder1_paramset1,
	                                quasiset_angmomdensityy_freepts_extraporder1_paramset1,
	                                quasiset_angmomdensityz_freepts_extraporder1_paramset1,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder1_paramset1,ypbdy_freepts_extraporder1_paramset1,zpbdy_freepts_extraporder1_paramset1,
	                                chrbdy_freepts_extraporder1_paramset1,&numbdypoints_freepts_extraporder1_paramset1,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                        } 
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_freepts_extraporder1_paramset1; i<ie_bdy_freepts_extraporder1_paramset1; i++)
	                        {
	                            lquasiset_tt0_freepts_extraporder1_paramset1           [i] = quasiset_tt_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_tchi0_freepts_extraporder1_paramset1         [i] = quasiset_tchi_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_txi0_freepts_extraporder1_paramset1          [i] = quasiset_txi_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_chichi0_freepts_extraporder1_paramset1       [i] = quasiset_chichi_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_chixi0_freepts_extraporder1_paramset1        [i] = quasiset_chixi_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_xixi0_freepts_extraporder1_paramset1         [i] = quasiset_xixi_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_trace0_freepts_extraporder1_paramset1        [i] = quasiset_trace_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_massdensity0_freepts_extraporder1_paramset1  [i] = quasiset_massdensity_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_angmomdensityx0_freepts_extraporder1_paramset1 [i] = quasiset_angmomdensityx_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_angmomdensityy0_freepts_extraporder1_paramset1 [i] = quasiset_angmomdensityy_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lquasiset_angmomdensityz0_freepts_extraporder1_paramset1 [i] = quasiset_angmomdensityz_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                            lbdyphi0_freepts_extraporder1_paramset1                [i] = bdyphi_freepts_extraporder1_paramset1[i-is_bdy_freepts_extraporder1_paramset1];
	                        }   

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset1 - POST PERFORM EXTRAPOLATION BOUNDARY QUANTITIES   \n"); fflush(stdout);}
	
							//PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder1_paramset1,          maxquasiset_tt0_freepts_extraporder1_paramset1,          basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder1_paramset1,        maxquasiset_tchi0_freepts_extraporder1_paramset1,        basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder1_paramset1,         maxquasiset_txi0_freepts_extraporder1_paramset1,         basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder1_paramset1,      maxquasiset_chichi0_freepts_extraporder1_paramset1,      basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder1_paramset1,       maxquasiset_chixi0_freepts_extraporder1_paramset1,       basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder1_paramset1,        maxquasiset_xixi0_freepts_extraporder1_paramset1,        basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder1_paramset1,       maxquasiset_trace0_freepts_extraporder1_paramset1,       basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder1_paramset1, maxquasiset_massdensity0_freepts_extraporder1_paramset1, basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder1_paramset1, maxquasiset_angmomdensityx0_freepts_extraporder1_paramset1, basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder1_paramset1, maxquasiset_angmomdensityy0_freepts_extraporder1_paramset1, basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder1_paramset1, maxquasiset_angmomdensityz0_freepts_extraporder1_paramset1, basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder1_paramset1,               maxbdyphi0_freepts_extraporder1_paramset1,               basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder1_paramset1,          minquasiset_tt0_freepts_extraporder1_paramset1,          basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder1_paramset1,        minquasiset_tchi0_freepts_extraporder1_paramset1,        basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder1_paramset1,         minquasiset_txi0_freepts_extraporder1_paramset1,         basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder1_paramset1,      minquasiset_chichi0_freepts_extraporder1_paramset1,      basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder1_paramset1,       minquasiset_chixi0_freepts_extraporder1_paramset1,       basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder1_paramset1,        minquasiset_xixi0_freepts_extraporder1_paramset1,        basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder1_paramset1,       minquasiset_trace0_freepts_extraporder1_paramset1,       basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder1_paramset1, minquasiset_massdensity0_freepts_extraporder1_paramset1, basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder1_paramset1, minquasiset_angmomdensityx0_freepts_extraporder1_paramset1, basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder1_paramset1, minquasiset_angmomdensityy0_freepts_extraporder1_paramset1, basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder1_paramset1, minquasiset_angmomdensityz0_freepts_extraporder1_paramset1, basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder1_paramset1,               minbdyphi0_freepts_extraporder1_paramset1,               basenumbdypoints_freepts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset1 - in PRINT BOUNDARY QUANTITIES - POST MPI_Allreduce   \n"); fflush(stdout);}

	                        for (i=0; i<basenumbdypoints_freepts_extraporder1_paramset1; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_freepts_extraporder1_paramset1          [i] = maxquasiset_tt0_freepts_extraporder1_paramset1          [i] + minquasiset_tt0_freepts_extraporder1_paramset1          [i];
	                                    quasiset_tchi0_freepts_extraporder1_paramset1        [i] = maxquasiset_tchi0_freepts_extraporder1_paramset1        [i] + minquasiset_tchi0_freepts_extraporder1_paramset1        [i];
	                                    quasiset_txi0_freepts_extraporder1_paramset1         [i] = maxquasiset_txi0_freepts_extraporder1_paramset1         [i] + minquasiset_txi0_freepts_extraporder1_paramset1         [i];
	                                    quasiset_chichi0_freepts_extraporder1_paramset1      [i] = maxquasiset_chichi0_freepts_extraporder1_paramset1      [i] + minquasiset_chichi0_freepts_extraporder1_paramset1      [i];
	                                    quasiset_chixi0_freepts_extraporder1_paramset1       [i] = maxquasiset_chixi0_freepts_extraporder1_paramset1       [i] + minquasiset_chixi0_freepts_extraporder1_paramset1       [i];
	                                    quasiset_xixi0_freepts_extraporder1_paramset1        [i] = maxquasiset_xixi0_freepts_extraporder1_paramset1        [i] + minquasiset_xixi0_freepts_extraporder1_paramset1        [i];
	                                    quasiset_trace0_freepts_extraporder1_paramset1       [i] = maxquasiset_trace0_freepts_extraporder1_paramset1       [i] + minquasiset_trace0_freepts_extraporder1_paramset1       [i];
	                                    quasiset_massdensity0_freepts_extraporder1_paramset1 [i] = maxquasiset_massdensity0_freepts_extraporder1_paramset1 [i] + minquasiset_massdensity0_freepts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityx0_freepts_extraporder1_paramset1 [i] + minquasiset_angmomdensityx0_freepts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityy0_freepts_extraporder1_paramset1 [i] + minquasiset_angmomdensityy0_freepts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityz0_freepts_extraporder1_paramset1 [i] + minquasiset_angmomdensityz0_freepts_extraporder1_paramset1 [i];
	                                    bdyphi0_freepts_extraporder1_paramset1               [i] = maxbdyphi0_freepts_extraporder1_paramset1               [i] + minbdyphi0_freepts_extraporder1_paramset1               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_freepts_extraporder1_paramset1          [i] = maxquasiset_tt0_freepts_extraporder1_paramset1          [i];
	                                    quasiset_tchi0_freepts_extraporder1_paramset1        [i] = maxquasiset_tchi0_freepts_extraporder1_paramset1        [i];
	                                    quasiset_txi0_freepts_extraporder1_paramset1         [i] = maxquasiset_txi0_freepts_extraporder1_paramset1         [i];
	                                    quasiset_chichi0_freepts_extraporder1_paramset1      [i] = maxquasiset_chichi0_freepts_extraporder1_paramset1      [i];
	                                    quasiset_chixi0_freepts_extraporder1_paramset1       [i] = maxquasiset_chixi0_freepts_extraporder1_paramset1       [i];
	                                    quasiset_xixi0_freepts_extraporder1_paramset1        [i] = maxquasiset_xixi0_freepts_extraporder1_paramset1        [i];
	                                    quasiset_trace0_freepts_extraporder1_paramset1       [i] = maxquasiset_trace0_freepts_extraporder1_paramset1       [i];
	                                    quasiset_massdensity0_freepts_extraporder1_paramset1 [i] = maxquasiset_massdensity0_freepts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityx0_freepts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityy0_freepts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityz0_freepts_extraporder1_paramset1 [i];
	                                    bdyphi0_freepts_extraporder1_paramset1               [i] = maxbdyphi0_freepts_extraporder1_paramset1               [i];
	                                }  
	                        }      

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset1 - in PRINT BOUNDARY QUANTITIES - PRE print   \n"); fflush(stdout);} 
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {     
	                            			size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder1_paramset1[j],ypbdy0_freepts_extraporder1_paramset1[j],zpbdy0_freepts_extraporder1_paramset1[j],j);
		                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder1_paramset1[j],ypbdy0_freepts_extraporder1_paramset1[j],zpbdy0_freepts_extraporder1_paramset1[j],j);
		                                    }
		                                    fclose(fp);
		                                    free(name);

		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder1_paramset1[j],ypbdy0_freepts_extraporder1_paramset1[j],zpbdy0_freepts_extraporder1_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }  

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset1 - in PRINT BOUNDARY QUANTITIES - post print xext   \n"); fflush(stdout);}  


	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder1_paramset1[j],y_outermostpt0_freepts_extraporder1_paramset1[j],z_outermostpt0_freepts_extraporder1_paramset1[j],j);
	                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder1_paramset1[j],y_outermostpt0_freepts_extraporder1_paramset1[j],z_outermostpt0_freepts_extraporder1_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder1_paramset1[j],y_outermostpt0_freepts_extraporder1_paramset1[j],z_outermostpt0_freepts_extraporder1_paramset1[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name);
	                                	}   
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset1 - in PRINT BOUNDARY QUANTITIES - post print xout   \n"); fflush(stdout);} 

	                                if(output_bdyphi)
	                                {
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder1_paramset1[j],j);
		                                    }
		                                    fclose(fp); 
		                                    free(name);
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder1_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                } 
	                                }    

	                                    // save quasiset_ll as ascii
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder1_paramset1[j],quasiset_tchi0_freepts_extraporder1_paramset1[j],quasiset_txi0_freepts_extraporder1_paramset1[j],quasiset_chichi0_freepts_extraporder1_paramset1[j],quasiset_chixi0_freepts_extraporder1_paramset1[j],quasiset_xixi0_freepts_extraporder1_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder1_paramset1[j],quasiset_tchi0_freepts_extraporder1_paramset1[j],quasiset_txi0_freepts_extraporder1_paramset1[j],quasiset_chichi0_freepts_extraporder1_paramset1[j],quasiset_chixi0_freepts_extraporder1_paramset1[j],quasiset_xixi0_freepts_extraporder1_paramset1[j],
	                                                    j_red);
	                                            //printf("%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                            //        ct,
	                                            //        quasiset_tt0_freepts_extraporder1_paramset1[j],quasiset_tchi0_freepts_extraporder1_paramset1[j],quasiset_txi0_freepts_extraporder1_paramset1[j],quasiset_chichi0_freepts_extraporder1_paramset1[j],quasiset_chixi0_freepts_extraporder1_paramset1[j],quasiset_xixi0_freepts_extraporder1_paramset1[j],
	                                            //        j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset1 - in PRINT BOUNDARY QUANTITIES - post print quasisetll  \n"); fflush(stdout);} 

	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_freepts_extraporder1_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_freepts_extraporder1_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {   
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_freepts_extraporder1_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);  
	                                    free(name); 
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_freepts_extraporder1_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {

		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
			                            	sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder1_paramset1[j],quasiset_angmomdensityy0_freepts_extraporder1_paramset1[j],quasiset_angmomdensityz0_freepts_extraporder1_paramset1[j],
		                                                    j);
		                                    }
		                                    fclose(fp);
		                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder1_paramset1[j],quasiset_angmomdensityy0_freepts_extraporder1_paramset1[j],quasiset_angmomdensityz0_freepts_extraporder1_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_freepts_extraporder1_paramset1=1;
	                                chibdy_xibdy_(chibdy0_freepts_extraporder1_paramset1,xibdy0_freepts_extraporder1_paramset1,xpbdy0_freepts_extraporder1_paramset1,ypbdy0_freepts_extraporder1_paramset1,zpbdy0_freepts_extraporder1_paramset1,&basenumbdypoints_freepts_extraporder1_paramset1,chiextrap0_freepts_extraporder1_paramset1,xiextrap0_freepts_extraporder1_paramset1,&basebdy_Nchi_freepts_extraporder1_paramset1,&basebdy_Nxi_freepts_extraporder1_paramset1);    
	                                doubleintegralonsphere_(AdS_mass0_freepts_extraporder1_paramset1,quasiset_massdensity0_freepts_extraporder1_paramset1,xpbdy0_freepts_extraporder1_paramset1,ypbdy0_freepts_extraporder1_paramset1,zpbdy0_freepts_extraporder1_paramset1,&basenumbdypoints_freepts_extraporder1_paramset1,rhobdy0_freepts_extraporder1_paramset1,chibdy0_freepts_extraporder1_paramset1,xibdy0_freepts_extraporder1_paramset1,&basebdy_Nchi_freepts_extraporder1_paramset1,&basebdy_Nxi_freepts_extraporder1_paramset1);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset1_%st_AdSmass.txt",AMRD_save_tag) + 1;
    								name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_freepts_extraporder1_paramset1_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_freepts_extraporder1_paramset1);
	                                fclose(fp);
	                                free(name);
	                            }
	                        }

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset1 - POST PRINT BOUNDARY QUANTITIES   \n"); fflush(stdout);}

	                        free(vecbdypoints_freepts_extraporder1_paramset1);
	                        free(dsplsbdypoints_freepts_extraporder1_paramset1);
	                        free(quasiset_tt_freepts_extraporder1_paramset1);
	                        free(quasiset_tchi_freepts_extraporder1_paramset1);
	                        free(quasiset_txi_freepts_extraporder1_paramset1);
	                        free(quasiset_chichi_freepts_extraporder1_paramset1);
	                        free(quasiset_chixi_freepts_extraporder1_paramset1);
	                        free(quasiset_xixi_freepts_extraporder1_paramset1);
	                        free(quasiset_trace_freepts_extraporder1_paramset1);
	                        free(quasiset_massdensity_freepts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityx_freepts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityy_freepts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityz_freepts_extraporder1_paramset1);
	                        free(bdyphi_freepts_extraporder1_paramset1);  
	                        free(xpbdy_freepts_extraporder1_paramset1);
	                        free(ypbdy_freepts_extraporder1_paramset1);
	                        free(zpbdy_freepts_extraporder1_paramset1);   
	                       	free(x_outermostpt_freepts_extraporder1_paramset1);
	                       	free(y_outermostpt_freepts_extraporder1_paramset1);
	                       	free(z_outermostpt_freepts_extraporder1_paramset1);   
	
	                        free(lquasiset_tt0_freepts_extraporder1_paramset1);        
	                        free(lquasiset_tchi0_freepts_extraporder1_paramset1);
	                        free(lquasiset_txi0_freepts_extraporder1_paramset1);
	                        free(lquasiset_chichi0_freepts_extraporder1_paramset1);
	                        free(lquasiset_chixi0_freepts_extraporder1_paramset1);
	                        free(lquasiset_xixi0_freepts_extraporder1_paramset1);
	                        free(lquasiset_trace0_freepts_extraporder1_paramset1);
	                        free(lquasiset_massdensity0_freepts_extraporder1_paramset1);
	                        free(lquasiset_angmomdensityx0_freepts_extraporder1_paramset1);
	                        free(lquasiset_angmomdensityy0_freepts_extraporder1_paramset1);
	                        free(lquasiset_angmomdensityz0_freepts_extraporder1_paramset1);
	                        free(lbdyphi0_freepts_extraporder1_paramset1);      
	                        free(maxquasiset_tt0_freepts_extraporder1_paramset1);        
	                        free(maxquasiset_tchi0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_txi0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_chichi0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_chixi0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_xixi0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_trace0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_massdensity0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_angmomdensityx0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_angmomdensityy0_freepts_extraporder1_paramset1);
	                        free(maxquasiset_angmomdensityz0_freepts_extraporder1_paramset1);
	                        free(maxbdyphi0_freepts_extraporder1_paramset1);    
	                        free(minquasiset_tt0_freepts_extraporder1_paramset1);
	                        free(minquasiset_tchi0_freepts_extraporder1_paramset1);
	                        free(minquasiset_txi0_freepts_extraporder1_paramset1);
	                        free(minquasiset_chichi0_freepts_extraporder1_paramset1);
	                        free(minquasiset_chixi0_freepts_extraporder1_paramset1);
	                        free(minquasiset_xixi0_freepts_extraporder1_paramset1);
	                        free(minquasiset_trace0_freepts_extraporder1_paramset1);
	                        free(minquasiset_massdensity0_freepts_extraporder1_paramset1);
	                        free(minquasiset_angmomdensityx0_freepts_extraporder1_paramset1);
	                        free(minquasiset_angmomdensityy0_freepts_extraporder1_paramset1);
	                        free(minquasiset_angmomdensityz0_freepts_extraporder1_paramset1);
	                        free(minbdyphi0_freepts_extraporder1_paramset1);    
	                        free(quasiset_tt0_freepts_extraporder1_paramset1);
	                        free(quasiset_tchi0_freepts_extraporder1_paramset1);
	                        free(quasiset_txi0_freepts_extraporder1_paramset1);
	                        free(quasiset_chichi0_freepts_extraporder1_paramset1);
	                        free(quasiset_chixi0_freepts_extraporder1_paramset1);
	                        free(quasiset_xixi0_freepts_extraporder1_paramset1);
	                        free(quasiset_trace0_freepts_extraporder1_paramset1);
	                        free(quasiset_massdensity0_freepts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityx0_freepts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityy0_freepts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityz0_freepts_extraporder1_paramset1);
	                        free(bdyphi0_freepts_extraporder1_paramset1);
	                        free(AdS_mass0_freepts_extraporder1_paramset1);     
	                        free(xpbdy0_freepts_extraporder1_paramset1);
	                        free(ypbdy0_freepts_extraporder1_paramset1);
	                        free(zpbdy0_freepts_extraporder1_paramset1);
	                       	free(x_outermostpt0_freepts_extraporder1_paramset1);
	                       	free(y_outermostpt0_freepts_extraporder1_paramset1);
	                       	free(z_outermostpt0_freepts_extraporder1_paramset1);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_freepts_extraporder1_paramset1);
	                            free(chiextrap0_freepts_extraporder1_paramset1);
	                            free(xiextrap0_freepts_extraporder1_paramset1);             
	                            free(rhobdy0_freepts_extraporder1_paramset1);
	                            free(chibdy0_freepts_extraporder1_paramset1);
	                            free(xibdy0_freepts_extraporder1_paramset1);    
	                        }	
	            		}//closes condition on output_bdy_extraporder1_paramset1

	            		//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_freepts 1st order extrap paramset1\n"); fflush(stdout);}

	            		//SECOND ORDER EXTRAPOLATION
		            	if (output_bdy_extraporder2_paramset1)
	            		{
							bdy_extrap_order=2;
	
							//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
                			if (rad_extrap)
	                		{
    	            			if (my_rank==0) printf("%i-th order radial extrapolation of boundary quantities using paramset1 parameters - saved in freepts_extraporder2_paramset1*.txt files\n",bdy_extrap_order);
        	        			nexttobdypoints_radextrap_(chrbdy_freepts_extraporder2_paramset1,&numbdypoints_freepts_extraporder2_paramset1,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset1,&half_steps_from_bdy_int_paramset1,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
            	    		}
                			else
                			{
                				nexttobdypoints_freepts_(chrbdy_freepts_extraporder2_paramset1,&numbdypoints_freepts_extraporder2_paramset1,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset1,&half_steps_from_bdy_int_paramset1,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
                			}
	
	
	                		//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_freepts_extraporder2_paramset1 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_freepts_extraporder2_paramset1 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_freepts_extraporder2_paramset1,1,MPI_INT,vecbdypoints_freepts_extraporder2_paramset1,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_freepts_extraporder2_paramset1,&basenumbdypoints_freepts_extraporder2_paramset1,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_freepts_extraporder2_paramset1=%i\n",numbdypoints_freepts_extraporder2_paramset1);
	                        //fflush(stdout); 
	                        quasiset_tt_freepts_extraporder2_paramset1              = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_tchi_freepts_extraporder2_paramset1            = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_txi_freepts_extraporder2_paramset1             = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_chichi_freepts_extraporder2_paramset1          = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_chixi_freepts_extraporder2_paramset1           = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_xixi_freepts_extraporder2_paramset1            = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_trace_freepts_extraporder2_paramset1           = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_massdensity_freepts_extraporder2_paramset1     = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx_freepts_extraporder2_paramset1  = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy_freepts_extraporder2_paramset1  = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz_freepts_extraporder2_paramset1  = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        bdyphi_freepts_extraporder2_paramset1                   = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));   
	                        xpbdy_freepts_extraporder2_paramset1               = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        ypbdy_freepts_extraporder2_paramset1               = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        zpbdy_freepts_extraporder2_paramset1               = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));  
	                       	x_outermostpt_freepts_extraporder2_paramset1            = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                       	y_outermostpt_freepts_extraporder2_paramset1            = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                       	z_outermostpt_freepts_extraporder2_paramset1            = malloc((numbdypoints_freepts_extraporder2_paramset1)*sizeof(real)); 
	
	                        lquasiset_tt0_freepts_extraporder2_paramset1            = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_tchi0_freepts_extraporder2_paramset1          = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_txi0_freepts_extraporder2_paramset1           = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_chichi0_freepts_extraporder2_paramset1        = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_chixi0_freepts_extraporder2_paramset1         = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_xixi0_freepts_extraporder2_paramset1          = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_trace0_freepts_extraporder2_paramset1         = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_massdensity0_freepts_extraporder2_paramset1   = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityx0_freepts_extraporder2_paramset1= malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityy0_freepts_extraporder2_paramset1= malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityz0_freepts_extraporder2_paramset1= malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        lbdyphi0_freepts_extraporder2_paramset1                 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));   
	                        maxquasiset_tt0_freepts_extraporder2_paramset1          = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_tchi0_freepts_extraporder2_paramset1        = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_txi0_freepts_extraporder2_paramset1         = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_chichi0_freepts_extraporder2_paramset1      = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_chixi0_freepts_extraporder2_paramset1       = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_xixi0_freepts_extraporder2_paramset1        = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_trace0_freepts_extraporder2_paramset1       = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_massdensity0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityx0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityy0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityz0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        maxbdyphi0_freepts_extraporder2_paramset1               = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));   
	                        minquasiset_tt0_freepts_extraporder2_paramset1          = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_tchi0_freepts_extraporder2_paramset1        = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_txi0_freepts_extraporder2_paramset1         = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_chichi0_freepts_extraporder2_paramset1      = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_chixi0_freepts_extraporder2_paramset1       = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_xixi0_freepts_extraporder2_paramset1        = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_trace0_freepts_extraporder2_paramset1       = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_massdensity0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityx0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityy0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityz0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        minbdyphi0_freepts_extraporder2_paramset1               = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));   
	                        quasiset_tt0_freepts_extraporder2_paramset1             = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_tchi0_freepts_extraporder2_paramset1           = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_txi0_freepts_extraporder2_paramset1            = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_chichi0_freepts_extraporder2_paramset1         = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_chixi0_freepts_extraporder2_paramset1          = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_xixi0_freepts_extraporder2_paramset1           = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_trace0_freepts_extraporder2_paramset1          = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_massdensity0_freepts_extraporder2_paramset1    = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        AdS_mass0_freepts_extraporder2_paramset1                = malloc(sizeof(real));
	                        bdyphi0_freepts_extraporder2_paramset1                  = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));    
	                        xpbdy0_freepts_extraporder2_paramset1              = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        ypbdy0_freepts_extraporder2_paramset1              = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                        zpbdy0_freepts_extraporder2_paramset1              = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));   
	                       	x_outermostpt0_freepts_extraporder2_paramset1           = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                       	y_outermostpt0_freepts_extraporder2_paramset1           = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                       	z_outermostpt0_freepts_extraporder2_paramset1           = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));   
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_freepts_extraporder2_paramset1=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_freepts_extraporder2_paramset1=vecbdypoints_freepts_extraporder2_paramset1[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_freepts_extraporder2_paramset1=is_bdy_freepts_extraporder2_paramset1+vecbdypoints_freepts_extraporder2_paramset1[j];
	                            }
	                            ie_bdy_freepts_extraporder2_paramset1=is_bdy_freepts_extraporder2_paramset1+vecbdypoints_freepts_extraporder2_paramset1[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_freepts_extraporder2_paramset1[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_freepts_extraporder2_paramset1[i]=dsplsbdypoints_freepts_extraporder2_paramset1[i]+vecbdypoints_freepts_extraporder2_paramset1[j];
	                                }
	                            }
	                        }   
	
	                        if (rad_extrap)
							{
								xyz_bdy_out_radextrap_(xpbdy_freepts_extraporder2_paramset1,ypbdy_freepts_extraporder2_paramset1,zpbdy_freepts_extraporder2_paramset1,
	                        						x_outermostpt_freepts_extraporder2_paramset1,y_outermostpt_freepts_extraporder2_paramset1,z_outermostpt_freepts_extraporder2_paramset1,
	                        						chrbdy_freepts_extraporder2_paramset1,&numbdypoints_freepts_extraporder2_paramset1,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
							}
	                    	else
	                    	{
	                        	xyz_extrap_outermost_(xpbdy_freepts_extraporder2_paramset1,ypbdy_freepts_extraporder2_paramset1,zpbdy_freepts_extraporder2_paramset1,
	                        						x_outermostpt_freepts_extraporder2_paramset1,y_outermostpt_freepts_extraporder2_paramset1,z_outermostpt_freepts_extraporder2_paramset1,
	                        						chrbdy_freepts_extraporder2_paramset1,&numbdypoints_freepts_extraporder2_paramset1,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	                        }
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_freepts_extraporder2_paramset1,numbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,xpbdy0_freepts_extraporder2_paramset1,vecbdypoints_freepts_extraporder2_paramset1,dsplsbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_freepts_extraporder2_paramset1,numbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,ypbdy0_freepts_extraporder2_paramset1,vecbdypoints_freepts_extraporder2_paramset1,dsplsbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_freepts_extraporder2_paramset1,numbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,zpbdy0_freepts_extraporder2_paramset1,vecbdypoints_freepts_extraporder2_paramset1,dsplsbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_freepts_extraporder2_paramset1,numbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,x_outermostpt0_freepts_extraporder2_paramset1,vecbdypoints_freepts_extraporder2_paramset1,dsplsbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_freepts_extraporder2_paramset1,numbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,y_outermostpt0_freepts_extraporder2_paramset1,vecbdypoints_freepts_extraporder2_paramset1,dsplsbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_freepts_extraporder2_paramset1,numbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,z_outermostpt0_freepts_extraporder2_paramset1,vecbdypoints_freepts_extraporder2_paramset1,dsplsbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_freepts_extraporder2_paramset1 = malloc(sizeof(real));
	                                chiextrap0_freepts_extraporder2_paramset1 = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real));
	                                xiextrap0_freepts_extraporder2_paramset1  = malloc((basenumbdypoints_freepts_extraporder2_paramset1)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_freepts_extraporder2_paramset1,chiextrap0_freepts_extraporder2_paramset1,xiextrap0_freepts_extraporder2_paramset1,xpbdy0_freepts_extraporder2_paramset1,ypbdy0_freepts_extraporder2_paramset1,zpbdy0_freepts_extraporder2_paramset1,&basenumbdypoints_freepts_extraporder2_paramset1);  
	                                basebdy_Nchi_freepts_extraporder2_paramset1=0;//initialize
	                                basebdy_Nxi_freepts_extraporder2_paramset1=0; //initialize
	                                bdyn_(&basebdy_Nchi_freepts_extraporder2_paramset1,&basebdy_Nxi_freepts_extraporder2_paramset1,&basenumbdypoints_freepts_extraporder2_paramset1,chiextrap0_freepts_extraporder2_paramset1,xiextrap0_freepts_extraporder2_paramset1);  
	                                rhobdy0_freepts_extraporder2_paramset1 = malloc(sizeof(real));
	                                chibdy0_freepts_extraporder2_paramset1 = malloc(basebdy_Nchi_freepts_extraporder2_paramset1*sizeof(real));
	                                xibdy0_freepts_extraporder2_paramset1  = malloc(basebdy_Nxi_freepts_extraporder2_paramset1*sizeof(real));   
	                            }
	                        }
	
	
							if (rad_extrap)
	                		{
	
	                			bdyphi_radextrap_(bdyphi_freepts_extraporder2_paramset1,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder2_paramset1,ypbdy_freepts_extraporder2_paramset1,zpbdy_freepts_extraporder2_paramset1,
	                                        chrbdy_freepts_extraporder2_paramset1,&numbdypoints_freepts_extraporder2_paramset1,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        	quasiset_radextrap_(quasiset_tt_freepts_extraporder2_paramset1,quasiset_tchi_freepts_extraporder2_paramset1,quasiset_txi_freepts_extraporder2_paramset1,
	                                quasiset_chichi_freepts_extraporder2_paramset1,quasiset_chixi_freepts_extraporder2_paramset1,
	                                quasiset_xixi_freepts_extraporder2_paramset1,
	                                quasiset_trace_freepts_extraporder2_paramset1,
	                                quasiset_massdensity_freepts_extraporder2_paramset1,
	                                quasiset_angmomdensityx_freepts_extraporder2_paramset1,
	                                quasiset_angmomdensityy_freepts_extraporder2_paramset1,
	                                quasiset_angmomdensityz_freepts_extraporder2_paramset1,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder2_paramset1,ypbdy_freepts_extraporder2_paramset1,zpbdy_freepts_extraporder2_paramset1,
	                                chrbdy_freepts_extraporder2_paramset1,&numbdypoints_freepts_extraporder2_paramset1,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                		}
	                		else
	                		{   
	                        	extrap_bdyphi_freepts_(bdyphi_freepts_extraporder2_paramset1,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder2_paramset1,ypbdy_freepts_extraporder2_paramset1,zpbdy_freepts_extraporder2_paramset1,
	                                        chrbdy_freepts_extraporder2_paramset1,&numbdypoints_freepts_extraporder2_paramset1,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        	extrap_quasiset_freepts_(quasiset_tt_freepts_extraporder2_paramset1,quasiset_tchi_freepts_extraporder2_paramset1,quasiset_txi_freepts_extraporder2_paramset1,
	                                quasiset_chichi_freepts_extraporder2_paramset1,quasiset_chixi_freepts_extraporder2_paramset1,
	                                quasiset_xixi_freepts_extraporder2_paramset1,
	                                quasiset_trace_freepts_extraporder2_paramset1,
	                                quasiset_massdensity_freepts_extraporder2_paramset1,
	                                quasiset_angmomdensityx_freepts_extraporder2_paramset1,
	                                quasiset_angmomdensityy_freepts_extraporder2_paramset1,
	                                quasiset_angmomdensityz_freepts_extraporder2_paramset1,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder2_paramset1,ypbdy_freepts_extraporder2_paramset1,zpbdy_freepts_extraporder2_paramset1,
	                                chrbdy_freepts_extraporder2_paramset1,&numbdypoints_freepts_extraporder2_paramset1,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                        } 
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_freepts_extraporder2_paramset1; i<ie_bdy_freepts_extraporder2_paramset1; i++)
	                        {
	                            lquasiset_tt0_freepts_extraporder2_paramset1           [i] = quasiset_tt_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_tchi0_freepts_extraporder2_paramset1         [i] = quasiset_tchi_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_txi0_freepts_extraporder2_paramset1          [i] = quasiset_txi_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_chichi0_freepts_extraporder2_paramset1       [i] = quasiset_chichi_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_chixi0_freepts_extraporder2_paramset1        [i] = quasiset_chixi_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_xixi0_freepts_extraporder2_paramset1         [i] = quasiset_xixi_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_trace0_freepts_extraporder2_paramset1        [i] = quasiset_trace_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_massdensity0_freepts_extraporder2_paramset1  [i] = quasiset_massdensity_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_angmomdensityx0_freepts_extraporder2_paramset1 [i] = quasiset_angmomdensityx_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_angmomdensityy0_freepts_extraporder2_paramset1 [i] = quasiset_angmomdensityy_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lquasiset_angmomdensityz0_freepts_extraporder2_paramset1 [i] = quasiset_angmomdensityz_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                            lbdyphi0_freepts_extraporder2_paramset1                [i] = bdyphi_freepts_extraporder2_paramset1[i-is_bdy_freepts_extraporder2_paramset1];
	                        }   
	
							//PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder2_paramset1,          maxquasiset_tt0_freepts_extraporder2_paramset1,          basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder2_paramset1,        maxquasiset_tchi0_freepts_extraporder2_paramset1,        basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder2_paramset1,         maxquasiset_txi0_freepts_extraporder2_paramset1,         basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder2_paramset1,      maxquasiset_chichi0_freepts_extraporder2_paramset1,      basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder2_paramset1,       maxquasiset_chixi0_freepts_extraporder2_paramset1,       basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder2_paramset1,        maxquasiset_xixi0_freepts_extraporder2_paramset1,        basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder2_paramset1,       maxquasiset_trace0_freepts_extraporder2_paramset1,       basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder2_paramset1, maxquasiset_massdensity0_freepts_extraporder2_paramset1, basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder2_paramset1, maxquasiset_angmomdensityx0_freepts_extraporder2_paramset1, basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder2_paramset1, maxquasiset_angmomdensityy0_freepts_extraporder2_paramset1, basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder2_paramset1, maxquasiset_angmomdensityz0_freepts_extraporder2_paramset1, basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder2_paramset1,               maxbdyphi0_freepts_extraporder2_paramset1,               basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder2_paramset1,          minquasiset_tt0_freepts_extraporder2_paramset1,          basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder2_paramset1,        minquasiset_tchi0_freepts_extraporder2_paramset1,        basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder2_paramset1,         minquasiset_txi0_freepts_extraporder2_paramset1,         basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder2_paramset1,      minquasiset_chichi0_freepts_extraporder2_paramset1,      basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder2_paramset1,       minquasiset_chixi0_freepts_extraporder2_paramset1,       basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder2_paramset1,        minquasiset_xixi0_freepts_extraporder2_paramset1,        basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder2_paramset1,       minquasiset_trace0_freepts_extraporder2_paramset1,       basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder2_paramset1, minquasiset_massdensity0_freepts_extraporder2_paramset1, basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder2_paramset1, minquasiset_angmomdensityx0_freepts_extraporder2_paramset1, basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder2_paramset1, minquasiset_angmomdensityy0_freepts_extraporder2_paramset1, basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder2_paramset1, minquasiset_angmomdensityz0_freepts_extraporder2_paramset1, basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder2_paramset1,               minbdyphi0_freepts_extraporder2_paramset1,               basenumbdypoints_freepts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_freepts_extraporder2_paramset1; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_freepts_extraporder2_paramset1          [i] = maxquasiset_tt0_freepts_extraporder2_paramset1          [i] + minquasiset_tt0_freepts_extraporder2_paramset1          [i];
	                                    quasiset_tchi0_freepts_extraporder2_paramset1        [i] = maxquasiset_tchi0_freepts_extraporder2_paramset1        [i] + minquasiset_tchi0_freepts_extraporder2_paramset1        [i];
	                                    quasiset_txi0_freepts_extraporder2_paramset1         [i] = maxquasiset_txi0_freepts_extraporder2_paramset1         [i] + minquasiset_txi0_freepts_extraporder2_paramset1         [i];
	                                    quasiset_chichi0_freepts_extraporder2_paramset1      [i] = maxquasiset_chichi0_freepts_extraporder2_paramset1      [i] + minquasiset_chichi0_freepts_extraporder2_paramset1      [i];
	                                    quasiset_chixi0_freepts_extraporder2_paramset1       [i] = maxquasiset_chixi0_freepts_extraporder2_paramset1       [i] + minquasiset_chixi0_freepts_extraporder2_paramset1       [i];
	                                    quasiset_xixi0_freepts_extraporder2_paramset1        [i] = maxquasiset_xixi0_freepts_extraporder2_paramset1        [i] + minquasiset_xixi0_freepts_extraporder2_paramset1        [i];
	                                    quasiset_trace0_freepts_extraporder2_paramset1       [i] = maxquasiset_trace0_freepts_extraporder2_paramset1       [i] + minquasiset_trace0_freepts_extraporder2_paramset1       [i];
	                                    quasiset_massdensity0_freepts_extraporder2_paramset1 [i] = maxquasiset_massdensity0_freepts_extraporder2_paramset1 [i] + minquasiset_massdensity0_freepts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityx0_freepts_extraporder2_paramset1 [i] + minquasiset_angmomdensityx0_freepts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityy0_freepts_extraporder2_paramset1 [i] + minquasiset_angmomdensityy0_freepts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityz0_freepts_extraporder2_paramset1 [i] + minquasiset_angmomdensityz0_freepts_extraporder2_paramset1 [i];
	                                    bdyphi0_freepts_extraporder2_paramset1               [i] = maxbdyphi0_freepts_extraporder2_paramset1               [i] + minbdyphi0_freepts_extraporder2_paramset1               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_freepts_extraporder2_paramset1          [i] = maxquasiset_tt0_freepts_extraporder2_paramset1          [i];
	                                    quasiset_tchi0_freepts_extraporder2_paramset1        [i] = maxquasiset_tchi0_freepts_extraporder2_paramset1        [i];
	                                    quasiset_txi0_freepts_extraporder2_paramset1         [i] = maxquasiset_txi0_freepts_extraporder2_paramset1         [i];
	                                    quasiset_chichi0_freepts_extraporder2_paramset1      [i] = maxquasiset_chichi0_freepts_extraporder2_paramset1      [i];
	                                    quasiset_chixi0_freepts_extraporder2_paramset1       [i] = maxquasiset_chixi0_freepts_extraporder2_paramset1       [i];
	                                    quasiset_xixi0_freepts_extraporder2_paramset1        [i] = maxquasiset_xixi0_freepts_extraporder2_paramset1        [i];
	                                    quasiset_trace0_freepts_extraporder2_paramset1       [i] = maxquasiset_trace0_freepts_extraporder2_paramset1       [i];
	                                    quasiset_massdensity0_freepts_extraporder2_paramset1 [i] = maxquasiset_massdensity0_freepts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityx0_freepts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityy0_freepts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityz0_freepts_extraporder2_paramset1 [i];
	                                    bdyphi0_freepts_extraporder2_paramset1               [i] = maxbdyphi0_freepts_extraporder2_paramset1               [i];
	                                }  
	                        }       
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {     
	                            			size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder2_paramset1[j],ypbdy0_freepts_extraporder2_paramset1[j],zpbdy0_freepts_extraporder2_paramset1[j],j);
		                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder2_paramset1[j],ypbdy0_freepts_extraporder2_paramset1[j],zpbdy0_freepts_extraporder2_paramset1[j],j);
		                                    }
		                                    fclose(fp);
		                                    free(name);

		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder2_paramset1[j],ypbdy0_freepts_extraporder2_paramset1[j],zpbdy0_freepts_extraporder2_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }  

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder2_paramset1 - in PRINT BOUNDARY QUANTITIES - post print xext   \n"); fflush(stdout);}  


	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder2_paramset1[j],y_outermostpt0_freepts_extraporder2_paramset1[j],z_outermostpt0_freepts_extraporder2_paramset1[j],j);
	                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder2_paramset1[j],y_outermostpt0_freepts_extraporder2_paramset1[j],z_outermostpt0_freepts_extraporder2_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder2_paramset1[j],y_outermostpt0_freepts_extraporder2_paramset1[j],z_outermostpt0_freepts_extraporder2_paramset1[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name);
	                                	}   
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder2_paramset1 - in PRINT BOUNDARY QUANTITIES - post print xout   \n"); fflush(stdout);} 

	                                if(output_bdyphi)
	                                {
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder2_paramset1[j],j);
		                                    }
		                                    fclose(fp); 
		                                    free(name);
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder2_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                } 
	                                }    

	                                    // save quasiset_ll as ascii
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder2_paramset1[j],quasiset_tchi0_freepts_extraporder2_paramset1[j],quasiset_txi0_freepts_extraporder2_paramset1[j],quasiset_chichi0_freepts_extraporder2_paramset1[j],quasiset_chixi0_freepts_extraporder2_paramset1[j],quasiset_xixi0_freepts_extraporder2_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder2_paramset1[j],quasiset_tchi0_freepts_extraporder2_paramset1[j],quasiset_txi0_freepts_extraporder2_paramset1[j],quasiset_chichi0_freepts_extraporder2_paramset1[j],quasiset_chixi0_freepts_extraporder2_paramset1[j],quasiset_xixi0_freepts_extraporder2_paramset1[j],
	                                                    j_red);
	                                            //printf("%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                            //        ct,
	                                            //        quasiset_tt0_freepts_extraporder2_paramset1[j],quasiset_tchi0_freepts_extraporder2_paramset1[j],quasiset_txi0_freepts_extraporder2_paramset1[j],quasiset_chichi0_freepts_extraporder2_paramset1[j],quasiset_chixi0_freepts_extraporder2_paramset1[j],quasiset_xixi0_freepts_extraporder2_paramset1[j],
	                                            //        j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder2_paramset1 - in PRINT BOUNDARY QUANTITIES - post print quasisetll  \n"); fflush(stdout);} 

	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_freepts_extraporder2_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_freepts_extraporder2_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {   
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_freepts_extraporder2_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);  
	                                    free(name); 
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_freepts_extraporder2_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {

		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
			                            	sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder2_paramset1[j],quasiset_angmomdensityy0_freepts_extraporder2_paramset1[j],quasiset_angmomdensityz0_freepts_extraporder2_paramset1[j],
		                                                    j);
		                                    }
		                                    fclose(fp);
		                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder2_paramset1[j],quasiset_angmomdensityy0_freepts_extraporder2_paramset1[j],quasiset_angmomdensityz0_freepts_extraporder2_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_freepts_extraporder2_paramset1=1;
	                                chibdy_xibdy_(chibdy0_freepts_extraporder2_paramset1,xibdy0_freepts_extraporder2_paramset1,xpbdy0_freepts_extraporder2_paramset1,ypbdy0_freepts_extraporder2_paramset1,zpbdy0_freepts_extraporder2_paramset1,&basenumbdypoints_freepts_extraporder2_paramset1,chiextrap0_freepts_extraporder2_paramset1,xiextrap0_freepts_extraporder2_paramset1,&basebdy_Nchi_freepts_extraporder2_paramset1,&basebdy_Nxi_freepts_extraporder2_paramset1);    
	                                doubleintegralonsphere_(AdS_mass0_freepts_extraporder2_paramset1,quasiset_massdensity0_freepts_extraporder2_paramset1,xpbdy0_freepts_extraporder2_paramset1,ypbdy0_freepts_extraporder2_paramset1,zpbdy0_freepts_extraporder2_paramset1,&basenumbdypoints_freepts_extraporder2_paramset1,rhobdy0_freepts_extraporder2_paramset1,chibdy0_freepts_extraporder2_paramset1,xibdy0_freepts_extraporder2_paramset1,&basebdy_Nchi_freepts_extraporder2_paramset1,&basebdy_Nxi_freepts_extraporder2_paramset1);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset1_%st_AdSmass.txt",AMRD_save_tag) + 1;
    								name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_freepts_extraporder2_paramset1_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_freepts_extraporder2_paramset1);
	                                fclose(fp);
	                                free(name);
	                            }
	                        }

	                        free(vecbdypoints_freepts_extraporder2_paramset1);
	                        free(dsplsbdypoints_freepts_extraporder2_paramset1);
	                        free(quasiset_tt_freepts_extraporder2_paramset1);
	                        free(quasiset_tchi_freepts_extraporder2_paramset1);
	                        free(quasiset_txi_freepts_extraporder2_paramset1);
	                        free(quasiset_chichi_freepts_extraporder2_paramset1);
	                        free(quasiset_chixi_freepts_extraporder2_paramset1);
	                        free(quasiset_xixi_freepts_extraporder2_paramset1);
	                        free(quasiset_trace_freepts_extraporder2_paramset1);
	                        free(quasiset_massdensity_freepts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityx_freepts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityy_freepts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityz_freepts_extraporder2_paramset1);
	                        free(bdyphi_freepts_extraporder2_paramset1);  
	                        free(xpbdy_freepts_extraporder2_paramset1);
	                        free(ypbdy_freepts_extraporder2_paramset1);
	                        free(zpbdy_freepts_extraporder2_paramset1);   
	                       	free(x_outermostpt_freepts_extraporder2_paramset1);
	                       	free(y_outermostpt_freepts_extraporder2_paramset1);
	                       	free(z_outermostpt_freepts_extraporder2_paramset1);   
	
	                        free(lquasiset_tt0_freepts_extraporder2_paramset1);        
	                        free(lquasiset_tchi0_freepts_extraporder2_paramset1);
	                        free(lquasiset_txi0_freepts_extraporder2_paramset1);
	                        free(lquasiset_chichi0_freepts_extraporder2_paramset1);
	                        free(lquasiset_chixi0_freepts_extraporder2_paramset1);
	                        free(lquasiset_xixi0_freepts_extraporder2_paramset1);
	                        free(lquasiset_trace0_freepts_extraporder2_paramset1);
	                        free(lquasiset_massdensity0_freepts_extraporder2_paramset1);
	                        free(lquasiset_angmomdensityx0_freepts_extraporder2_paramset1);
	                        free(lquasiset_angmomdensityy0_freepts_extraporder2_paramset1);
	                        free(lquasiset_angmomdensityz0_freepts_extraporder2_paramset1);
	                        free(lbdyphi0_freepts_extraporder2_paramset1);      
	                        free(maxquasiset_tt0_freepts_extraporder2_paramset1);        
	                        free(maxquasiset_tchi0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_txi0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_chichi0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_chixi0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_xixi0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_trace0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_massdensity0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_angmomdensityx0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_angmomdensityy0_freepts_extraporder2_paramset1);
	                        free(maxquasiset_angmomdensityz0_freepts_extraporder2_paramset1);
	                        free(maxbdyphi0_freepts_extraporder2_paramset1);    
	                        free(minquasiset_tt0_freepts_extraporder2_paramset1);
	                        free(minquasiset_tchi0_freepts_extraporder2_paramset1);
	                        free(minquasiset_txi0_freepts_extraporder2_paramset1);
	                        free(minquasiset_chichi0_freepts_extraporder2_paramset1);
	                        free(minquasiset_chixi0_freepts_extraporder2_paramset1);
	                        free(minquasiset_xixi0_freepts_extraporder2_paramset1);
	                        free(minquasiset_trace0_freepts_extraporder2_paramset1);
	                        free(minquasiset_massdensity0_freepts_extraporder2_paramset1);
	                        free(minquasiset_angmomdensityx0_freepts_extraporder2_paramset1);
	                        free(minquasiset_angmomdensityy0_freepts_extraporder2_paramset1);
	                        free(minquasiset_angmomdensityz0_freepts_extraporder2_paramset1);
	                        free(minbdyphi0_freepts_extraporder2_paramset1);    
	                        free(quasiset_tt0_freepts_extraporder2_paramset1);
	                        free(quasiset_tchi0_freepts_extraporder2_paramset1);
	                        free(quasiset_txi0_freepts_extraporder2_paramset1);
	                        free(quasiset_chichi0_freepts_extraporder2_paramset1);
	                        free(quasiset_chixi0_freepts_extraporder2_paramset1);
	                        free(quasiset_xixi0_freepts_extraporder2_paramset1);
	                        free(quasiset_trace0_freepts_extraporder2_paramset1);
	                        free(quasiset_massdensity0_freepts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityx0_freepts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityy0_freepts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityz0_freepts_extraporder2_paramset1);
	                        free(bdyphi0_freepts_extraporder2_paramset1);
	                        free(AdS_mass0_freepts_extraporder2_paramset1);     
	                        free(xpbdy0_freepts_extraporder2_paramset1);
	                        free(ypbdy0_freepts_extraporder2_paramset1);
	                        free(zpbdy0_freepts_extraporder2_paramset1);
	                       	free(x_outermostpt0_freepts_extraporder2_paramset1);
	                       	free(y_outermostpt0_freepts_extraporder2_paramset1);
	                       	free(z_outermostpt0_freepts_extraporder2_paramset1);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_freepts_extraporder2_paramset1);
	                            free(chiextrap0_freepts_extraporder2_paramset1);
	                            free(xiextrap0_freepts_extraporder2_paramset1);             
	                            free(rhobdy0_freepts_extraporder2_paramset1);
	                            free(chibdy0_freepts_extraporder2_paramset1);
	                            free(xibdy0_freepts_extraporder2_paramset1);    
	                        }   	
	            		}//closes condition on output_bdy_extraporder2_paramset1

	            		//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_freepts 2nd order extrap paramset1\n"); fflush(stdout);}

	            		//THIRD ORDER EXTRAPOLATION
		            	if (output_bdy_extraporder3_paramset1)
		            	{
		                	bdy_extrap_order=3; 
	
		                	//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
		                    nexttobdypoints_freepts_(chrbdy_freepts_extraporder3_paramset1,&numbdypoints_freepts_extraporder3_paramset1,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset1,&half_steps_from_bdy_int_paramset1,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	
	
		                	//PERFORM EXTRAPOLATION
	                        vecbdypoints_freepts_extraporder3_paramset1 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_freepts_extraporder3_paramset1 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_freepts_extraporder3_paramset1,1,MPI_INT,vecbdypoints_freepts_extraporder3_paramset1,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_freepts_extraporder3_paramset1,&basenumbdypoints_freepts_extraporder3_paramset1,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_freepts_extraporder3_paramset1=%i\n",numbdypoints_freepts_extraporder3_paramset1);
	                        //fflush(stdout); 
	                        quasiset_tt_freepts_extraporder3_paramset1              = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_tchi_freepts_extraporder3_paramset1            = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_txi_freepts_extraporder3_paramset1             = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_chichi_freepts_extraporder3_paramset1          = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_chixi_freepts_extraporder3_paramset1           = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_xixi_freepts_extraporder3_paramset1            = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_trace_freepts_extraporder3_paramset1           = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_massdensity_freepts_extraporder3_paramset1     = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx_freepts_extraporder3_paramset1  = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy_freepts_extraporder3_paramset1  = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz_freepts_extraporder3_paramset1  = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        bdyphi_freepts_extraporder3_paramset1                   = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));   
	                        xpbdy_freepts_extraporder3_paramset1               = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        ypbdy_freepts_extraporder3_paramset1               = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        zpbdy_freepts_extraporder3_paramset1               = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));  
	                        x_outermostpt_freepts_extraporder3_paramset1            = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        y_outermostpt_freepts_extraporder3_paramset1            = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        z_outermostpt_freepts_extraporder3_paramset1            = malloc((numbdypoints_freepts_extraporder3_paramset1)*sizeof(real)); 
	
	                        lquasiset_tt0_freepts_extraporder3_paramset1            = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_tchi0_freepts_extraporder3_paramset1          = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_txi0_freepts_extraporder3_paramset1           = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_chichi0_freepts_extraporder3_paramset1        = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_chixi0_freepts_extraporder3_paramset1         = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_xixi0_freepts_extraporder3_paramset1          = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_trace0_freepts_extraporder3_paramset1         = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_massdensity0_freepts_extraporder3_paramset1   = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityx0_freepts_extraporder3_paramset1= malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityy0_freepts_extraporder3_paramset1= malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityz0_freepts_extraporder3_paramset1= malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        lbdyphi0_freepts_extraporder3_paramset1                 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));   
	                        maxquasiset_tt0_freepts_extraporder3_paramset1          = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_tchi0_freepts_extraporder3_paramset1        = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_txi0_freepts_extraporder3_paramset1         = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_chichi0_freepts_extraporder3_paramset1      = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_chixi0_freepts_extraporder3_paramset1       = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_xixi0_freepts_extraporder3_paramset1        = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_trace0_freepts_extraporder3_paramset1       = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_massdensity0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityx0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityy0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityz0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        maxbdyphi0_freepts_extraporder3_paramset1               = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));   
	                        minquasiset_tt0_freepts_extraporder3_paramset1          = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_tchi0_freepts_extraporder3_paramset1        = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_txi0_freepts_extraporder3_paramset1         = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_chichi0_freepts_extraporder3_paramset1      = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_chixi0_freepts_extraporder3_paramset1       = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_xixi0_freepts_extraporder3_paramset1        = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_trace0_freepts_extraporder3_paramset1       = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_massdensity0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityx0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityy0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityz0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        minbdyphi0_freepts_extraporder3_paramset1               = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));   
	                        quasiset_tt0_freepts_extraporder3_paramset1             = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_tchi0_freepts_extraporder3_paramset1           = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_txi0_freepts_extraporder3_paramset1            = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_chichi0_freepts_extraporder3_paramset1         = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_chixi0_freepts_extraporder3_paramset1          = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_xixi0_freepts_extraporder3_paramset1           = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_trace0_freepts_extraporder3_paramset1          = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_massdensity0_freepts_extraporder3_paramset1    = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        AdS_mass0_freepts_extraporder3_paramset1                = malloc(sizeof(real));
	                        bdyphi0_freepts_extraporder3_paramset1                  = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));    
	                        xpbdy0_freepts_extraporder3_paramset1              = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        ypbdy0_freepts_extraporder3_paramset1              = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        zpbdy0_freepts_extraporder3_paramset1              = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));   
	                        x_outermostpt0_freepts_extraporder3_paramset1           = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        y_outermostpt0_freepts_extraporder3_paramset1           = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                        z_outermostpt0_freepts_extraporder3_paramset1           = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));   

	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_freepts_extraporder3_paramset1=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_freepts_extraporder3_paramset1=vecbdypoints_freepts_extraporder3_paramset1[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_freepts_extraporder3_paramset1=is_bdy_freepts_extraporder3_paramset1+vecbdypoints_freepts_extraporder3_paramset1[j];
	                            }
	                            ie_bdy_freepts_extraporder3_paramset1=is_bdy_freepts_extraporder3_paramset1+vecbdypoints_freepts_extraporder3_paramset1[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_freepts_extraporder3_paramset1[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_freepts_extraporder3_paramset1[i]=dsplsbdypoints_freepts_extraporder3_paramset1[i]+vecbdypoints_freepts_extraporder3_paramset1[j];
	                                }
	                            }
	                        }   
	
	                        xyz_extrap_outermost_(xpbdy_freepts_extraporder3_paramset1,ypbdy_freepts_extraporder3_paramset1,zpbdy_freepts_extraporder3_paramset1,
	                                                                        x_outermostpt_freepts_extraporder3_paramset1,y_outermostpt_freepts_extraporder3_paramset1,z_outermostpt_freepts_extraporder3_paramset1,
	                                                                        chrbdy_freepts_extraporder3_paramset1,&numbdypoints_freepts_extraporder3_paramset1,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_freepts_extraporder3_paramset1,numbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,xpbdy0_freepts_extraporder3_paramset1,vecbdypoints_freepts_extraporder3_paramset1,dsplsbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_freepts_extraporder3_paramset1,numbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,ypbdy0_freepts_extraporder3_paramset1,vecbdypoints_freepts_extraporder3_paramset1,dsplsbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_freepts_extraporder3_paramset1,numbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,zpbdy0_freepts_extraporder3_paramset1,vecbdypoints_freepts_extraporder3_paramset1,dsplsbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                                MPI_Allgatherv(x_outermostpt_freepts_extraporder3_paramset1,numbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,x_outermostpt0_freepts_extraporder3_paramset1,vecbdypoints_freepts_extraporder3_paramset1,dsplsbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                                MPI_Allgatherv(y_outermostpt_freepts_extraporder3_paramset1,numbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,y_outermostpt0_freepts_extraporder3_paramset1,vecbdypoints_freepts_extraporder3_paramset1,dsplsbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                                MPI_Allgatherv(z_outermostpt_freepts_extraporder3_paramset1,numbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,z_outermostpt0_freepts_extraporder3_paramset1,vecbdypoints_freepts_extraporder3_paramset1,dsplsbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_freepts_extraporder3_paramset1 = malloc(sizeof(real));
	                                chiextrap0_freepts_extraporder3_paramset1 = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real));
	                                xiextrap0_freepts_extraporder3_paramset1  = malloc((basenumbdypoints_freepts_extraporder3_paramset1)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_freepts_extraporder3_paramset1,chiextrap0_freepts_extraporder3_paramset1,xiextrap0_freepts_extraporder3_paramset1,xpbdy0_freepts_extraporder3_paramset1,ypbdy0_freepts_extraporder3_paramset1,zpbdy0_freepts_extraporder3_paramset1,&basenumbdypoints_freepts_extraporder3_paramset1);  
	                                basebdy_Nchi_freepts_extraporder3_paramset1=0;//initialize
	                                basebdy_Nxi_freepts_extraporder3_paramset1=0; //initialize
	                                bdyn_(&basebdy_Nchi_freepts_extraporder3_paramset1,&basebdy_Nxi_freepts_extraporder3_paramset1,&basenumbdypoints_freepts_extraporder3_paramset1,chiextrap0_freepts_extraporder3_paramset1,xiextrap0_freepts_extraporder3_paramset1);  
	                                rhobdy0_freepts_extraporder3_paramset1 = malloc(sizeof(real));
	                                chibdy0_freepts_extraporder3_paramset1 = malloc(basebdy_Nchi_freepts_extraporder3_paramset1*sizeof(real));
	                                xibdy0_freepts_extraporder3_paramset1  = malloc(basebdy_Nxi_freepts_extraporder3_paramset1*sizeof(real));   
	                            }
	                        }
	
	
	                        extrap_bdyphi_freepts_(bdyphi_freepts_extraporder3_paramset1,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder3_paramset1,ypbdy_freepts_extraporder3_paramset1,zpbdy_freepts_extraporder3_paramset1,
	                                        chrbdy_freepts_extraporder3_paramset1,&numbdypoints_freepts_extraporder3_paramset1,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        extrap_quasiset_freepts_(quasiset_tt_freepts_extraporder3_paramset1,quasiset_tchi_freepts_extraporder3_paramset1,quasiset_txi_freepts_extraporder3_paramset1,
	                                quasiset_chichi_freepts_extraporder3_paramset1,quasiset_chixi_freepts_extraporder3_paramset1,
	                                quasiset_xixi_freepts_extraporder3_paramset1,
	                                quasiset_trace_freepts_extraporder3_paramset1,
	                                quasiset_massdensity_freepts_extraporder3_paramset1,
	                                quasiset_angmomdensityx_freepts_extraporder3_paramset1,
	                                quasiset_angmomdensityy_freepts_extraporder3_paramset1,
	                                quasiset_angmomdensityz_freepts_extraporder3_paramset1,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder3_paramset1,ypbdy_freepts_extraporder3_paramset1,zpbdy_freepts_extraporder3_paramset1,
	                                chrbdy_freepts_extraporder3_paramset1,&numbdypoints_freepts_extraporder3_paramset1,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_freepts_extraporder3_paramset1; i<ie_bdy_freepts_extraporder3_paramset1; i++)
	                        {
	                            lquasiset_tt0_freepts_extraporder3_paramset1           [i] = quasiset_tt_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_tchi0_freepts_extraporder3_paramset1         [i] = quasiset_tchi_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_txi0_freepts_extraporder3_paramset1          [i] = quasiset_txi_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_chichi0_freepts_extraporder3_paramset1       [i] = quasiset_chichi_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_chixi0_freepts_extraporder3_paramset1        [i] = quasiset_chixi_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_xixi0_freepts_extraporder3_paramset1         [i] = quasiset_xixi_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_trace0_freepts_extraporder3_paramset1        [i] = quasiset_trace_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_massdensity0_freepts_extraporder3_paramset1  [i] = quasiset_massdensity_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_angmomdensityx0_freepts_extraporder3_paramset1 [i] = quasiset_angmomdensityx_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_angmomdensityy0_freepts_extraporder3_paramset1 [i] = quasiset_angmomdensityy_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lquasiset_angmomdensityz0_freepts_extraporder3_paramset1 [i] = quasiset_angmomdensityz_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                            lbdyphi0_freepts_extraporder3_paramset1                [i] = bdyphi_freepts_extraporder3_paramset1[i-is_bdy_freepts_extraporder3_paramset1];
	                        }   
	
	                        //PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder3_paramset1,          maxquasiset_tt0_freepts_extraporder3_paramset1,          basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder3_paramset1,        maxquasiset_tchi0_freepts_extraporder3_paramset1,        basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder3_paramset1,         maxquasiset_txi0_freepts_extraporder3_paramset1,         basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder3_paramset1,      maxquasiset_chichi0_freepts_extraporder3_paramset1,      basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder3_paramset1,       maxquasiset_chixi0_freepts_extraporder3_paramset1,       basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder3_paramset1,        maxquasiset_xixi0_freepts_extraporder3_paramset1,        basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder3_paramset1,       maxquasiset_trace0_freepts_extraporder3_paramset1,       basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder3_paramset1, maxquasiset_massdensity0_freepts_extraporder3_paramset1, basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder3_paramset1, maxquasiset_angmomdensityx0_freepts_extraporder3_paramset1, basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder3_paramset1, maxquasiset_angmomdensityy0_freepts_extraporder3_paramset1, basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder3_paramset1, maxquasiset_angmomdensityz0_freepts_extraporder3_paramset1, basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder3_paramset1,               maxbdyphi0_freepts_extraporder3_paramset1,               basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder3_paramset1,          minquasiset_tt0_freepts_extraporder3_paramset1,          basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder3_paramset1,        minquasiset_tchi0_freepts_extraporder3_paramset1,        basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder3_paramset1,         minquasiset_txi0_freepts_extraporder3_paramset1,         basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder3_paramset1,      minquasiset_chichi0_freepts_extraporder3_paramset1,      basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder3_paramset1,       minquasiset_chixi0_freepts_extraporder3_paramset1,       basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder3_paramset1,        minquasiset_xixi0_freepts_extraporder3_paramset1,        basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder3_paramset1,       minquasiset_trace0_freepts_extraporder3_paramset1,       basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder3_paramset1, minquasiset_massdensity0_freepts_extraporder3_paramset1, basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder3_paramset1, minquasiset_angmomdensityx0_freepts_extraporder3_paramset1, basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder3_paramset1, minquasiset_angmomdensityy0_freepts_extraporder3_paramset1, basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder3_paramset1, minquasiset_angmomdensityz0_freepts_extraporder3_paramset1, basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder3_paramset1,               minbdyphi0_freepts_extraporder3_paramset1,               basenumbdypoints_freepts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_freepts_extraporder3_paramset1; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_freepts_extraporder3_paramset1          [i] = maxquasiset_tt0_freepts_extraporder3_paramset1          [i] + minquasiset_tt0_freepts_extraporder3_paramset1          [i];
	                                    quasiset_tchi0_freepts_extraporder3_paramset1        [i] = maxquasiset_tchi0_freepts_extraporder3_paramset1        [i] + minquasiset_tchi0_freepts_extraporder3_paramset1        [i];
	                                    quasiset_txi0_freepts_extraporder3_paramset1         [i] = maxquasiset_txi0_freepts_extraporder3_paramset1         [i] + minquasiset_txi0_freepts_extraporder3_paramset1         [i];
	                                    quasiset_chichi0_freepts_extraporder3_paramset1      [i] = maxquasiset_chichi0_freepts_extraporder3_paramset1      [i] + minquasiset_chichi0_freepts_extraporder3_paramset1      [i];
	                                    quasiset_chixi0_freepts_extraporder3_paramset1       [i] = maxquasiset_chixi0_freepts_extraporder3_paramset1       [i] + minquasiset_chixi0_freepts_extraporder3_paramset1       [i];
	                                    quasiset_xixi0_freepts_extraporder3_paramset1        [i] = maxquasiset_xixi0_freepts_extraporder3_paramset1        [i] + minquasiset_xixi0_freepts_extraporder3_paramset1        [i];
	                                    quasiset_trace0_freepts_extraporder3_paramset1       [i] = maxquasiset_trace0_freepts_extraporder3_paramset1       [i] + minquasiset_trace0_freepts_extraporder3_paramset1       [i];
	                                    quasiset_massdensity0_freepts_extraporder3_paramset1 [i] = maxquasiset_massdensity0_freepts_extraporder3_paramset1 [i] + minquasiset_massdensity0_freepts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityx0_freepts_extraporder3_paramset1 [i] + minquasiset_angmomdensityx0_freepts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityy0_freepts_extraporder3_paramset1 [i] + minquasiset_angmomdensityy0_freepts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityz0_freepts_extraporder3_paramset1 [i] + minquasiset_angmomdensityz0_freepts_extraporder3_paramset1 [i];
	                                    bdyphi0_freepts_extraporder3_paramset1               [i] = maxbdyphi0_freepts_extraporder3_paramset1               [i] + minbdyphi0_freepts_extraporder3_paramset1               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_freepts_extraporder3_paramset1          [i] = maxquasiset_tt0_freepts_extraporder3_paramset1          [i];
	                                    quasiset_tchi0_freepts_extraporder3_paramset1        [i] = maxquasiset_tchi0_freepts_extraporder3_paramset1        [i];
	                                    quasiset_txi0_freepts_extraporder3_paramset1         [i] = maxquasiset_txi0_freepts_extraporder3_paramset1         [i];
	                                    quasiset_chichi0_freepts_extraporder3_paramset1      [i] = maxquasiset_chichi0_freepts_extraporder3_paramset1      [i];
	                                    quasiset_chixi0_freepts_extraporder3_paramset1       [i] = maxquasiset_chixi0_freepts_extraporder3_paramset1       [i];
	                                    quasiset_xixi0_freepts_extraporder3_paramset1        [i] = maxquasiset_xixi0_freepts_extraporder3_paramset1        [i];
	                                    quasiset_trace0_freepts_extraporder3_paramset1       [i] = maxquasiset_trace0_freepts_extraporder3_paramset1       [i];
	                                    quasiset_massdensity0_freepts_extraporder3_paramset1 [i] = maxquasiset_massdensity0_freepts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityx0_freepts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityy0_freepts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityz0_freepts_extraporder3_paramset1 [i];
	                                    bdyphi0_freepts_extraporder3_paramset1               [i] = maxbdyphi0_freepts_extraporder3_paramset1               [i];
	                                }  
	                        }       
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {     
	                            			size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder3_paramset1[j],ypbdy0_freepts_extraporder3_paramset1[j],zpbdy0_freepts_extraporder3_paramset1[j],j);
		                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder3_paramset1[j],ypbdy0_freepts_extraporder3_paramset1[j],zpbdy0_freepts_extraporder3_paramset1[j],j);
		                                    }
		                                    fclose(fp);
		                                    free(name);

		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder3_paramset1[j],ypbdy0_freepts_extraporder3_paramset1[j],zpbdy0_freepts_extraporder3_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }  

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder3_paramset1 - in PRINT BOUNDARY QUANTITIES - post print xext   \n"); fflush(stdout);}  


	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder3_paramset1[j],y_outermostpt0_freepts_extraporder3_paramset1[j],z_outermostpt0_freepts_extraporder3_paramset1[j],j);
	                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder3_paramset1[j],y_outermostpt0_freepts_extraporder3_paramset1[j],z_outermostpt0_freepts_extraporder3_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder3_paramset1[j],y_outermostpt0_freepts_extraporder3_paramset1[j],z_outermostpt0_freepts_extraporder3_paramset1[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name);
	                                	}   
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder3_paramset1 - in PRINT BOUNDARY QUANTITIES - post print xout   \n"); fflush(stdout);} 

	                                if(output_bdyphi)
	                                {
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder3_paramset1[j],j);
		                                    }
		                                    fclose(fp); 
		                                    free(name);
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder3_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                } 
	                                }    

	                                    // save quasiset_ll as ascii
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder3_paramset1[j],quasiset_tchi0_freepts_extraporder3_paramset1[j],quasiset_txi0_freepts_extraporder3_paramset1[j],quasiset_chichi0_freepts_extraporder3_paramset1[j],quasiset_chixi0_freepts_extraporder3_paramset1[j],quasiset_xixi0_freepts_extraporder3_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder3_paramset1[j],quasiset_tchi0_freepts_extraporder3_paramset1[j],quasiset_txi0_freepts_extraporder3_paramset1[j],quasiset_chichi0_freepts_extraporder3_paramset1[j],quasiset_chixi0_freepts_extraporder3_paramset1[j],quasiset_xixi0_freepts_extraporder3_paramset1[j],
	                                                    j_red);
	                                            //printf("%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                            //        ct,
	                                            //        quasiset_tt0_freepts_extraporder3_paramset1[j],quasiset_tchi0_freepts_extraporder3_paramset1[j],quasiset_txi0_freepts_extraporder3_paramset1[j],quasiset_chichi0_freepts_extraporder3_paramset1[j],quasiset_chixi0_freepts_extraporder3_paramset1[j],quasiset_xixi0_freepts_extraporder3_paramset1[j],
	                                            //        j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder3_paramset1 - in PRINT BOUNDARY QUANTITIES - post print quasisetll  \n"); fflush(stdout);} 

	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_freepts_extraporder3_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_freepts_extraporder3_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {   
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_freepts_extraporder3_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);  
	                                    free(name); 
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_freepts_extraporder3_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {

		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
			                            	sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder3_paramset1[j],quasiset_angmomdensityy0_freepts_extraporder3_paramset1[j],quasiset_angmomdensityz0_freepts_extraporder3_paramset1[j],
		                                                    j);
		                                    }
		                                    fclose(fp);
		                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder3_paramset1[j],quasiset_angmomdensityy0_freepts_extraporder3_paramset1[j],quasiset_angmomdensityz0_freepts_extraporder3_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_freepts_extraporder3_paramset1=1;
	                                chibdy_xibdy_(chibdy0_freepts_extraporder3_paramset1,xibdy0_freepts_extraporder3_paramset1,xpbdy0_freepts_extraporder3_paramset1,ypbdy0_freepts_extraporder3_paramset1,zpbdy0_freepts_extraporder3_paramset1,&basenumbdypoints_freepts_extraporder3_paramset1,chiextrap0_freepts_extraporder3_paramset1,xiextrap0_freepts_extraporder3_paramset1,&basebdy_Nchi_freepts_extraporder3_paramset1,&basebdy_Nxi_freepts_extraporder3_paramset1);    
	                                doubleintegralonsphere_(AdS_mass0_freepts_extraporder3_paramset1,quasiset_massdensity0_freepts_extraporder3_paramset1,xpbdy0_freepts_extraporder3_paramset1,ypbdy0_freepts_extraporder3_paramset1,zpbdy0_freepts_extraporder3_paramset1,&basenumbdypoints_freepts_extraporder3_paramset1,rhobdy0_freepts_extraporder3_paramset1,chibdy0_freepts_extraporder3_paramset1,xibdy0_freepts_extraporder3_paramset1,&basebdy_Nchi_freepts_extraporder3_paramset1,&basebdy_Nxi_freepts_extraporder3_paramset1);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset1_%st_AdSmass.txt",AMRD_save_tag) + 1;
    								name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_freepts_extraporder3_paramset1_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_freepts_extraporder3_paramset1);
	                                fclose(fp);
	                                free(name);
	                            }
	                        }

	                        free(vecbdypoints_freepts_extraporder3_paramset1);
	                        free(dsplsbdypoints_freepts_extraporder3_paramset1);
	                        free(quasiset_tt_freepts_extraporder3_paramset1);
	                        free(quasiset_tchi_freepts_extraporder3_paramset1);
	                        free(quasiset_txi_freepts_extraporder3_paramset1);
	                        free(quasiset_chichi_freepts_extraporder3_paramset1);
	                        free(quasiset_chixi_freepts_extraporder3_paramset1);
	                        free(quasiset_xixi_freepts_extraporder3_paramset1);
	                        free(quasiset_trace_freepts_extraporder3_paramset1);
	                        free(quasiset_massdensity_freepts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityx_freepts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityy_freepts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityz_freepts_extraporder3_paramset1);
	                        free(bdyphi_freepts_extraporder3_paramset1);  
	                        free(xpbdy_freepts_extraporder3_paramset1);
	                        free(ypbdy_freepts_extraporder3_paramset1);
	                        free(zpbdy_freepts_extraporder3_paramset1);   
	                       	free(x_outermostpt_freepts_extraporder3_paramset1);
	                       	free(y_outermostpt_freepts_extraporder3_paramset1);
	                       	free(z_outermostpt_freepts_extraporder3_paramset1);   
	
	                        free(lquasiset_tt0_freepts_extraporder3_paramset1);        
	                        free(lquasiset_tchi0_freepts_extraporder3_paramset1);
	                        free(lquasiset_txi0_freepts_extraporder3_paramset1);
	                        free(lquasiset_chichi0_freepts_extraporder3_paramset1);
	                        free(lquasiset_chixi0_freepts_extraporder3_paramset1);
	                        free(lquasiset_xixi0_freepts_extraporder3_paramset1);
	                        free(lquasiset_trace0_freepts_extraporder3_paramset1);
	                        free(lquasiset_massdensity0_freepts_extraporder3_paramset1);
	                        free(lquasiset_angmomdensityx0_freepts_extraporder3_paramset1);
	                        free(lquasiset_angmomdensityy0_freepts_extraporder3_paramset1);
	                        free(lquasiset_angmomdensityz0_freepts_extraporder3_paramset1);
	                        free(lbdyphi0_freepts_extraporder3_paramset1);      
	                        free(maxquasiset_tt0_freepts_extraporder3_paramset1);        
	                        free(maxquasiset_tchi0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_txi0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_chichi0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_chixi0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_xixi0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_trace0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_massdensity0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_angmomdensityx0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_angmomdensityy0_freepts_extraporder3_paramset1);
	                        free(maxquasiset_angmomdensityz0_freepts_extraporder3_paramset1);
	                        free(maxbdyphi0_freepts_extraporder3_paramset1);    
	                        free(minquasiset_tt0_freepts_extraporder3_paramset1);
	                        free(minquasiset_tchi0_freepts_extraporder3_paramset1);
	                        free(minquasiset_txi0_freepts_extraporder3_paramset1);
	                        free(minquasiset_chichi0_freepts_extraporder3_paramset1);
	                        free(minquasiset_chixi0_freepts_extraporder3_paramset1);
	                        free(minquasiset_xixi0_freepts_extraporder3_paramset1);
	                        free(minquasiset_trace0_freepts_extraporder3_paramset1);
	                        free(minquasiset_massdensity0_freepts_extraporder3_paramset1);
	                        free(minquasiset_angmomdensityx0_freepts_extraporder3_paramset1);
	                        free(minquasiset_angmomdensityy0_freepts_extraporder3_paramset1);
	                        free(minquasiset_angmomdensityz0_freepts_extraporder3_paramset1);
	                        free(minbdyphi0_freepts_extraporder3_paramset1);    
	                        free(quasiset_tt0_freepts_extraporder3_paramset1);
	                        free(quasiset_tchi0_freepts_extraporder3_paramset1);
	                        free(quasiset_txi0_freepts_extraporder3_paramset1);
	                        free(quasiset_chichi0_freepts_extraporder3_paramset1);
	                        free(quasiset_chixi0_freepts_extraporder3_paramset1);
	                        free(quasiset_xixi0_freepts_extraporder3_paramset1);
	                        free(quasiset_trace0_freepts_extraporder3_paramset1);
	                        free(quasiset_massdensity0_freepts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityx0_freepts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityy0_freepts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityz0_freepts_extraporder3_paramset1);
	                        free(bdyphi0_freepts_extraporder3_paramset1);
	                        free(AdS_mass0_freepts_extraporder3_paramset1);     
	                        free(xpbdy0_freepts_extraporder3_paramset1);
	                        free(ypbdy0_freepts_extraporder3_paramset1);
	                        free(zpbdy0_freepts_extraporder3_paramset1);
	                       	free(x_outermostpt0_freepts_extraporder3_paramset1);
	                       	free(y_outermostpt0_freepts_extraporder3_paramset1);
	                       	free(z_outermostpt0_freepts_extraporder3_paramset1);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_freepts_extraporder3_paramset1);
	                            free(chiextrap0_freepts_extraporder3_paramset1);
	                            free(xiextrap0_freepts_extraporder3_paramset1);             
	                            free(rhobdy0_freepts_extraporder3_paramset1);
	                            free(chibdy0_freepts_extraporder3_paramset1);
	                            free(xibdy0_freepts_extraporder3_paramset1);    
	                        }   	
		                }//closes condition on output_bdy_extraporder3_paramset1

		                //MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_freepts 3rd order extrap paramset1\n"); fflush(stdout);}

	            		//EXTRAPOLATION WITH SECOND SET OF PARAMETERS (denoted by index 2 at the end)

		        		//FIRST ORDER EXTRAPOLATION
		            	if (output_bdy_extraporder1_paramset2)
	            		{
							bdy_extrap_order=1;
	
							//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
							if (rad_extrap)
		                	{
	    	            		if (my_rank==0) printf("%i-th order radial extrapolation of boundary quantities using paramset2 parameters - saved in freepts_extraporder1_paramset2*.txt files\n",bdy_extrap_order);
	        	        		nexttobdypoints_radextrap_(chrbdy_freepts_extraporder1_paramset2,&numbdypoints_freepts_extraporder1_paramset2,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset2,&half_steps_from_bdy_int_paramset2,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	            	    	}
	                		else
	                		{
	                			nexttobdypoints_freepts_(chrbdy_freepts_extraporder1_paramset2,&numbdypoints_freepts_extraporder1_paramset2,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset2,&half_steps_from_bdy_int_paramset2,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                		}
	
								//MPI_Barrier(MPI_COMM_WORLD);
								//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset2 - POST COMPUTE NUMBER OF BOUNDARY QUANTITIES   \n"); fflush(stdout);}
	
	                		//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_freepts_extraporder1_paramset2 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_freepts_extraporder1_paramset2 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_freepts_extraporder1_paramset2,1,MPI_INT,vecbdypoints_freepts_extraporder1_paramset2,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_freepts_extraporder1_paramset2,&basenumbdypoints_freepts_extraporder1_paramset2,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_freepts_extraporder1_paramset2=%i\n",numbdypoints_freepts_extraporder1_paramset2);
	                        //fflush(stdout); 
	                        quasiset_tt_freepts_extraporder1_paramset2              = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_tchi_freepts_extraporder1_paramset2            = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_txi_freepts_extraporder1_paramset2             = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_chichi_freepts_extraporder1_paramset2          = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_chixi_freepts_extraporder1_paramset2           = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_xixi_freepts_extraporder1_paramset2            = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_trace_freepts_extraporder1_paramset2           = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_massdensity_freepts_extraporder1_paramset2     = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx_freepts_extraporder1_paramset2  = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy_freepts_extraporder1_paramset2  = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz_freepts_extraporder1_paramset2  = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        bdyphi_freepts_extraporder1_paramset2                   = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));   
	                        xpbdy_freepts_extraporder1_paramset2               = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        ypbdy_freepts_extraporder1_paramset2               = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        zpbdy_freepts_extraporder1_paramset2               = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));  
	                       	x_outermostpt_freepts_extraporder1_paramset2            = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                       	y_outermostpt_freepts_extraporder1_paramset2            = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                       	z_outermostpt_freepts_extraporder1_paramset2            = malloc((numbdypoints_freepts_extraporder1_paramset2)*sizeof(real)); 
	
	                        lquasiset_tt0_freepts_extraporder1_paramset2            = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_tchi0_freepts_extraporder1_paramset2          = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_txi0_freepts_extraporder1_paramset2           = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_chichi0_freepts_extraporder1_paramset2        = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_chixi0_freepts_extraporder1_paramset2         = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_xixi0_freepts_extraporder1_paramset2          = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_trace0_freepts_extraporder1_paramset2         = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_massdensity0_freepts_extraporder1_paramset2   = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityx0_freepts_extraporder1_paramset2= malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityy0_freepts_extraporder1_paramset2= malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityz0_freepts_extraporder1_paramset2= malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        lbdyphi0_freepts_extraporder1_paramset2                 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));   
	                        maxquasiset_tt0_freepts_extraporder1_paramset2          = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_tchi0_freepts_extraporder1_paramset2        = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_txi0_freepts_extraporder1_paramset2         = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_chichi0_freepts_extraporder1_paramset2      = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_chixi0_freepts_extraporder1_paramset2       = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_xixi0_freepts_extraporder1_paramset2        = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_trace0_freepts_extraporder1_paramset2       = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_massdensity0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityx0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityy0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityz0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        maxbdyphi0_freepts_extraporder1_paramset2               = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));   
	                        minquasiset_tt0_freepts_extraporder1_paramset2          = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_tchi0_freepts_extraporder1_paramset2        = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_txi0_freepts_extraporder1_paramset2         = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_chichi0_freepts_extraporder1_paramset2      = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_chixi0_freepts_extraporder1_paramset2       = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_xixi0_freepts_extraporder1_paramset2        = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_trace0_freepts_extraporder1_paramset2       = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_massdensity0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityx0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityy0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityz0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        minbdyphi0_freepts_extraporder1_paramset2               = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));   
	                        quasiset_tt0_freepts_extraporder1_paramset2             = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_tchi0_freepts_extraporder1_paramset2           = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_txi0_freepts_extraporder1_paramset2            = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_chichi0_freepts_extraporder1_paramset2         = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_chixi0_freepts_extraporder1_paramset2          = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_xixi0_freepts_extraporder1_paramset2           = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_trace0_freepts_extraporder1_paramset2          = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_massdensity0_freepts_extraporder1_paramset2    = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        AdS_mass0_freepts_extraporder1_paramset2                = malloc(sizeof(real));
	                        bdyphi0_freepts_extraporder1_paramset2                  = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));    
	                        xpbdy0_freepts_extraporder1_paramset2              = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        ypbdy0_freepts_extraporder1_paramset2              = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                        zpbdy0_freepts_extraporder1_paramset2              = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));   
	                       	x_outermostpt0_freepts_extraporder1_paramset2           = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                       	y_outermostpt0_freepts_extraporder1_paramset2           = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                       	z_outermostpt0_freepts_extraporder1_paramset2           = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_freepts_extraporder1_paramset2=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_freepts_extraporder1_paramset2=vecbdypoints_freepts_extraporder1_paramset2[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_freepts_extraporder1_paramset2=is_bdy_freepts_extraporder1_paramset2+vecbdypoints_freepts_extraporder1_paramset2[j];
	                            }
	                            ie_bdy_freepts_extraporder1_paramset2=is_bdy_freepts_extraporder1_paramset2+vecbdypoints_freepts_extraporder1_paramset2[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_freepts_extraporder1_paramset2[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_freepts_extraporder1_paramset2[i]=dsplsbdypoints_freepts_extraporder1_paramset2[i]+vecbdypoints_freepts_extraporder1_paramset2[j];
	                                }
	                            }
	                        }   
	
	                        if (rad_extrap)
							{
								xyz_bdy_out_radextrap_(xpbdy_freepts_extraporder1_paramset2,ypbdy_freepts_extraporder1_paramset2,zpbdy_freepts_extraporder1_paramset2,
	                        						x_outermostpt_freepts_extraporder1_paramset2,y_outermostpt_freepts_extraporder1_paramset2,z_outermostpt_freepts_extraporder1_paramset2,
	                        						chrbdy_freepts_extraporder1_paramset2,&numbdypoints_freepts_extraporder1_paramset2,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
							}
	                    	else
	                    	{
	                        	xyz_extrap_outermost_(xpbdy_freepts_extraporder1_paramset2,ypbdy_freepts_extraporder1_paramset2,zpbdy_freepts_extraporder1_paramset2,
	                        						x_outermostpt_freepts_extraporder1_paramset2,y_outermostpt_freepts_extraporder1_paramset2,z_outermostpt_freepts_extraporder1_paramset2,
	                        						chrbdy_freepts_extraporder1_paramset2,&numbdypoints_freepts_extraporder1_paramset2,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	                        }
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_freepts_extraporder1_paramset2,numbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,xpbdy0_freepts_extraporder1_paramset2,vecbdypoints_freepts_extraporder1_paramset2,dsplsbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_freepts_extraporder1_paramset2,numbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,ypbdy0_freepts_extraporder1_paramset2,vecbdypoints_freepts_extraporder1_paramset2,dsplsbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_freepts_extraporder1_paramset2,numbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,zpbdy0_freepts_extraporder1_paramset2,vecbdypoints_freepts_extraporder1_paramset2,dsplsbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_freepts_extraporder1_paramset2,numbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,x_outermostpt0_freepts_extraporder1_paramset2,vecbdypoints_freepts_extraporder1_paramset2,dsplsbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_freepts_extraporder1_paramset2,numbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,y_outermostpt0_freepts_extraporder1_paramset2,vecbdypoints_freepts_extraporder1_paramset2,dsplsbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_freepts_extraporder1_paramset2,numbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,z_outermostpt0_freepts_extraporder1_paramset2,vecbdypoints_freepts_extraporder1_paramset2,dsplsbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_freepts_extraporder1_paramset2 = malloc(sizeof(real));
	                                chiextrap0_freepts_extraporder1_paramset2 = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real));
	                                xiextrap0_freepts_extraporder1_paramset2  = malloc((basenumbdypoints_freepts_extraporder1_paramset2)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_freepts_extraporder1_paramset2,chiextrap0_freepts_extraporder1_paramset2,xiextrap0_freepts_extraporder1_paramset2,xpbdy0_freepts_extraporder1_paramset2,ypbdy0_freepts_extraporder1_paramset2,zpbdy0_freepts_extraporder1_paramset2,&basenumbdypoints_freepts_extraporder1_paramset2);  
	                                basebdy_Nchi_freepts_extraporder1_paramset2=0;//initialize
	                                basebdy_Nxi_freepts_extraporder1_paramset2=0; //initialize
	                                bdyn_(&basebdy_Nchi_freepts_extraporder1_paramset2,&basebdy_Nxi_freepts_extraporder1_paramset2,&basenumbdypoints_freepts_extraporder1_paramset2,chiextrap0_freepts_extraporder1_paramset2,xiextrap0_freepts_extraporder1_paramset2);  
	                                rhobdy0_freepts_extraporder1_paramset2 = malloc(sizeof(real));
	                                chibdy0_freepts_extraporder1_paramset2 = malloc(basebdy_Nchi_freepts_extraporder1_paramset2*sizeof(real));
	                                xibdy0_freepts_extraporder1_paramset2  = malloc(basebdy_Nxi_freepts_extraporder1_paramset2*sizeof(real));   
	                            }
	                        }
	
	
							if (rad_extrap)
	                		{
	
	                			bdyphi_radextrap_(bdyphi_freepts_extraporder1_paramset2,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder1_paramset2,ypbdy_freepts_extraporder1_paramset2,zpbdy_freepts_extraporder1_paramset2,
	                                        chrbdy_freepts_extraporder1_paramset2,&numbdypoints_freepts_extraporder1_paramset2,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        	quasiset_radextrap_(quasiset_tt_freepts_extraporder1_paramset2,quasiset_tchi_freepts_extraporder1_paramset2,quasiset_txi_freepts_extraporder1_paramset2,
	                                quasiset_chichi_freepts_extraporder1_paramset2,quasiset_chixi_freepts_extraporder1_paramset2,
	                                quasiset_xixi_freepts_extraporder1_paramset2,
	                                quasiset_trace_freepts_extraporder1_paramset2,
	                                quasiset_massdensity_freepts_extraporder1_paramset2,
	                                quasiset_angmomdensityx_freepts_extraporder1_paramset2,
	                                quasiset_angmomdensityy_freepts_extraporder1_paramset2,
	                                quasiset_angmomdensityz_freepts_extraporder1_paramset2,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder1_paramset2,ypbdy_freepts_extraporder1_paramset2,zpbdy_freepts_extraporder1_paramset2,
	                                chrbdy_freepts_extraporder1_paramset2,&numbdypoints_freepts_extraporder1_paramset2,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                		}
	                		else
	                		{   
	                        	extrap_bdyphi_freepts_(bdyphi_freepts_extraporder1_paramset2,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder1_paramset2,ypbdy_freepts_extraporder1_paramset2,zpbdy_freepts_extraporder1_paramset2,
	                                        chrbdy_freepts_extraporder1_paramset2,&numbdypoints_freepts_extraporder1_paramset2,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        	extrap_quasiset_freepts_(quasiset_tt_freepts_extraporder1_paramset2,quasiset_tchi_freepts_extraporder1_paramset2,quasiset_txi_freepts_extraporder1_paramset2,
	                                quasiset_chichi_freepts_extraporder1_paramset2,quasiset_chixi_freepts_extraporder1_paramset2,
	                                quasiset_xixi_freepts_extraporder1_paramset2,
	                                quasiset_trace_freepts_extraporder1_paramset2,
	                                quasiset_massdensity_freepts_extraporder1_paramset2,
	                                quasiset_angmomdensityx_freepts_extraporder1_paramset2,
	                                quasiset_angmomdensityy_freepts_extraporder1_paramset2,
	                                quasiset_angmomdensityz_freepts_extraporder1_paramset2,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder1_paramset2,ypbdy_freepts_extraporder1_paramset2,zpbdy_freepts_extraporder1_paramset2,
	                                chrbdy_freepts_extraporder1_paramset2,&numbdypoints_freepts_extraporder1_paramset2,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                        } 
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_freepts_extraporder1_paramset2; i<ie_bdy_freepts_extraporder1_paramset2; i++)
	                        {
	                            lquasiset_tt0_freepts_extraporder1_paramset2           [i] = quasiset_tt_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_tchi0_freepts_extraporder1_paramset2         [i] = quasiset_tchi_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_txi0_freepts_extraporder1_paramset2          [i] = quasiset_txi_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_chichi0_freepts_extraporder1_paramset2       [i] = quasiset_chichi_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_chixi0_freepts_extraporder1_paramset2        [i] = quasiset_chixi_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_xixi0_freepts_extraporder1_paramset2         [i] = quasiset_xixi_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_trace0_freepts_extraporder1_paramset2        [i] = quasiset_trace_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_massdensity0_freepts_extraporder1_paramset2  [i] = quasiset_massdensity_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_angmomdensityx0_freepts_extraporder1_paramset2 [i] = quasiset_angmomdensityx_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_angmomdensityy0_freepts_extraporder1_paramset2 [i] = quasiset_angmomdensityy_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lquasiset_angmomdensityz0_freepts_extraporder1_paramset2 [i] = quasiset_angmomdensityz_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                            lbdyphi0_freepts_extraporder1_paramset2                [i] = bdyphi_freepts_extraporder1_paramset2[i-is_bdy_freepts_extraporder1_paramset2];
	                        }   

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset2 - POST PERFORM EXTRAPOLATION BOUNDARY QUANTITIES   \n"); fflush(stdout);}
	
							//PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder1_paramset2,          maxquasiset_tt0_freepts_extraporder1_paramset2,          basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder1_paramset2,        maxquasiset_tchi0_freepts_extraporder1_paramset2,        basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder1_paramset2,         maxquasiset_txi0_freepts_extraporder1_paramset2,         basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder1_paramset2,      maxquasiset_chichi0_freepts_extraporder1_paramset2,      basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder1_paramset2,       maxquasiset_chixi0_freepts_extraporder1_paramset2,       basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder1_paramset2,        maxquasiset_xixi0_freepts_extraporder1_paramset2,        basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder1_paramset2,       maxquasiset_trace0_freepts_extraporder1_paramset2,       basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder1_paramset2, maxquasiset_massdensity0_freepts_extraporder1_paramset2, basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder1_paramset2, maxquasiset_angmomdensityx0_freepts_extraporder1_paramset2, basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder1_paramset2, maxquasiset_angmomdensityy0_freepts_extraporder1_paramset2, basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder1_paramset2, maxquasiset_angmomdensityz0_freepts_extraporder1_paramset2, basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder1_paramset2,               maxbdyphi0_freepts_extraporder1_paramset2,               basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder1_paramset2,          minquasiset_tt0_freepts_extraporder1_paramset2,          basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder1_paramset2,        minquasiset_tchi0_freepts_extraporder1_paramset2,        basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder1_paramset2,         minquasiset_txi0_freepts_extraporder1_paramset2,         basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder1_paramset2,      minquasiset_chichi0_freepts_extraporder1_paramset2,      basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder1_paramset2,       minquasiset_chixi0_freepts_extraporder1_paramset2,       basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder1_paramset2,        minquasiset_xixi0_freepts_extraporder1_paramset2,        basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder1_paramset2,       minquasiset_trace0_freepts_extraporder1_paramset2,       basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder1_paramset2, minquasiset_massdensity0_freepts_extraporder1_paramset2, basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder1_paramset2, minquasiset_angmomdensityx0_freepts_extraporder1_paramset2, basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder1_paramset2, minquasiset_angmomdensityy0_freepts_extraporder1_paramset2, basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder1_paramset2, minquasiset_angmomdensityz0_freepts_extraporder1_paramset2, basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder1_paramset2,               minbdyphi0_freepts_extraporder1_paramset2,               basenumbdypoints_freepts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset2 - in PRINT BOUNDARY QUANTITIES - POST MPI_Allreduce   \n"); fflush(stdout);}

	                        for (i=0; i<basenumbdypoints_freepts_extraporder1_paramset2; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_freepts_extraporder1_paramset2          [i] = maxquasiset_tt0_freepts_extraporder1_paramset2          [i] + minquasiset_tt0_freepts_extraporder1_paramset2          [i];
	                                    quasiset_tchi0_freepts_extraporder1_paramset2        [i] = maxquasiset_tchi0_freepts_extraporder1_paramset2        [i] + minquasiset_tchi0_freepts_extraporder1_paramset2        [i];
	                                    quasiset_txi0_freepts_extraporder1_paramset2         [i] = maxquasiset_txi0_freepts_extraporder1_paramset2         [i] + minquasiset_txi0_freepts_extraporder1_paramset2         [i];
	                                    quasiset_chichi0_freepts_extraporder1_paramset2      [i] = maxquasiset_chichi0_freepts_extraporder1_paramset2      [i] + minquasiset_chichi0_freepts_extraporder1_paramset2      [i];
	                                    quasiset_chixi0_freepts_extraporder1_paramset2       [i] = maxquasiset_chixi0_freepts_extraporder1_paramset2       [i] + minquasiset_chixi0_freepts_extraporder1_paramset2       [i];
	                                    quasiset_xixi0_freepts_extraporder1_paramset2        [i] = maxquasiset_xixi0_freepts_extraporder1_paramset2        [i] + minquasiset_xixi0_freepts_extraporder1_paramset2        [i];
	                                    quasiset_trace0_freepts_extraporder1_paramset2       [i] = maxquasiset_trace0_freepts_extraporder1_paramset2       [i] + minquasiset_trace0_freepts_extraporder1_paramset2       [i];
	                                    quasiset_massdensity0_freepts_extraporder1_paramset2 [i] = maxquasiset_massdensity0_freepts_extraporder1_paramset2 [i] + minquasiset_massdensity0_freepts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityx0_freepts_extraporder1_paramset2 [i] + minquasiset_angmomdensityx0_freepts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityy0_freepts_extraporder1_paramset2 [i] + minquasiset_angmomdensityy0_freepts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityz0_freepts_extraporder1_paramset2 [i] + minquasiset_angmomdensityz0_freepts_extraporder1_paramset2 [i];
	                                    bdyphi0_freepts_extraporder1_paramset2               [i] = maxbdyphi0_freepts_extraporder1_paramset2               [i] + minbdyphi0_freepts_extraporder1_paramset2               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_freepts_extraporder1_paramset2          [i] = maxquasiset_tt0_freepts_extraporder1_paramset2          [i];
	                                    quasiset_tchi0_freepts_extraporder1_paramset2        [i] = maxquasiset_tchi0_freepts_extraporder1_paramset2        [i];
	                                    quasiset_txi0_freepts_extraporder1_paramset2         [i] = maxquasiset_txi0_freepts_extraporder1_paramset2         [i];
	                                    quasiset_chichi0_freepts_extraporder1_paramset2      [i] = maxquasiset_chichi0_freepts_extraporder1_paramset2      [i];
	                                    quasiset_chixi0_freepts_extraporder1_paramset2       [i] = maxquasiset_chixi0_freepts_extraporder1_paramset2       [i];
	                                    quasiset_xixi0_freepts_extraporder1_paramset2        [i] = maxquasiset_xixi0_freepts_extraporder1_paramset2        [i];
	                                    quasiset_trace0_freepts_extraporder1_paramset2       [i] = maxquasiset_trace0_freepts_extraporder1_paramset2       [i];
	                                    quasiset_massdensity0_freepts_extraporder1_paramset2 [i] = maxquasiset_massdensity0_freepts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityx0_freepts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityy0_freepts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityz0_freepts_extraporder1_paramset2 [i];
	                                    bdyphi0_freepts_extraporder1_paramset2               [i] = maxbdyphi0_freepts_extraporder1_paramset2               [i];
	                                }  
	                        }      

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset2 - in PRINT BOUNDARY QUANTITIES - PRE print   \n"); fflush(stdout);} 
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {     
	                            			size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder1_paramset2[j],ypbdy0_freepts_extraporder1_paramset2[j],zpbdy0_freepts_extraporder1_paramset2[j],j);
		                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder1_paramset2[j],ypbdy0_freepts_extraporder1_paramset2[j],zpbdy0_freepts_extraporder1_paramset2[j],j);
		                                    }
		                                    fclose(fp);
		                                    free(name);

		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder1_paramset2[j],ypbdy0_freepts_extraporder1_paramset2[j],zpbdy0_freepts_extraporder1_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }  

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset2 - in PRINT BOUNDARY QUANTITIES - post print xext   \n"); fflush(stdout);}  


	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder1_paramset2[j],y_outermostpt0_freepts_extraporder1_paramset2[j],z_outermostpt0_freepts_extraporder1_paramset2[j],j);
	                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder1_paramset2[j],y_outermostpt0_freepts_extraporder1_paramset2[j],z_outermostpt0_freepts_extraporder1_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder1_paramset2[j],y_outermostpt0_freepts_extraporder1_paramset2[j],z_outermostpt0_freepts_extraporder1_paramset2[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name);
	                                	}   
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset2 - in PRINT BOUNDARY QUANTITIES - post print xout   \n"); fflush(stdout);} 

	                                if(output_bdyphi)
	                                {
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder1_paramset2[j],j);
		                                    }
		                                    fclose(fp); 
		                                    free(name);
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder1_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                } 
	                                }    

	                                    // save quasiset_ll as ascii
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder1_paramset2[j],quasiset_tchi0_freepts_extraporder1_paramset2[j],quasiset_txi0_freepts_extraporder1_paramset2[j],quasiset_chichi0_freepts_extraporder1_paramset2[j],quasiset_chixi0_freepts_extraporder1_paramset2[j],quasiset_xixi0_freepts_extraporder1_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder1_paramset2[j],quasiset_tchi0_freepts_extraporder1_paramset2[j],quasiset_txi0_freepts_extraporder1_paramset2[j],quasiset_chichi0_freepts_extraporder1_paramset2[j],quasiset_chixi0_freepts_extraporder1_paramset2[j],quasiset_xixi0_freepts_extraporder1_paramset2[j],
	                                                    j_red);
	                                            //printf("%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                            //        ct,
	                                            //        quasiset_tt0_freepts_extraporder1_paramset2[j],quasiset_tchi0_freepts_extraporder1_paramset2[j],quasiset_txi0_freepts_extraporder1_paramset2[j],quasiset_chichi0_freepts_extraporder1_paramset2[j],quasiset_chixi0_freepts_extraporder1_paramset2[j],quasiset_xixi0_freepts_extraporder1_paramset2[j],
	                                            //        j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset2 - in PRINT BOUNDARY QUANTITIES - post print quasisetll  \n"); fflush(stdout);} 

	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_freepts_extraporder1_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_freepts_extraporder1_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {   
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_freepts_extraporder1_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);  
	                                    free(name); 
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_freepts_extraporder1_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {

		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
			                            	sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder1_paramset2[j],quasiset_angmomdensityy0_freepts_extraporder1_paramset2[j],quasiset_angmomdensityz0_freepts_extraporder1_paramset2[j],
		                                                    j);
		                                    }
		                                    fclose(fp);
		                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder1_paramset2[j],quasiset_angmomdensityy0_freepts_extraporder1_paramset2[j],quasiset_angmomdensityz0_freepts_extraporder1_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_freepts_extraporder1_paramset2=1;
	                                chibdy_xibdy_(chibdy0_freepts_extraporder1_paramset2,xibdy0_freepts_extraporder1_paramset2,xpbdy0_freepts_extraporder1_paramset2,ypbdy0_freepts_extraporder1_paramset2,zpbdy0_freepts_extraporder1_paramset2,&basenumbdypoints_freepts_extraporder1_paramset2,chiextrap0_freepts_extraporder1_paramset2,xiextrap0_freepts_extraporder1_paramset2,&basebdy_Nchi_freepts_extraporder1_paramset2,&basebdy_Nxi_freepts_extraporder1_paramset2);    
	                                doubleintegralonsphere_(AdS_mass0_freepts_extraporder1_paramset2,quasiset_massdensity0_freepts_extraporder1_paramset2,xpbdy0_freepts_extraporder1_paramset2,ypbdy0_freepts_extraporder1_paramset2,zpbdy0_freepts_extraporder1_paramset2,&basenumbdypoints_freepts_extraporder1_paramset2,rhobdy0_freepts_extraporder1_paramset2,chibdy0_freepts_extraporder1_paramset2,xibdy0_freepts_extraporder1_paramset2,&basebdy_Nchi_freepts_extraporder1_paramset2,&basebdy_Nxi_freepts_extraporder1_paramset2);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder1_paramset2_%st_AdSmass.txt",AMRD_save_tag) + 1;
    								name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_freepts_extraporder1_paramset2_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_freepts_extraporder1_paramset2);
	                                fclose(fp);
	                                free(name);
	                            }
	                        }

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder1_paramset2 - POST PRINT BOUNDARY QUANTITIES   \n"); fflush(stdout);}

	                        free(vecbdypoints_freepts_extraporder1_paramset2);
	                        free(dsplsbdypoints_freepts_extraporder1_paramset2);
	                        free(quasiset_tt_freepts_extraporder1_paramset2);
	                        free(quasiset_tchi_freepts_extraporder1_paramset2);
	                        free(quasiset_txi_freepts_extraporder1_paramset2);
	                        free(quasiset_chichi_freepts_extraporder1_paramset2);
	                        free(quasiset_chixi_freepts_extraporder1_paramset2);
	                        free(quasiset_xixi_freepts_extraporder1_paramset2);
	                        free(quasiset_trace_freepts_extraporder1_paramset2);
	                        free(quasiset_massdensity_freepts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityx_freepts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityy_freepts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityz_freepts_extraporder1_paramset2);
	                        free(bdyphi_freepts_extraporder1_paramset2);  
	                        free(xpbdy_freepts_extraporder1_paramset2);
	                        free(ypbdy_freepts_extraporder1_paramset2);
	                        free(zpbdy_freepts_extraporder1_paramset2);   
	                       	free(x_outermostpt_freepts_extraporder1_paramset2);
	                       	free(y_outermostpt_freepts_extraporder1_paramset2);
	                       	free(z_outermostpt_freepts_extraporder1_paramset2);   
	
	                        free(lquasiset_tt0_freepts_extraporder1_paramset2);        
	                        free(lquasiset_tchi0_freepts_extraporder1_paramset2);
	                        free(lquasiset_txi0_freepts_extraporder1_paramset2);
	                        free(lquasiset_chichi0_freepts_extraporder1_paramset2);
	                        free(lquasiset_chixi0_freepts_extraporder1_paramset2);
	                        free(lquasiset_xixi0_freepts_extraporder1_paramset2);
	                        free(lquasiset_trace0_freepts_extraporder1_paramset2);
	                        free(lquasiset_massdensity0_freepts_extraporder1_paramset2);
	                        free(lquasiset_angmomdensityx0_freepts_extraporder1_paramset2);
	                        free(lquasiset_angmomdensityy0_freepts_extraporder1_paramset2);
	                        free(lquasiset_angmomdensityz0_freepts_extraporder1_paramset2);
	                        free(lbdyphi0_freepts_extraporder1_paramset2);      
	                        free(maxquasiset_tt0_freepts_extraporder1_paramset2);        
	                        free(maxquasiset_tchi0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_txi0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_chichi0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_chixi0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_xixi0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_trace0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_massdensity0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_angmomdensityx0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_angmomdensityy0_freepts_extraporder1_paramset2);
	                        free(maxquasiset_angmomdensityz0_freepts_extraporder1_paramset2);
	                        free(maxbdyphi0_freepts_extraporder1_paramset2);    
	                        free(minquasiset_tt0_freepts_extraporder1_paramset2);
	                        free(minquasiset_tchi0_freepts_extraporder1_paramset2);
	                        free(minquasiset_txi0_freepts_extraporder1_paramset2);
	                        free(minquasiset_chichi0_freepts_extraporder1_paramset2);
	                        free(minquasiset_chixi0_freepts_extraporder1_paramset2);
	                        free(minquasiset_xixi0_freepts_extraporder1_paramset2);
	                        free(minquasiset_trace0_freepts_extraporder1_paramset2);
	                        free(minquasiset_massdensity0_freepts_extraporder1_paramset2);
	                        free(minquasiset_angmomdensityx0_freepts_extraporder1_paramset2);
	                        free(minquasiset_angmomdensityy0_freepts_extraporder1_paramset2);
	                        free(minquasiset_angmomdensityz0_freepts_extraporder1_paramset2);
	                        free(minbdyphi0_freepts_extraporder1_paramset2);    
	                        free(quasiset_tt0_freepts_extraporder1_paramset2);
	                        free(quasiset_tchi0_freepts_extraporder1_paramset2);
	                        free(quasiset_txi0_freepts_extraporder1_paramset2);
	                        free(quasiset_chichi0_freepts_extraporder1_paramset2);
	                        free(quasiset_chixi0_freepts_extraporder1_paramset2);
	                        free(quasiset_xixi0_freepts_extraporder1_paramset2);
	                        free(quasiset_trace0_freepts_extraporder1_paramset2);
	                        free(quasiset_massdensity0_freepts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityx0_freepts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityy0_freepts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityz0_freepts_extraporder1_paramset2);
	                        free(bdyphi0_freepts_extraporder1_paramset2);
	                        free(AdS_mass0_freepts_extraporder1_paramset2);     
	                        free(xpbdy0_freepts_extraporder1_paramset2);
	                        free(ypbdy0_freepts_extraporder1_paramset2);
	                        free(zpbdy0_freepts_extraporder1_paramset2);
	                       	free(x_outermostpt0_freepts_extraporder1_paramset2);
	                       	free(y_outermostpt0_freepts_extraporder1_paramset2);
	                       	free(z_outermostpt0_freepts_extraporder1_paramset2);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_freepts_extraporder1_paramset2);
	                            free(chiextrap0_freepts_extraporder1_paramset2);
	                            free(xiextrap0_freepts_extraporder1_paramset2);             
	                            free(rhobdy0_freepts_extraporder1_paramset2);
	                            free(chibdy0_freepts_extraporder1_paramset2);
	                            free(xibdy0_freepts_extraporder1_paramset2);    
	                        }	
	            		}//closes condition on output_bdy_extraporder1_paramset2

	            		//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_freepts 1st order extrap paramset2\n"); fflush(stdout);}

	            		//SECOND ORDER EXTRAPOLATION
		            	if (output_bdy_extraporder2_paramset2)
	            		{
							bdy_extrap_order=2;
	
							//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
                			if (rad_extrap)
	                		{
    	            			if (my_rank==0) printf("%i-th order radial extrapolation of boundary quantities using paramset2 parameters - saved in freepts_extraporder2_paramset2*.txt files\n",bdy_extrap_order);
        	        			nexttobdypoints_radextrap_(chrbdy_freepts_extraporder2_paramset2,&numbdypoints_freepts_extraporder2_paramset2,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset2,&half_steps_from_bdy_int_paramset2,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
            	    		}
                			else
                			{
                				nexttobdypoints_freepts_(chrbdy_freepts_extraporder2_paramset2,&numbdypoints_freepts_extraporder2_paramset2,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset2,&half_steps_from_bdy_int_paramset2,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
                			}
	
	
	                		//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_freepts_extraporder2_paramset2 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_freepts_extraporder2_paramset2 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_freepts_extraporder2_paramset2,1,MPI_INT,vecbdypoints_freepts_extraporder2_paramset2,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_freepts_extraporder2_paramset2,&basenumbdypoints_freepts_extraporder2_paramset2,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_freepts_extraporder2_paramset2=%i\n",numbdypoints_freepts_extraporder2_paramset2);
	                        //fflush(stdout); 
	                        quasiset_tt_freepts_extraporder2_paramset2              = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_tchi_freepts_extraporder2_paramset2            = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_txi_freepts_extraporder2_paramset2             = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_chichi_freepts_extraporder2_paramset2          = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_chixi_freepts_extraporder2_paramset2           = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_xixi_freepts_extraporder2_paramset2            = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_trace_freepts_extraporder2_paramset2           = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_massdensity_freepts_extraporder2_paramset2     = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx_freepts_extraporder2_paramset2  = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy_freepts_extraporder2_paramset2  = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz_freepts_extraporder2_paramset2  = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        bdyphi_freepts_extraporder2_paramset2                   = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));   
	                        xpbdy_freepts_extraporder2_paramset2               = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        ypbdy_freepts_extraporder2_paramset2               = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        zpbdy_freepts_extraporder2_paramset2               = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));  
	                       	x_outermostpt_freepts_extraporder2_paramset2            = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                       	y_outermostpt_freepts_extraporder2_paramset2            = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                       	z_outermostpt_freepts_extraporder2_paramset2            = malloc((numbdypoints_freepts_extraporder2_paramset2)*sizeof(real)); 
	
	                        lquasiset_tt0_freepts_extraporder2_paramset2            = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_tchi0_freepts_extraporder2_paramset2          = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_txi0_freepts_extraporder2_paramset2           = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_chichi0_freepts_extraporder2_paramset2        = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_chixi0_freepts_extraporder2_paramset2         = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_xixi0_freepts_extraporder2_paramset2          = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_trace0_freepts_extraporder2_paramset2         = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_massdensity0_freepts_extraporder2_paramset2   = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityx0_freepts_extraporder2_paramset2= malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityy0_freepts_extraporder2_paramset2= malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityz0_freepts_extraporder2_paramset2= malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        lbdyphi0_freepts_extraporder2_paramset2                 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));   
	                        maxquasiset_tt0_freepts_extraporder2_paramset2          = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_tchi0_freepts_extraporder2_paramset2        = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_txi0_freepts_extraporder2_paramset2         = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_chichi0_freepts_extraporder2_paramset2      = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_chixi0_freepts_extraporder2_paramset2       = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_xixi0_freepts_extraporder2_paramset2        = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_trace0_freepts_extraporder2_paramset2       = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_massdensity0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityx0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityy0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityz0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        maxbdyphi0_freepts_extraporder2_paramset2               = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));   
	                        minquasiset_tt0_freepts_extraporder2_paramset2          = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_tchi0_freepts_extraporder2_paramset2        = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_txi0_freepts_extraporder2_paramset2         = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_chichi0_freepts_extraporder2_paramset2      = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_chixi0_freepts_extraporder2_paramset2       = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_xixi0_freepts_extraporder2_paramset2        = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_trace0_freepts_extraporder2_paramset2       = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_massdensity0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityx0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityy0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityz0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        minbdyphi0_freepts_extraporder2_paramset2               = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));   
	                        quasiset_tt0_freepts_extraporder2_paramset2             = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_tchi0_freepts_extraporder2_paramset2           = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_txi0_freepts_extraporder2_paramset2            = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_chichi0_freepts_extraporder2_paramset2         = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_chixi0_freepts_extraporder2_paramset2          = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_xixi0_freepts_extraporder2_paramset2           = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_trace0_freepts_extraporder2_paramset2          = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_massdensity0_freepts_extraporder2_paramset2    = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        AdS_mass0_freepts_extraporder2_paramset2                = malloc(sizeof(real));
	                        bdyphi0_freepts_extraporder2_paramset2                  = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));    
	                        xpbdy0_freepts_extraporder2_paramset2              = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        ypbdy0_freepts_extraporder2_paramset2              = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                        zpbdy0_freepts_extraporder2_paramset2              = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));   
	                       	x_outermostpt0_freepts_extraporder2_paramset2           = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                       	y_outermostpt0_freepts_extraporder2_paramset2           = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                       	z_outermostpt0_freepts_extraporder2_paramset2           = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));   
	
	
	                        //initialize
	                        for (i=0;i<numbdypoints_freepts_extraporder2_paramset2;i++)
	                        {
	                            quasiset_tt_freepts_extraporder2_paramset2              [i] = 0;
	                            quasiset_tchi_freepts_extraporder2_paramset2            [i] = 0;
	                            quasiset_txi_freepts_extraporder2_paramset2             [i] = 0;
	                            quasiset_chichi_freepts_extraporder2_paramset2          [i] = 0;
	                            quasiset_chixi_freepts_extraporder2_paramset2           [i] = 0;
	                            quasiset_xixi_freepts_extraporder2_paramset2            [i] = 0;
	                            quasiset_trace_freepts_extraporder2_paramset2           [i] = 0;
	                            quasiset_massdensity_freepts_extraporder2_paramset2     [i] = 0;
	                            quasiset_angmomdensityx_freepts_extraporder2_paramset2  [i] = 0;
	                            quasiset_angmomdensityy_freepts_extraporder2_paramset2  [i] = 0;
	                            quasiset_angmomdensityz_freepts_extraporder2_paramset2  [i] = 0;
	                            bdyphi_freepts_extraporder2_paramset2                   [i] = 0;   
	                            xpbdy_freepts_extraporder2_paramset2               [i] = 0;
	                            ypbdy_freepts_extraporder2_paramset2               [i] = 0;
	                            zpbdy_freepts_extraporder2_paramset2               [i] = 0;
	                           	x_outermostpt_freepts_extraporder2_paramset2            [i] = 0;
	                           	y_outermostpt_freepts_extraporder2_paramset2            [i] = 0;
	                           	z_outermostpt_freepts_extraporder2_paramset2            [i] = 0;
	
	                        }   
	                        for (i=0;i<basenumbdypoints_freepts_extraporder2_paramset2;i++)
	                        {   
	                            lquasiset_tt0_freepts_extraporder2_paramset2            [i] = 0;
	                            lquasiset_tchi0_freepts_extraporder2_paramset2          [i] = 0;
	                            lquasiset_txi0_freepts_extraporder2_paramset2           [i] = 0;
	                            lquasiset_chichi0_freepts_extraporder2_paramset2        [i] = 0;
	                            lquasiset_chixi0_freepts_extraporder2_paramset2         [i] = 0;
	                            lquasiset_xixi0_freepts_extraporder2_paramset2          [i] = 0;
	                            lquasiset_trace0_freepts_extraporder2_paramset2         [i] = 0;
	                            lquasiset_massdensity0_freepts_extraporder2_paramset2   [i] = 0;
	                            lquasiset_angmomdensityx0_freepts_extraporder2_paramset2 [i] = 0;
	                            lquasiset_angmomdensityy0_freepts_extraporder2_paramset2 [i] = 0;
	                            lquasiset_angmomdensityz0_freepts_extraporder2_paramset2 [i] = 0;
	                            lbdyphi0_freepts_extraporder2_paramset2                 [i] = 0;             
	                            maxquasiset_tt0_freepts_extraporder2_paramset2          [i] = 0;
	                            maxquasiset_tchi0_freepts_extraporder2_paramset2        [i] = 0;
	                            maxquasiset_txi0_freepts_extraporder2_paramset2         [i] = 0;
	                            maxquasiset_chichi0_freepts_extraporder2_paramset2      [i] = 0;
	                            maxquasiset_chixi0_freepts_extraporder2_paramset2       [i] = 0;
	                            maxquasiset_xixi0_freepts_extraporder2_paramset2        [i] = 0;
	                            maxquasiset_trace0_freepts_extraporder2_paramset2       [i] = 0;
	                            maxquasiset_massdensity0_freepts_extraporder2_paramset2 [i] = 0;
	                            maxquasiset_angmomdensityx0_freepts_extraporder2_paramset2 [i] = 0;
	                            maxquasiset_angmomdensityy0_freepts_extraporder2_paramset2 [i] = 0;
	                            maxquasiset_angmomdensityz0_freepts_extraporder2_paramset2 [i] = 0;
	                            maxbdyphi0_freepts_extraporder2_paramset2               [i] = 0;  
	                            minquasiset_tt0_freepts_extraporder2_paramset2          [i] = 0;
	                            minquasiset_tchi0_freepts_extraporder2_paramset2        [i] = 0;
	                            minquasiset_txi0_freepts_extraporder2_paramset2         [i] = 0;
	                            minquasiset_chichi0_freepts_extraporder2_paramset2      [i] = 0;
	                            minquasiset_chixi0_freepts_extraporder2_paramset2       [i] = 0;
	                            minquasiset_xixi0_freepts_extraporder2_paramset2        [i] = 0;
	                            minquasiset_trace0_freepts_extraporder2_paramset2       [i] = 0;
	                            minquasiset_massdensity0_freepts_extraporder2_paramset2 [i] = 0;
	                            minquasiset_angmomdensityx0_freepts_extraporder2_paramset2 [i] = 0;
	                            minquasiset_angmomdensityy0_freepts_extraporder2_paramset2 [i] = 0;
	                            minquasiset_angmomdensityz0_freepts_extraporder2_paramset2 [i] = 0;
	                            minbdyphi0_freepts_extraporder2_paramset2               [i] = 0;  
	                            quasiset_tt0_freepts_extraporder2_paramset2             [i] = 0;
	                            quasiset_tchi0_freepts_extraporder2_paramset2           [i] = 0;
	                            quasiset_txi0_freepts_extraporder2_paramset2            [i] = 0;
	                            quasiset_chichi0_freepts_extraporder2_paramset2         [i] = 0;
	                            quasiset_chixi0_freepts_extraporder2_paramset2          [i] = 0;
	                            quasiset_xixi0_freepts_extraporder2_paramset2           [i] = 0;
	                            quasiset_trace0_freepts_extraporder2_paramset2          [i] = 0;
	                            quasiset_massdensity0_freepts_extraporder2_paramset2    [i] = 0;
	                            quasiset_angmomdensityx0_freepts_extraporder2_paramset2 [i] = 0;
	                            quasiset_angmomdensityy0_freepts_extraporder2_paramset2 [i] = 0;
	                            quasiset_angmomdensityz0_freepts_extraporder2_paramset2 [i] = 0;
	                            bdyphi0_freepts_extraporder2_paramset2                  [i] = 0;   
	                            xpbdy0_freepts_extraporder2_paramset2              [i] = 0;
	                            ypbdy0_freepts_extraporder2_paramset2              [i] = 0;
	                            zpbdy0_freepts_extraporder2_paramset2              [i] = 0;
	                           	x_outermostpt0_freepts_extraporder2_paramset2           [i] = 0;
	                           	y_outermostpt0_freepts_extraporder2_paramset2           [i] = 0;
	                           	z_outermostpt0_freepts_extraporder2_paramset2           [i] = 0;
	
	                        }
	                        *AdS_mass0_freepts_extraporder2_paramset2                    = 0; 
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_freepts_extraporder2_paramset2=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_freepts_extraporder2_paramset2=vecbdypoints_freepts_extraporder2_paramset2[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_freepts_extraporder2_paramset2=is_bdy_freepts_extraporder2_paramset2+vecbdypoints_freepts_extraporder2_paramset2[j];
	                            }
	                            ie_bdy_freepts_extraporder2_paramset2=is_bdy_freepts_extraporder2_paramset2+vecbdypoints_freepts_extraporder2_paramset2[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_freepts_extraporder2_paramset2[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_freepts_extraporder2_paramset2[i]=dsplsbdypoints_freepts_extraporder2_paramset2[i]+vecbdypoints_freepts_extraporder2_paramset2[j];
	                                }
	                            }
	                        }   
	
	                        if (rad_extrap)
							{
								xyz_bdy_out_radextrap_(xpbdy_freepts_extraporder2_paramset2,ypbdy_freepts_extraporder2_paramset2,zpbdy_freepts_extraporder2_paramset2,
	                        						x_outermostpt_freepts_extraporder2_paramset2,y_outermostpt_freepts_extraporder2_paramset2,z_outermostpt_freepts_extraporder2_paramset2,
	                        						chrbdy_freepts_extraporder2_paramset2,&numbdypoints_freepts_extraporder2_paramset2,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
							}
	                    	else
	                    	{
	                        	xyz_extrap_outermost_(xpbdy_freepts_extraporder2_paramset2,ypbdy_freepts_extraporder2_paramset2,zpbdy_freepts_extraporder2_paramset2,
	                        						x_outermostpt_freepts_extraporder2_paramset2,y_outermostpt_freepts_extraporder2_paramset2,z_outermostpt_freepts_extraporder2_paramset2,
	                        						chrbdy_freepts_extraporder2_paramset2,&numbdypoints_freepts_extraporder2_paramset2,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	                        }
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_freepts_extraporder2_paramset2,numbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,xpbdy0_freepts_extraporder2_paramset2,vecbdypoints_freepts_extraporder2_paramset2,dsplsbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_freepts_extraporder2_paramset2,numbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,ypbdy0_freepts_extraporder2_paramset2,vecbdypoints_freepts_extraporder2_paramset2,dsplsbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_freepts_extraporder2_paramset2,numbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,zpbdy0_freepts_extraporder2_paramset2,vecbdypoints_freepts_extraporder2_paramset2,dsplsbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_freepts_extraporder2_paramset2,numbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,x_outermostpt0_freepts_extraporder2_paramset2,vecbdypoints_freepts_extraporder2_paramset2,dsplsbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_freepts_extraporder2_paramset2,numbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,y_outermostpt0_freepts_extraporder2_paramset2,vecbdypoints_freepts_extraporder2_paramset2,dsplsbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_freepts_extraporder2_paramset2,numbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,z_outermostpt0_freepts_extraporder2_paramset2,vecbdypoints_freepts_extraporder2_paramset2,dsplsbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_freepts_extraporder2_paramset2 = malloc(sizeof(real));
	                                chiextrap0_freepts_extraporder2_paramset2 = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real));
	                                xiextrap0_freepts_extraporder2_paramset2  = malloc((basenumbdypoints_freepts_extraporder2_paramset2)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_freepts_extraporder2_paramset2,chiextrap0_freepts_extraporder2_paramset2,xiextrap0_freepts_extraporder2_paramset2,xpbdy0_freepts_extraporder2_paramset2,ypbdy0_freepts_extraporder2_paramset2,zpbdy0_freepts_extraporder2_paramset2,&basenumbdypoints_freepts_extraporder2_paramset2);  
	                                basebdy_Nchi_freepts_extraporder2_paramset2=0;//initialize
	                                basebdy_Nxi_freepts_extraporder2_paramset2=0; //initialize
	                                bdyn_(&basebdy_Nchi_freepts_extraporder2_paramset2,&basebdy_Nxi_freepts_extraporder2_paramset2,&basenumbdypoints_freepts_extraporder2_paramset2,chiextrap0_freepts_extraporder2_paramset2,xiextrap0_freepts_extraporder2_paramset2);  
	                                rhobdy0_freepts_extraporder2_paramset2 = malloc(sizeof(real));
	                                chibdy0_freepts_extraporder2_paramset2 = malloc(basebdy_Nchi_freepts_extraporder2_paramset2*sizeof(real));
	                                xibdy0_freepts_extraporder2_paramset2  = malloc(basebdy_Nxi_freepts_extraporder2_paramset2*sizeof(real));   
	                            }
	                        }
	
	
							if (rad_extrap)
	                		{
	
	                			bdyphi_radextrap_(bdyphi_freepts_extraporder2_paramset2,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder2_paramset2,ypbdy_freepts_extraporder2_paramset2,zpbdy_freepts_extraporder2_paramset2,
	                                        chrbdy_freepts_extraporder2_paramset2,&numbdypoints_freepts_extraporder2_paramset2,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        	quasiset_radextrap_(quasiset_tt_freepts_extraporder2_paramset2,quasiset_tchi_freepts_extraporder2_paramset2,quasiset_txi_freepts_extraporder2_paramset2,
	                                quasiset_chichi_freepts_extraporder2_paramset2,quasiset_chixi_freepts_extraporder2_paramset2,
	                                quasiset_xixi_freepts_extraporder2_paramset2,
	                                quasiset_trace_freepts_extraporder2_paramset2,
	                                quasiset_massdensity_freepts_extraporder2_paramset2,
	                                quasiset_angmomdensityx_freepts_extraporder2_paramset2,
	                                quasiset_angmomdensityy_freepts_extraporder2_paramset2,
	                                quasiset_angmomdensityz_freepts_extraporder2_paramset2,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder2_paramset2,ypbdy_freepts_extraporder2_paramset2,zpbdy_freepts_extraporder2_paramset2,
	                                chrbdy_freepts_extraporder2_paramset2,&numbdypoints_freepts_extraporder2_paramset2,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                		}
	                		else
	                		{   
	                        	extrap_bdyphi_freepts_(bdyphi_freepts_extraporder2_paramset2,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder2_paramset2,ypbdy_freepts_extraporder2_paramset2,zpbdy_freepts_extraporder2_paramset2,
	                                        chrbdy_freepts_extraporder2_paramset2,&numbdypoints_freepts_extraporder2_paramset2,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        	extrap_quasiset_freepts_(quasiset_tt_freepts_extraporder2_paramset2,quasiset_tchi_freepts_extraporder2_paramset2,quasiset_txi_freepts_extraporder2_paramset2,
	                                quasiset_chichi_freepts_extraporder2_paramset2,quasiset_chixi_freepts_extraporder2_paramset2,
	                                quasiset_xixi_freepts_extraporder2_paramset2,
	                                quasiset_trace_freepts_extraporder2_paramset2,
	                                quasiset_massdensity_freepts_extraporder2_paramset2,
	                                quasiset_angmomdensityx_freepts_extraporder2_paramset2,
	                                quasiset_angmomdensityy_freepts_extraporder2_paramset2,
	                                quasiset_angmomdensityz_freepts_extraporder2_paramset2,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder2_paramset2,ypbdy_freepts_extraporder2_paramset2,zpbdy_freepts_extraporder2_paramset2,
	                                chrbdy_freepts_extraporder2_paramset2,&numbdypoints_freepts_extraporder2_paramset2,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	                        } 
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_freepts_extraporder2_paramset2; i<ie_bdy_freepts_extraporder2_paramset2; i++)
	                        {
	                            lquasiset_tt0_freepts_extraporder2_paramset2           [i] = quasiset_tt_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_tchi0_freepts_extraporder2_paramset2         [i] = quasiset_tchi_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_txi0_freepts_extraporder2_paramset2          [i] = quasiset_txi_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_chichi0_freepts_extraporder2_paramset2       [i] = quasiset_chichi_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_chixi0_freepts_extraporder2_paramset2        [i] = quasiset_chixi_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_xixi0_freepts_extraporder2_paramset2         [i] = quasiset_xixi_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_trace0_freepts_extraporder2_paramset2        [i] = quasiset_trace_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_massdensity0_freepts_extraporder2_paramset2  [i] = quasiset_massdensity_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_angmomdensityx0_freepts_extraporder2_paramset2 [i] = quasiset_angmomdensityx_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_angmomdensityy0_freepts_extraporder2_paramset2 [i] = quasiset_angmomdensityy_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lquasiset_angmomdensityz0_freepts_extraporder2_paramset2 [i] = quasiset_angmomdensityz_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                            lbdyphi0_freepts_extraporder2_paramset2                [i] = bdyphi_freepts_extraporder2_paramset2[i-is_bdy_freepts_extraporder2_paramset2];
	                        }   
	
							//PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder2_paramset2,          maxquasiset_tt0_freepts_extraporder2_paramset2,          basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder2_paramset2,        maxquasiset_tchi0_freepts_extraporder2_paramset2,        basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder2_paramset2,         maxquasiset_txi0_freepts_extraporder2_paramset2,         basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder2_paramset2,      maxquasiset_chichi0_freepts_extraporder2_paramset2,      basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder2_paramset2,       maxquasiset_chixi0_freepts_extraporder2_paramset2,       basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder2_paramset2,        maxquasiset_xixi0_freepts_extraporder2_paramset2,        basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder2_paramset2,       maxquasiset_trace0_freepts_extraporder2_paramset2,       basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder2_paramset2, maxquasiset_massdensity0_freepts_extraporder2_paramset2, basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder2_paramset2, maxquasiset_angmomdensityx0_freepts_extraporder2_paramset2, basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder2_paramset2, maxquasiset_angmomdensityy0_freepts_extraporder2_paramset2, basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder2_paramset2, maxquasiset_angmomdensityz0_freepts_extraporder2_paramset2, basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder2_paramset2,               maxbdyphi0_freepts_extraporder2_paramset2,               basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder2_paramset2,          minquasiset_tt0_freepts_extraporder2_paramset2,          basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder2_paramset2,        minquasiset_tchi0_freepts_extraporder2_paramset2,        basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder2_paramset2,         minquasiset_txi0_freepts_extraporder2_paramset2,         basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder2_paramset2,      minquasiset_chichi0_freepts_extraporder2_paramset2,      basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder2_paramset2,       minquasiset_chixi0_freepts_extraporder2_paramset2,       basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder2_paramset2,        minquasiset_xixi0_freepts_extraporder2_paramset2,        basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder2_paramset2,       minquasiset_trace0_freepts_extraporder2_paramset2,       basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder2_paramset2, minquasiset_massdensity0_freepts_extraporder2_paramset2, basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder2_paramset2, minquasiset_angmomdensityx0_freepts_extraporder2_paramset2, basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder2_paramset2, minquasiset_angmomdensityy0_freepts_extraporder2_paramset2, basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder2_paramset2, minquasiset_angmomdensityz0_freepts_extraporder2_paramset2, basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder2_paramset2,               minbdyphi0_freepts_extraporder2_paramset2,               basenumbdypoints_freepts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_freepts_extraporder2_paramset2; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_freepts_extraporder2_paramset2          [i] = maxquasiset_tt0_freepts_extraporder2_paramset2          [i] + minquasiset_tt0_freepts_extraporder2_paramset2          [i];
	                                    quasiset_tchi0_freepts_extraporder2_paramset2        [i] = maxquasiset_tchi0_freepts_extraporder2_paramset2        [i] + minquasiset_tchi0_freepts_extraporder2_paramset2        [i];
	                                    quasiset_txi0_freepts_extraporder2_paramset2         [i] = maxquasiset_txi0_freepts_extraporder2_paramset2         [i] + minquasiset_txi0_freepts_extraporder2_paramset2         [i];
	                                    quasiset_chichi0_freepts_extraporder2_paramset2      [i] = maxquasiset_chichi0_freepts_extraporder2_paramset2      [i] + minquasiset_chichi0_freepts_extraporder2_paramset2      [i];
	                                    quasiset_chixi0_freepts_extraporder2_paramset2       [i] = maxquasiset_chixi0_freepts_extraporder2_paramset2       [i] + minquasiset_chixi0_freepts_extraporder2_paramset2       [i];
	                                    quasiset_xixi0_freepts_extraporder2_paramset2        [i] = maxquasiset_xixi0_freepts_extraporder2_paramset2        [i] + minquasiset_xixi0_freepts_extraporder2_paramset2        [i];
	                                    quasiset_trace0_freepts_extraporder2_paramset2       [i] = maxquasiset_trace0_freepts_extraporder2_paramset2       [i] + minquasiset_trace0_freepts_extraporder2_paramset2       [i];
	                                    quasiset_massdensity0_freepts_extraporder2_paramset2 [i] = maxquasiset_massdensity0_freepts_extraporder2_paramset2 [i] + minquasiset_massdensity0_freepts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityx0_freepts_extraporder2_paramset2 [i] + minquasiset_angmomdensityx0_freepts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityy0_freepts_extraporder2_paramset2 [i] + minquasiset_angmomdensityy0_freepts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityz0_freepts_extraporder2_paramset2 [i] + minquasiset_angmomdensityz0_freepts_extraporder2_paramset2 [i];
	                                    bdyphi0_freepts_extraporder2_paramset2               [i] = maxbdyphi0_freepts_extraporder2_paramset2               [i] + minbdyphi0_freepts_extraporder2_paramset2               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_freepts_extraporder2_paramset2          [i] = maxquasiset_tt0_freepts_extraporder2_paramset2          [i];
	                                    quasiset_tchi0_freepts_extraporder2_paramset2        [i] = maxquasiset_tchi0_freepts_extraporder2_paramset2        [i];
	                                    quasiset_txi0_freepts_extraporder2_paramset2         [i] = maxquasiset_txi0_freepts_extraporder2_paramset2         [i];
	                                    quasiset_chichi0_freepts_extraporder2_paramset2      [i] = maxquasiset_chichi0_freepts_extraporder2_paramset2      [i];
	                                    quasiset_chixi0_freepts_extraporder2_paramset2       [i] = maxquasiset_chixi0_freepts_extraporder2_paramset2       [i];
	                                    quasiset_xixi0_freepts_extraporder2_paramset2        [i] = maxquasiset_xixi0_freepts_extraporder2_paramset2        [i];
	                                    quasiset_trace0_freepts_extraporder2_paramset2       [i] = maxquasiset_trace0_freepts_extraporder2_paramset2       [i];
	                                    quasiset_massdensity0_freepts_extraporder2_paramset2 [i] = maxquasiset_massdensity0_freepts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityx0_freepts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityy0_freepts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityz0_freepts_extraporder2_paramset2 [i];
	                                    bdyphi0_freepts_extraporder2_paramset2               [i] = maxbdyphi0_freepts_extraporder2_paramset2               [i];
	                                }  
	                        }       
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {     
	                            			size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder2_paramset2[j],ypbdy0_freepts_extraporder2_paramset2[j],zpbdy0_freepts_extraporder2_paramset2[j],j);
		                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder2_paramset2[j],ypbdy0_freepts_extraporder2_paramset2[j],zpbdy0_freepts_extraporder2_paramset2[j],j);
		                                    }
		                                    fclose(fp);
		                                    free(name);

		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder2_paramset2[j],ypbdy0_freepts_extraporder2_paramset2[j],zpbdy0_freepts_extraporder2_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }  

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder2_paramset2 - in PRINT BOUNDARY QUANTITIES - post print xext   \n"); fflush(stdout);}  


	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder2_paramset2[j],y_outermostpt0_freepts_extraporder2_paramset2[j],z_outermostpt0_freepts_extraporder2_paramset2[j],j);
	                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder2_paramset2[j],y_outermostpt0_freepts_extraporder2_paramset2[j],z_outermostpt0_freepts_extraporder2_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder2_paramset2[j],y_outermostpt0_freepts_extraporder2_paramset2[j],z_outermostpt0_freepts_extraporder2_paramset2[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name);
	                                	}   
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder2_paramset2 - in PRINT BOUNDARY QUANTITIES - post print xout   \n"); fflush(stdout);} 

	                                if(output_bdyphi)
	                                {
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder2_paramset2[j],j);
		                                    }
		                                    fclose(fp); 
		                                    free(name);
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder2_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                } 
	                                }    

	                                    // save quasiset_ll as ascii
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder2_paramset2[j],quasiset_tchi0_freepts_extraporder2_paramset2[j],quasiset_txi0_freepts_extraporder2_paramset2[j],quasiset_chichi0_freepts_extraporder2_paramset2[j],quasiset_chixi0_freepts_extraporder2_paramset2[j],quasiset_xixi0_freepts_extraporder2_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder2_paramset2[j],quasiset_tchi0_freepts_extraporder2_paramset2[j],quasiset_txi0_freepts_extraporder2_paramset2[j],quasiset_chichi0_freepts_extraporder2_paramset2[j],quasiset_chixi0_freepts_extraporder2_paramset2[j],quasiset_xixi0_freepts_extraporder2_paramset2[j],
	                                                    j_red);
	                                            //printf("%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                            //        ct,
	                                            //        quasiset_tt0_freepts_extraporder2_paramset2[j],quasiset_tchi0_freepts_extraporder2_paramset2[j],quasiset_txi0_freepts_extraporder2_paramset2[j],quasiset_chichi0_freepts_extraporder2_paramset2[j],quasiset_chixi0_freepts_extraporder2_paramset2[j],quasiset_xixi0_freepts_extraporder2_paramset2[j],
	                                            //        j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder2_paramset2 - in PRINT BOUNDARY QUANTITIES - post print quasisetll  \n"); fflush(stdout);} 

	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_freepts_extraporder2_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_freepts_extraporder2_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {   
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_freepts_extraporder2_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);  
	                                    free(name); 
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_freepts_extraporder2_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {

		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
			                            	sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder2_paramset2[j],quasiset_angmomdensityy0_freepts_extraporder2_paramset2[j],quasiset_angmomdensityz0_freepts_extraporder2_paramset2[j],
		                                                    j);
		                                    }
		                                    fclose(fp);
		                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder2_paramset2[j],quasiset_angmomdensityy0_freepts_extraporder2_paramset2[j],quasiset_angmomdensityz0_freepts_extraporder2_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_freepts_extraporder2_paramset2=1;
	                                chibdy_xibdy_(chibdy0_freepts_extraporder2_paramset2,xibdy0_freepts_extraporder2_paramset2,xpbdy0_freepts_extraporder2_paramset2,ypbdy0_freepts_extraporder2_paramset2,zpbdy0_freepts_extraporder2_paramset2,&basenumbdypoints_freepts_extraporder2_paramset2,chiextrap0_freepts_extraporder2_paramset2,xiextrap0_freepts_extraporder2_paramset2,&basebdy_Nchi_freepts_extraporder2_paramset2,&basebdy_Nxi_freepts_extraporder2_paramset2);    
	                                doubleintegralonsphere_(AdS_mass0_freepts_extraporder2_paramset2,quasiset_massdensity0_freepts_extraporder2_paramset2,xpbdy0_freepts_extraporder2_paramset2,ypbdy0_freepts_extraporder2_paramset2,zpbdy0_freepts_extraporder2_paramset2,&basenumbdypoints_freepts_extraporder2_paramset2,rhobdy0_freepts_extraporder2_paramset2,chibdy0_freepts_extraporder2_paramset2,xibdy0_freepts_extraporder2_paramset2,&basebdy_Nchi_freepts_extraporder2_paramset2,&basebdy_Nxi_freepts_extraporder2_paramset2);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder2_paramset2_%st_AdSmass.txt",AMRD_save_tag) + 1;
    								name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_freepts_extraporder2_paramset2_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_freepts_extraporder2_paramset2);
	                                fclose(fp);
	                                free(name);
	                            }
	                        }
	                        
	                        free(vecbdypoints_freepts_extraporder2_paramset2);
	                        free(dsplsbdypoints_freepts_extraporder2_paramset2);
	                        free(quasiset_tt_freepts_extraporder2_paramset2);
	                        free(quasiset_tchi_freepts_extraporder2_paramset2);
	                        free(quasiset_txi_freepts_extraporder2_paramset2);
	                        free(quasiset_chichi_freepts_extraporder2_paramset2);
	                        free(quasiset_chixi_freepts_extraporder2_paramset2);
	                        free(quasiset_xixi_freepts_extraporder2_paramset2);
	                        free(quasiset_trace_freepts_extraporder2_paramset2);
	                        free(quasiset_massdensity_freepts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityx_freepts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityy_freepts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityz_freepts_extraporder2_paramset2);
	                        free(bdyphi_freepts_extraporder2_paramset2);  
	                        free(xpbdy_freepts_extraporder2_paramset2);
	                        free(ypbdy_freepts_extraporder2_paramset2);
	                        free(zpbdy_freepts_extraporder2_paramset2);   
	                       	free(x_outermostpt_freepts_extraporder2_paramset2);
	                       	free(y_outermostpt_freepts_extraporder2_paramset2);
	                       	free(z_outermostpt_freepts_extraporder2_paramset2);   
	
	                        free(lquasiset_tt0_freepts_extraporder2_paramset2);        
	                        free(lquasiset_tchi0_freepts_extraporder2_paramset2);
	                        free(lquasiset_txi0_freepts_extraporder2_paramset2);
	                        free(lquasiset_chichi0_freepts_extraporder2_paramset2);
	                        free(lquasiset_chixi0_freepts_extraporder2_paramset2);
	                        free(lquasiset_xixi0_freepts_extraporder2_paramset2);
	                        free(lquasiset_trace0_freepts_extraporder2_paramset2);
	                        free(lquasiset_massdensity0_freepts_extraporder2_paramset2);
	                        free(lquasiset_angmomdensityx0_freepts_extraporder2_paramset2);
	                        free(lquasiset_angmomdensityy0_freepts_extraporder2_paramset2);
	                        free(lquasiset_angmomdensityz0_freepts_extraporder2_paramset2);
	                        free(lbdyphi0_freepts_extraporder2_paramset2);      
	                        free(maxquasiset_tt0_freepts_extraporder2_paramset2);        
	                        free(maxquasiset_tchi0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_txi0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_chichi0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_chixi0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_xixi0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_trace0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_massdensity0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_angmomdensityx0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_angmomdensityy0_freepts_extraporder2_paramset2);
	                        free(maxquasiset_angmomdensityz0_freepts_extraporder2_paramset2);
	                        free(maxbdyphi0_freepts_extraporder2_paramset2);    
	                        free(minquasiset_tt0_freepts_extraporder2_paramset2);
	                        free(minquasiset_tchi0_freepts_extraporder2_paramset2);
	                        free(minquasiset_txi0_freepts_extraporder2_paramset2);
	                        free(minquasiset_chichi0_freepts_extraporder2_paramset2);
	                        free(minquasiset_chixi0_freepts_extraporder2_paramset2);
	                        free(minquasiset_xixi0_freepts_extraporder2_paramset2);
	                        free(minquasiset_trace0_freepts_extraporder2_paramset2);
	                        free(minquasiset_massdensity0_freepts_extraporder2_paramset2);
	                        free(minquasiset_angmomdensityx0_freepts_extraporder2_paramset2);
	                        free(minquasiset_angmomdensityy0_freepts_extraporder2_paramset2);
	                        free(minquasiset_angmomdensityz0_freepts_extraporder2_paramset2);
	                        free(minbdyphi0_freepts_extraporder2_paramset2);    
	                        free(quasiset_tt0_freepts_extraporder2_paramset2);
	                        free(quasiset_tchi0_freepts_extraporder2_paramset2);
	                        free(quasiset_txi0_freepts_extraporder2_paramset2);
	                        free(quasiset_chichi0_freepts_extraporder2_paramset2);
	                        free(quasiset_chixi0_freepts_extraporder2_paramset2);
	                        free(quasiset_xixi0_freepts_extraporder2_paramset2);
	                        free(quasiset_trace0_freepts_extraporder2_paramset2);
	                        free(quasiset_massdensity0_freepts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityx0_freepts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityy0_freepts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityz0_freepts_extraporder2_paramset2);
	                        free(bdyphi0_freepts_extraporder2_paramset2);
	                        free(AdS_mass0_freepts_extraporder2_paramset2);     
	                        free(xpbdy0_freepts_extraporder2_paramset2);
	                        free(ypbdy0_freepts_extraporder2_paramset2);
	                        free(zpbdy0_freepts_extraporder2_paramset2);
	                       	free(x_outermostpt0_freepts_extraporder2_paramset2);
	                       	free(y_outermostpt0_freepts_extraporder2_paramset2);
	                       	free(z_outermostpt0_freepts_extraporder2_paramset2);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_freepts_extraporder2_paramset2);
	                            free(chiextrap0_freepts_extraporder2_paramset2);
	                            free(xiextrap0_freepts_extraporder2_paramset2);             
	                            free(rhobdy0_freepts_extraporder2_paramset2);
	                            free(chibdy0_freepts_extraporder2_paramset2);
	                            free(xibdy0_freepts_extraporder2_paramset2);    
	                        }   	
	            		}//closes condition on output_bdy_extraporder2_paramset2

	            		//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_freepts 2nd order extrap paramset2\n"); fflush(stdout);}

	            		//THIRD ORDER EXTRAPOLATION
		            	if (output_bdy_extraporder3_paramset2)
		            	{
		                	bdy_extrap_order=3; 
	
		                	//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
		                    nexttobdypoints_freepts_(chrbdy_freepts_extraporder3_paramset2,&numbdypoints_freepts_extraporder3_paramset2,&bdy_extrap_order,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset2,&half_steps_from_bdy_int_paramset2,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);
	
	
		                	//PERFORM EXTRAPOLATION
	                        vecbdypoints_freepts_extraporder3_paramset2 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_freepts_extraporder3_paramset2 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_freepts_extraporder3_paramset2,1,MPI_INT,vecbdypoints_freepts_extraporder3_paramset2,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_freepts_extraporder3_paramset2,&basenumbdypoints_freepts_extraporder3_paramset2,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_freepts_extraporder3_paramset2=%i\n",numbdypoints_freepts_extraporder3_paramset2);
	                        //fflush(stdout); 
	                        quasiset_tt_freepts_extraporder3_paramset2              = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_tchi_freepts_extraporder3_paramset2            = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_txi_freepts_extraporder3_paramset2             = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_chichi_freepts_extraporder3_paramset2          = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_chixi_freepts_extraporder3_paramset2           = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_xixi_freepts_extraporder3_paramset2            = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_trace_freepts_extraporder3_paramset2           = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_massdensity_freepts_extraporder3_paramset2     = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx_freepts_extraporder3_paramset2  = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy_freepts_extraporder3_paramset2  = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz_freepts_extraporder3_paramset2  = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        bdyphi_freepts_extraporder3_paramset2                   = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));   
	                        xpbdy_freepts_extraporder3_paramset2               = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        ypbdy_freepts_extraporder3_paramset2               = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        zpbdy_freepts_extraporder3_paramset2               = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));  
	                        x_outermostpt_freepts_extraporder3_paramset2            = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        y_outermostpt_freepts_extraporder3_paramset2            = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        z_outermostpt_freepts_extraporder3_paramset2            = malloc((numbdypoints_freepts_extraporder3_paramset2)*sizeof(real)); 
	
	                        lquasiset_tt0_freepts_extraporder3_paramset2            = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_tchi0_freepts_extraporder3_paramset2          = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_txi0_freepts_extraporder3_paramset2           = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_chichi0_freepts_extraporder3_paramset2        = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_chixi0_freepts_extraporder3_paramset2         = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_xixi0_freepts_extraporder3_paramset2          = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_trace0_freepts_extraporder3_paramset2         = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_massdensity0_freepts_extraporder3_paramset2   = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityx0_freepts_extraporder3_paramset2= malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityy0_freepts_extraporder3_paramset2= malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityz0_freepts_extraporder3_paramset2= malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        lbdyphi0_freepts_extraporder3_paramset2                 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));   
	                        maxquasiset_tt0_freepts_extraporder3_paramset2          = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_tchi0_freepts_extraporder3_paramset2        = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_txi0_freepts_extraporder3_paramset2         = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_chichi0_freepts_extraporder3_paramset2      = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_chixi0_freepts_extraporder3_paramset2       = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_xixi0_freepts_extraporder3_paramset2        = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_trace0_freepts_extraporder3_paramset2       = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_massdensity0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityx0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityy0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityz0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        maxbdyphi0_freepts_extraporder3_paramset2               = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));   
	                        minquasiset_tt0_freepts_extraporder3_paramset2          = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_tchi0_freepts_extraporder3_paramset2        = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_txi0_freepts_extraporder3_paramset2         = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_chichi0_freepts_extraporder3_paramset2      = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_chixi0_freepts_extraporder3_paramset2       = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_xixi0_freepts_extraporder3_paramset2        = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_trace0_freepts_extraporder3_paramset2       = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_massdensity0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityx0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityy0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityz0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        minbdyphi0_freepts_extraporder3_paramset2               = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));   
	                        quasiset_tt0_freepts_extraporder3_paramset2             = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_tchi0_freepts_extraporder3_paramset2           = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_txi0_freepts_extraporder3_paramset2            = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_chichi0_freepts_extraporder3_paramset2         = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_chixi0_freepts_extraporder3_paramset2          = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_xixi0_freepts_extraporder3_paramset2           = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_trace0_freepts_extraporder3_paramset2          = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_massdensity0_freepts_extraporder3_paramset2    = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        AdS_mass0_freepts_extraporder3_paramset2                = malloc(sizeof(real));
	                        bdyphi0_freepts_extraporder3_paramset2                  = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));    
	                        xpbdy0_freepts_extraporder3_paramset2              = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        ypbdy0_freepts_extraporder3_paramset2              = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        zpbdy0_freepts_extraporder3_paramset2              = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));   
	                        x_outermostpt0_freepts_extraporder3_paramset2           = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        y_outermostpt0_freepts_extraporder3_paramset2           = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                        z_outermostpt0_freepts_extraporder3_paramset2           = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));   
	
	
	                        //initialize
	                        for (i=0;i<numbdypoints_freepts_extraporder3_paramset2;i++)
	                        {
	                            quasiset_tt_freepts_extraporder3_paramset2              [i] = 0;
	                            quasiset_tchi_freepts_extraporder3_paramset2            [i] = 0;
	                            quasiset_txi_freepts_extraporder3_paramset2             [i] = 0;
	                            quasiset_chichi_freepts_extraporder3_paramset2          [i] = 0;
	                            quasiset_chixi_freepts_extraporder3_paramset2           [i] = 0;
	                            quasiset_xixi_freepts_extraporder3_paramset2            [i] = 0;
	                            quasiset_trace_freepts_extraporder3_paramset2           [i] = 0;
	                            quasiset_massdensity_freepts_extraporder3_paramset2     [i] = 0;
	                            quasiset_angmomdensityx_freepts_extraporder3_paramset2  [i] = 0;
	                            quasiset_angmomdensityy_freepts_extraporder3_paramset2  [i] = 0;
	                            quasiset_angmomdensityz_freepts_extraporder3_paramset2  [i] = 0;
	                            bdyphi_freepts_extraporder3_paramset2                   [i] = 0;   
	                            xpbdy_freepts_extraporder3_paramset2               [i] = 0;
	                            ypbdy_freepts_extraporder3_paramset2               [i] = 0;
	                            zpbdy_freepts_extraporder3_paramset2               [i] = 0;
	                                x_outermostpt_freepts_extraporder3_paramset2            [i] = 0;
	                                y_outermostpt_freepts_extraporder3_paramset2            [i] = 0;
	                                z_outermostpt_freepts_extraporder3_paramset2            [i] = 0;
	
	                        }   
	                        for (i=0;i<basenumbdypoints_freepts_extraporder3_paramset2;i++)
	                        {   
	                            lquasiset_tt0_freepts_extraporder3_paramset2            [i] = 0;
	                            lquasiset_tchi0_freepts_extraporder3_paramset2          [i] = 0;
	                            lquasiset_txi0_freepts_extraporder3_paramset2           [i] = 0;
	                            lquasiset_chichi0_freepts_extraporder3_paramset2        [i] = 0;
	                            lquasiset_chixi0_freepts_extraporder3_paramset2         [i] = 0;
	                            lquasiset_xixi0_freepts_extraporder3_paramset2          [i] = 0;
	                            lquasiset_trace0_freepts_extraporder3_paramset2         [i] = 0;
	                            lquasiset_massdensity0_freepts_extraporder3_paramset2   [i] = 0;
	                            lquasiset_angmomdensityx0_freepts_extraporder3_paramset2 [i] = 0;
	                            lquasiset_angmomdensityy0_freepts_extraporder3_paramset2 [i] = 0;
	                            lquasiset_angmomdensityz0_freepts_extraporder3_paramset2 [i] = 0;
	                            lbdyphi0_freepts_extraporder3_paramset2                 [i] = 0;             
	                            maxquasiset_tt0_freepts_extraporder3_paramset2          [i] = 0;
	                            maxquasiset_tchi0_freepts_extraporder3_paramset2        [i] = 0;
	                            maxquasiset_txi0_freepts_extraporder3_paramset2         [i] = 0;
	                            maxquasiset_chichi0_freepts_extraporder3_paramset2      [i] = 0;
	                            maxquasiset_chixi0_freepts_extraporder3_paramset2       [i] = 0;
	                            maxquasiset_xixi0_freepts_extraporder3_paramset2        [i] = 0;
	                            maxquasiset_trace0_freepts_extraporder3_paramset2       [i] = 0;
	                            maxquasiset_massdensity0_freepts_extraporder3_paramset2 [i] = 0;
	                            maxquasiset_angmomdensityx0_freepts_extraporder3_paramset2 [i] = 0;
	                            maxquasiset_angmomdensityy0_freepts_extraporder3_paramset2 [i] = 0;
	                            maxquasiset_angmomdensityz0_freepts_extraporder3_paramset2 [i] = 0;
	                            maxbdyphi0_freepts_extraporder3_paramset2               [i] = 0;  
	                            minquasiset_tt0_freepts_extraporder3_paramset2          [i] = 0;
	                            minquasiset_tchi0_freepts_extraporder3_paramset2        [i] = 0;
	                            minquasiset_txi0_freepts_extraporder3_paramset2         [i] = 0;
	                            minquasiset_chichi0_freepts_extraporder3_paramset2      [i] = 0;
	                            minquasiset_chixi0_freepts_extraporder3_paramset2       [i] = 0;
	                            minquasiset_xixi0_freepts_extraporder3_paramset2        [i] = 0;
	                            minquasiset_trace0_freepts_extraporder3_paramset2       [i] = 0;
	                            minquasiset_massdensity0_freepts_extraporder3_paramset2 [i] = 0;
	                            minquasiset_angmomdensityx0_freepts_extraporder3_paramset2 [i] = 0;
	                            minquasiset_angmomdensityy0_freepts_extraporder3_paramset2 [i] = 0;
	                            minquasiset_angmomdensityz0_freepts_extraporder3_paramset2 [i] = 0;
	                            minbdyphi0_freepts_extraporder3_paramset2               [i] = 0;  
	                            quasiset_tt0_freepts_extraporder3_paramset2             [i] = 0;
	                            quasiset_tchi0_freepts_extraporder3_paramset2           [i] = 0;
	                            quasiset_txi0_freepts_extraporder3_paramset2            [i] = 0;
	                            quasiset_chichi0_freepts_extraporder3_paramset2         [i] = 0;
	                            quasiset_chixi0_freepts_extraporder3_paramset2          [i] = 0;
	                            quasiset_xixi0_freepts_extraporder3_paramset2           [i] = 0;
	                            quasiset_trace0_freepts_extraporder3_paramset2          [i] = 0;
	                            quasiset_massdensity0_freepts_extraporder3_paramset2    [i] = 0;
	                            quasiset_angmomdensityx0_freepts_extraporder3_paramset2 [i] = 0;
	                            quasiset_angmomdensityy0_freepts_extraporder3_paramset2 [i] = 0;
	                            quasiset_angmomdensityz0_freepts_extraporder3_paramset2 [i] = 0;
	                            bdyphi0_freepts_extraporder3_paramset2                  [i] = 0;   
	                            xpbdy0_freepts_extraporder3_paramset2              [i] = 0;
	                            ypbdy0_freepts_extraporder3_paramset2              [i] = 0;
	                            zpbdy0_freepts_extraporder3_paramset2              [i] = 0;
	                                x_outermostpt0_freepts_extraporder3_paramset2           [i] = 0;
	                                y_outermostpt0_freepts_extraporder3_paramset2           [i] = 0;
	                                z_outermostpt0_freepts_extraporder3_paramset2           [i] = 0;
	
	                        }
	                        *AdS_mass0_freepts_extraporder3_paramset2                    = 0; 
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_freepts_extraporder3_paramset2=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_freepts_extraporder3_paramset2=vecbdypoints_freepts_extraporder3_paramset2[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_freepts_extraporder3_paramset2=is_bdy_freepts_extraporder3_paramset2+vecbdypoints_freepts_extraporder3_paramset2[j];
	                            }
	                            ie_bdy_freepts_extraporder3_paramset2=is_bdy_freepts_extraporder3_paramset2+vecbdypoints_freepts_extraporder3_paramset2[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_freepts_extraporder3_paramset2[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_freepts_extraporder3_paramset2[i]=dsplsbdypoints_freepts_extraporder3_paramset2[i]+vecbdypoints_freepts_extraporder3_paramset2[j];
	                                }
	                            }
	                        }   
	
	                        xyz_extrap_outermost_(xpbdy_freepts_extraporder3_paramset2,ypbdy_freepts_extraporder3_paramset2,zpbdy_freepts_extraporder3_paramset2,
	                                                                        x_outermostpt_freepts_extraporder3_paramset2,y_outermostpt_freepts_extraporder3_paramset2,z_outermostpt_freepts_extraporder3_paramset2,
	                                                                        chrbdy_freepts_extraporder3_paramset2,&numbdypoints_freepts_extraporder3_paramset2,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_freepts_extraporder3_paramset2,numbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,xpbdy0_freepts_extraporder3_paramset2,vecbdypoints_freepts_extraporder3_paramset2,dsplsbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_freepts_extraporder3_paramset2,numbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,ypbdy0_freepts_extraporder3_paramset2,vecbdypoints_freepts_extraporder3_paramset2,dsplsbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_freepts_extraporder3_paramset2,numbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,zpbdy0_freepts_extraporder3_paramset2,vecbdypoints_freepts_extraporder3_paramset2,dsplsbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                                MPI_Allgatherv(x_outermostpt_freepts_extraporder3_paramset2,numbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,x_outermostpt0_freepts_extraporder3_paramset2,vecbdypoints_freepts_extraporder3_paramset2,dsplsbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                                MPI_Allgatherv(y_outermostpt_freepts_extraporder3_paramset2,numbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,y_outermostpt0_freepts_extraporder3_paramset2,vecbdypoints_freepts_extraporder3_paramset2,dsplsbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                                MPI_Allgatherv(z_outermostpt_freepts_extraporder3_paramset2,numbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,z_outermostpt0_freepts_extraporder3_paramset2,vecbdypoints_freepts_extraporder3_paramset2,dsplsbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_freepts_extraporder3_paramset2 = malloc(sizeof(real));
	                                chiextrap0_freepts_extraporder3_paramset2 = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real));
	                                xiextrap0_freepts_extraporder3_paramset2  = malloc((basenumbdypoints_freepts_extraporder3_paramset2)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_freepts_extraporder3_paramset2,chiextrap0_freepts_extraporder3_paramset2,xiextrap0_freepts_extraporder3_paramset2,xpbdy0_freepts_extraporder3_paramset2,ypbdy0_freepts_extraporder3_paramset2,zpbdy0_freepts_extraporder3_paramset2,&basenumbdypoints_freepts_extraporder3_paramset2);  
	                                basebdy_Nchi_freepts_extraporder3_paramset2=0;//initialize
	                                basebdy_Nxi_freepts_extraporder3_paramset2=0; //initialize
	                                bdyn_(&basebdy_Nchi_freepts_extraporder3_paramset2,&basebdy_Nxi_freepts_extraporder3_paramset2,&basenumbdypoints_freepts_extraporder3_paramset2,chiextrap0_freepts_extraporder3_paramset2,xiextrap0_freepts_extraporder3_paramset2);  
	                                rhobdy0_freepts_extraporder3_paramset2 = malloc(sizeof(real));
	                                chibdy0_freepts_extraporder3_paramset2 = malloc(basebdy_Nchi_freepts_extraporder3_paramset2*sizeof(real));
	                                xibdy0_freepts_extraporder3_paramset2  = malloc(basebdy_Nxi_freepts_extraporder3_paramset2*sizeof(real));   
	                            }
	                        }
	
	
	                        extrap_bdyphi_freepts_(bdyphi_freepts_extraporder3_paramset2,
	                                        leadordcoeff_phi1,
	                                        xpbdy_freepts_extraporder3_paramset2,ypbdy_freepts_extraporder3_paramset2,zpbdy_freepts_extraporder3_paramset2,
	                                        chrbdy_freepts_extraporder3_paramset2,&numbdypoints_freepts_extraporder3_paramset2,
	                                        &bdy_extrap_order,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        extrap_quasiset_freepts_(quasiset_tt_freepts_extraporder3_paramset2,quasiset_tchi_freepts_extraporder3_paramset2,quasiset_txi_freepts_extraporder3_paramset2,
	                                quasiset_chichi_freepts_extraporder3_paramset2,quasiset_chixi_freepts_extraporder3_paramset2,
	                                quasiset_xixi_freepts_extraporder3_paramset2,
	                                quasiset_trace_freepts_extraporder3_paramset2,
	                                quasiset_massdensity_freepts_extraporder3_paramset2,
	                                quasiset_angmomdensityx_freepts_extraporder3_paramset2,
	                                quasiset_angmomdensityy_freepts_extraporder3_paramset2,
	                                quasiset_angmomdensityz_freepts_extraporder3_paramset2,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_freepts_extraporder3_paramset2,ypbdy_freepts_extraporder3_paramset2,zpbdy_freepts_extraporder3_paramset2,
	                                chrbdy_freepts_extraporder3_paramset2,&numbdypoints_freepts_extraporder3_paramset2,
	                                &bdy_extrap_order,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_freepts_extraporder3_paramset2; i<ie_bdy_freepts_extraporder3_paramset2; i++)
	                        {
	                            lquasiset_tt0_freepts_extraporder3_paramset2           [i] = quasiset_tt_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_tchi0_freepts_extraporder3_paramset2         [i] = quasiset_tchi_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_txi0_freepts_extraporder3_paramset2          [i] = quasiset_txi_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_chichi0_freepts_extraporder3_paramset2       [i] = quasiset_chichi_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_chixi0_freepts_extraporder3_paramset2        [i] = quasiset_chixi_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_xixi0_freepts_extraporder3_paramset2         [i] = quasiset_xixi_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_trace0_freepts_extraporder3_paramset2        [i] = quasiset_trace_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_massdensity0_freepts_extraporder3_paramset2  [i] = quasiset_massdensity_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_angmomdensityx0_freepts_extraporder3_paramset2 [i] = quasiset_angmomdensityx_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_angmomdensityy0_freepts_extraporder3_paramset2 [i] = quasiset_angmomdensityy_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lquasiset_angmomdensityz0_freepts_extraporder3_paramset2 [i] = quasiset_angmomdensityz_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                            lbdyphi0_freepts_extraporder3_paramset2                [i] = bdyphi_freepts_extraporder3_paramset2[i-is_bdy_freepts_extraporder3_paramset2];
	                        }   
	
	                        //PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder3_paramset2,          maxquasiset_tt0_freepts_extraporder3_paramset2,          basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder3_paramset2,        maxquasiset_tchi0_freepts_extraporder3_paramset2,        basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder3_paramset2,         maxquasiset_txi0_freepts_extraporder3_paramset2,         basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder3_paramset2,      maxquasiset_chichi0_freepts_extraporder3_paramset2,      basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder3_paramset2,       maxquasiset_chixi0_freepts_extraporder3_paramset2,       basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder3_paramset2,        maxquasiset_xixi0_freepts_extraporder3_paramset2,        basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder3_paramset2,       maxquasiset_trace0_freepts_extraporder3_paramset2,       basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder3_paramset2, maxquasiset_massdensity0_freepts_extraporder3_paramset2, basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder3_paramset2, maxquasiset_angmomdensityx0_freepts_extraporder3_paramset2, basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder3_paramset2, maxquasiset_angmomdensityy0_freepts_extraporder3_paramset2, basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder3_paramset2, maxquasiset_angmomdensityz0_freepts_extraporder3_paramset2, basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder3_paramset2,               maxbdyphi0_freepts_extraporder3_paramset2,               basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_freepts_extraporder3_paramset2,          minquasiset_tt0_freepts_extraporder3_paramset2,          basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_freepts_extraporder3_paramset2,        minquasiset_tchi0_freepts_extraporder3_paramset2,        basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_freepts_extraporder3_paramset2,         minquasiset_txi0_freepts_extraporder3_paramset2,         basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_freepts_extraporder3_paramset2,      minquasiset_chichi0_freepts_extraporder3_paramset2,      basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_freepts_extraporder3_paramset2,       minquasiset_chixi0_freepts_extraporder3_paramset2,       basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_freepts_extraporder3_paramset2,        minquasiset_xixi0_freepts_extraporder3_paramset2,        basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_freepts_extraporder3_paramset2,       minquasiset_trace0_freepts_extraporder3_paramset2,       basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_freepts_extraporder3_paramset2, minquasiset_massdensity0_freepts_extraporder3_paramset2, basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_freepts_extraporder3_paramset2, minquasiset_angmomdensityx0_freepts_extraporder3_paramset2, basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_freepts_extraporder3_paramset2, minquasiset_angmomdensityy0_freepts_extraporder3_paramset2, basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_freepts_extraporder3_paramset2, minquasiset_angmomdensityz0_freepts_extraporder3_paramset2, basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_freepts_extraporder3_paramset2,               minbdyphi0_freepts_extraporder3_paramset2,               basenumbdypoints_freepts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_freepts_extraporder3_paramset2; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_freepts_extraporder3_paramset2          [i] = maxquasiset_tt0_freepts_extraporder3_paramset2          [i] + minquasiset_tt0_freepts_extraporder3_paramset2          [i];
	                                    quasiset_tchi0_freepts_extraporder3_paramset2        [i] = maxquasiset_tchi0_freepts_extraporder3_paramset2        [i] + minquasiset_tchi0_freepts_extraporder3_paramset2        [i];
	                                    quasiset_txi0_freepts_extraporder3_paramset2         [i] = maxquasiset_txi0_freepts_extraporder3_paramset2         [i] + minquasiset_txi0_freepts_extraporder3_paramset2         [i];
	                                    quasiset_chichi0_freepts_extraporder3_paramset2      [i] = maxquasiset_chichi0_freepts_extraporder3_paramset2      [i] + minquasiset_chichi0_freepts_extraporder3_paramset2      [i];
	                                    quasiset_chixi0_freepts_extraporder3_paramset2       [i] = maxquasiset_chixi0_freepts_extraporder3_paramset2       [i] + minquasiset_chixi0_freepts_extraporder3_paramset2       [i];
	                                    quasiset_xixi0_freepts_extraporder3_paramset2        [i] = maxquasiset_xixi0_freepts_extraporder3_paramset2        [i] + minquasiset_xixi0_freepts_extraporder3_paramset2        [i];
	                                    quasiset_trace0_freepts_extraporder3_paramset2       [i] = maxquasiset_trace0_freepts_extraporder3_paramset2       [i] + minquasiset_trace0_freepts_extraporder3_paramset2       [i];
	                                    quasiset_massdensity0_freepts_extraporder3_paramset2 [i] = maxquasiset_massdensity0_freepts_extraporder3_paramset2 [i] + minquasiset_massdensity0_freepts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityx0_freepts_extraporder3_paramset2 [i] + minquasiset_angmomdensityx0_freepts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityy0_freepts_extraporder3_paramset2 [i] + minquasiset_angmomdensityy0_freepts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityz0_freepts_extraporder3_paramset2 [i] + minquasiset_angmomdensityz0_freepts_extraporder3_paramset2 [i];
	                                    bdyphi0_freepts_extraporder3_paramset2               [i] = maxbdyphi0_freepts_extraporder3_paramset2               [i] + minbdyphi0_freepts_extraporder3_paramset2               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_freepts_extraporder3_paramset2          [i] = maxquasiset_tt0_freepts_extraporder3_paramset2          [i];
	                                    quasiset_tchi0_freepts_extraporder3_paramset2        [i] = maxquasiset_tchi0_freepts_extraporder3_paramset2        [i];
	                                    quasiset_txi0_freepts_extraporder3_paramset2         [i] = maxquasiset_txi0_freepts_extraporder3_paramset2         [i];
	                                    quasiset_chichi0_freepts_extraporder3_paramset2      [i] = maxquasiset_chichi0_freepts_extraporder3_paramset2      [i];
	                                    quasiset_chixi0_freepts_extraporder3_paramset2       [i] = maxquasiset_chixi0_freepts_extraporder3_paramset2       [i];
	                                    quasiset_xixi0_freepts_extraporder3_paramset2        [i] = maxquasiset_xixi0_freepts_extraporder3_paramset2        [i];
	                                    quasiset_trace0_freepts_extraporder3_paramset2       [i] = maxquasiset_trace0_freepts_extraporder3_paramset2       [i];
	                                    quasiset_massdensity0_freepts_extraporder3_paramset2 [i] = maxquasiset_massdensity0_freepts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityx0_freepts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityx0_freepts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityy0_freepts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityy0_freepts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityz0_freepts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityz0_freepts_extraporder3_paramset2 [i];
	                                    bdyphi0_freepts_extraporder3_paramset2               [i] = maxbdyphi0_freepts_extraporder3_paramset2               [i];
	                                }  
	                        }       
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {     
	                            			size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder3_paramset2[j],ypbdy0_freepts_extraporder3_paramset2[j],zpbdy0_freepts_extraporder3_paramset2[j],j);
		                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder3_paramset2[j],ypbdy0_freepts_extraporder3_paramset2[j],zpbdy0_freepts_extraporder3_paramset2[j],j);
		                                    }
		                                    fclose(fp);
		                                    free(name);

		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_freepts_extraporder3_paramset2[j],ypbdy0_freepts_extraporder3_paramset2[j],zpbdy0_freepts_extraporder3_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }  

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder3_paramset2 - in PRINT BOUNDARY QUANTITIES - post print xext   \n"); fflush(stdout);}  


	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder3_paramset2[j],y_outermostpt0_freepts_extraporder3_paramset2[j],z_outermostpt0_freepts_extraporder3_paramset2[j],j);
	                                        //printf("%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder3_paramset2[j],y_outermostpt0_freepts_extraporder3_paramset2[j],z_outermostpt0_freepts_extraporder3_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_freepts_extraporder3_paramset2[j],y_outermostpt0_freepts_extraporder3_paramset2[j],z_outermostpt0_freepts_extraporder3_paramset2[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name);
	                                	}   
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder3_paramset2 - in PRINT BOUNDARY QUANTITIES - post print xout   \n"); fflush(stdout);} 

	                                if(output_bdyphi)
	                                {
	                                		size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder3_paramset2[j],j);
		                                    }
		                                    fclose(fp); 
		                                    free(name);
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_freepts_extraporder3_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                } 
	                                }    

	                                    // save quasiset_ll as ascii
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder3_paramset2[j],quasiset_tchi0_freepts_extraporder3_paramset2[j],quasiset_txi0_freepts_extraporder3_paramset2[j],quasiset_chichi0_freepts_extraporder3_paramset2[j],quasiset_chixi0_freepts_extraporder3_paramset2[j],quasiset_xixi0_freepts_extraporder3_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_freepts_extraporder3_paramset2[j],quasiset_tchi0_freepts_extraporder3_paramset2[j],quasiset_txi0_freepts_extraporder3_paramset2[j],quasiset_chichi0_freepts_extraporder3_paramset2[j],quasiset_chixi0_freepts_extraporder3_paramset2[j],quasiset_xixi0_freepts_extraporder3_paramset2[j],
	                                                    j_red);
	                                            //printf("%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                            //        ct,
	                                            //        quasiset_tt0_freepts_extraporder3_paramset2[j],quasiset_tchi0_freepts_extraporder3_paramset2[j],quasiset_txi0_freepts_extraporder3_paramset2[j],quasiset_chichi0_freepts_extraporder3_paramset2[j],quasiset_chixi0_freepts_extraporder3_paramset2[j],quasiset_xixi0_freepts_extraporder3_paramset2[j],
	                                            //        j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name);
	                                }

									//if (my_rank==0) {printf("pre_io_calc: freepts extrap:extraporder3_paramset2 - in PRINT BOUNDARY QUANTITIES - post print quasisetll  \n"); fflush(stdout);} 

	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_freepts_extraporder3_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp); 
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_freepts_extraporder3_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {   
	                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_freepts_extraporder3_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);  
	                                    free(name); 
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_freepts_extraporder3_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {

		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
			                            	sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
		                                    {
		                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder3_paramset2[j],quasiset_angmomdensityy0_freepts_extraporder3_paramset2[j],quasiset_angmomdensityz0_freepts_extraporder3_paramset2[j],
		                                                    j);
		                                    }
		                                    fclose(fp);
		                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_freepts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_freepts_extraporder3_paramset2[j],quasiset_angmomdensityy0_freepts_extraporder3_paramset2[j],quasiset_angmomdensityz0_freepts_extraporder3_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name);
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_freepts_extraporder3_paramset2=1;
	                                chibdy_xibdy_(chibdy0_freepts_extraporder3_paramset2,xibdy0_freepts_extraporder3_paramset2,xpbdy0_freepts_extraporder3_paramset2,ypbdy0_freepts_extraporder3_paramset2,zpbdy0_freepts_extraporder3_paramset2,&basenumbdypoints_freepts_extraporder3_paramset2,chiextrap0_freepts_extraporder3_paramset2,xiextrap0_freepts_extraporder3_paramset2,&basebdy_Nchi_freepts_extraporder3_paramset2,&basebdy_Nxi_freepts_extraporder3_paramset2);    
	                                doubleintegralonsphere_(AdS_mass0_freepts_extraporder3_paramset2,quasiset_massdensity0_freepts_extraporder3_paramset2,xpbdy0_freepts_extraporder3_paramset2,ypbdy0_freepts_extraporder3_paramset2,zpbdy0_freepts_extraporder3_paramset2,&basenumbdypoints_freepts_extraporder3_paramset2,rhobdy0_freepts_extraporder3_paramset2,chibdy0_freepts_extraporder3_paramset2,xibdy0_freepts_extraporder3_paramset2,&basebdy_Nchi_freepts_extraporder3_paramset2,&basebdy_Nxi_freepts_extraporder3_paramset2);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_freepts_extraporder3_paramset2_%st_AdSmass.txt",AMRD_save_tag) + 1;
    								name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_freepts_extraporder3_paramset2_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_freepts_extraporder3_paramset2);
	                                fclose(fp);
	                                free(name);
	                            }
	                        }

	                        free(vecbdypoints_freepts_extraporder3_paramset2);
	                        free(dsplsbdypoints_freepts_extraporder3_paramset2);
	                        free(quasiset_tt_freepts_extraporder3_paramset2);
	                        free(quasiset_tchi_freepts_extraporder3_paramset2);
	                        free(quasiset_txi_freepts_extraporder3_paramset2);
	                        free(quasiset_chichi_freepts_extraporder3_paramset2);
	                        free(quasiset_chixi_freepts_extraporder3_paramset2);
	                        free(quasiset_xixi_freepts_extraporder3_paramset2);
	                        free(quasiset_trace_freepts_extraporder3_paramset2);
	                        free(quasiset_massdensity_freepts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityx_freepts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityy_freepts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityz_freepts_extraporder3_paramset2);
	                        free(bdyphi_freepts_extraporder3_paramset2);  
	                        free(xpbdy_freepts_extraporder3_paramset2);
	                        free(ypbdy_freepts_extraporder3_paramset2);
	                        free(zpbdy_freepts_extraporder3_paramset2);   
	                       	free(x_outermostpt_freepts_extraporder3_paramset2);
	                       	free(y_outermostpt_freepts_extraporder3_paramset2);
	                       	free(z_outermostpt_freepts_extraporder3_paramset2);   
	
	                        free(lquasiset_tt0_freepts_extraporder3_paramset2);        
	                        free(lquasiset_tchi0_freepts_extraporder3_paramset2);
	                        free(lquasiset_txi0_freepts_extraporder3_paramset2);
	                        free(lquasiset_chichi0_freepts_extraporder3_paramset2);
	                        free(lquasiset_chixi0_freepts_extraporder3_paramset2);
	                        free(lquasiset_xixi0_freepts_extraporder3_paramset2);
	                        free(lquasiset_trace0_freepts_extraporder3_paramset2);
	                        free(lquasiset_massdensity0_freepts_extraporder3_paramset2);
	                        free(lquasiset_angmomdensityx0_freepts_extraporder3_paramset2);
	                        free(lquasiset_angmomdensityy0_freepts_extraporder3_paramset2);
	                        free(lquasiset_angmomdensityz0_freepts_extraporder3_paramset2);
	                        free(lbdyphi0_freepts_extraporder3_paramset2);      
	                        free(maxquasiset_tt0_freepts_extraporder3_paramset2);        
	                        free(maxquasiset_tchi0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_txi0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_chichi0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_chixi0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_xixi0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_trace0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_massdensity0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_angmomdensityx0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_angmomdensityy0_freepts_extraporder3_paramset2);
	                        free(maxquasiset_angmomdensityz0_freepts_extraporder3_paramset2);
	                        free(maxbdyphi0_freepts_extraporder3_paramset2);    
	                        free(minquasiset_tt0_freepts_extraporder3_paramset2);
	                        free(minquasiset_tchi0_freepts_extraporder3_paramset2);
	                        free(minquasiset_txi0_freepts_extraporder3_paramset2);
	                        free(minquasiset_chichi0_freepts_extraporder3_paramset2);
	                        free(minquasiset_chixi0_freepts_extraporder3_paramset2);
	                        free(minquasiset_xixi0_freepts_extraporder3_paramset2);
	                        free(minquasiset_trace0_freepts_extraporder3_paramset2);
	                        free(minquasiset_massdensity0_freepts_extraporder3_paramset2);
	                        free(minquasiset_angmomdensityx0_freepts_extraporder3_paramset2);
	                        free(minquasiset_angmomdensityy0_freepts_extraporder3_paramset2);
	                        free(minquasiset_angmomdensityz0_freepts_extraporder3_paramset2);
	                        free(minbdyphi0_freepts_extraporder3_paramset2);    
	                        free(quasiset_tt0_freepts_extraporder3_paramset2);
	                        free(quasiset_tchi0_freepts_extraporder3_paramset2);
	                        free(quasiset_txi0_freepts_extraporder3_paramset2);
	                        free(quasiset_chichi0_freepts_extraporder3_paramset2);
	                        free(quasiset_chixi0_freepts_extraporder3_paramset2);
	                        free(quasiset_xixi0_freepts_extraporder3_paramset2);
	                        free(quasiset_trace0_freepts_extraporder3_paramset2);
	                        free(quasiset_massdensity0_freepts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityx0_freepts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityy0_freepts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityz0_freepts_extraporder3_paramset2);
	                        free(bdyphi0_freepts_extraporder3_paramset2);
	                        free(AdS_mass0_freepts_extraporder3_paramset2);     
	                        free(xpbdy0_freepts_extraporder3_paramset2);
	                        free(ypbdy0_freepts_extraporder3_paramset2);
	                        free(zpbdy0_freepts_extraporder3_paramset2);
	                       	free(x_outermostpt0_freepts_extraporder3_paramset2);
	                       	free(y_outermostpt0_freepts_extraporder3_paramset2);
	                       	free(z_outermostpt0_freepts_extraporder3_paramset2);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_freepts_extraporder3_paramset2);
	                            free(chiextrap0_freepts_extraporder3_paramset2);
	                            free(xiextrap0_freepts_extraporder3_paramset2);             
	                            free(rhobdy0_freepts_extraporder3_paramset2);
	                            free(chibdy0_freepts_extraporder3_paramset2);
	                            free(xibdy0_freepts_extraporder3_paramset2);    
	                        }   	
		                }//closes condition on output_bdy_extraporder3_paramset2

		                //MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_freepts 3rd order extrap paramset2\n"); fflush(stdout);}
	
		        	}//closes condition on bdy_extrap_freepts
	
	
		        	//FIXED POINTS EXTRAPOLATION
		        	if (bdy_extrap_fixedpts)
		        	{   

		        		//set fixed_coords, i.e. the values (fixed for all resolutions) of coordinates of points that we use for boundary extrapolation
		        		if (init_fixed_coords==0)
		        		{
							for (i=0;i<num_fixed_coords;i++)
	            			{
	                			fixed_coords[i]=-1+i*ind_distance_fixedpts*dx; 
		              			//if (my_rank==0) 
	                			//{
	                			//	printf("pre_io_calc: i=%i,ind_distance_fixedpts=%i,num_fixed_coords=%i,fixed_coords[i]=%lf\n",i,ind_distance_fixedpts,num_fixed_coords,fixed_coords[i]);
		                		//}
		                		init_fixed_coords=1;
	            			}
	            		} 

	            		//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: pre_fixedpts extrap\n"); fflush(stdout);}
	
		        		//EXTRAPOLATION WITH FIRST SET OF PARAMETERS (denoted by index 1 at the end)
	
		        		//FIRST ORDER EXTRAPOLATION
            			if (output_bdy_extraporder1_paramset1)
            			{
                			bdy_extrap_order=1;

                			//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
	                        nexttobdypoints_fixedpts_(chrbdy_fixedpts_extraporder1_paramset1,&numbdypoints_fixedpts_extraporder1_paramset1,&bdy_extrap_order,&ind_distance_fixedpts,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset1,&half_steps_from_bdy_int_paramset1,&num_fixed_coords,fixed_coords,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);

	                    	//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_fixedpts_extraporder1_paramset1 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_fixedpts_extraporder1_paramset1 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_fixedpts_extraporder1_paramset1,1,MPI_INT,vecbdypoints_fixedpts_extraporder1_paramset1,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_fixedpts_extraporder1_paramset1,&basenumbdypoints_fixedpts_extraporder1_paramset1,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_fixedpts_extraporder1_paramset1=%i\n",numbdypoints_fixedpts_extraporder1_paramset1);
	                        //fflush(stdout); 
	                        quasiset_tt_fixedpts_extraporder1_paramset1              = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_tchi_fixedpts_extraporder1_paramset1            = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_txi_fixedpts_extraporder1_paramset1             = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_chichi_fixedpts_extraporder1_paramset1          = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_chixi_fixedpts_extraporder1_paramset1           = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_xixi_fixedpts_extraporder1_paramset1            = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_trace_fixedpts_extraporder1_paramset1           = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_massdensity_fixedpts_extraporder1_paramset1     = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx_fixedpts_extraporder1_paramset1  = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy_fixedpts_extraporder1_paramset1  = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz_fixedpts_extraporder1_paramset1  = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        bdyphi_fixedpts_extraporder1_paramset1                   = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));   
	                        xpbdy_fixedpts_extraporder1_paramset1               = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        ypbdy_fixedpts_extraporder1_paramset1               = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        zpbdy_fixedpts_extraporder1_paramset1               = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));  
	                       	x_outermostpt_fixedpts_extraporder1_paramset1            = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                       	y_outermostpt_fixedpts_extraporder1_paramset1            = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                       	z_outermostpt_fixedpts_extraporder1_paramset1            = malloc((numbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real)); 
	
	                        lquasiset_tt0_fixedpts_extraporder1_paramset1            = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_tchi0_fixedpts_extraporder1_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_txi0_fixedpts_extraporder1_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_chichi0_fixedpts_extraporder1_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_chixi0_fixedpts_extraporder1_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_xixi0_fixedpts_extraporder1_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_trace0_fixedpts_extraporder1_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_massdensity0_fixedpts_extraporder1_paramset1   = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1= malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1= malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1= malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        lbdyphi0_fixedpts_extraporder1_paramset1                 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));   
	                        maxquasiset_tt0_fixedpts_extraporder1_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_tchi0_fixedpts_extraporder1_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_txi0_fixedpts_extraporder1_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_chichi0_fixedpts_extraporder1_paramset1      = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_chixi0_fixedpts_extraporder1_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_xixi0_fixedpts_extraporder1_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_trace0_fixedpts_extraporder1_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_massdensity0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        maxbdyphi0_fixedpts_extraporder1_paramset1               = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));   
	                        minquasiset_tt0_fixedpts_extraporder1_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_tchi0_fixedpts_extraporder1_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_txi0_fixedpts_extraporder1_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_chichi0_fixedpts_extraporder1_paramset1      = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_chixi0_fixedpts_extraporder1_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_xixi0_fixedpts_extraporder1_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_trace0_fixedpts_extraporder1_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_massdensity0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        minbdyphi0_fixedpts_extraporder1_paramset1               = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));   
	                        quasiset_tt0_fixedpts_extraporder1_paramset1             = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_tchi0_fixedpts_extraporder1_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_txi0_fixedpts_extraporder1_paramset1            = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_chichi0_fixedpts_extraporder1_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_chixi0_fixedpts_extraporder1_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_xixi0_fixedpts_extraporder1_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_trace0_fixedpts_extraporder1_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_massdensity0_fixedpts_extraporder1_paramset1    = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        AdS_mass0_fixedpts_extraporder1_paramset1                = malloc(sizeof(real));
	                        bdyphi0_fixedpts_extraporder1_paramset1                  = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));    
	                        xpbdy0_fixedpts_extraporder1_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        ypbdy0_fixedpts_extraporder1_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                        zpbdy0_fixedpts_extraporder1_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));   
	                       	x_outermostpt0_fixedpts_extraporder1_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                       	y_outermostpt0_fixedpts_extraporder1_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                       	z_outermostpt0_fixedpts_extraporder1_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));   
	
	
	                        //initialize
	                        for (i=0;i<numbdypoints_fixedpts_extraporder1_paramset1;i++)
	                        {
	                            quasiset_tt_fixedpts_extraporder1_paramset1              [i] = 0;
	                            quasiset_tchi_fixedpts_extraporder1_paramset1            [i] = 0;
	                            quasiset_txi_fixedpts_extraporder1_paramset1             [i] = 0;
	                            quasiset_chichi_fixedpts_extraporder1_paramset1          [i] = 0;
	                            quasiset_chixi_fixedpts_extraporder1_paramset1           [i] = 0;
	                            quasiset_xixi_fixedpts_extraporder1_paramset1            [i] = 0;
	                            quasiset_trace_fixedpts_extraporder1_paramset1           [i] = 0;
	                            quasiset_massdensity_fixedpts_extraporder1_paramset1     [i] = 0;
	                            quasiset_angmomdensityx_fixedpts_extraporder1_paramset1  [i] = 0;
	                            quasiset_angmomdensityy_fixedpts_extraporder1_paramset1  [i] = 0;
	                            quasiset_angmomdensityz_fixedpts_extraporder1_paramset1  [i] = 0;
	                            bdyphi_fixedpts_extraporder1_paramset1                   [i] = 0;   
	                            xpbdy_fixedpts_extraporder1_paramset1               [i] = 0;
	                            ypbdy_fixedpts_extraporder1_paramset1               [i] = 0;
	                            zpbdy_fixedpts_extraporder1_paramset1               [i] = 0;
	                           	x_outermostpt_fixedpts_extraporder1_paramset1            [i] = 0;
	                           	y_outermostpt_fixedpts_extraporder1_paramset1            [i] = 0;
	                           	z_outermostpt_fixedpts_extraporder1_paramset1            [i] = 0;
	
	                        }   
	                        for (i=0;i<basenumbdypoints_fixedpts_extraporder1_paramset1;i++)
	                        {   
	                            lquasiset_tt0_fixedpts_extraporder1_paramset1            [i] = 0;
	                            lquasiset_tchi0_fixedpts_extraporder1_paramset1          [i] = 0;
	                            lquasiset_txi0_fixedpts_extraporder1_paramset1           [i] = 0;
	                            lquasiset_chichi0_fixedpts_extraporder1_paramset1        [i] = 0;
	                            lquasiset_chixi0_fixedpts_extraporder1_paramset1         [i] = 0;
	                            lquasiset_xixi0_fixedpts_extraporder1_paramset1          [i] = 0;
	                            lquasiset_trace0_fixedpts_extraporder1_paramset1         [i] = 0;
	                            lquasiset_massdensity0_fixedpts_extraporder1_paramset1   [i] = 0;
	                            lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1[i] = 0;
	                            lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1[i] = 0;
	                            lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1[i] = 0;
	                            lbdyphi0_fixedpts_extraporder1_paramset1                 [i] = 0;             
	                            maxquasiset_tt0_fixedpts_extraporder1_paramset1          [i] = 0;
	                            maxquasiset_tchi0_fixedpts_extraporder1_paramset1        [i] = 0;
	                            maxquasiset_txi0_fixedpts_extraporder1_paramset1         [i] = 0;
	                            maxquasiset_chichi0_fixedpts_extraporder1_paramset1      [i] = 0;
	                            maxquasiset_chixi0_fixedpts_extraporder1_paramset1       [i] = 0;
	                            maxquasiset_xixi0_fixedpts_extraporder1_paramset1        [i] = 0;
	                            maxquasiset_trace0_fixedpts_extraporder1_paramset1       [i] = 0;
	                            maxquasiset_massdensity0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            maxbdyphi0_fixedpts_extraporder1_paramset1               [i] = 0;  
	                            minquasiset_tt0_fixedpts_extraporder1_paramset1          [i] = 0;
	                            minquasiset_tchi0_fixedpts_extraporder1_paramset1        [i] = 0;
	                            minquasiset_txi0_fixedpts_extraporder1_paramset1         [i] = 0;
	                            minquasiset_chichi0_fixedpts_extraporder1_paramset1      [i] = 0;
	                            minquasiset_chixi0_fixedpts_extraporder1_paramset1       [i] = 0;
	                            minquasiset_xixi0_fixedpts_extraporder1_paramset1        [i] = 0;
	                            minquasiset_trace0_fixedpts_extraporder1_paramset1       [i] = 0;
	                            minquasiset_massdensity0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            minbdyphi0_fixedpts_extraporder1_paramset1               [i] = 0;  
	                            quasiset_tt0_fixedpts_extraporder1_paramset1             [i] = 0;
	                            quasiset_tchi0_fixedpts_extraporder1_paramset1           [i] = 0;
	                            quasiset_txi0_fixedpts_extraporder1_paramset1            [i] = 0;
	                            quasiset_chichi0_fixedpts_extraporder1_paramset1         [i] = 0;
	                            quasiset_chixi0_fixedpts_extraporder1_paramset1          [i] = 0;
	                            quasiset_xixi0_fixedpts_extraporder1_paramset1           [i] = 0;
	                            quasiset_trace0_fixedpts_extraporder1_paramset1          [i] = 0;
	                            quasiset_massdensity0_fixedpts_extraporder1_paramset1    [i] = 0;
	                            quasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            quasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            quasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i] = 0;
	                            bdyphi0_fixedpts_extraporder1_paramset1                  [i] = 0;   
	                            xpbdy0_fixedpts_extraporder1_paramset1              [i] = 0;
	                            ypbdy0_fixedpts_extraporder1_paramset1              [i] = 0;
	                            zpbdy0_fixedpts_extraporder1_paramset1              [i] = 0;  
	                           	x_outermostpt0_fixedpts_extraporder1_paramset1           [i] = 0;
	                           	y_outermostpt0_fixedpts_extraporder1_paramset1           [i] = 0;
	                           	z_outermostpt0_fixedpts_extraporder1_paramset1           [i] = 0;
	
	                        }
	                        *AdS_mass0_fixedpts_extraporder1_paramset1                    = 0; 
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_fixedpts_extraporder1_paramset1=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_fixedpts_extraporder1_paramset1=vecbdypoints_fixedpts_extraporder1_paramset1[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_fixedpts_extraporder1_paramset1=is_bdy_fixedpts_extraporder1_paramset1+vecbdypoints_fixedpts_extraporder1_paramset1[j];
	                            }
	                            ie_bdy_fixedpts_extraporder1_paramset1=is_bdy_fixedpts_extraporder1_paramset1+vecbdypoints_fixedpts_extraporder1_paramset1[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_fixedpts_extraporder1_paramset1[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_fixedpts_extraporder1_paramset1[i]=dsplsbdypoints_fixedpts_extraporder1_paramset1[i]+vecbdypoints_fixedpts_extraporder1_paramset1[j];
	                                }
	                            }
	                        }   
	
	                        xyz_extrap_outermost_(xpbdy_fixedpts_extraporder1_paramset1,ypbdy_fixedpts_extraporder1_paramset1,zpbdy_fixedpts_extraporder1_paramset1,
	                        						x_outermostpt_fixedpts_extraporder1_paramset1,y_outermostpt_fixedpts_extraporder1_paramset1,z_outermostpt_fixedpts_extraporder1_paramset1,
	                        						chrbdy_fixedpts_extraporder1_paramset1,&numbdypoints_fixedpts_extraporder1_paramset1,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_fixedpts_extraporder1_paramset1,numbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,xpbdy0_fixedpts_extraporder1_paramset1,vecbdypoints_fixedpts_extraporder1_paramset1,dsplsbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_fixedpts_extraporder1_paramset1,numbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,ypbdy0_fixedpts_extraporder1_paramset1,vecbdypoints_fixedpts_extraporder1_paramset1,dsplsbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_fixedpts_extraporder1_paramset1,numbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,zpbdy0_fixedpts_extraporder1_paramset1,vecbdypoints_fixedpts_extraporder1_paramset1,dsplsbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_fixedpts_extraporder1_paramset1,numbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,x_outermostpt0_fixedpts_extraporder1_paramset1,vecbdypoints_fixedpts_extraporder1_paramset1,dsplsbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_fixedpts_extraporder1_paramset1,numbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,y_outermostpt0_fixedpts_extraporder1_paramset1,vecbdypoints_fixedpts_extraporder1_paramset1,dsplsbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_fixedpts_extraporder1_paramset1,numbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,z_outermostpt0_fixedpts_extraporder1_paramset1,vecbdypoints_fixedpts_extraporder1_paramset1,dsplsbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_fixedpts_extraporder1_paramset1 = malloc(sizeof(real));
	                                chiextrap0_fixedpts_extraporder1_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real));
	                                xiextrap0_fixedpts_extraporder1_paramset1  = malloc((basenumbdypoints_fixedpts_extraporder1_paramset1)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_fixedpts_extraporder1_paramset1,chiextrap0_fixedpts_extraporder1_paramset1,xiextrap0_fixedpts_extraporder1_paramset1,xpbdy0_fixedpts_extraporder1_paramset1,ypbdy0_fixedpts_extraporder1_paramset1,zpbdy0_fixedpts_extraporder1_paramset1,&basenumbdypoints_fixedpts_extraporder1_paramset1);  
	                                basebdy_Nchi_fixedpts_extraporder1_paramset1=0;//initialize
	                                basebdy_Nxi_fixedpts_extraporder1_paramset1=0; //initialize
	                                bdyn_(&basebdy_Nchi_fixedpts_extraporder1_paramset1,&basebdy_Nxi_fixedpts_extraporder1_paramset1,&basenumbdypoints_fixedpts_extraporder1_paramset1,chiextrap0_fixedpts_extraporder1_paramset1,xiextrap0_fixedpts_extraporder1_paramset1);  
	                                rhobdy0_fixedpts_extraporder1_paramset1 = malloc(sizeof(real));
	                                chibdy0_fixedpts_extraporder1_paramset1 = malloc(basebdy_Nchi_fixedpts_extraporder1_paramset1*sizeof(real));
	                                xibdy0_fixedpts_extraporder1_paramset1  = malloc(basebdy_Nxi_fixedpts_extraporder1_paramset1*sizeof(real));   
	                            }
	                        }
	
	
	                        extrap_bdyphi_fixedpts_(bdyphi_fixedpts_extraporder1_paramset1,
	                                        leadordcoeff_phi1,
	                                        xpbdy_fixedpts_extraporder1_paramset1,ypbdy_fixedpts_extraporder1_paramset1,zpbdy_fixedpts_extraporder1_paramset1,
	                                        chrbdy_fixedpts_extraporder1_paramset1,&numbdypoints_fixedpts_extraporder1_paramset1,
	                                        &bdy_extrap_order,
	                                        &ind_distance_fixedpts,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);   

	                        extrap_quasiset_fixedpts_(quasiset_tt_fixedpts_extraporder1_paramset1,quasiset_tchi_fixedpts_extraporder1_paramset1,quasiset_txi_fixedpts_extraporder1_paramset1,
	                                quasiset_chichi_fixedpts_extraporder1_paramset1,quasiset_chixi_fixedpts_extraporder1_paramset1,
	                                quasiset_xixi_fixedpts_extraporder1_paramset1,
	                                quasiset_trace_fixedpts_extraporder1_paramset1,
	                                quasiset_massdensity_fixedpts_extraporder1_paramset1,
	                                quasiset_angmomdensityx_fixedpts_extraporder1_paramset1,
	                                quasiset_angmomdensityy_fixedpts_extraporder1_paramset1,
	                                quasiset_angmomdensityz_fixedpts_extraporder1_paramset1,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_fixedpts_extraporder1_paramset1,ypbdy_fixedpts_extraporder1_paramset1,zpbdy_fixedpts_extraporder1_paramset1,
	                                chrbdy_fixedpts_extraporder1_paramset1,&numbdypoints_fixedpts_extraporder1_paramset1,
	                                &bdy_extrap_order,
	                                &ind_distance_fixedpts,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);  

	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_fixedpts_extraporder1_paramset1; i<ie_bdy_fixedpts_extraporder1_paramset1; i++)
	                        {
	                            lquasiset_tt0_fixedpts_extraporder1_paramset1           [i] = quasiset_tt_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_tchi0_fixedpts_extraporder1_paramset1         [i] = quasiset_tchi_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_txi0_fixedpts_extraporder1_paramset1          [i] = quasiset_txi_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_chichi0_fixedpts_extraporder1_paramset1       [i] = quasiset_chichi_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_chixi0_fixedpts_extraporder1_paramset1        [i] = quasiset_chixi_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_xixi0_fixedpts_extraporder1_paramset1         [i] = quasiset_xixi_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_trace0_fixedpts_extraporder1_paramset1        [i] = quasiset_trace_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_massdensity0_fixedpts_extraporder1_paramset1  [i] = quasiset_massdensity_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i] = quasiset_angmomdensityx_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i] = quasiset_angmomdensityy_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i] = quasiset_angmomdensityz_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                            lbdyphi0_fixedpts_extraporder1_paramset1                [i] = bdyphi_fixedpts_extraporder1_paramset1[i-is_bdy_fixedpts_extraporder1_paramset1];
	                        }   

	                        //PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder1_paramset1,          maxquasiset_tt0_fixedpts_extraporder1_paramset1,          basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder1_paramset1,        maxquasiset_tchi0_fixedpts_extraporder1_paramset1,        basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder1_paramset1,         maxquasiset_txi0_fixedpts_extraporder1_paramset1,         basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder1_paramset1,      maxquasiset_chichi0_fixedpts_extraporder1_paramset1,      basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder1_paramset1,       maxquasiset_chixi0_fixedpts_extraporder1_paramset1,       basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder1_paramset1,        maxquasiset_xixi0_fixedpts_extraporder1_paramset1,        basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder1_paramset1,       maxquasiset_trace0_fixedpts_extraporder1_paramset1,       basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder1_paramset1, maxquasiset_massdensity0_fixedpts_extraporder1_paramset1, basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1, maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1, basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1, maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1, basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1, maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1, basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder1_paramset1,               maxbdyphi0_fixedpts_extraporder1_paramset1,               basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder1_paramset1,          minquasiset_tt0_fixedpts_extraporder1_paramset1,          basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder1_paramset1,        minquasiset_tchi0_fixedpts_extraporder1_paramset1,        basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder1_paramset1,         minquasiset_txi0_fixedpts_extraporder1_paramset1,         basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder1_paramset1,      minquasiset_chichi0_fixedpts_extraporder1_paramset1,      basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder1_paramset1,       minquasiset_chixi0_fixedpts_extraporder1_paramset1,       basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder1_paramset1,        minquasiset_xixi0_fixedpts_extraporder1_paramset1,        basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder1_paramset1,       minquasiset_trace0_fixedpts_extraporder1_paramset1,       basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder1_paramset1, minquasiset_massdensity0_fixedpts_extraporder1_paramset1, basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1, minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1, basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1, minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1, basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1, minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1, basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder1_paramset1,               minbdyphi0_fixedpts_extraporder1_paramset1,               basenumbdypoints_fixedpts_extraporder1_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_fixedpts_extraporder1_paramset1; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_fixedpts_extraporder1_paramset1          [i] = maxquasiset_tt0_fixedpts_extraporder1_paramset1          [i] + minquasiset_tt0_fixedpts_extraporder1_paramset1          [i];
	                                    quasiset_tchi0_fixedpts_extraporder1_paramset1        [i] = maxquasiset_tchi0_fixedpts_extraporder1_paramset1        [i] + minquasiset_tchi0_fixedpts_extraporder1_paramset1        [i];
	                                    quasiset_txi0_fixedpts_extraporder1_paramset1         [i] = maxquasiset_txi0_fixedpts_extraporder1_paramset1         [i] + minquasiset_txi0_fixedpts_extraporder1_paramset1         [i];
	                                    quasiset_chichi0_fixedpts_extraporder1_paramset1      [i] = maxquasiset_chichi0_fixedpts_extraporder1_paramset1      [i] + minquasiset_chichi0_fixedpts_extraporder1_paramset1      [i];
	                                    quasiset_chixi0_fixedpts_extraporder1_paramset1       [i] = maxquasiset_chixi0_fixedpts_extraporder1_paramset1       [i] + minquasiset_chixi0_fixedpts_extraporder1_paramset1       [i];
	                                    quasiset_xixi0_fixedpts_extraporder1_paramset1        [i] = maxquasiset_xixi0_fixedpts_extraporder1_paramset1        [i] + minquasiset_xixi0_fixedpts_extraporder1_paramset1        [i];
	                                    quasiset_trace0_fixedpts_extraporder1_paramset1       [i] = maxquasiset_trace0_fixedpts_extraporder1_paramset1       [i] + minquasiset_trace0_fixedpts_extraporder1_paramset1       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder1_paramset1 [i] = maxquasiset_massdensity0_fixedpts_extraporder1_paramset1 [i] + minquasiset_massdensity0_fixedpts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i] + minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i] + minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i] + minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i];
	                                    bdyphi0_fixedpts_extraporder1_paramset1               [i] = maxbdyphi0_fixedpts_extraporder1_paramset1               [i] + minbdyphi0_fixedpts_extraporder1_paramset1               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_fixedpts_extraporder1_paramset1          [i] = maxquasiset_tt0_fixedpts_extraporder1_paramset1          [i];
	                                    quasiset_tchi0_fixedpts_extraporder1_paramset1        [i] = maxquasiset_tchi0_fixedpts_extraporder1_paramset1        [i];
	                                    quasiset_txi0_fixedpts_extraporder1_paramset1         [i] = maxquasiset_txi0_fixedpts_extraporder1_paramset1         [i];
	                                    quasiset_chichi0_fixedpts_extraporder1_paramset1      [i] = maxquasiset_chichi0_fixedpts_extraporder1_paramset1      [i];
	                                    quasiset_chixi0_fixedpts_extraporder1_paramset1       [i] = maxquasiset_chixi0_fixedpts_extraporder1_paramset1       [i];
	                                    quasiset_xixi0_fixedpts_extraporder1_paramset1        [i] = maxquasiset_xixi0_fixedpts_extraporder1_paramset1        [i];
	                                    quasiset_trace0_fixedpts_extraporder1_paramset1       [i] = maxquasiset_trace0_fixedpts_extraporder1_paramset1       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder1_paramset1 [i] = maxquasiset_massdensity0_fixedpts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1 [i];
	                                    bdyphi0_fixedpts_extraporder1_paramset1               [i] = maxbdyphi0_fixedpts_extraporder1_paramset1               [i];
	                                }  
	                        }       
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {
	                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    								name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder1_paramset1[j],ypbdy0_fixedpts_extraporder1_paramset1[j],zpbdy0_fixedpts_extraporder1_paramset1[j],j);
                                    }
                                    fclose(fp);
                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder1_paramset1[j],ypbdy0_fixedpts_extraporder1_paramset1[j],zpbdy0_fixedpts_extraporder1_paramset1[j],j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }   
	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder1_paramset1[j],y_outermostpt0_fixedpts_extraporder1_paramset1[j],z_outermostpt0_fixedpts_extraporder1_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder1_paramset1[j],y_outermostpt0_fixedpts_extraporder1_paramset1[j],z_outermostpt0_fixedpts_extraporder1_paramset1[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name); 
	                                	}   
	                                }
	                                if(output_bdyphi)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
                                    	sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder1_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder1_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                } 
	                                }    

                                    // save quasiset_ll as ascii
                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   									name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
                                                    ct,
                                                    quasiset_tt0_fixedpts_extraporder1_paramset1[j],quasiset_tchi0_fixedpts_extraporder1_paramset1[j],quasiset_txi0_fixedpts_extraporder1_paramset1[j],quasiset_chichi0_fixedpts_extraporder1_paramset1[j],quasiset_chixi0_fixedpts_extraporder1_paramset1[j],quasiset_xixi0_fixedpts_extraporder1_paramset1[j],
                                                    j);
                                    }
                                    fclose(fp);
                                    free(name);  
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_fixedpts_extraporder1_paramset1[j],quasiset_tchi0_fixedpts_extraporder1_paramset1[j],quasiset_txi0_fixedpts_extraporder1_paramset1[j],quasiset_chichi0_fixedpts_extraporder1_paramset1[j],quasiset_chixi0_fixedpts_extraporder1_paramset1[j],quasiset_xixi0_fixedpts_extraporder1_paramset1[j],
	                                                    j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }
	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_fixedpts_extraporder1_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_fixedpts_extraporder1_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_fixedpts_extraporder1_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_fixedpts_extraporder1_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {
		                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
		                            	sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_angmomdensityx0_fixedpts_extraporder1_paramset1[j],quasiset_angmomdensityy0_fixedpts_extraporder1_paramset1[j],quasiset_angmomdensityz0_fixedpts_extraporder1_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);   
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_fixedpts_extraporder1_paramset1[j],quasiset_angmomdensityy0_fixedpts_extraporder1_paramset1[j],quasiset_angmomdensityz0_fixedpts_extraporder1_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_fixedpts_extraporder1_paramset1=1;
	                                chibdy_xibdy_(chibdy0_fixedpts_extraporder1_paramset1,xibdy0_fixedpts_extraporder1_paramset1,xpbdy0_fixedpts_extraporder1_paramset1,ypbdy0_fixedpts_extraporder1_paramset1,zpbdy0_fixedpts_extraporder1_paramset1,&basenumbdypoints_fixedpts_extraporder1_paramset1,chiextrap0_fixedpts_extraporder1_paramset1,xiextrap0_fixedpts_extraporder1_paramset1,&basebdy_Nchi_fixedpts_extraporder1_paramset1,&basebdy_Nxi_fixedpts_extraporder1_paramset1);    
	                                doubleintegralonsphere_(AdS_mass0_fixedpts_extraporder1_paramset1,quasiset_massdensity0_fixedpts_extraporder1_paramset1,xpbdy0_fixedpts_extraporder1_paramset1,ypbdy0_fixedpts_extraporder1_paramset1,zpbdy0_fixedpts_extraporder1_paramset1,&basenumbdypoints_fixedpts_extraporder1_paramset1,rhobdy0_fixedpts_extraporder1_paramset1,chibdy0_fixedpts_extraporder1_paramset1,xibdy0_fixedpts_extraporder1_paramset1,&basebdy_Nchi_fixedpts_extraporder1_paramset1,&basebdy_Nxi_fixedpts_extraporder1_paramset1);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset1_%st_AdSmass.txt",AMRD_save_tag) + 1;
   									name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset1_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_fixedpts_extraporder1_paramset1);
	                                fclose(fp);
	                                free(name); 
	                            }
	                        }      

	                        free(vecbdypoints_fixedpts_extraporder1_paramset1);
	                        free(dsplsbdypoints_fixedpts_extraporder1_paramset1);
	                        free(quasiset_tt_fixedpts_extraporder1_paramset1);
	                        free(quasiset_tchi_fixedpts_extraporder1_paramset1);
	                        free(quasiset_txi_fixedpts_extraporder1_paramset1);
	                        free(quasiset_chichi_fixedpts_extraporder1_paramset1);
	                        free(quasiset_chixi_fixedpts_extraporder1_paramset1);
	                        free(quasiset_xixi_fixedpts_extraporder1_paramset1);
	                        free(quasiset_trace_fixedpts_extraporder1_paramset1);
	                        free(quasiset_massdensity_fixedpts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityx_fixedpts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityy_fixedpts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityz_fixedpts_extraporder1_paramset1);
	                        free(bdyphi_fixedpts_extraporder1_paramset1);  
	                        free(xpbdy_fixedpts_extraporder1_paramset1);
	                        free(ypbdy_fixedpts_extraporder1_paramset1);
	                        free(zpbdy_fixedpts_extraporder1_paramset1);   
	                        free(x_outermostpt_fixedpts_extraporder1_paramset1);
	                        free(y_outermostpt_fixedpts_extraporder1_paramset1);
	                        free(z_outermostpt_fixedpts_extraporder1_paramset1);   
	
	                        free(lquasiset_tt0_fixedpts_extraporder1_paramset1);        
	                        free(lquasiset_tchi0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_txi0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_chichi0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_chixi0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_xixi0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_trace0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_massdensity0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1);
	                        free(lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1);
	                        free(lbdyphi0_fixedpts_extraporder1_paramset1);      
	                        free(maxquasiset_tt0_fixedpts_extraporder1_paramset1);        
	                        free(maxquasiset_tchi0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_txi0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_chichi0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_chixi0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_xixi0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_trace0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_massdensity0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1);
	                        free(maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1);
	                        free(maxbdyphi0_fixedpts_extraporder1_paramset1);    
	                        free(minquasiset_tt0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_tchi0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_txi0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_chichi0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_chixi0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_xixi0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_trace0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_massdensity0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset1);
	                        free(minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset1);
	                        free(minbdyphi0_fixedpts_extraporder1_paramset1);    
	                        free(quasiset_tt0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_tchi0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_txi0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_chichi0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_chixi0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_xixi0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_trace0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_massdensity0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityx0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityy0_fixedpts_extraporder1_paramset1);
	                        free(quasiset_angmomdensityz0_fixedpts_extraporder1_paramset1);
	                        free(bdyphi0_fixedpts_extraporder1_paramset1);
	                        free(AdS_mass0_fixedpts_extraporder1_paramset1);     
	                        free(xpbdy0_fixedpts_extraporder1_paramset1);
	                        free(ypbdy0_fixedpts_extraporder1_paramset1);
	                        free(zpbdy0_fixedpts_extraporder1_paramset1);
	                        free(x_outermostpt0_fixedpts_extraporder1_paramset1);
	                        free(y_outermostpt0_fixedpts_extraporder1_paramset1);
	                        free(z_outermostpt0_fixedpts_extraporder1_paramset1);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_fixedpts_extraporder1_paramset1);
	                            free(chiextrap0_fixedpts_extraporder1_paramset1);
	                            free(xiextrap0_fixedpts_extraporder1_paramset1);             
	                            free(rhobdy0_fixedpts_extraporder1_paramset1);
	                            free(chibdy0_fixedpts_extraporder1_paramset1);
	                            free(xibdy0_fixedpts_extraporder1_paramset1);    
	                        }   
                		}//closes condition on output_bdy_extraporder1_paramset1

		            	//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_fixedpts 1st order extrap paramset1\n"); fflush(stdout);}

	            		//SECOND ORDER EXTRAPOLATION
						if (output_bdy_extraporder2_paramset1)
            			{
                			bdy_extrap_order=2;

                			//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
	                        nexttobdypoints_fixedpts_(chrbdy_fixedpts_extraporder2_paramset1,&numbdypoints_fixedpts_extraporder2_paramset1,&bdy_extrap_order,&ind_distance_fixedpts,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset1,&half_steps_from_bdy_int_paramset1,&num_fixed_coords,fixed_coords,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);

	                    	//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_fixedpts_extraporder2_paramset1 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_fixedpts_extraporder2_paramset1 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_fixedpts_extraporder2_paramset1,1,MPI_INT,vecbdypoints_fixedpts_extraporder2_paramset1,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_fixedpts_extraporder2_paramset1,&basenumbdypoints_fixedpts_extraporder2_paramset1,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_fixedpts_extraporder2_paramset1=%i\n",numbdypoints_fixedpts_extraporder2_paramset1);
	                        //fflush(stdout); 
	                        quasiset_tt_fixedpts_extraporder2_paramset1              = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_tchi_fixedpts_extraporder2_paramset1            = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_txi_fixedpts_extraporder2_paramset1             = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_chichi_fixedpts_extraporder2_paramset1          = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_chixi_fixedpts_extraporder2_paramset1           = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_xixi_fixedpts_extraporder2_paramset1            = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_trace_fixedpts_extraporder2_paramset1           = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_massdensity_fixedpts_extraporder2_paramset1     = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx_fixedpts_extraporder2_paramset1  = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy_fixedpts_extraporder2_paramset1  = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz_fixedpts_extraporder2_paramset1  = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        bdyphi_fixedpts_extraporder2_paramset1                   = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));   
	                        xpbdy_fixedpts_extraporder2_paramset1               = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        ypbdy_fixedpts_extraporder2_paramset1               = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        zpbdy_fixedpts_extraporder2_paramset1               = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));  
	                       	x_outermostpt_fixedpts_extraporder2_paramset1            = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                       	y_outermostpt_fixedpts_extraporder2_paramset1            = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                       	z_outermostpt_fixedpts_extraporder2_paramset1            = malloc((numbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real)); 
	
	                        lquasiset_tt0_fixedpts_extraporder2_paramset1            = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_tchi0_fixedpts_extraporder2_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_txi0_fixedpts_extraporder2_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_chichi0_fixedpts_extraporder2_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_chixi0_fixedpts_extraporder2_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_xixi0_fixedpts_extraporder2_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_trace0_fixedpts_extraporder2_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_massdensity0_fixedpts_extraporder2_paramset1   = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1= malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1= malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1= malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        lbdyphi0_fixedpts_extraporder2_paramset1                 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));   
	                        maxquasiset_tt0_fixedpts_extraporder2_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_tchi0_fixedpts_extraporder2_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_txi0_fixedpts_extraporder2_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_chichi0_fixedpts_extraporder2_paramset1      = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_chixi0_fixedpts_extraporder2_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_xixi0_fixedpts_extraporder2_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_trace0_fixedpts_extraporder2_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_massdensity0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        maxbdyphi0_fixedpts_extraporder2_paramset1               = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));   
	                        minquasiset_tt0_fixedpts_extraporder2_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_tchi0_fixedpts_extraporder2_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_txi0_fixedpts_extraporder2_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_chichi0_fixedpts_extraporder2_paramset1      = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_chixi0_fixedpts_extraporder2_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_xixi0_fixedpts_extraporder2_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_trace0_fixedpts_extraporder2_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_massdensity0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        minbdyphi0_fixedpts_extraporder2_paramset1               = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));   
	                        quasiset_tt0_fixedpts_extraporder2_paramset1             = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_tchi0_fixedpts_extraporder2_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_txi0_fixedpts_extraporder2_paramset1            = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_chichi0_fixedpts_extraporder2_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_chixi0_fixedpts_extraporder2_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_xixi0_fixedpts_extraporder2_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_trace0_fixedpts_extraporder2_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_massdensity0_fixedpts_extraporder2_paramset1    = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        AdS_mass0_fixedpts_extraporder2_paramset1                = malloc(sizeof(real));
	                        bdyphi0_fixedpts_extraporder2_paramset1                  = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));    
	                        xpbdy0_fixedpts_extraporder2_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        ypbdy0_fixedpts_extraporder2_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                        zpbdy0_fixedpts_extraporder2_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));   
	                       	x_outermostpt0_fixedpts_extraporder2_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                       	y_outermostpt0_fixedpts_extraporder2_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                       	z_outermostpt0_fixedpts_extraporder2_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));   
	
	
	                        //initialize
	                        for (i=0;i<numbdypoints_fixedpts_extraporder2_paramset1;i++)
	                        {
	                            quasiset_tt_fixedpts_extraporder2_paramset1              [i] = 0;
	                            quasiset_tchi_fixedpts_extraporder2_paramset1            [i] = 0;
	                            quasiset_txi_fixedpts_extraporder2_paramset1             [i] = 0;
	                            quasiset_chichi_fixedpts_extraporder2_paramset1          [i] = 0;
	                            quasiset_chixi_fixedpts_extraporder2_paramset1           [i] = 0;
	                            quasiset_xixi_fixedpts_extraporder2_paramset1            [i] = 0;
	                            quasiset_trace_fixedpts_extraporder2_paramset1           [i] = 0;
	                            quasiset_massdensity_fixedpts_extraporder2_paramset1     [i] = 0;
	                            quasiset_angmomdensityx_fixedpts_extraporder2_paramset1  [i] = 0;
	                            quasiset_angmomdensityy_fixedpts_extraporder2_paramset1  [i] = 0;
	                            quasiset_angmomdensityz_fixedpts_extraporder2_paramset1  [i] = 0;
	                            bdyphi_fixedpts_extraporder2_paramset1                   [i] = 0;   
	                            xpbdy_fixedpts_extraporder2_paramset1               [i] = 0;
	                            ypbdy_fixedpts_extraporder2_paramset1               [i] = 0;
	                            zpbdy_fixedpts_extraporder2_paramset1               [i] = 0;
	                           	x_outermostpt_fixedpts_extraporder2_paramset1            [i] = 0;
	                           	y_outermostpt_fixedpts_extraporder2_paramset1            [i] = 0;
	                           	z_outermostpt_fixedpts_extraporder2_paramset1            [i] = 0;
	
	                        }   
	                        for (i=0;i<basenumbdypoints_fixedpts_extraporder2_paramset1;i++)
	                        {   
	                            lquasiset_tt0_fixedpts_extraporder2_paramset1            [i] = 0;
	                            lquasiset_tchi0_fixedpts_extraporder2_paramset1          [i] = 0;
	                            lquasiset_txi0_fixedpts_extraporder2_paramset1           [i] = 0;
	                            lquasiset_chichi0_fixedpts_extraporder2_paramset1        [i] = 0;
	                            lquasiset_chixi0_fixedpts_extraporder2_paramset1         [i] = 0;
	                            lquasiset_xixi0_fixedpts_extraporder2_paramset1          [i] = 0;
	                            lquasiset_trace0_fixedpts_extraporder2_paramset1         [i] = 0;
	                            lquasiset_massdensity0_fixedpts_extraporder2_paramset1   [i] = 0;
	                            lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1[i] = 0;
	                            lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1[i] = 0;
	                            lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1[i] = 0;
	                            lbdyphi0_fixedpts_extraporder2_paramset1                 [i] = 0;             
	                            maxquasiset_tt0_fixedpts_extraporder2_paramset1          [i] = 0;
	                            maxquasiset_tchi0_fixedpts_extraporder2_paramset1        [i] = 0;
	                            maxquasiset_txi0_fixedpts_extraporder2_paramset1         [i] = 0;
	                            maxquasiset_chichi0_fixedpts_extraporder2_paramset1      [i] = 0;
	                            maxquasiset_chixi0_fixedpts_extraporder2_paramset1       [i] = 0;
	                            maxquasiset_xixi0_fixedpts_extraporder2_paramset1        [i] = 0;
	                            maxquasiset_trace0_fixedpts_extraporder2_paramset1       [i] = 0;
	                            maxquasiset_massdensity0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            maxbdyphi0_fixedpts_extraporder2_paramset1               [i] = 0;  
	                            minquasiset_tt0_fixedpts_extraporder2_paramset1          [i] = 0;
	                            minquasiset_tchi0_fixedpts_extraporder2_paramset1        [i] = 0;
	                            minquasiset_txi0_fixedpts_extraporder2_paramset1         [i] = 0;
	                            minquasiset_chichi0_fixedpts_extraporder2_paramset1      [i] = 0;
	                            minquasiset_chixi0_fixedpts_extraporder2_paramset1       [i] = 0;
	                            minquasiset_xixi0_fixedpts_extraporder2_paramset1        [i] = 0;
	                            minquasiset_trace0_fixedpts_extraporder2_paramset1       [i] = 0;
	                            minquasiset_massdensity0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            minbdyphi0_fixedpts_extraporder2_paramset1               [i] = 0;  
	                            quasiset_tt0_fixedpts_extraporder2_paramset1             [i] = 0;
	                            quasiset_tchi0_fixedpts_extraporder2_paramset1           [i] = 0;
	                            quasiset_txi0_fixedpts_extraporder2_paramset1            [i] = 0;
	                            quasiset_chichi0_fixedpts_extraporder2_paramset1         [i] = 0;
	                            quasiset_chixi0_fixedpts_extraporder2_paramset1          [i] = 0;
	                            quasiset_xixi0_fixedpts_extraporder2_paramset1           [i] = 0;
	                            quasiset_trace0_fixedpts_extraporder2_paramset1          [i] = 0;
	                            quasiset_massdensity0_fixedpts_extraporder2_paramset1    [i] = 0;
	                            quasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            quasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            quasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i] = 0;
	                            bdyphi0_fixedpts_extraporder2_paramset1                  [i] = 0;   
	                            xpbdy0_fixedpts_extraporder2_paramset1              [i] = 0;
	                            ypbdy0_fixedpts_extraporder2_paramset1              [i] = 0;
	                            zpbdy0_fixedpts_extraporder2_paramset1              [i] = 0;  
	                           	x_outermostpt0_fixedpts_extraporder2_paramset1           [i] = 0;
	                           	y_outermostpt0_fixedpts_extraporder2_paramset1           [i] = 0;
	                           	z_outermostpt0_fixedpts_extraporder2_paramset1           [i] = 0;
	
	                        }
	                        *AdS_mass0_fixedpts_extraporder2_paramset1                    = 0; 
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_fixedpts_extraporder2_paramset1=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_fixedpts_extraporder2_paramset1=vecbdypoints_fixedpts_extraporder2_paramset1[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_fixedpts_extraporder2_paramset1=is_bdy_fixedpts_extraporder2_paramset1+vecbdypoints_fixedpts_extraporder2_paramset1[j];
	                            }
	                            ie_bdy_fixedpts_extraporder2_paramset1=is_bdy_fixedpts_extraporder2_paramset1+vecbdypoints_fixedpts_extraporder2_paramset1[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_fixedpts_extraporder2_paramset1[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_fixedpts_extraporder2_paramset1[i]=dsplsbdypoints_fixedpts_extraporder2_paramset1[i]+vecbdypoints_fixedpts_extraporder2_paramset1[j];
	                                }
	                            }
	                        }   
	
	                        xyz_extrap_outermost_(xpbdy_fixedpts_extraporder2_paramset1,ypbdy_fixedpts_extraporder2_paramset1,zpbdy_fixedpts_extraporder2_paramset1,
	                        						x_outermostpt_fixedpts_extraporder2_paramset1,y_outermostpt_fixedpts_extraporder2_paramset1,z_outermostpt_fixedpts_extraporder2_paramset1,
	                        						chrbdy_fixedpts_extraporder2_paramset1,&numbdypoints_fixedpts_extraporder2_paramset1,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_fixedpts_extraporder2_paramset1,numbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,xpbdy0_fixedpts_extraporder2_paramset1,vecbdypoints_fixedpts_extraporder2_paramset1,dsplsbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_fixedpts_extraporder2_paramset1,numbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,ypbdy0_fixedpts_extraporder2_paramset1,vecbdypoints_fixedpts_extraporder2_paramset1,dsplsbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_fixedpts_extraporder2_paramset1,numbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,zpbdy0_fixedpts_extraporder2_paramset1,vecbdypoints_fixedpts_extraporder2_paramset1,dsplsbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_fixedpts_extraporder2_paramset1,numbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,x_outermostpt0_fixedpts_extraporder2_paramset1,vecbdypoints_fixedpts_extraporder2_paramset1,dsplsbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_fixedpts_extraporder2_paramset1,numbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,y_outermostpt0_fixedpts_extraporder2_paramset1,vecbdypoints_fixedpts_extraporder2_paramset1,dsplsbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_fixedpts_extraporder2_paramset1,numbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,z_outermostpt0_fixedpts_extraporder2_paramset1,vecbdypoints_fixedpts_extraporder2_paramset1,dsplsbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_fixedpts_extraporder2_paramset1 = malloc(sizeof(real));
	                                chiextrap0_fixedpts_extraporder2_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real));
	                                xiextrap0_fixedpts_extraporder2_paramset1  = malloc((basenumbdypoints_fixedpts_extraporder2_paramset1)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_fixedpts_extraporder2_paramset1,chiextrap0_fixedpts_extraporder2_paramset1,xiextrap0_fixedpts_extraporder2_paramset1,xpbdy0_fixedpts_extraporder2_paramset1,ypbdy0_fixedpts_extraporder2_paramset1,zpbdy0_fixedpts_extraporder2_paramset1,&basenumbdypoints_fixedpts_extraporder2_paramset1);  
	                                basebdy_Nchi_fixedpts_extraporder2_paramset1=0;//initialize
	                                basebdy_Nxi_fixedpts_extraporder2_paramset1=0; //initialize
	                                bdyn_(&basebdy_Nchi_fixedpts_extraporder2_paramset1,&basebdy_Nxi_fixedpts_extraporder2_paramset1,&basenumbdypoints_fixedpts_extraporder2_paramset1,chiextrap0_fixedpts_extraporder2_paramset1,xiextrap0_fixedpts_extraporder2_paramset1);  
	                                rhobdy0_fixedpts_extraporder2_paramset1 = malloc(sizeof(real));
	                                chibdy0_fixedpts_extraporder2_paramset1 = malloc(basebdy_Nchi_fixedpts_extraporder2_paramset1*sizeof(real));
	                                xibdy0_fixedpts_extraporder2_paramset1  = malloc(basebdy_Nxi_fixedpts_extraporder2_paramset1*sizeof(real));   
	                            }
	                        }
	
	
	                        extrap_bdyphi_fixedpts_(bdyphi_fixedpts_extraporder2_paramset1,
	                                        leadordcoeff_phi1,
	                                        xpbdy_fixedpts_extraporder2_paramset1,ypbdy_fixedpts_extraporder2_paramset1,zpbdy_fixedpts_extraporder2_paramset1,
	                                        chrbdy_fixedpts_extraporder2_paramset1,&numbdypoints_fixedpts_extraporder2_paramset1,
	                                        &bdy_extrap_order,
	                                        &ind_distance_fixedpts,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        extrap_quasiset_fixedpts_(quasiset_tt_fixedpts_extraporder2_paramset1,quasiset_tchi_fixedpts_extraporder2_paramset1,quasiset_txi_fixedpts_extraporder2_paramset1,
	                                quasiset_chichi_fixedpts_extraporder2_paramset1,quasiset_chixi_fixedpts_extraporder2_paramset1,
	                                quasiset_xixi_fixedpts_extraporder2_paramset1,
	                                quasiset_trace_fixedpts_extraporder2_paramset1,
	                                quasiset_massdensity_fixedpts_extraporder2_paramset1,
	                                quasiset_angmomdensityx_fixedpts_extraporder2_paramset1,
	                                quasiset_angmomdensityy_fixedpts_extraporder2_paramset1,
	                                quasiset_angmomdensityz_fixedpts_extraporder2_paramset1,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_fixedpts_extraporder2_paramset1,ypbdy_fixedpts_extraporder2_paramset1,zpbdy_fixedpts_extraporder2_paramset1,
	                                chrbdy_fixedpts_extraporder2_paramset1,&numbdypoints_fixedpts_extraporder2_paramset1,
	                                &bdy_extrap_order,
	                                &ind_distance_fixedpts,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_fixedpts_extraporder2_paramset1; i<ie_bdy_fixedpts_extraporder2_paramset1; i++)
	                        {
	                            lquasiset_tt0_fixedpts_extraporder2_paramset1           [i] = quasiset_tt_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_tchi0_fixedpts_extraporder2_paramset1         [i] = quasiset_tchi_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_txi0_fixedpts_extraporder2_paramset1          [i] = quasiset_txi_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_chichi0_fixedpts_extraporder2_paramset1       [i] = quasiset_chichi_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_chixi0_fixedpts_extraporder2_paramset1        [i] = quasiset_chixi_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_xixi0_fixedpts_extraporder2_paramset1         [i] = quasiset_xixi_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_trace0_fixedpts_extraporder2_paramset1        [i] = quasiset_trace_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_massdensity0_fixedpts_extraporder2_paramset1  [i] = quasiset_massdensity_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i] = quasiset_angmomdensityx_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i] = quasiset_angmomdensityy_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i] = quasiset_angmomdensityz_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                            lbdyphi0_fixedpts_extraporder2_paramset1                [i] = bdyphi_fixedpts_extraporder2_paramset1[i-is_bdy_fixedpts_extraporder2_paramset1];
	                        }   

	                        //PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder2_paramset1,          maxquasiset_tt0_fixedpts_extraporder2_paramset1,          basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder2_paramset1,        maxquasiset_tchi0_fixedpts_extraporder2_paramset1,        basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder2_paramset1,         maxquasiset_txi0_fixedpts_extraporder2_paramset1,         basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder2_paramset1,      maxquasiset_chichi0_fixedpts_extraporder2_paramset1,      basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder2_paramset1,       maxquasiset_chixi0_fixedpts_extraporder2_paramset1,       basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder2_paramset1,        maxquasiset_xixi0_fixedpts_extraporder2_paramset1,        basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder2_paramset1,       maxquasiset_trace0_fixedpts_extraporder2_paramset1,       basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder2_paramset1, maxquasiset_massdensity0_fixedpts_extraporder2_paramset1, basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1, maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1, basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1, maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1, basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1, maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1, basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder2_paramset1,               maxbdyphi0_fixedpts_extraporder2_paramset1,               basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder2_paramset1,          minquasiset_tt0_fixedpts_extraporder2_paramset1,          basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder2_paramset1,        minquasiset_tchi0_fixedpts_extraporder2_paramset1,        basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder2_paramset1,         minquasiset_txi0_fixedpts_extraporder2_paramset1,         basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder2_paramset1,      minquasiset_chichi0_fixedpts_extraporder2_paramset1,      basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder2_paramset1,       minquasiset_chixi0_fixedpts_extraporder2_paramset1,       basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder2_paramset1,        minquasiset_xixi0_fixedpts_extraporder2_paramset1,        basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder2_paramset1,       minquasiset_trace0_fixedpts_extraporder2_paramset1,       basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder2_paramset1, minquasiset_massdensity0_fixedpts_extraporder2_paramset1, basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1, minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1, basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1, minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1, basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1, minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1, basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder2_paramset1,               minbdyphi0_fixedpts_extraporder2_paramset1,               basenumbdypoints_fixedpts_extraporder2_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_fixedpts_extraporder2_paramset1; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_fixedpts_extraporder2_paramset1          [i] = maxquasiset_tt0_fixedpts_extraporder2_paramset1          [i] + minquasiset_tt0_fixedpts_extraporder2_paramset1          [i];
	                                    quasiset_tchi0_fixedpts_extraporder2_paramset1        [i] = maxquasiset_tchi0_fixedpts_extraporder2_paramset1        [i] + minquasiset_tchi0_fixedpts_extraporder2_paramset1        [i];
	                                    quasiset_txi0_fixedpts_extraporder2_paramset1         [i] = maxquasiset_txi0_fixedpts_extraporder2_paramset1         [i] + minquasiset_txi0_fixedpts_extraporder2_paramset1         [i];
	                                    quasiset_chichi0_fixedpts_extraporder2_paramset1      [i] = maxquasiset_chichi0_fixedpts_extraporder2_paramset1      [i] + minquasiset_chichi0_fixedpts_extraporder2_paramset1      [i];
	                                    quasiset_chixi0_fixedpts_extraporder2_paramset1       [i] = maxquasiset_chixi0_fixedpts_extraporder2_paramset1       [i] + minquasiset_chixi0_fixedpts_extraporder2_paramset1       [i];
	                                    quasiset_xixi0_fixedpts_extraporder2_paramset1        [i] = maxquasiset_xixi0_fixedpts_extraporder2_paramset1        [i] + minquasiset_xixi0_fixedpts_extraporder2_paramset1        [i];
	                                    quasiset_trace0_fixedpts_extraporder2_paramset1       [i] = maxquasiset_trace0_fixedpts_extraporder2_paramset1       [i] + minquasiset_trace0_fixedpts_extraporder2_paramset1       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder2_paramset1 [i] = maxquasiset_massdensity0_fixedpts_extraporder2_paramset1 [i] + minquasiset_massdensity0_fixedpts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i] + minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i] + minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i] + minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i];
	                                    bdyphi0_fixedpts_extraporder2_paramset1               [i] = maxbdyphi0_fixedpts_extraporder2_paramset1               [i] + minbdyphi0_fixedpts_extraporder2_paramset1               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_fixedpts_extraporder2_paramset1          [i] = maxquasiset_tt0_fixedpts_extraporder2_paramset1          [i];
	                                    quasiset_tchi0_fixedpts_extraporder2_paramset1        [i] = maxquasiset_tchi0_fixedpts_extraporder2_paramset1        [i];
	                                    quasiset_txi0_fixedpts_extraporder2_paramset1         [i] = maxquasiset_txi0_fixedpts_extraporder2_paramset1         [i];
	                                    quasiset_chichi0_fixedpts_extraporder2_paramset1      [i] = maxquasiset_chichi0_fixedpts_extraporder2_paramset1      [i];
	                                    quasiset_chixi0_fixedpts_extraporder2_paramset1       [i] = maxquasiset_chixi0_fixedpts_extraporder2_paramset1       [i];
	                                    quasiset_xixi0_fixedpts_extraporder2_paramset1        [i] = maxquasiset_xixi0_fixedpts_extraporder2_paramset1        [i];
	                                    quasiset_trace0_fixedpts_extraporder2_paramset1       [i] = maxquasiset_trace0_fixedpts_extraporder2_paramset1       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder2_paramset1 [i] = maxquasiset_massdensity0_fixedpts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1 [i];
	                                    bdyphi0_fixedpts_extraporder2_paramset1               [i] = maxbdyphi0_fixedpts_extraporder2_paramset1               [i];
	                                }  
	                        }       
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {
	                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    								name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder2_paramset1[j],ypbdy0_fixedpts_extraporder2_paramset1[j],zpbdy0_fixedpts_extraporder2_paramset1[j],j);
                                    }
                                    fclose(fp);
                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder2_paramset1[j],ypbdy0_fixedpts_extraporder2_paramset1[j],zpbdy0_fixedpts_extraporder2_paramset1[j],j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }   
	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder2_paramset1[j],y_outermostpt0_fixedpts_extraporder2_paramset1[j],z_outermostpt0_fixedpts_extraporder2_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder2_paramset1[j],y_outermostpt0_fixedpts_extraporder2_paramset1[j],z_outermostpt0_fixedpts_extraporder2_paramset1[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name); 
	                                	}   
	                                }
	                                if(output_bdyphi)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
                                    	sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder2_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder2_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                } 
	                                }    

                                    // save quasiset_ll as ascii
                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   									name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
                                                    ct,
                                                    quasiset_tt0_fixedpts_extraporder2_paramset1[j],quasiset_tchi0_fixedpts_extraporder2_paramset1[j],quasiset_txi0_fixedpts_extraporder2_paramset1[j],quasiset_chichi0_fixedpts_extraporder2_paramset1[j],quasiset_chixi0_fixedpts_extraporder2_paramset1[j],quasiset_xixi0_fixedpts_extraporder2_paramset1[j],
                                                    j);
                                    }
                                    fclose(fp);
                                    free(name);  
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_fixedpts_extraporder2_paramset1[j],quasiset_tchi0_fixedpts_extraporder2_paramset1[j],quasiset_txi0_fixedpts_extraporder2_paramset1[j],quasiset_chichi0_fixedpts_extraporder2_paramset1[j],quasiset_chixi0_fixedpts_extraporder2_paramset1[j],quasiset_xixi0_fixedpts_extraporder2_paramset1[j],
	                                                    j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }
	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_fixedpts_extraporder2_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_fixedpts_extraporder2_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_fixedpts_extraporder2_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_fixedpts_extraporder2_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {
		                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
		                            	sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_angmomdensityx0_fixedpts_extraporder2_paramset1[j],quasiset_angmomdensityy0_fixedpts_extraporder2_paramset1[j],quasiset_angmomdensityz0_fixedpts_extraporder2_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);   
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_fixedpts_extraporder2_paramset1[j],quasiset_angmomdensityy0_fixedpts_extraporder2_paramset1[j],quasiset_angmomdensityz0_fixedpts_extraporder2_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_fixedpts_extraporder2_paramset1=1;
	                                chibdy_xibdy_(chibdy0_fixedpts_extraporder2_paramset1,xibdy0_fixedpts_extraporder2_paramset1,xpbdy0_fixedpts_extraporder2_paramset1,ypbdy0_fixedpts_extraporder2_paramset1,zpbdy0_fixedpts_extraporder2_paramset1,&basenumbdypoints_fixedpts_extraporder2_paramset1,chiextrap0_fixedpts_extraporder2_paramset1,xiextrap0_fixedpts_extraporder2_paramset1,&basebdy_Nchi_fixedpts_extraporder2_paramset1,&basebdy_Nxi_fixedpts_extraporder2_paramset1);    
	                                doubleintegralonsphere_(AdS_mass0_fixedpts_extraporder2_paramset1,quasiset_massdensity0_fixedpts_extraporder2_paramset1,xpbdy0_fixedpts_extraporder2_paramset1,ypbdy0_fixedpts_extraporder2_paramset1,zpbdy0_fixedpts_extraporder2_paramset1,&basenumbdypoints_fixedpts_extraporder2_paramset1,rhobdy0_fixedpts_extraporder2_paramset1,chibdy0_fixedpts_extraporder2_paramset1,xibdy0_fixedpts_extraporder2_paramset1,&basebdy_Nchi_fixedpts_extraporder2_paramset1,&basebdy_Nxi_fixedpts_extraporder2_paramset1);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset1_%st_AdSmass.txt",AMRD_save_tag) + 1;
   									name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset1_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_fixedpts_extraporder2_paramset1);
	                                fclose(fp);
	                                free(name); 
	                            }
	                        }     

	                        free(vecbdypoints_fixedpts_extraporder2_paramset1);
	                        free(dsplsbdypoints_fixedpts_extraporder2_paramset1);
	                        free(quasiset_tt_fixedpts_extraporder2_paramset1);
	                        free(quasiset_tchi_fixedpts_extraporder2_paramset1);
	                        free(quasiset_txi_fixedpts_extraporder2_paramset1);
	                        free(quasiset_chichi_fixedpts_extraporder2_paramset1);
	                        free(quasiset_chixi_fixedpts_extraporder2_paramset1);
	                        free(quasiset_xixi_fixedpts_extraporder2_paramset1);
	                        free(quasiset_trace_fixedpts_extraporder2_paramset1);
	                        free(quasiset_massdensity_fixedpts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityx_fixedpts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityy_fixedpts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityz_fixedpts_extraporder2_paramset1);
	                        free(bdyphi_fixedpts_extraporder2_paramset1);  
	                        free(xpbdy_fixedpts_extraporder2_paramset1);
	                        free(ypbdy_fixedpts_extraporder2_paramset1);
	                        free(zpbdy_fixedpts_extraporder2_paramset1);   
	                        free(x_outermostpt_fixedpts_extraporder2_paramset1);
	                        free(y_outermostpt_fixedpts_extraporder2_paramset1);
	                        free(z_outermostpt_fixedpts_extraporder2_paramset1);   
	
	                        free(lquasiset_tt0_fixedpts_extraporder2_paramset1);        
	                        free(lquasiset_tchi0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_txi0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_chichi0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_chixi0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_xixi0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_trace0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_massdensity0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1);
	                        free(lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1);
	                        free(lbdyphi0_fixedpts_extraporder2_paramset1);      
	                        free(maxquasiset_tt0_fixedpts_extraporder2_paramset1);        
	                        free(maxquasiset_tchi0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_txi0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_chichi0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_chixi0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_xixi0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_trace0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_massdensity0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1);
	                        free(maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1);
	                        free(maxbdyphi0_fixedpts_extraporder2_paramset1);    
	                        free(minquasiset_tt0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_tchi0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_txi0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_chichi0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_chixi0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_xixi0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_trace0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_massdensity0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset1);
	                        free(minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset1);
	                        free(minbdyphi0_fixedpts_extraporder2_paramset1);    
	                        free(quasiset_tt0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_tchi0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_txi0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_chichi0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_chixi0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_xixi0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_trace0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_massdensity0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityx0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityy0_fixedpts_extraporder2_paramset1);
	                        free(quasiset_angmomdensityz0_fixedpts_extraporder2_paramset1);
	                        free(bdyphi0_fixedpts_extraporder2_paramset1);
	                        free(AdS_mass0_fixedpts_extraporder2_paramset1);     
	                        free(xpbdy0_fixedpts_extraporder2_paramset1);
	                        free(ypbdy0_fixedpts_extraporder2_paramset1);
	                        free(zpbdy0_fixedpts_extraporder2_paramset1);
	                        free(x_outermostpt0_fixedpts_extraporder2_paramset1);
	                        free(y_outermostpt0_fixedpts_extraporder2_paramset1);
	                        free(z_outermostpt0_fixedpts_extraporder2_paramset1);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_fixedpts_extraporder2_paramset1);
	                            free(chiextrap0_fixedpts_extraporder2_paramset1);
	                            free(xiextrap0_fixedpts_extraporder2_paramset1);             
	                            free(rhobdy0_fixedpts_extraporder2_paramset1);
	                            free(chibdy0_fixedpts_extraporder2_paramset1);
	                            free(xibdy0_fixedpts_extraporder2_paramset1);    
	                        }   
                		}//closes condition on output_bdy_extraporder2_paramset1

                		//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_fixedpts 2nd order extrap paramset1\n"); fflush(stdout);}

	            		//THIRD ORDER EXTRAPOLATION
						if (output_bdy_extraporder3_paramset1)
            			{
                			bdy_extrap_order=3;

                			//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
							nexttobdypoints_fixedpts_(chrbdy_fixedpts_extraporder3_paramset1,&numbdypoints_fixedpts_extraporder3_paramset1,&bdy_extrap_order,&ind_distance_fixedpts,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset1,&half_steps_from_bdy_int_paramset1,&num_fixed_coords,fixed_coords,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width); 

	                    	//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_fixedpts_extraporder3_paramset1 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_fixedpts_extraporder3_paramset1 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_fixedpts_extraporder3_paramset1,1,MPI_INT,vecbdypoints_fixedpts_extraporder3_paramset1,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_fixedpts_extraporder3_paramset1,&basenumbdypoints_fixedpts_extraporder3_paramset1,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_fixedpts_extraporder3_paramset1=%i\n",numbdypoints_fixedpts_extraporder3_paramset1);
	                        //fflush(stdout); 
	                        quasiset_tt_fixedpts_extraporder3_paramset1              = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_tchi_fixedpts_extraporder3_paramset1            = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_txi_fixedpts_extraporder3_paramset1             = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_chichi_fixedpts_extraporder3_paramset1          = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_chixi_fixedpts_extraporder3_paramset1           = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_xixi_fixedpts_extraporder3_paramset1            = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_trace_fixedpts_extraporder3_paramset1           = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_massdensity_fixedpts_extraporder3_paramset1     = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx_fixedpts_extraporder3_paramset1  = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy_fixedpts_extraporder3_paramset1  = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz_fixedpts_extraporder3_paramset1  = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        bdyphi_fixedpts_extraporder3_paramset1                   = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));   
	                        xpbdy_fixedpts_extraporder3_paramset1               = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        ypbdy_fixedpts_extraporder3_paramset1               = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        zpbdy_fixedpts_extraporder3_paramset1               = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));  
	                       	x_outermostpt_fixedpts_extraporder3_paramset1            = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                       	y_outermostpt_fixedpts_extraporder3_paramset1            = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                       	z_outermostpt_fixedpts_extraporder3_paramset1            = malloc((numbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real)); 
	
	                        lquasiset_tt0_fixedpts_extraporder3_paramset1            = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_tchi0_fixedpts_extraporder3_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_txi0_fixedpts_extraporder3_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_chichi0_fixedpts_extraporder3_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_chixi0_fixedpts_extraporder3_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_xixi0_fixedpts_extraporder3_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_trace0_fixedpts_extraporder3_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_massdensity0_fixedpts_extraporder3_paramset1   = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1= malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1= malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1= malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        lbdyphi0_fixedpts_extraporder3_paramset1                 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));   
	                        maxquasiset_tt0_fixedpts_extraporder3_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_tchi0_fixedpts_extraporder3_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_txi0_fixedpts_extraporder3_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_chichi0_fixedpts_extraporder3_paramset1      = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_chixi0_fixedpts_extraporder3_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_xixi0_fixedpts_extraporder3_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_trace0_fixedpts_extraporder3_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_massdensity0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        maxbdyphi0_fixedpts_extraporder3_paramset1               = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));   
	                        minquasiset_tt0_fixedpts_extraporder3_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_tchi0_fixedpts_extraporder3_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_txi0_fixedpts_extraporder3_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_chichi0_fixedpts_extraporder3_paramset1      = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_chixi0_fixedpts_extraporder3_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_xixi0_fixedpts_extraporder3_paramset1        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_trace0_fixedpts_extraporder3_paramset1       = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_massdensity0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        minbdyphi0_fixedpts_extraporder3_paramset1               = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));   
	                        quasiset_tt0_fixedpts_extraporder3_paramset1             = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_tchi0_fixedpts_extraporder3_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_txi0_fixedpts_extraporder3_paramset1            = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_chichi0_fixedpts_extraporder3_paramset1         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_chixi0_fixedpts_extraporder3_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_xixi0_fixedpts_extraporder3_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_trace0_fixedpts_extraporder3_paramset1          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_massdensity0_fixedpts_extraporder3_paramset1    = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        quasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        AdS_mass0_fixedpts_extraporder3_paramset1                = malloc(sizeof(real));
	                        bdyphi0_fixedpts_extraporder3_paramset1                  = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));    
	                        xpbdy0_fixedpts_extraporder3_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        ypbdy0_fixedpts_extraporder3_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                        zpbdy0_fixedpts_extraporder3_paramset1              = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));   
	                       	x_outermostpt0_fixedpts_extraporder3_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                       	y_outermostpt0_fixedpts_extraporder3_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                       	z_outermostpt0_fixedpts_extraporder3_paramset1           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));   
	
	
	                        //initialize
	                        for (i=0;i<numbdypoints_fixedpts_extraporder3_paramset1;i++)
	                        {
	                            quasiset_tt_fixedpts_extraporder3_paramset1              [i] = 0;
	                            quasiset_tchi_fixedpts_extraporder3_paramset1            [i] = 0;
	                            quasiset_txi_fixedpts_extraporder3_paramset1             [i] = 0;
	                            quasiset_chichi_fixedpts_extraporder3_paramset1          [i] = 0;
	                            quasiset_chixi_fixedpts_extraporder3_paramset1           [i] = 0;
	                            quasiset_xixi_fixedpts_extraporder3_paramset1            [i] = 0;
	                            quasiset_trace_fixedpts_extraporder3_paramset1           [i] = 0;
	                            quasiset_massdensity_fixedpts_extraporder3_paramset1     [i] = 0;
	                            quasiset_angmomdensityx_fixedpts_extraporder3_paramset1  [i] = 0;
	                            quasiset_angmomdensityy_fixedpts_extraporder3_paramset1  [i] = 0;
	                            quasiset_angmomdensityz_fixedpts_extraporder3_paramset1  [i] = 0;
	                            bdyphi_fixedpts_extraporder3_paramset1                   [i] = 0;   
	                            xpbdy_fixedpts_extraporder3_paramset1               [i] = 0;
	                            ypbdy_fixedpts_extraporder3_paramset1               [i] = 0;
	                            zpbdy_fixedpts_extraporder3_paramset1               [i] = 0;
	                           	x_outermostpt_fixedpts_extraporder3_paramset1            [i] = 0;
	                           	y_outermostpt_fixedpts_extraporder3_paramset1            [i] = 0;
	                           	z_outermostpt_fixedpts_extraporder3_paramset1            [i] = 0;
	
	                        }   
	                        for (i=0;i<basenumbdypoints_fixedpts_extraporder3_paramset1;i++)
	                        {   
	                            lquasiset_tt0_fixedpts_extraporder3_paramset1            [i] = 0;
	                            lquasiset_tchi0_fixedpts_extraporder3_paramset1          [i] = 0;
	                            lquasiset_txi0_fixedpts_extraporder3_paramset1           [i] = 0;
	                            lquasiset_chichi0_fixedpts_extraporder3_paramset1        [i] = 0;
	                            lquasiset_chixi0_fixedpts_extraporder3_paramset1         [i] = 0;
	                            lquasiset_xixi0_fixedpts_extraporder3_paramset1          [i] = 0;
	                            lquasiset_trace0_fixedpts_extraporder3_paramset1         [i] = 0;
	                            lquasiset_massdensity0_fixedpts_extraporder3_paramset1   [i] = 0;
	                            lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1[i] = 0;
	                            lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1[i] = 0;
	                            lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1[i] = 0;
	                            lbdyphi0_fixedpts_extraporder3_paramset1                 [i] = 0;             
	                            maxquasiset_tt0_fixedpts_extraporder3_paramset1          [i] = 0;
	                            maxquasiset_tchi0_fixedpts_extraporder3_paramset1        [i] = 0;
	                            maxquasiset_txi0_fixedpts_extraporder3_paramset1         [i] = 0;
	                            maxquasiset_chichi0_fixedpts_extraporder3_paramset1      [i] = 0;
	                            maxquasiset_chixi0_fixedpts_extraporder3_paramset1       [i] = 0;
	                            maxquasiset_xixi0_fixedpts_extraporder3_paramset1        [i] = 0;
	                            maxquasiset_trace0_fixedpts_extraporder3_paramset1       [i] = 0;
	                            maxquasiset_massdensity0_fixedpts_extraporder3_paramset1 [i] = 0;
	                            maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 [i] = 0;
	                            maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 [i] = 0;
	                            maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 [i] = 0;
	                            maxbdyphi0_fixedpts_extraporder3_paramset1               [i] = 0;  
	                            minquasiset_tt0_fixedpts_extraporder3_paramset1          [i] = 0;
	                            minquasiset_tchi0_fixedpts_extraporder3_paramset1        [i] = 0;
	                            minquasiset_txi0_fixedpts_extraporder3_paramset1         [i] = 0;
	                            minquasiset_chichi0_fixedpts_extraporder3_paramset1      [i] = 0;
	                            minquasiset_chixi0_fixedpts_extraporder3_paramset1       [i] = 0;
	                            minquasiset_xixi0_fixedpts_extraporder3_paramset1        [i] = 0;
	                            minquasiset_trace0_fixedpts_extraporder3_paramset1       [i] = 0;
	                            minquasiset_massdensity0_fixedpts_extraporder3_paramset1 [i] = 0;
	                            minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 [i] = 0;
	                            minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 [i] = 0;
	                            minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 [i] = 0;
	                            minbdyphi0_fixedpts_extraporder3_paramset1               [i] = 0;  
	                            quasiset_tt0_fixedpts_extraporder3_paramset1             [i] = 0;
	                            quasiset_tchi0_fixedpts_extraporder3_paramset1           [i] = 0;
	                            quasiset_txi0_fixedpts_extraporder3_paramset1            [i] = 0;
	                            quasiset_chichi0_fixedpts_extraporder3_paramset1         [i] = 0;
	                            quasiset_chixi0_fixedpts_extraporder3_paramset1          [i] = 0;
	                            quasiset_xixi0_fixedpts_extraporder3_paramset1           [i] = 0;
	                            quasiset_trace0_fixedpts_extraporder3_paramset1          [i] = 0;
	                            quasiset_massdensity0_fixedpts_extraporder3_paramset1    [i] = 0;
	                            quasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 [i] = 0;
	                            quasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 [i] = 0;
	                            quasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 [i] = 0;
	                            bdyphi0_fixedpts_extraporder3_paramset1                  [i] = 0;   
	                            xpbdy0_fixedpts_extraporder3_paramset1              [i] = 0;
	                            ypbdy0_fixedpts_extraporder3_paramset1              [i] = 0;
	                            zpbdy0_fixedpts_extraporder3_paramset1              [i] = 0;  
	                           	x_outermostpt0_fixedpts_extraporder3_paramset1           [i] = 0;
	                           	y_outermostpt0_fixedpts_extraporder3_paramset1           [i] = 0;
	                           	z_outermostpt0_fixedpts_extraporder3_paramset1           [i] = 0;
	
	                        }
	                        *AdS_mass0_fixedpts_extraporder3_paramset1                    = 0; 
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_fixedpts_extraporder3_paramset1=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_fixedpts_extraporder3_paramset1=vecbdypoints_fixedpts_extraporder3_paramset1[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_fixedpts_extraporder3_paramset1=is_bdy_fixedpts_extraporder3_paramset1+vecbdypoints_fixedpts_extraporder3_paramset1[j];
	                            }
	                            ie_bdy_fixedpts_extraporder3_paramset1=is_bdy_fixedpts_extraporder3_paramset1+vecbdypoints_fixedpts_extraporder3_paramset1[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_fixedpts_extraporder3_paramset1[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_fixedpts_extraporder3_paramset1[i]=dsplsbdypoints_fixedpts_extraporder3_paramset1[i]+vecbdypoints_fixedpts_extraporder3_paramset1[j];
	                                }
	                            }
	                        }   
	
	                        xyz_extrap_outermost_(xpbdy_fixedpts_extraporder3_paramset1,ypbdy_fixedpts_extraporder3_paramset1,zpbdy_fixedpts_extraporder3_paramset1,
	                        						x_outermostpt_fixedpts_extraporder3_paramset1,y_outermostpt_fixedpts_extraporder3_paramset1,z_outermostpt_fixedpts_extraporder3_paramset1,
	                        						chrbdy_fixedpts_extraporder3_paramset1,&numbdypoints_fixedpts_extraporder3_paramset1,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_fixedpts_extraporder3_paramset1,numbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,xpbdy0_fixedpts_extraporder3_paramset1,vecbdypoints_fixedpts_extraporder3_paramset1,dsplsbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_fixedpts_extraporder3_paramset1,numbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,ypbdy0_fixedpts_extraporder3_paramset1,vecbdypoints_fixedpts_extraporder3_paramset1,dsplsbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_fixedpts_extraporder3_paramset1,numbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,zpbdy0_fixedpts_extraporder3_paramset1,vecbdypoints_fixedpts_extraporder3_paramset1,dsplsbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_fixedpts_extraporder3_paramset1,numbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,x_outermostpt0_fixedpts_extraporder3_paramset1,vecbdypoints_fixedpts_extraporder3_paramset1,dsplsbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_fixedpts_extraporder3_paramset1,numbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,y_outermostpt0_fixedpts_extraporder3_paramset1,vecbdypoints_fixedpts_extraporder3_paramset1,dsplsbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_fixedpts_extraporder3_paramset1,numbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,z_outermostpt0_fixedpts_extraporder3_paramset1,vecbdypoints_fixedpts_extraporder3_paramset1,dsplsbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_fixedpts_extraporder3_paramset1 = malloc(sizeof(real));
	                                chiextrap0_fixedpts_extraporder3_paramset1 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real));
	                                xiextrap0_fixedpts_extraporder3_paramset1  = malloc((basenumbdypoints_fixedpts_extraporder3_paramset1)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_fixedpts_extraporder3_paramset1,chiextrap0_fixedpts_extraporder3_paramset1,xiextrap0_fixedpts_extraporder3_paramset1,xpbdy0_fixedpts_extraporder3_paramset1,ypbdy0_fixedpts_extraporder3_paramset1,zpbdy0_fixedpts_extraporder3_paramset1,&basenumbdypoints_fixedpts_extraporder3_paramset1);  
	                                basebdy_Nchi_fixedpts_extraporder3_paramset1=0;//initialize
	                                basebdy_Nxi_fixedpts_extraporder3_paramset1=0; //initialize
	                                bdyn_(&basebdy_Nchi_fixedpts_extraporder3_paramset1,&basebdy_Nxi_fixedpts_extraporder3_paramset1,&basenumbdypoints_fixedpts_extraporder3_paramset1,chiextrap0_fixedpts_extraporder3_paramset1,xiextrap0_fixedpts_extraporder3_paramset1);  
	                                rhobdy0_fixedpts_extraporder3_paramset1 = malloc(sizeof(real));
	                                chibdy0_fixedpts_extraporder3_paramset1 = malloc(basebdy_Nchi_fixedpts_extraporder3_paramset1*sizeof(real));
	                                xibdy0_fixedpts_extraporder3_paramset1  = malloc(basebdy_Nxi_fixedpts_extraporder3_paramset1*sizeof(real));   
	                            }
	                        }
	
	
	                        extrap_bdyphi_fixedpts_(bdyphi_fixedpts_extraporder3_paramset1,
	                                        leadordcoeff_phi1,
	                                        xpbdy_fixedpts_extraporder3_paramset1,ypbdy_fixedpts_extraporder3_paramset1,zpbdy_fixedpts_extraporder3_paramset1,
	                                        chrbdy_fixedpts_extraporder3_paramset1,&numbdypoints_fixedpts_extraporder3_paramset1,
	                                        &bdy_extrap_order,
	                                        &ind_distance_fixedpts,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        extrap_quasiset_fixedpts_(quasiset_tt_fixedpts_extraporder3_paramset1,quasiset_tchi_fixedpts_extraporder3_paramset1,quasiset_txi_fixedpts_extraporder3_paramset1,
	                                quasiset_chichi_fixedpts_extraporder3_paramset1,quasiset_chixi_fixedpts_extraporder3_paramset1,
	                                quasiset_xixi_fixedpts_extraporder3_paramset1,
	                                quasiset_trace_fixedpts_extraporder3_paramset1,
	                                quasiset_massdensity_fixedpts_extraporder3_paramset1,
	                                quasiset_angmomdensityx_fixedpts_extraporder3_paramset1,
	                                quasiset_angmomdensityy_fixedpts_extraporder3_paramset1,
	                                quasiset_angmomdensityz_fixedpts_extraporder3_paramset1,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_fixedpts_extraporder3_paramset1,ypbdy_fixedpts_extraporder3_paramset1,zpbdy_fixedpts_extraporder3_paramset1,
	                                chrbdy_fixedpts_extraporder3_paramset1,&numbdypoints_fixedpts_extraporder3_paramset1,
	                                &bdy_extrap_order,
	                                &ind_distance_fixedpts,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_fixedpts_extraporder3_paramset1; i<ie_bdy_fixedpts_extraporder3_paramset1; i++)
	                        {
	                            lquasiset_tt0_fixedpts_extraporder3_paramset1           [i] = quasiset_tt_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_tchi0_fixedpts_extraporder3_paramset1         [i] = quasiset_tchi_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_txi0_fixedpts_extraporder3_paramset1          [i] = quasiset_txi_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_chichi0_fixedpts_extraporder3_paramset1       [i] = quasiset_chichi_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_chixi0_fixedpts_extraporder3_paramset1        [i] = quasiset_chixi_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_xixi0_fixedpts_extraporder3_paramset1         [i] = quasiset_xixi_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_trace0_fixedpts_extraporder3_paramset1        [i] = quasiset_trace_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_massdensity0_fixedpts_extraporder3_paramset1  [i] = quasiset_massdensity_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 [i] = quasiset_angmomdensityx_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 [i] = quasiset_angmomdensityy_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 [i] = quasiset_angmomdensityz_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                            lbdyphi0_fixedpts_extraporder3_paramset1                [i] = bdyphi_fixedpts_extraporder3_paramset1[i-is_bdy_fixedpts_extraporder3_paramset1];
	                        }   

	                        //PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder3_paramset1,          maxquasiset_tt0_fixedpts_extraporder3_paramset1,          basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder3_paramset1,        maxquasiset_tchi0_fixedpts_extraporder3_paramset1,        basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder3_paramset1,         maxquasiset_txi0_fixedpts_extraporder3_paramset1,         basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder3_paramset1,      maxquasiset_chichi0_fixedpts_extraporder3_paramset1,      basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder3_paramset1,       maxquasiset_chixi0_fixedpts_extraporder3_paramset1,       basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder3_paramset1,        maxquasiset_xixi0_fixedpts_extraporder3_paramset1,        basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder3_paramset1,       maxquasiset_trace0_fixedpts_extraporder3_paramset1,       basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder3_paramset1, maxquasiset_massdensity0_fixedpts_extraporder3_paramset1, basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1, maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1, basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1, maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1, basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1, maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1, basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder3_paramset1,               maxbdyphi0_fixedpts_extraporder3_paramset1,               basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder3_paramset1,          minquasiset_tt0_fixedpts_extraporder3_paramset1,          basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder3_paramset1,        minquasiset_tchi0_fixedpts_extraporder3_paramset1,        basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder3_paramset1,         minquasiset_txi0_fixedpts_extraporder3_paramset1,         basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder3_paramset1,      minquasiset_chichi0_fixedpts_extraporder3_paramset1,      basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder3_paramset1,       minquasiset_chixi0_fixedpts_extraporder3_paramset1,       basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder3_paramset1,        minquasiset_xixi0_fixedpts_extraporder3_paramset1,        basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder3_paramset1,       minquasiset_trace0_fixedpts_extraporder3_paramset1,       basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder3_paramset1, minquasiset_massdensity0_fixedpts_extraporder3_paramset1, basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1, minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1, basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1, minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1, basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1, minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1, basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder3_paramset1,               minbdyphi0_fixedpts_extraporder3_paramset1,               basenumbdypoints_fixedpts_extraporder3_paramset1,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_fixedpts_extraporder3_paramset1; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_fixedpts_extraporder3_paramset1          [i] = maxquasiset_tt0_fixedpts_extraporder3_paramset1          [i] + minquasiset_tt0_fixedpts_extraporder3_paramset1          [i];
	                                    quasiset_tchi0_fixedpts_extraporder3_paramset1        [i] = maxquasiset_tchi0_fixedpts_extraporder3_paramset1        [i] + minquasiset_tchi0_fixedpts_extraporder3_paramset1        [i];
	                                    quasiset_txi0_fixedpts_extraporder3_paramset1         [i] = maxquasiset_txi0_fixedpts_extraporder3_paramset1         [i] + minquasiset_txi0_fixedpts_extraporder3_paramset1         [i];
	                                    quasiset_chichi0_fixedpts_extraporder3_paramset1      [i] = maxquasiset_chichi0_fixedpts_extraporder3_paramset1      [i] + minquasiset_chichi0_fixedpts_extraporder3_paramset1      [i];
	                                    quasiset_chixi0_fixedpts_extraporder3_paramset1       [i] = maxquasiset_chixi0_fixedpts_extraporder3_paramset1       [i] + minquasiset_chixi0_fixedpts_extraporder3_paramset1       [i];
	                                    quasiset_xixi0_fixedpts_extraporder3_paramset1        [i] = maxquasiset_xixi0_fixedpts_extraporder3_paramset1        [i] + minquasiset_xixi0_fixedpts_extraporder3_paramset1        [i];
	                                    quasiset_trace0_fixedpts_extraporder3_paramset1       [i] = maxquasiset_trace0_fixedpts_extraporder3_paramset1       [i] + minquasiset_trace0_fixedpts_extraporder3_paramset1       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder3_paramset1 [i] = maxquasiset_massdensity0_fixedpts_extraporder3_paramset1 [i] + minquasiset_massdensity0_fixedpts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 [i] + minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 [i] + minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 [i] + minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 [i];
	                                    bdyphi0_fixedpts_extraporder3_paramset1               [i] = maxbdyphi0_fixedpts_extraporder3_paramset1               [i] + minbdyphi0_fixedpts_extraporder3_paramset1               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_fixedpts_extraporder3_paramset1          [i] = maxquasiset_tt0_fixedpts_extraporder3_paramset1          [i];
	                                    quasiset_tchi0_fixedpts_extraporder3_paramset1        [i] = maxquasiset_tchi0_fixedpts_extraporder3_paramset1        [i];
	                                    quasiset_txi0_fixedpts_extraporder3_paramset1         [i] = maxquasiset_txi0_fixedpts_extraporder3_paramset1         [i];
	                                    quasiset_chichi0_fixedpts_extraporder3_paramset1      [i] = maxquasiset_chichi0_fixedpts_extraporder3_paramset1      [i];
	                                    quasiset_chixi0_fixedpts_extraporder3_paramset1       [i] = maxquasiset_chixi0_fixedpts_extraporder3_paramset1       [i];
	                                    quasiset_xixi0_fixedpts_extraporder3_paramset1        [i] = maxquasiset_xixi0_fixedpts_extraporder3_paramset1        [i];
	                                    quasiset_trace0_fixedpts_extraporder3_paramset1       [i] = maxquasiset_trace0_fixedpts_extraporder3_paramset1       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder3_paramset1 [i] = maxquasiset_massdensity0_fixedpts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1 [i];
	                                    bdyphi0_fixedpts_extraporder3_paramset1               [i] = maxbdyphi0_fixedpts_extraporder3_paramset1               [i];
	                                }  
	                        }       
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {
	                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    								name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder3_paramset1[j],ypbdy0_fixedpts_extraporder3_paramset1[j],zpbdy0_fixedpts_extraporder3_paramset1[j],j);
                                    }
                                    fclose(fp);
                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder3_paramset1[j],ypbdy0_fixedpts_extraporder3_paramset1[j],zpbdy0_fixedpts_extraporder3_paramset1[j],j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }   
	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder3_paramset1[j],y_outermostpt0_fixedpts_extraporder3_paramset1[j],z_outermostpt0_fixedpts_extraporder3_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder3_paramset1[j],y_outermostpt0_fixedpts_extraporder3_paramset1[j],z_outermostpt0_fixedpts_extraporder3_paramset1[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name); 
	                                	}   
	                                }
	                                if(output_bdyphi)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
                                    	sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder3_paramset1[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder3_paramset1[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                } 
	                                }    

                                    // save quasiset_ll as ascii
                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   									name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
                                                    ct,
                                                    quasiset_tt0_fixedpts_extraporder3_paramset1[j],quasiset_tchi0_fixedpts_extraporder3_paramset1[j],quasiset_txi0_fixedpts_extraporder3_paramset1[j],quasiset_chichi0_fixedpts_extraporder3_paramset1[j],quasiset_chixi0_fixedpts_extraporder3_paramset1[j],quasiset_xixi0_fixedpts_extraporder3_paramset1[j],
                                                    j);
                                    }
                                    fclose(fp);
                                    free(name);  
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_fixedpts_extraporder3_paramset1[j],quasiset_tchi0_fixedpts_extraporder3_paramset1[j],quasiset_txi0_fixedpts_extraporder3_paramset1[j],quasiset_chichi0_fixedpts_extraporder3_paramset1[j],quasiset_chixi0_fixedpts_extraporder3_paramset1[j],quasiset_xixi0_fixedpts_extraporder3_paramset1[j],
	                                                    j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }
	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_fixedpts_extraporder3_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_fixedpts_extraporder3_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_fixedpts_extraporder3_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_fixedpts_extraporder3_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {
		                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
		                            	sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_angmomdensityx0_fixedpts_extraporder3_paramset1[j],quasiset_angmomdensityy0_fixedpts_extraporder3_paramset1[j],quasiset_angmomdensityz0_fixedpts_extraporder3_paramset1[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);   
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset1; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_fixedpts_extraporder3_paramset1[j],quasiset_angmomdensityy0_fixedpts_extraporder3_paramset1[j],quasiset_angmomdensityz0_fixedpts_extraporder3_paramset1[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_fixedpts_extraporder3_paramset1=1;
	                                chibdy_xibdy_(chibdy0_fixedpts_extraporder3_paramset1,xibdy0_fixedpts_extraporder3_paramset1,xpbdy0_fixedpts_extraporder3_paramset1,ypbdy0_fixedpts_extraporder3_paramset1,zpbdy0_fixedpts_extraporder3_paramset1,&basenumbdypoints_fixedpts_extraporder3_paramset1,chiextrap0_fixedpts_extraporder3_paramset1,xiextrap0_fixedpts_extraporder3_paramset1,&basebdy_Nchi_fixedpts_extraporder3_paramset1,&basebdy_Nxi_fixedpts_extraporder3_paramset1);    
	                                doubleintegralonsphere_(AdS_mass0_fixedpts_extraporder3_paramset1,quasiset_massdensity0_fixedpts_extraporder3_paramset1,xpbdy0_fixedpts_extraporder3_paramset1,ypbdy0_fixedpts_extraporder3_paramset1,zpbdy0_fixedpts_extraporder3_paramset1,&basenumbdypoints_fixedpts_extraporder3_paramset1,rhobdy0_fixedpts_extraporder3_paramset1,chibdy0_fixedpts_extraporder3_paramset1,xibdy0_fixedpts_extraporder3_paramset1,&basebdy_Nchi_fixedpts_extraporder3_paramset1,&basebdy_Nxi_fixedpts_extraporder3_paramset1);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset1_%st_AdSmass.txt",AMRD_save_tag) + 1;
   									name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset1_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_fixedpts_extraporder3_paramset1);
	                                fclose(fp);
	                                free(name); 
	                            }
	                        }     

	                        free(vecbdypoints_fixedpts_extraporder3_paramset1);
	                        free(dsplsbdypoints_fixedpts_extraporder3_paramset1);
	                        free(quasiset_tt_fixedpts_extraporder3_paramset1);
	                        free(quasiset_tchi_fixedpts_extraporder3_paramset1);
	                        free(quasiset_txi_fixedpts_extraporder3_paramset1);
	                        free(quasiset_chichi_fixedpts_extraporder3_paramset1);
	                        free(quasiset_chixi_fixedpts_extraporder3_paramset1);
	                        free(quasiset_xixi_fixedpts_extraporder3_paramset1);
	                        free(quasiset_trace_fixedpts_extraporder3_paramset1);
	                        free(quasiset_massdensity_fixedpts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityx_fixedpts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityy_fixedpts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityz_fixedpts_extraporder3_paramset1);
	                        free(bdyphi_fixedpts_extraporder3_paramset1);  
	                        free(xpbdy_fixedpts_extraporder3_paramset1);
	                        free(ypbdy_fixedpts_extraporder3_paramset1);
	                        free(zpbdy_fixedpts_extraporder3_paramset1);   
	                        free(x_outermostpt_fixedpts_extraporder3_paramset1);
	                        free(y_outermostpt_fixedpts_extraporder3_paramset1);
	                        free(z_outermostpt_fixedpts_extraporder3_paramset1);   
	
	                        free(lquasiset_tt0_fixedpts_extraporder3_paramset1);        
	                        free(lquasiset_tchi0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_txi0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_chichi0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_chixi0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_xixi0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_trace0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_massdensity0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1);
	                        free(lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1);
	                        free(lbdyphi0_fixedpts_extraporder3_paramset1);      
	                        free(maxquasiset_tt0_fixedpts_extraporder3_paramset1);        
	                        free(maxquasiset_tchi0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_txi0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_chichi0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_chixi0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_xixi0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_trace0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_massdensity0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1);
	                        free(maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1);
	                        free(maxbdyphi0_fixedpts_extraporder3_paramset1);    
	                        free(minquasiset_tt0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_tchi0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_txi0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_chichi0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_chixi0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_xixi0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_trace0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_massdensity0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset1);
	                        free(minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset1);
	                        free(minbdyphi0_fixedpts_extraporder3_paramset1);    
	                        free(quasiset_tt0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_tchi0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_txi0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_chichi0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_chixi0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_xixi0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_trace0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_massdensity0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityx0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityy0_fixedpts_extraporder3_paramset1);
	                        free(quasiset_angmomdensityz0_fixedpts_extraporder3_paramset1);
	                        free(bdyphi0_fixedpts_extraporder3_paramset1);
	                        free(AdS_mass0_fixedpts_extraporder3_paramset1);     
	                        free(xpbdy0_fixedpts_extraporder3_paramset1);
	                        free(ypbdy0_fixedpts_extraporder3_paramset1);
	                        free(zpbdy0_fixedpts_extraporder3_paramset1);
	                        free(x_outermostpt0_fixedpts_extraporder3_paramset1);
	                        free(y_outermostpt0_fixedpts_extraporder3_paramset1);
	                        free(z_outermostpt0_fixedpts_extraporder3_paramset1);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_fixedpts_extraporder3_paramset1);
	                            free(chiextrap0_fixedpts_extraporder3_paramset1);
	                            free(xiextrap0_fixedpts_extraporder3_paramset1);             
	                            free(rhobdy0_fixedpts_extraporder3_paramset1);
	                            free(chibdy0_fixedpts_extraporder3_paramset1);
	                            free(xibdy0_fixedpts_extraporder3_paramset1);    
	                        }   
                		}//closes condition on output_bdy_extraporder3_paramset1

                		//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_fixedpts 3rd order extrap paramset1\n"); fflush(stdout);}

	            		//EXTRAPOLATION WITH SECOND SET OF PARAMETERS (denoted by index 2 at the end)

		        		//FIRST ORDER EXTRAPOLATION
            			if (output_bdy_extraporder1_paramset2)
            			{
                			bdy_extrap_order=1;

                			//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
	                        nexttobdypoints_fixedpts_(chrbdy_fixedpts_extraporder1_paramset2,&numbdypoints_fixedpts_extraporder1_paramset2,&bdy_extrap_order,&ind_distance_fixedpts,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset2,&half_steps_from_bdy_int_paramset2,&num_fixed_coords,fixed_coords,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc-fixedpts_extraporder1_paramset2: pre perform extrap\n"); fflush(stdout);}  

	                    	//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_fixedpts_extraporder1_paramset2 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_fixedpts_extraporder1_paramset2 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_fixedpts_extraporder1_paramset2,1,MPI_INT,vecbdypoints_fixedpts_extraporder1_paramset2,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_fixedpts_extraporder1_paramset2,&basenumbdypoints_fixedpts_extraporder1_paramset2,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_fixedpts_extraporder1_paramset2=%i\n",numbdypoints_fixedpts_extraporder1_paramset2);
	                        //fflush(stdout); 
	                        quasiset_tt_fixedpts_extraporder1_paramset2              = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_tchi_fixedpts_extraporder1_paramset2            = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_txi_fixedpts_extraporder1_paramset2             = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_chichi_fixedpts_extraporder1_paramset2          = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_chixi_fixedpts_extraporder1_paramset2           = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_xixi_fixedpts_extraporder1_paramset2            = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_trace_fixedpts_extraporder1_paramset2           = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_massdensity_fixedpts_extraporder1_paramset2     = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx_fixedpts_extraporder1_paramset2  = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy_fixedpts_extraporder1_paramset2  = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz_fixedpts_extraporder1_paramset2  = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        bdyphi_fixedpts_extraporder1_paramset2                   = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));   
	                        xpbdy_fixedpts_extraporder1_paramset2               = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        ypbdy_fixedpts_extraporder1_paramset2               = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        zpbdy_fixedpts_extraporder1_paramset2               = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));  
	                       	x_outermostpt_fixedpts_extraporder1_paramset2            = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                       	y_outermostpt_fixedpts_extraporder1_paramset2            = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                       	z_outermostpt_fixedpts_extraporder1_paramset2            = malloc((numbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real)); 
	
	                        lquasiset_tt0_fixedpts_extraporder1_paramset2            = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_tchi0_fixedpts_extraporder1_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_txi0_fixedpts_extraporder1_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_chichi0_fixedpts_extraporder1_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_chixi0_fixedpts_extraporder1_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_xixi0_fixedpts_extraporder1_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_trace0_fixedpts_extraporder1_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_massdensity0_fixedpts_extraporder1_paramset2   = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2= malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2= malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2= malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        lbdyphi0_fixedpts_extraporder1_paramset2                 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));   
	                        maxquasiset_tt0_fixedpts_extraporder1_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_tchi0_fixedpts_extraporder1_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_txi0_fixedpts_extraporder1_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_chichi0_fixedpts_extraporder1_paramset2      = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_chixi0_fixedpts_extraporder1_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_xixi0_fixedpts_extraporder1_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_trace0_fixedpts_extraporder1_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_massdensity0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        maxbdyphi0_fixedpts_extraporder1_paramset2               = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));   
	                        minquasiset_tt0_fixedpts_extraporder1_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_tchi0_fixedpts_extraporder1_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_txi0_fixedpts_extraporder1_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_chichi0_fixedpts_extraporder1_paramset2      = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_chixi0_fixedpts_extraporder1_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_xixi0_fixedpts_extraporder1_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_trace0_fixedpts_extraporder1_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_massdensity0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        minbdyphi0_fixedpts_extraporder1_paramset2               = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));   
	                        quasiset_tt0_fixedpts_extraporder1_paramset2             = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_tchi0_fixedpts_extraporder1_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_txi0_fixedpts_extraporder1_paramset2            = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_chichi0_fixedpts_extraporder1_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_chixi0_fixedpts_extraporder1_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_xixi0_fixedpts_extraporder1_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_trace0_fixedpts_extraporder1_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_massdensity0_fixedpts_extraporder1_paramset2    = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        AdS_mass0_fixedpts_extraporder1_paramset2                = malloc(sizeof(real));
	                        bdyphi0_fixedpts_extraporder1_paramset2                  = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));    
	                        xpbdy0_fixedpts_extraporder1_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        ypbdy0_fixedpts_extraporder1_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                        zpbdy0_fixedpts_extraporder1_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));   
	                       	x_outermostpt0_fixedpts_extraporder1_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                       	y_outermostpt0_fixedpts_extraporder1_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                       	z_outermostpt0_fixedpts_extraporder1_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));   
	
	
	                        //initialize
	                        for (i=0;i<numbdypoints_fixedpts_extraporder1_paramset2;i++)
	                        {
	                            quasiset_tt_fixedpts_extraporder1_paramset2              [i] = 0;
	                            quasiset_tchi_fixedpts_extraporder1_paramset2            [i] = 0;
	                            quasiset_txi_fixedpts_extraporder1_paramset2             [i] = 0;
	                            quasiset_chichi_fixedpts_extraporder1_paramset2          [i] = 0;
	                            quasiset_chixi_fixedpts_extraporder1_paramset2           [i] = 0;
	                            quasiset_xixi_fixedpts_extraporder1_paramset2            [i] = 0;
	                            quasiset_trace_fixedpts_extraporder1_paramset2           [i] = 0;
	                            quasiset_massdensity_fixedpts_extraporder1_paramset2     [i] = 0;
	                            quasiset_angmomdensityx_fixedpts_extraporder1_paramset2  [i] = 0;
	                            quasiset_angmomdensityy_fixedpts_extraporder1_paramset2  [i] = 0;
	                            quasiset_angmomdensityz_fixedpts_extraporder1_paramset2  [i] = 0;
	                            bdyphi_fixedpts_extraporder1_paramset2                   [i] = 0;   
	                            xpbdy_fixedpts_extraporder1_paramset2               [i] = 0;
	                            ypbdy_fixedpts_extraporder1_paramset2               [i] = 0;
	                            zpbdy_fixedpts_extraporder1_paramset2               [i] = 0;
	                           	x_outermostpt_fixedpts_extraporder1_paramset2            [i] = 0;
	                           	y_outermostpt_fixedpts_extraporder1_paramset2            [i] = 0;
	                           	z_outermostpt_fixedpts_extraporder1_paramset2            [i] = 0;
	
	                        }   
	                        for (i=0;i<basenumbdypoints_fixedpts_extraporder1_paramset2;i++)
	                        {   
	                            lquasiset_tt0_fixedpts_extraporder1_paramset2            [i] = 0;
	                            lquasiset_tchi0_fixedpts_extraporder1_paramset2          [i] = 0;
	                            lquasiset_txi0_fixedpts_extraporder1_paramset2           [i] = 0;
	                            lquasiset_chichi0_fixedpts_extraporder1_paramset2        [i] = 0;
	                            lquasiset_chixi0_fixedpts_extraporder1_paramset2         [i] = 0;
	                            lquasiset_xixi0_fixedpts_extraporder1_paramset2          [i] = 0;
	                            lquasiset_trace0_fixedpts_extraporder1_paramset2         [i] = 0;
	                            lquasiset_massdensity0_fixedpts_extraporder1_paramset2   [i] = 0;
	                            lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2[i] = 0;
	                            lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2[i] = 0;
	                            lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2[i] = 0;
	                            lbdyphi0_fixedpts_extraporder1_paramset2                 [i] = 0;             
	                            maxquasiset_tt0_fixedpts_extraporder1_paramset2          [i] = 0;
	                            maxquasiset_tchi0_fixedpts_extraporder1_paramset2        [i] = 0;
	                            maxquasiset_txi0_fixedpts_extraporder1_paramset2         [i] = 0;
	                            maxquasiset_chichi0_fixedpts_extraporder1_paramset2      [i] = 0;
	                            maxquasiset_chixi0_fixedpts_extraporder1_paramset2       [i] = 0;
	                            maxquasiset_xixi0_fixedpts_extraporder1_paramset2        [i] = 0;
	                            maxquasiset_trace0_fixedpts_extraporder1_paramset2       [i] = 0;
	                            maxquasiset_massdensity0_fixedpts_extraporder1_paramset2 [i] = 0;
	                            maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 [i] = 0;
	                            maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 [i] = 0;
	                            maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 [i] = 0;
	                            maxbdyphi0_fixedpts_extraporder1_paramset2               [i] = 0;  
	                            minquasiset_tt0_fixedpts_extraporder1_paramset2          [i] = 0;
	                            minquasiset_tchi0_fixedpts_extraporder1_paramset2        [i] = 0;
	                            minquasiset_txi0_fixedpts_extraporder1_paramset2         [i] = 0;
	                            minquasiset_chichi0_fixedpts_extraporder1_paramset2      [i] = 0;
	                            minquasiset_chixi0_fixedpts_extraporder1_paramset2       [i] = 0;
	                            minquasiset_xixi0_fixedpts_extraporder1_paramset2        [i] = 0;
	                            minquasiset_trace0_fixedpts_extraporder1_paramset2       [i] = 0;
	                            minquasiset_massdensity0_fixedpts_extraporder1_paramset2 [i] = 0;
	                            minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 [i] = 0;
	                            minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 [i] = 0;
	                            minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 [i] = 0;
	                            minbdyphi0_fixedpts_extraporder1_paramset2               [i] = 0;  
	                            quasiset_tt0_fixedpts_extraporder1_paramset2             [i] = 0;
	                            quasiset_tchi0_fixedpts_extraporder1_paramset2           [i] = 0;
	                            quasiset_txi0_fixedpts_extraporder1_paramset2            [i] = 0;
	                            quasiset_chichi0_fixedpts_extraporder1_paramset2         [i] = 0;
	                            quasiset_chixi0_fixedpts_extraporder1_paramset2          [i] = 0;
	                            quasiset_xixi0_fixedpts_extraporder1_paramset2           [i] = 0;
	                            quasiset_trace0_fixedpts_extraporder1_paramset2          [i] = 0;
	                            quasiset_massdensity0_fixedpts_extraporder1_paramset2    [i] = 0;
	                            quasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 [i] = 0;
	                            quasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 [i] = 0;
	                            quasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 [i] = 0;
	                            bdyphi0_fixedpts_extraporder1_paramset2                  [i] = 0;   
	                            xpbdy0_fixedpts_extraporder1_paramset2              [i] = 0;
	                            ypbdy0_fixedpts_extraporder1_paramset2              [i] = 0;
	                            zpbdy0_fixedpts_extraporder1_paramset2              [i] = 0;  
	                           	x_outermostpt0_fixedpts_extraporder1_paramset2           [i] = 0;
	                           	y_outermostpt0_fixedpts_extraporder1_paramset2           [i] = 0;
	                           	z_outermostpt0_fixedpts_extraporder1_paramset2           [i] = 0;
	
	                        }
	                        *AdS_mass0_fixedpts_extraporder1_paramset2                    = 0; 
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_fixedpts_extraporder1_paramset2=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_fixedpts_extraporder1_paramset2=vecbdypoints_fixedpts_extraporder1_paramset2[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_fixedpts_extraporder1_paramset2=is_bdy_fixedpts_extraporder1_paramset2+vecbdypoints_fixedpts_extraporder1_paramset2[j];
	                            }
	                            ie_bdy_fixedpts_extraporder1_paramset2=is_bdy_fixedpts_extraporder1_paramset2+vecbdypoints_fixedpts_extraporder1_paramset2[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_fixedpts_extraporder1_paramset2[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_fixedpts_extraporder1_paramset2[i]=dsplsbdypoints_fixedpts_extraporder1_paramset2[i]+vecbdypoints_fixedpts_extraporder1_paramset2[j];
	                                }
	                            }
	                        }   
	
	                        xyz_extrap_outermost_(xpbdy_fixedpts_extraporder1_paramset2,ypbdy_fixedpts_extraporder1_paramset2,zpbdy_fixedpts_extraporder1_paramset2,
	                        						x_outermostpt_fixedpts_extraporder1_paramset2,y_outermostpt_fixedpts_extraporder1_paramset2,z_outermostpt_fixedpts_extraporder1_paramset2,
	                        						chrbdy_fixedpts_extraporder1_paramset2,&numbdypoints_fixedpts_extraporder1_paramset2,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_fixedpts_extraporder1_paramset2,numbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,xpbdy0_fixedpts_extraporder1_paramset2,vecbdypoints_fixedpts_extraporder1_paramset2,dsplsbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_fixedpts_extraporder1_paramset2,numbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,ypbdy0_fixedpts_extraporder1_paramset2,vecbdypoints_fixedpts_extraporder1_paramset2,dsplsbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_fixedpts_extraporder1_paramset2,numbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,zpbdy0_fixedpts_extraporder1_paramset2,vecbdypoints_fixedpts_extraporder1_paramset2,dsplsbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_fixedpts_extraporder1_paramset2,numbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,x_outermostpt0_fixedpts_extraporder1_paramset2,vecbdypoints_fixedpts_extraporder1_paramset2,dsplsbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_fixedpts_extraporder1_paramset2,numbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,y_outermostpt0_fixedpts_extraporder1_paramset2,vecbdypoints_fixedpts_extraporder1_paramset2,dsplsbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_fixedpts_extraporder1_paramset2,numbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,z_outermostpt0_fixedpts_extraporder1_paramset2,vecbdypoints_fixedpts_extraporder1_paramset2,dsplsbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_fixedpts_extraporder1_paramset2 = malloc(sizeof(real));
	                                chiextrap0_fixedpts_extraporder1_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real));
	                                xiextrap0_fixedpts_extraporder1_paramset2  = malloc((basenumbdypoints_fixedpts_extraporder1_paramset2)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_fixedpts_extraporder1_paramset2,chiextrap0_fixedpts_extraporder1_paramset2,xiextrap0_fixedpts_extraporder1_paramset2,xpbdy0_fixedpts_extraporder1_paramset2,ypbdy0_fixedpts_extraporder1_paramset2,zpbdy0_fixedpts_extraporder1_paramset2,&basenumbdypoints_fixedpts_extraporder1_paramset2);  
	                                basebdy_Nchi_fixedpts_extraporder1_paramset2=0;//initialize
	                                basebdy_Nxi_fixedpts_extraporder1_paramset2=0; //initialize
	                                bdyn_(&basebdy_Nchi_fixedpts_extraporder1_paramset2,&basebdy_Nxi_fixedpts_extraporder1_paramset2,&basenumbdypoints_fixedpts_extraporder1_paramset2,chiextrap0_fixedpts_extraporder1_paramset2,xiextrap0_fixedpts_extraporder1_paramset2);  
	                                rhobdy0_fixedpts_extraporder1_paramset2 = malloc(sizeof(real));
	                                chibdy0_fixedpts_extraporder1_paramset2 = malloc(basebdy_Nchi_fixedpts_extraporder1_paramset2*sizeof(real));
	                                xibdy0_fixedpts_extraporder1_paramset2  = malloc(basebdy_Nxi_fixedpts_extraporder1_paramset2*sizeof(real));   
	                            }
	                        }
	
	
	                        extrap_bdyphi_fixedpts_(bdyphi_fixedpts_extraporder1_paramset2,
	                                        leadordcoeff_phi1,
	                                        xpbdy_fixedpts_extraporder1_paramset2,ypbdy_fixedpts_extraporder1_paramset2,zpbdy_fixedpts_extraporder1_paramset2,
	                                        chrbdy_fixedpts_extraporder1_paramset2,&numbdypoints_fixedpts_extraporder1_paramset2,
	                                        &bdy_extrap_order,
	                                        &ind_distance_fixedpts,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        extrap_quasiset_fixedpts_(quasiset_tt_fixedpts_extraporder1_paramset2,quasiset_tchi_fixedpts_extraporder1_paramset2,quasiset_txi_fixedpts_extraporder1_paramset2,
	                                quasiset_chichi_fixedpts_extraporder1_paramset2,quasiset_chixi_fixedpts_extraporder1_paramset2,
	                                quasiset_xixi_fixedpts_extraporder1_paramset2,
	                                quasiset_trace_fixedpts_extraporder1_paramset2,
	                                quasiset_massdensity_fixedpts_extraporder1_paramset2,
	                                quasiset_angmomdensityx_fixedpts_extraporder1_paramset2,
	                                quasiset_angmomdensityy_fixedpts_extraporder1_paramset2,
	                                quasiset_angmomdensityz_fixedpts_extraporder1_paramset2,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_fixedpts_extraporder1_paramset2,ypbdy_fixedpts_extraporder1_paramset2,zpbdy_fixedpts_extraporder1_paramset2,
	                                chrbdy_fixedpts_extraporder1_paramset2,&numbdypoints_fixedpts_extraporder1_paramset2,
	                                &bdy_extrap_order,
	                                &ind_distance_fixedpts,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_fixedpts_extraporder1_paramset2; i<ie_bdy_fixedpts_extraporder1_paramset2; i++)
	                        {
	                            lquasiset_tt0_fixedpts_extraporder1_paramset2           [i] = quasiset_tt_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_tchi0_fixedpts_extraporder1_paramset2         [i] = quasiset_tchi_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_txi0_fixedpts_extraporder1_paramset2          [i] = quasiset_txi_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_chichi0_fixedpts_extraporder1_paramset2       [i] = quasiset_chichi_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_chixi0_fixedpts_extraporder1_paramset2        [i] = quasiset_chixi_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_xixi0_fixedpts_extraporder1_paramset2         [i] = quasiset_xixi_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_trace0_fixedpts_extraporder1_paramset2        [i] = quasiset_trace_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_massdensity0_fixedpts_extraporder1_paramset2  [i] = quasiset_massdensity_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 [i] = quasiset_angmomdensityx_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 [i] = quasiset_angmomdensityy_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 [i] = quasiset_angmomdensityz_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                            lbdyphi0_fixedpts_extraporder1_paramset2                [i] = bdyphi_fixedpts_extraporder1_paramset2[i-is_bdy_fixedpts_extraporder1_paramset2];
	                        } 

	                       	//MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc-fixedpts_extraporder1_paramset2: pre print\n"); fflush(stdout);}    

	                        //PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder1_paramset2,          maxquasiset_tt0_fixedpts_extraporder1_paramset2,          basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder1_paramset2,        maxquasiset_tchi0_fixedpts_extraporder1_paramset2,        basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder1_paramset2,         maxquasiset_txi0_fixedpts_extraporder1_paramset2,         basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder1_paramset2,      maxquasiset_chichi0_fixedpts_extraporder1_paramset2,      basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder1_paramset2,       maxquasiset_chixi0_fixedpts_extraporder1_paramset2,       basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder1_paramset2,        maxquasiset_xixi0_fixedpts_extraporder1_paramset2,        basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder1_paramset2,       maxquasiset_trace0_fixedpts_extraporder1_paramset2,       basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder1_paramset2, maxquasiset_massdensity0_fixedpts_extraporder1_paramset2, basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2, maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2, basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2, maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2, basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2, maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2, basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder1_paramset2,               maxbdyphi0_fixedpts_extraporder1_paramset2,               basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder1_paramset2,          minquasiset_tt0_fixedpts_extraporder1_paramset2,          basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder1_paramset2,        minquasiset_tchi0_fixedpts_extraporder1_paramset2,        basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder1_paramset2,         minquasiset_txi0_fixedpts_extraporder1_paramset2,         basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder1_paramset2,      minquasiset_chichi0_fixedpts_extraporder1_paramset2,      basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder1_paramset2,       minquasiset_chixi0_fixedpts_extraporder1_paramset2,       basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder1_paramset2,        minquasiset_xixi0_fixedpts_extraporder1_paramset2,        basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder1_paramset2,       minquasiset_trace0_fixedpts_extraporder1_paramset2,       basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder1_paramset2, minquasiset_massdensity0_fixedpts_extraporder1_paramset2, basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2, minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2, basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2, minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2, basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2, minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2, basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder1_paramset2,               minbdyphi0_fixedpts_extraporder1_paramset2,               basenumbdypoints_fixedpts_extraporder1_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_fixedpts_extraporder1_paramset2; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_fixedpts_extraporder1_paramset2          [i] = maxquasiset_tt0_fixedpts_extraporder1_paramset2          [i] + minquasiset_tt0_fixedpts_extraporder1_paramset2          [i];
	                                    quasiset_tchi0_fixedpts_extraporder1_paramset2        [i] = maxquasiset_tchi0_fixedpts_extraporder1_paramset2        [i] + minquasiset_tchi0_fixedpts_extraporder1_paramset2        [i];
	                                    quasiset_txi0_fixedpts_extraporder1_paramset2         [i] = maxquasiset_txi0_fixedpts_extraporder1_paramset2         [i] + minquasiset_txi0_fixedpts_extraporder1_paramset2         [i];
	                                    quasiset_chichi0_fixedpts_extraporder1_paramset2      [i] = maxquasiset_chichi0_fixedpts_extraporder1_paramset2      [i] + minquasiset_chichi0_fixedpts_extraporder1_paramset2      [i];
	                                    quasiset_chixi0_fixedpts_extraporder1_paramset2       [i] = maxquasiset_chixi0_fixedpts_extraporder1_paramset2       [i] + minquasiset_chixi0_fixedpts_extraporder1_paramset2       [i];
	                                    quasiset_xixi0_fixedpts_extraporder1_paramset2        [i] = maxquasiset_xixi0_fixedpts_extraporder1_paramset2        [i] + minquasiset_xixi0_fixedpts_extraporder1_paramset2        [i];
	                                    quasiset_trace0_fixedpts_extraporder1_paramset2       [i] = maxquasiset_trace0_fixedpts_extraporder1_paramset2       [i] + minquasiset_trace0_fixedpts_extraporder1_paramset2       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder1_paramset2 [i] = maxquasiset_massdensity0_fixedpts_extraporder1_paramset2 [i] + minquasiset_massdensity0_fixedpts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 [i] + minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 [i] + minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 [i] + minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 [i];
	                                    bdyphi0_fixedpts_extraporder1_paramset2               [i] = maxbdyphi0_fixedpts_extraporder1_paramset2               [i] + minbdyphi0_fixedpts_extraporder1_paramset2               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_fixedpts_extraporder1_paramset2          [i] = maxquasiset_tt0_fixedpts_extraporder1_paramset2          [i];
	                                    quasiset_tchi0_fixedpts_extraporder1_paramset2        [i] = maxquasiset_tchi0_fixedpts_extraporder1_paramset2        [i];
	                                    quasiset_txi0_fixedpts_extraporder1_paramset2         [i] = maxquasiset_txi0_fixedpts_extraporder1_paramset2         [i];
	                                    quasiset_chichi0_fixedpts_extraporder1_paramset2      [i] = maxquasiset_chichi0_fixedpts_extraporder1_paramset2      [i];
	                                    quasiset_chixi0_fixedpts_extraporder1_paramset2       [i] = maxquasiset_chixi0_fixedpts_extraporder1_paramset2       [i];
	                                    quasiset_xixi0_fixedpts_extraporder1_paramset2        [i] = maxquasiset_xixi0_fixedpts_extraporder1_paramset2        [i];
	                                    quasiset_trace0_fixedpts_extraporder1_paramset2       [i] = maxquasiset_trace0_fixedpts_extraporder1_paramset2       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder1_paramset2 [i] = maxquasiset_massdensity0_fixedpts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2 [i];
	                                    bdyphi0_fixedpts_extraporder1_paramset2               [i] = maxbdyphi0_fixedpts_extraporder1_paramset2               [i];
	                                }  
	                        }       
	
							//MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc-fixedpts_extraporder1_paramset2: pre output\n"); fflush(stdout);}  

	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {
	                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    								name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder1_paramset2[j],ypbdy0_fixedpts_extraporder1_paramset2[j],zpbdy0_fixedpts_extraporder1_paramset2[j],j);
                                    }
                                    fclose(fp);
                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder1_paramset2[j],ypbdy0_fixedpts_extraporder1_paramset2[j],zpbdy0_fixedpts_extraporder1_paramset2[j],j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }   
	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder1_paramset2[j],y_outermostpt0_fixedpts_extraporder1_paramset2[j],z_outermostpt0_fixedpts_extraporder1_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder1_paramset2[j],y_outermostpt0_fixedpts_extraporder1_paramset2[j],z_outermostpt0_fixedpts_extraporder1_paramset2[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name); 
	                                	}   
	                                }
	                                if(output_bdyphi)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
                                    	sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder1_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder1_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                } 
	                                }    

                                    // save quasiset_ll as ascii
                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   									name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
                                                    ct,
                                                    quasiset_tt0_fixedpts_extraporder1_paramset2[j],quasiset_tchi0_fixedpts_extraporder1_paramset2[j],quasiset_txi0_fixedpts_extraporder1_paramset2[j],quasiset_chichi0_fixedpts_extraporder1_paramset2[j],quasiset_chixi0_fixedpts_extraporder1_paramset2[j],quasiset_xixi0_fixedpts_extraporder1_paramset2[j],
                                                    j);
                                    }
                                    fclose(fp);
                                    free(name);  
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_fixedpts_extraporder1_paramset2[j],quasiset_tchi0_fixedpts_extraporder1_paramset2[j],quasiset_txi0_fixedpts_extraporder1_paramset2[j],quasiset_chichi0_fixedpts_extraporder1_paramset2[j],quasiset_chixi0_fixedpts_extraporder1_paramset2[j],quasiset_xixi0_fixedpts_extraporder1_paramset2[j],
	                                                    j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }
	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_fixedpts_extraporder1_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_fixedpts_extraporder1_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_fixedpts_extraporder1_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_fixedpts_extraporder1_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {
		                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
		                            	sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_angmomdensityx0_fixedpts_extraporder1_paramset2[j],quasiset_angmomdensityy0_fixedpts_extraporder1_paramset2[j],quasiset_angmomdensityz0_fixedpts_extraporder1_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);   
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder1_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_fixedpts_extraporder1_paramset2[j],quasiset_angmomdensityy0_fixedpts_extraporder1_paramset2[j],quasiset_angmomdensityz0_fixedpts_extraporder1_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_fixedpts_extraporder1_paramset2=1;
	                                chibdy_xibdy_(chibdy0_fixedpts_extraporder1_paramset2,xibdy0_fixedpts_extraporder1_paramset2,xpbdy0_fixedpts_extraporder1_paramset2,ypbdy0_fixedpts_extraporder1_paramset2,zpbdy0_fixedpts_extraporder1_paramset2,&basenumbdypoints_fixedpts_extraporder1_paramset2,chiextrap0_fixedpts_extraporder1_paramset2,xiextrap0_fixedpts_extraporder1_paramset2,&basebdy_Nchi_fixedpts_extraporder1_paramset2,&basebdy_Nxi_fixedpts_extraporder1_paramset2);    
	                                doubleintegralonsphere_(AdS_mass0_fixedpts_extraporder1_paramset2,quasiset_massdensity0_fixedpts_extraporder1_paramset2,xpbdy0_fixedpts_extraporder1_paramset2,ypbdy0_fixedpts_extraporder1_paramset2,zpbdy0_fixedpts_extraporder1_paramset2,&basenumbdypoints_fixedpts_extraporder1_paramset2,rhobdy0_fixedpts_extraporder1_paramset2,chibdy0_fixedpts_extraporder1_paramset2,xibdy0_fixedpts_extraporder1_paramset2,&basebdy_Nchi_fixedpts_extraporder1_paramset2,&basebdy_Nxi_fixedpts_extraporder1_paramset2);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder1_paramset2_%st_AdSmass.txt",AMRD_save_tag) + 1;
   									name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_fixedpts_extraporder1_paramset2_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_fixedpts_extraporder1_paramset2);
	                                fclose(fp);
	                                free(name); 
	                            }
	                        }  

	                        //MPI_Barrier(MPI_COMM_WORLD);
							//if (my_rank==0) {printf("pre_io_calc-fixedpts_extraporder1_paramset2: pre free memory\n"); fflush(stdout);}    

	                        free(vecbdypoints_fixedpts_extraporder1_paramset2);
	                        free(dsplsbdypoints_fixedpts_extraporder1_paramset2);
	                        free(quasiset_tt_fixedpts_extraporder1_paramset2);
	                        free(quasiset_tchi_fixedpts_extraporder1_paramset2);
	                        free(quasiset_txi_fixedpts_extraporder1_paramset2);
	                        free(quasiset_chichi_fixedpts_extraporder1_paramset2);
	                        free(quasiset_chixi_fixedpts_extraporder1_paramset2);
	                        free(quasiset_xixi_fixedpts_extraporder1_paramset2);
	                        free(quasiset_trace_fixedpts_extraporder1_paramset2);
	                        free(quasiset_massdensity_fixedpts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityx_fixedpts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityy_fixedpts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityz_fixedpts_extraporder1_paramset2);
	                        free(bdyphi_fixedpts_extraporder1_paramset2);  
	                        free(xpbdy_fixedpts_extraporder1_paramset2);
	                        free(ypbdy_fixedpts_extraporder1_paramset2);
	                        free(zpbdy_fixedpts_extraporder1_paramset2);   
	                        free(x_outermostpt_fixedpts_extraporder1_paramset2);
	                        free(y_outermostpt_fixedpts_extraporder1_paramset2);
	                        free(z_outermostpt_fixedpts_extraporder1_paramset2);   
	
	                        free(lquasiset_tt0_fixedpts_extraporder1_paramset2);        
	                        free(lquasiset_tchi0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_txi0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_chichi0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_chixi0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_xixi0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_trace0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_massdensity0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2);
	                        free(lquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2);
	                        free(lbdyphi0_fixedpts_extraporder1_paramset2);      
	                        free(maxquasiset_tt0_fixedpts_extraporder1_paramset2);        
	                        free(maxquasiset_tchi0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_txi0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_chichi0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_chixi0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_xixi0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_trace0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_massdensity0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2);
	                        free(maxquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2);
	                        free(maxbdyphi0_fixedpts_extraporder1_paramset2);    
	                        free(minquasiset_tt0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_tchi0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_txi0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_chichi0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_chixi0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_xixi0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_trace0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_massdensity0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_angmomdensityx0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_angmomdensityy0_fixedpts_extraporder1_paramset2);
	                        free(minquasiset_angmomdensityz0_fixedpts_extraporder1_paramset2);
	                        free(minbdyphi0_fixedpts_extraporder1_paramset2);    
	                        free(quasiset_tt0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_tchi0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_txi0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_chichi0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_chixi0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_xixi0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_trace0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_massdensity0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityx0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityy0_fixedpts_extraporder1_paramset2);
	                        free(quasiset_angmomdensityz0_fixedpts_extraporder1_paramset2);
	                        free(bdyphi0_fixedpts_extraporder1_paramset2);
	                        free(AdS_mass0_fixedpts_extraporder1_paramset2);     
	                        free(xpbdy0_fixedpts_extraporder1_paramset2);
	                        free(ypbdy0_fixedpts_extraporder1_paramset2);
	                        free(zpbdy0_fixedpts_extraporder1_paramset2);
	                        free(x_outermostpt0_fixedpts_extraporder1_paramset2);
	                        free(y_outermostpt0_fixedpts_extraporder1_paramset2);
	                        free(z_outermostpt0_fixedpts_extraporder1_paramset2);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_fixedpts_extraporder1_paramset2);
	                            free(chiextrap0_fixedpts_extraporder1_paramset2);
	                            free(xiextrap0_fixedpts_extraporder1_paramset2);             
	                            free(rhobdy0_fixedpts_extraporder1_paramset2);
	                            free(chibdy0_fixedpts_extraporder1_paramset2);
	                            free(xibdy0_fixedpts_extraporder1_paramset2);    
	                        }   
                		}//closes condition on output_bdy_extraporder1_paramset2

		            	//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_fixedpts 1st order extrap paramset2\n"); fflush(stdout);}

	            		//SECOND ORDER EXTRAPOLATION
						if (output_bdy_extraporder2_paramset2)
            			{
                			bdy_extrap_order=2;

                			//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
	                        nexttobdypoints_fixedpts_(chrbdy_fixedpts_extraporder2_paramset2,&numbdypoints_fixedpts_extraporder2_paramset2,&bdy_extrap_order,&ind_distance_fixedpts,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset2,&half_steps_from_bdy_int_paramset2,&num_fixed_coords,fixed_coords,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);

	                    	//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_fixedpts_extraporder2_paramset2 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_fixedpts_extraporder2_paramset2 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_fixedpts_extraporder2_paramset2,1,MPI_INT,vecbdypoints_fixedpts_extraporder2_paramset2,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_fixedpts_extraporder2_paramset2,&basenumbdypoints_fixedpts_extraporder2_paramset2,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_fixedpts_extraporder2_paramset2=%i\n",numbdypoints_fixedpts_extraporder2_paramset2);
	                        //fflush(stdout); 
	                        quasiset_tt_fixedpts_extraporder2_paramset2              = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_tchi_fixedpts_extraporder2_paramset2            = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_txi_fixedpts_extraporder2_paramset2             = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_chichi_fixedpts_extraporder2_paramset2          = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_chixi_fixedpts_extraporder2_paramset2           = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_xixi_fixedpts_extraporder2_paramset2            = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_trace_fixedpts_extraporder2_paramset2           = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_massdensity_fixedpts_extraporder2_paramset2     = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx_fixedpts_extraporder2_paramset2  = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy_fixedpts_extraporder2_paramset2  = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz_fixedpts_extraporder2_paramset2  = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        bdyphi_fixedpts_extraporder2_paramset2                   = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));   
	                        xpbdy_fixedpts_extraporder2_paramset2               = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        ypbdy_fixedpts_extraporder2_paramset2               = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        zpbdy_fixedpts_extraporder2_paramset2               = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));  
	                       	x_outermostpt_fixedpts_extraporder2_paramset2            = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                       	y_outermostpt_fixedpts_extraporder2_paramset2            = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                       	z_outermostpt_fixedpts_extraporder2_paramset2            = malloc((numbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real)); 
	
	                        lquasiset_tt0_fixedpts_extraporder2_paramset2            = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_tchi0_fixedpts_extraporder2_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_txi0_fixedpts_extraporder2_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_chichi0_fixedpts_extraporder2_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_chixi0_fixedpts_extraporder2_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_xixi0_fixedpts_extraporder2_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_trace0_fixedpts_extraporder2_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_massdensity0_fixedpts_extraporder2_paramset2   = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2= malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2= malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2= malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        lbdyphi0_fixedpts_extraporder2_paramset2                 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));   
	                        maxquasiset_tt0_fixedpts_extraporder2_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_tchi0_fixedpts_extraporder2_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_txi0_fixedpts_extraporder2_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_chichi0_fixedpts_extraporder2_paramset2      = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_chixi0_fixedpts_extraporder2_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_xixi0_fixedpts_extraporder2_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_trace0_fixedpts_extraporder2_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_massdensity0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        maxbdyphi0_fixedpts_extraporder2_paramset2               = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));   
	                        minquasiset_tt0_fixedpts_extraporder2_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_tchi0_fixedpts_extraporder2_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_txi0_fixedpts_extraporder2_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_chichi0_fixedpts_extraporder2_paramset2      = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_chixi0_fixedpts_extraporder2_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_xixi0_fixedpts_extraporder2_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_trace0_fixedpts_extraporder2_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_massdensity0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        minbdyphi0_fixedpts_extraporder2_paramset2               = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));   
	                        quasiset_tt0_fixedpts_extraporder2_paramset2             = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_tchi0_fixedpts_extraporder2_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_txi0_fixedpts_extraporder2_paramset2            = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_chichi0_fixedpts_extraporder2_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_chixi0_fixedpts_extraporder2_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_xixi0_fixedpts_extraporder2_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_trace0_fixedpts_extraporder2_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_massdensity0_fixedpts_extraporder2_paramset2    = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        AdS_mass0_fixedpts_extraporder2_paramset2                = malloc(sizeof(real));
	                        bdyphi0_fixedpts_extraporder2_paramset2                  = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));    
	                        xpbdy0_fixedpts_extraporder2_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        ypbdy0_fixedpts_extraporder2_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                        zpbdy0_fixedpts_extraporder2_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));   
	                       	x_outermostpt0_fixedpts_extraporder2_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                       	y_outermostpt0_fixedpts_extraporder2_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                       	z_outermostpt0_fixedpts_extraporder2_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));   
	
	
	                        //initialize
	                        for (i=0;i<numbdypoints_fixedpts_extraporder2_paramset2;i++)
	                        {
	                            quasiset_tt_fixedpts_extraporder2_paramset2              [i] = 0;
	                            quasiset_tchi_fixedpts_extraporder2_paramset2            [i] = 0;
	                            quasiset_txi_fixedpts_extraporder2_paramset2             [i] = 0;
	                            quasiset_chichi_fixedpts_extraporder2_paramset2          [i] = 0;
	                            quasiset_chixi_fixedpts_extraporder2_paramset2           [i] = 0;
	                            quasiset_xixi_fixedpts_extraporder2_paramset2            [i] = 0;
	                            quasiset_trace_fixedpts_extraporder2_paramset2           [i] = 0;
	                            quasiset_massdensity_fixedpts_extraporder2_paramset2     [i] = 0;
	                            quasiset_angmomdensityx_fixedpts_extraporder2_paramset2  [i] = 0;
	                            quasiset_angmomdensityy_fixedpts_extraporder2_paramset2  [i] = 0;
	                            quasiset_angmomdensityz_fixedpts_extraporder2_paramset2  [i] = 0;
	                            bdyphi_fixedpts_extraporder2_paramset2                   [i] = 0;   
	                            xpbdy_fixedpts_extraporder2_paramset2               [i] = 0;
	                            ypbdy_fixedpts_extraporder2_paramset2               [i] = 0;
	                            zpbdy_fixedpts_extraporder2_paramset2               [i] = 0;
	                           	x_outermostpt_fixedpts_extraporder2_paramset2            [i] = 0;
	                           	y_outermostpt_fixedpts_extraporder2_paramset2            [i] = 0;
	                           	z_outermostpt_fixedpts_extraporder2_paramset2            [i] = 0;
	
	                        }   
	                        for (i=0;i<basenumbdypoints_fixedpts_extraporder2_paramset2;i++)
	                        {   
	                            lquasiset_tt0_fixedpts_extraporder2_paramset2            [i] = 0;
	                            lquasiset_tchi0_fixedpts_extraporder2_paramset2          [i] = 0;
	                            lquasiset_txi0_fixedpts_extraporder2_paramset2           [i] = 0;
	                            lquasiset_chichi0_fixedpts_extraporder2_paramset2        [i] = 0;
	                            lquasiset_chixi0_fixedpts_extraporder2_paramset2         [i] = 0;
	                            lquasiset_xixi0_fixedpts_extraporder2_paramset2          [i] = 0;
	                            lquasiset_trace0_fixedpts_extraporder2_paramset2         [i] = 0;
	                            lquasiset_massdensity0_fixedpts_extraporder2_paramset2   [i] = 0;
	                            lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2[i] = 0;
	                            lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2[i] = 0;
	                            lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2[i] = 0;
	                            lbdyphi0_fixedpts_extraporder2_paramset2                 [i] = 0;             
	                            maxquasiset_tt0_fixedpts_extraporder2_paramset2          [i] = 0;
	                            maxquasiset_tchi0_fixedpts_extraporder2_paramset2        [i] = 0;
	                            maxquasiset_txi0_fixedpts_extraporder2_paramset2         [i] = 0;
	                            maxquasiset_chichi0_fixedpts_extraporder2_paramset2      [i] = 0;
	                            maxquasiset_chixi0_fixedpts_extraporder2_paramset2       [i] = 0;
	                            maxquasiset_xixi0_fixedpts_extraporder2_paramset2        [i] = 0;
	                            maxquasiset_trace0_fixedpts_extraporder2_paramset2       [i] = 0;
	                            maxquasiset_massdensity0_fixedpts_extraporder2_paramset2 [i] = 0;
	                            maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 [i] = 0;
	                            maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 [i] = 0;
	                            maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 [i] = 0;
	                            maxbdyphi0_fixedpts_extraporder2_paramset2               [i] = 0;  
	                            minquasiset_tt0_fixedpts_extraporder2_paramset2          [i] = 0;
	                            minquasiset_tchi0_fixedpts_extraporder2_paramset2        [i] = 0;
	                            minquasiset_txi0_fixedpts_extraporder2_paramset2         [i] = 0;
	                            minquasiset_chichi0_fixedpts_extraporder2_paramset2      [i] = 0;
	                            minquasiset_chixi0_fixedpts_extraporder2_paramset2       [i] = 0;
	                            minquasiset_xixi0_fixedpts_extraporder2_paramset2        [i] = 0;
	                            minquasiset_trace0_fixedpts_extraporder2_paramset2       [i] = 0;
	                            minquasiset_massdensity0_fixedpts_extraporder2_paramset2 [i] = 0;
	                            minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 [i] = 0;
	                            minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 [i] = 0;
	                            minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 [i] = 0;
	                            minbdyphi0_fixedpts_extraporder2_paramset2               [i] = 0;  
	                            quasiset_tt0_fixedpts_extraporder2_paramset2             [i] = 0;
	                            quasiset_tchi0_fixedpts_extraporder2_paramset2           [i] = 0;
	                            quasiset_txi0_fixedpts_extraporder2_paramset2            [i] = 0;
	                            quasiset_chichi0_fixedpts_extraporder2_paramset2         [i] = 0;
	                            quasiset_chixi0_fixedpts_extraporder2_paramset2          [i] = 0;
	                            quasiset_xixi0_fixedpts_extraporder2_paramset2           [i] = 0;
	                            quasiset_trace0_fixedpts_extraporder2_paramset2          [i] = 0;
	                            quasiset_massdensity0_fixedpts_extraporder2_paramset2    [i] = 0;
	                            quasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 [i] = 0;
	                            quasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 [i] = 0;
	                            quasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 [i] = 0;
	                            bdyphi0_fixedpts_extraporder2_paramset2                  [i] = 0;   
	                            xpbdy0_fixedpts_extraporder2_paramset2              [i] = 0;
	                            ypbdy0_fixedpts_extraporder2_paramset2              [i] = 0;
	                            zpbdy0_fixedpts_extraporder2_paramset2              [i] = 0;  
	                           	x_outermostpt0_fixedpts_extraporder2_paramset2           [i] = 0;
	                           	y_outermostpt0_fixedpts_extraporder2_paramset2           [i] = 0;
	                           	z_outermostpt0_fixedpts_extraporder2_paramset2           [i] = 0;
	
	                        }
	                        *AdS_mass0_fixedpts_extraporder2_paramset2                    = 0; 
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_fixedpts_extraporder2_paramset2=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_fixedpts_extraporder2_paramset2=vecbdypoints_fixedpts_extraporder2_paramset2[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_fixedpts_extraporder2_paramset2=is_bdy_fixedpts_extraporder2_paramset2+vecbdypoints_fixedpts_extraporder2_paramset2[j];
	                            }
	                            ie_bdy_fixedpts_extraporder2_paramset2=is_bdy_fixedpts_extraporder2_paramset2+vecbdypoints_fixedpts_extraporder2_paramset2[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_fixedpts_extraporder2_paramset2[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_fixedpts_extraporder2_paramset2[i]=dsplsbdypoints_fixedpts_extraporder2_paramset2[i]+vecbdypoints_fixedpts_extraporder2_paramset2[j];
	                                }
	                            }
	                        }   
	
	                        xyz_extrap_outermost_(xpbdy_fixedpts_extraporder2_paramset2,ypbdy_fixedpts_extraporder2_paramset2,zpbdy_fixedpts_extraporder2_paramset2,
	                        						x_outermostpt_fixedpts_extraporder2_paramset2,y_outermostpt_fixedpts_extraporder2_paramset2,z_outermostpt_fixedpts_extraporder2_paramset2,
	                        						chrbdy_fixedpts_extraporder2_paramset2,&numbdypoints_fixedpts_extraporder2_paramset2,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_fixedpts_extraporder2_paramset2,numbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,xpbdy0_fixedpts_extraporder2_paramset2,vecbdypoints_fixedpts_extraporder2_paramset2,dsplsbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_fixedpts_extraporder2_paramset2,numbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,ypbdy0_fixedpts_extraporder2_paramset2,vecbdypoints_fixedpts_extraporder2_paramset2,dsplsbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_fixedpts_extraporder2_paramset2,numbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,zpbdy0_fixedpts_extraporder2_paramset2,vecbdypoints_fixedpts_extraporder2_paramset2,dsplsbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_fixedpts_extraporder2_paramset2,numbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,x_outermostpt0_fixedpts_extraporder2_paramset2,vecbdypoints_fixedpts_extraporder2_paramset2,dsplsbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_fixedpts_extraporder2_paramset2,numbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,y_outermostpt0_fixedpts_extraporder2_paramset2,vecbdypoints_fixedpts_extraporder2_paramset2,dsplsbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_fixedpts_extraporder2_paramset2,numbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,z_outermostpt0_fixedpts_extraporder2_paramset2,vecbdypoints_fixedpts_extraporder2_paramset2,dsplsbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_fixedpts_extraporder2_paramset2 = malloc(sizeof(real));
	                                chiextrap0_fixedpts_extraporder2_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real));
	                                xiextrap0_fixedpts_extraporder2_paramset2  = malloc((basenumbdypoints_fixedpts_extraporder2_paramset2)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_fixedpts_extraporder2_paramset2,chiextrap0_fixedpts_extraporder2_paramset2,xiextrap0_fixedpts_extraporder2_paramset2,xpbdy0_fixedpts_extraporder2_paramset2,ypbdy0_fixedpts_extraporder2_paramset2,zpbdy0_fixedpts_extraporder2_paramset2,&basenumbdypoints_fixedpts_extraporder2_paramset2);  
	                                basebdy_Nchi_fixedpts_extraporder2_paramset2=0;//initialize
	                                basebdy_Nxi_fixedpts_extraporder2_paramset2=0; //initialize
	                                bdyn_(&basebdy_Nchi_fixedpts_extraporder2_paramset2,&basebdy_Nxi_fixedpts_extraporder2_paramset2,&basenumbdypoints_fixedpts_extraporder2_paramset2,chiextrap0_fixedpts_extraporder2_paramset2,xiextrap0_fixedpts_extraporder2_paramset2);  
	                                rhobdy0_fixedpts_extraporder2_paramset2 = malloc(sizeof(real));
	                                chibdy0_fixedpts_extraporder2_paramset2 = malloc(basebdy_Nchi_fixedpts_extraporder2_paramset2*sizeof(real));
	                                xibdy0_fixedpts_extraporder2_paramset2  = malloc(basebdy_Nxi_fixedpts_extraporder2_paramset2*sizeof(real));   
	                            }
	                        }
	
	
	                        extrap_bdyphi_fixedpts_(bdyphi_fixedpts_extraporder2_paramset2,
	                                        leadordcoeff_phi1,
	                                        xpbdy_fixedpts_extraporder2_paramset2,ypbdy_fixedpts_extraporder2_paramset2,zpbdy_fixedpts_extraporder2_paramset2,
	                                        chrbdy_fixedpts_extraporder2_paramset2,&numbdypoints_fixedpts_extraporder2_paramset2,
	                                        &bdy_extrap_order,
	                                        &ind_distance_fixedpts,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        extrap_quasiset_fixedpts_(quasiset_tt_fixedpts_extraporder2_paramset2,quasiset_tchi_fixedpts_extraporder2_paramset2,quasiset_txi_fixedpts_extraporder2_paramset2,
	                                quasiset_chichi_fixedpts_extraporder2_paramset2,quasiset_chixi_fixedpts_extraporder2_paramset2,
	                                quasiset_xixi_fixedpts_extraporder2_paramset2,
	                                quasiset_trace_fixedpts_extraporder2_paramset2,
	                                quasiset_massdensity_fixedpts_extraporder2_paramset2,
	                                quasiset_angmomdensityx_fixedpts_extraporder2_paramset2,
	                                quasiset_angmomdensityy_fixedpts_extraporder2_paramset2,
	                                quasiset_angmomdensityz_fixedpts_extraporder2_paramset2,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_fixedpts_extraporder2_paramset2,ypbdy_fixedpts_extraporder2_paramset2,zpbdy_fixedpts_extraporder2_paramset2,
	                                chrbdy_fixedpts_extraporder2_paramset2,&numbdypoints_fixedpts_extraporder2_paramset2,
	                                &bdy_extrap_order,
	                                &ind_distance_fixedpts,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_fixedpts_extraporder2_paramset2; i<ie_bdy_fixedpts_extraporder2_paramset2; i++)
	                        {
	                            lquasiset_tt0_fixedpts_extraporder2_paramset2           [i] = quasiset_tt_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_tchi0_fixedpts_extraporder2_paramset2         [i] = quasiset_tchi_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_txi0_fixedpts_extraporder2_paramset2          [i] = quasiset_txi_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_chichi0_fixedpts_extraporder2_paramset2       [i] = quasiset_chichi_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_chixi0_fixedpts_extraporder2_paramset2        [i] = quasiset_chixi_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_xixi0_fixedpts_extraporder2_paramset2         [i] = quasiset_xixi_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_trace0_fixedpts_extraporder2_paramset2        [i] = quasiset_trace_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_massdensity0_fixedpts_extraporder2_paramset2  [i] = quasiset_massdensity_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 [i] = quasiset_angmomdensityx_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 [i] = quasiset_angmomdensityy_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 [i] = quasiset_angmomdensityz_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                            lbdyphi0_fixedpts_extraporder2_paramset2                [i] = bdyphi_fixedpts_extraporder2_paramset2[i-is_bdy_fixedpts_extraporder2_paramset2];
	                        }   

	                        //PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder2_paramset2,          maxquasiset_tt0_fixedpts_extraporder2_paramset2,          basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder2_paramset2,        maxquasiset_tchi0_fixedpts_extraporder2_paramset2,        basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder2_paramset2,         maxquasiset_txi0_fixedpts_extraporder2_paramset2,         basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder2_paramset2,      maxquasiset_chichi0_fixedpts_extraporder2_paramset2,      basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder2_paramset2,       maxquasiset_chixi0_fixedpts_extraporder2_paramset2,       basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder2_paramset2,        maxquasiset_xixi0_fixedpts_extraporder2_paramset2,        basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder2_paramset2,       maxquasiset_trace0_fixedpts_extraporder2_paramset2,       basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder2_paramset2, maxquasiset_massdensity0_fixedpts_extraporder2_paramset2, basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2, maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2, basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2, maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2, basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2, maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2, basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder2_paramset2,               maxbdyphi0_fixedpts_extraporder2_paramset2,               basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder2_paramset2,          minquasiset_tt0_fixedpts_extraporder2_paramset2,          basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder2_paramset2,        minquasiset_tchi0_fixedpts_extraporder2_paramset2,        basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder2_paramset2,         minquasiset_txi0_fixedpts_extraporder2_paramset2,         basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder2_paramset2,      minquasiset_chichi0_fixedpts_extraporder2_paramset2,      basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder2_paramset2,       minquasiset_chixi0_fixedpts_extraporder2_paramset2,       basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder2_paramset2,        minquasiset_xixi0_fixedpts_extraporder2_paramset2,        basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder2_paramset2,       minquasiset_trace0_fixedpts_extraporder2_paramset2,       basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder2_paramset2, minquasiset_massdensity0_fixedpts_extraporder2_paramset2, basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2, minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2, basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2, minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2, basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2, minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2, basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder2_paramset2,               minbdyphi0_fixedpts_extraporder2_paramset2,               basenumbdypoints_fixedpts_extraporder2_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_fixedpts_extraporder2_paramset2; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_fixedpts_extraporder2_paramset2          [i] = maxquasiset_tt0_fixedpts_extraporder2_paramset2          [i] + minquasiset_tt0_fixedpts_extraporder2_paramset2          [i];
	                                    quasiset_tchi0_fixedpts_extraporder2_paramset2        [i] = maxquasiset_tchi0_fixedpts_extraporder2_paramset2        [i] + minquasiset_tchi0_fixedpts_extraporder2_paramset2        [i];
	                                    quasiset_txi0_fixedpts_extraporder2_paramset2         [i] = maxquasiset_txi0_fixedpts_extraporder2_paramset2         [i] + minquasiset_txi0_fixedpts_extraporder2_paramset2         [i];
	                                    quasiset_chichi0_fixedpts_extraporder2_paramset2      [i] = maxquasiset_chichi0_fixedpts_extraporder2_paramset2      [i] + minquasiset_chichi0_fixedpts_extraporder2_paramset2      [i];
	                                    quasiset_chixi0_fixedpts_extraporder2_paramset2       [i] = maxquasiset_chixi0_fixedpts_extraporder2_paramset2       [i] + minquasiset_chixi0_fixedpts_extraporder2_paramset2       [i];
	                                    quasiset_xixi0_fixedpts_extraporder2_paramset2        [i] = maxquasiset_xixi0_fixedpts_extraporder2_paramset2        [i] + minquasiset_xixi0_fixedpts_extraporder2_paramset2        [i];
	                                    quasiset_trace0_fixedpts_extraporder2_paramset2       [i] = maxquasiset_trace0_fixedpts_extraporder2_paramset2       [i] + minquasiset_trace0_fixedpts_extraporder2_paramset2       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder2_paramset2 [i] = maxquasiset_massdensity0_fixedpts_extraporder2_paramset2 [i] + minquasiset_massdensity0_fixedpts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 [i] + minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 [i] + minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 [i] + minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 [i];
	                                    bdyphi0_fixedpts_extraporder2_paramset2               [i] = maxbdyphi0_fixedpts_extraporder2_paramset2               [i] + minbdyphi0_fixedpts_extraporder2_paramset2               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_fixedpts_extraporder2_paramset2          [i] = maxquasiset_tt0_fixedpts_extraporder2_paramset2          [i];
	                                    quasiset_tchi0_fixedpts_extraporder2_paramset2        [i] = maxquasiset_tchi0_fixedpts_extraporder2_paramset2        [i];
	                                    quasiset_txi0_fixedpts_extraporder2_paramset2         [i] = maxquasiset_txi0_fixedpts_extraporder2_paramset2         [i];
	                                    quasiset_chichi0_fixedpts_extraporder2_paramset2      [i] = maxquasiset_chichi0_fixedpts_extraporder2_paramset2      [i];
	                                    quasiset_chixi0_fixedpts_extraporder2_paramset2       [i] = maxquasiset_chixi0_fixedpts_extraporder2_paramset2       [i];
	                                    quasiset_xixi0_fixedpts_extraporder2_paramset2        [i] = maxquasiset_xixi0_fixedpts_extraporder2_paramset2        [i];
	                                    quasiset_trace0_fixedpts_extraporder2_paramset2       [i] = maxquasiset_trace0_fixedpts_extraporder2_paramset2       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder2_paramset2 [i] = maxquasiset_massdensity0_fixedpts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2 [i];
	                                    bdyphi0_fixedpts_extraporder2_paramset2               [i] = maxbdyphi0_fixedpts_extraporder2_paramset2               [i];
	                                }  
	                        }       
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {
	                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    								name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder2_paramset2[j],ypbdy0_fixedpts_extraporder2_paramset2[j],zpbdy0_fixedpts_extraporder2_paramset2[j],j);
                                    }
                                    fclose(fp);
                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder2_paramset2[j],ypbdy0_fixedpts_extraporder2_paramset2[j],zpbdy0_fixedpts_extraporder2_paramset2[j],j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }   
	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder2_paramset2[j],y_outermostpt0_fixedpts_extraporder2_paramset2[j],z_outermostpt0_fixedpts_extraporder2_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder2_paramset2[j],y_outermostpt0_fixedpts_extraporder2_paramset2[j],z_outermostpt0_fixedpts_extraporder2_paramset2[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name); 
	                                	}   
	                                }
	                                if(output_bdyphi)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
                                    	sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder2_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder2_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                } 
	                                }    

                                    // save quasiset_ll as ascii
                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   									name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
                                                    ct,
                                                    quasiset_tt0_fixedpts_extraporder2_paramset2[j],quasiset_tchi0_fixedpts_extraporder2_paramset2[j],quasiset_txi0_fixedpts_extraporder2_paramset2[j],quasiset_chichi0_fixedpts_extraporder2_paramset2[j],quasiset_chixi0_fixedpts_extraporder2_paramset2[j],quasiset_xixi0_fixedpts_extraporder2_paramset2[j],
                                                    j);
                                    }
                                    fclose(fp);
                                    free(name);  
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_fixedpts_extraporder2_paramset2[j],quasiset_tchi0_fixedpts_extraporder2_paramset2[j],quasiset_txi0_fixedpts_extraporder2_paramset2[j],quasiset_chichi0_fixedpts_extraporder2_paramset2[j],quasiset_chixi0_fixedpts_extraporder2_paramset2[j],quasiset_xixi0_fixedpts_extraporder2_paramset2[j],
	                                                    j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }
	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_fixedpts_extraporder2_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_fixedpts_extraporder2_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_fixedpts_extraporder2_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_fixedpts_extraporder2_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {
		                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
		                            	sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_angmomdensityx0_fixedpts_extraporder2_paramset2[j],quasiset_angmomdensityy0_fixedpts_extraporder2_paramset2[j],quasiset_angmomdensityz0_fixedpts_extraporder2_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);   
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder2_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_fixedpts_extraporder2_paramset2[j],quasiset_angmomdensityy0_fixedpts_extraporder2_paramset2[j],quasiset_angmomdensityz0_fixedpts_extraporder2_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_fixedpts_extraporder2_paramset2=1;
	                                chibdy_xibdy_(chibdy0_fixedpts_extraporder2_paramset2,xibdy0_fixedpts_extraporder2_paramset2,xpbdy0_fixedpts_extraporder2_paramset2,ypbdy0_fixedpts_extraporder2_paramset2,zpbdy0_fixedpts_extraporder2_paramset2,&basenumbdypoints_fixedpts_extraporder2_paramset2,chiextrap0_fixedpts_extraporder2_paramset2,xiextrap0_fixedpts_extraporder2_paramset2,&basebdy_Nchi_fixedpts_extraporder2_paramset2,&basebdy_Nxi_fixedpts_extraporder2_paramset2);    
	                                doubleintegralonsphere_(AdS_mass0_fixedpts_extraporder2_paramset2,quasiset_massdensity0_fixedpts_extraporder2_paramset2,xpbdy0_fixedpts_extraporder2_paramset2,ypbdy0_fixedpts_extraporder2_paramset2,zpbdy0_fixedpts_extraporder2_paramset2,&basenumbdypoints_fixedpts_extraporder2_paramset2,rhobdy0_fixedpts_extraporder2_paramset2,chibdy0_fixedpts_extraporder2_paramset2,xibdy0_fixedpts_extraporder2_paramset2,&basebdy_Nchi_fixedpts_extraporder2_paramset2,&basebdy_Nxi_fixedpts_extraporder2_paramset2);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder2_paramset2_%st_AdSmass.txt",AMRD_save_tag) + 1;
   									name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_fixedpts_extraporder2_paramset2_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_fixedpts_extraporder2_paramset2);
	                                fclose(fp);
	                                free(name); 
	                            }
	                        }     

	                        free(vecbdypoints_fixedpts_extraporder2_paramset2);
	                        free(dsplsbdypoints_fixedpts_extraporder2_paramset2);
	                        free(quasiset_tt_fixedpts_extraporder2_paramset2);
	                        free(quasiset_tchi_fixedpts_extraporder2_paramset2);
	                        free(quasiset_txi_fixedpts_extraporder2_paramset2);
	                        free(quasiset_chichi_fixedpts_extraporder2_paramset2);
	                        free(quasiset_chixi_fixedpts_extraporder2_paramset2);
	                        free(quasiset_xixi_fixedpts_extraporder2_paramset2);
	                        free(quasiset_trace_fixedpts_extraporder2_paramset2);
	                        free(quasiset_massdensity_fixedpts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityx_fixedpts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityy_fixedpts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityz_fixedpts_extraporder2_paramset2);
	                        free(bdyphi_fixedpts_extraporder2_paramset2);  
	                        free(xpbdy_fixedpts_extraporder2_paramset2);
	                        free(ypbdy_fixedpts_extraporder2_paramset2);
	                        free(zpbdy_fixedpts_extraporder2_paramset2);   
	                        free(x_outermostpt_fixedpts_extraporder2_paramset2);
	                        free(y_outermostpt_fixedpts_extraporder2_paramset2);
	                        free(z_outermostpt_fixedpts_extraporder2_paramset2);   
	
	                        free(lquasiset_tt0_fixedpts_extraporder2_paramset2);        
	                        free(lquasiset_tchi0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_txi0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_chichi0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_chixi0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_xixi0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_trace0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_massdensity0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2);
	                        free(lquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2);
	                        free(lbdyphi0_fixedpts_extraporder2_paramset2);      
	                        free(maxquasiset_tt0_fixedpts_extraporder2_paramset2);        
	                        free(maxquasiset_tchi0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_txi0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_chichi0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_chixi0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_xixi0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_trace0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_massdensity0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2);
	                        free(maxquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2);
	                        free(maxbdyphi0_fixedpts_extraporder2_paramset2);    
	                        free(minquasiset_tt0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_tchi0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_txi0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_chichi0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_chixi0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_xixi0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_trace0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_massdensity0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_angmomdensityx0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_angmomdensityy0_fixedpts_extraporder2_paramset2);
	                        free(minquasiset_angmomdensityz0_fixedpts_extraporder2_paramset2);
	                        free(minbdyphi0_fixedpts_extraporder2_paramset2);    
	                        free(quasiset_tt0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_tchi0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_txi0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_chichi0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_chixi0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_xixi0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_trace0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_massdensity0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityx0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityy0_fixedpts_extraporder2_paramset2);
	                        free(quasiset_angmomdensityz0_fixedpts_extraporder2_paramset2);
	                        free(bdyphi0_fixedpts_extraporder2_paramset2);
	                        free(AdS_mass0_fixedpts_extraporder2_paramset2);     
	                        free(xpbdy0_fixedpts_extraporder2_paramset2);
	                        free(ypbdy0_fixedpts_extraporder2_paramset2);
	                        free(zpbdy0_fixedpts_extraporder2_paramset2);
	                        free(x_outermostpt0_fixedpts_extraporder2_paramset2);
	                        free(y_outermostpt0_fixedpts_extraporder2_paramset2);
	                        free(z_outermostpt0_fixedpts_extraporder2_paramset2);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_fixedpts_extraporder2_paramset2);
	                            free(chiextrap0_fixedpts_extraporder2_paramset2);
	                            free(xiextrap0_fixedpts_extraporder2_paramset2);             
	                            free(rhobdy0_fixedpts_extraporder2_paramset2);
	                            free(chibdy0_fixedpts_extraporder2_paramset2);
	                            free(xibdy0_fixedpts_extraporder2_paramset2);    
	                        }   
                		}//closes condition on output_bdy_extraporder2_paramset2

                		//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_fixedpts 2nd order extrap paramset2\n"); fflush(stdout);}

	            		//THIRD ORDER EXTRAPOLATION
						if (output_bdy_extraporder3_paramset2)
            			{
                			bdy_extrap_order=3;

                			//COMPUTE NUMBER OF BOUNDARY QUANTITIES    
							nexttobdypoints_fixedpts_(chrbdy_fixedpts_extraporder3_paramset2,&numbdypoints_fixedpts_extraporder3_paramset2,&bdy_extrap_order,&ind_distance_fixedpts,&currentres_ratio_Lhighres_Llowres,&half_steps_from_bdy_ext_paramset2,&half_steps_from_bdy_int_paramset2,&num_fixed_coords,fixed_coords,x,y,z,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width); 

	                    	//PERFORM BOUNDARY EXTRAPOLATION
	                        vecbdypoints_fixedpts_extraporder3_paramset2 = malloc(uniSize*sizeof(int));
	                        dsplsbdypoints_fixedpts_extraporder3_paramset2 = malloc(uniSize*sizeof(int));    
	                        //the ith element of vecbdypoints contains the number of nexttobdypoints identified by nexttobdypoints routine for the ith process
	                        MPI_Allgather(&numbdypoints_fixedpts_extraporder3_paramset2,1,MPI_INT,vecbdypoints_fixedpts_extraporder3_paramset2,1,MPI_INT,MPI_COMM_WORLD); 
	                        //basenumbdypoints contains the sum of the number of nexttobdypoints from all processes, i.e. the total number of nexttobdypoints, hence the total number of points at the boundary where we extrapolate the stress-energy tensor
	                        MPI_Allreduce(&numbdypoints_fixedpts_extraporder3_paramset2,&basenumbdypoints_fixedpts_extraporder3_paramset2,1,MPI_INT,MPI_SUM,MPI_COMM_WORLD);  
	                        //printf("numbdypoints_fixedpts_extraporder3_paramset2=%i\n",numbdypoints_fixedpts_extraporder3_paramset2);
	                        //fflush(stdout); 
	                        quasiset_tt_fixedpts_extraporder3_paramset2              = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_tchi_fixedpts_extraporder3_paramset2            = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_txi_fixedpts_extraporder3_paramset2             = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_chichi_fixedpts_extraporder3_paramset2          = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_chixi_fixedpts_extraporder3_paramset2           = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_xixi_fixedpts_extraporder3_paramset2            = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_trace_fixedpts_extraporder3_paramset2           = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_massdensity_fixedpts_extraporder3_paramset2     = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx_fixedpts_extraporder3_paramset2  = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy_fixedpts_extraporder3_paramset2  = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz_fixedpts_extraporder3_paramset2  = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        bdyphi_fixedpts_extraporder3_paramset2                   = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));   
	                        xpbdy_fixedpts_extraporder3_paramset2               = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        ypbdy_fixedpts_extraporder3_paramset2               = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        zpbdy_fixedpts_extraporder3_paramset2               = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));  
	                       	x_outermostpt_fixedpts_extraporder3_paramset2            = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                       	y_outermostpt_fixedpts_extraporder3_paramset2            = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                       	z_outermostpt_fixedpts_extraporder3_paramset2            = malloc((numbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real)); 
	
	                        lquasiset_tt0_fixedpts_extraporder3_paramset2            = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_tchi0_fixedpts_extraporder3_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_txi0_fixedpts_extraporder3_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_chichi0_fixedpts_extraporder3_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_chixi0_fixedpts_extraporder3_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_xixi0_fixedpts_extraporder3_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_trace0_fixedpts_extraporder3_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_massdensity0_fixedpts_extraporder3_paramset2   = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2= malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2= malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2= malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        lbdyphi0_fixedpts_extraporder3_paramset2                 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));   
	                        maxquasiset_tt0_fixedpts_extraporder3_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_tchi0_fixedpts_extraporder3_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_txi0_fixedpts_extraporder3_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_chichi0_fixedpts_extraporder3_paramset2      = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_chixi0_fixedpts_extraporder3_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_xixi0_fixedpts_extraporder3_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_trace0_fixedpts_extraporder3_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_massdensity0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        maxbdyphi0_fixedpts_extraporder3_paramset2               = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));   
	                        minquasiset_tt0_fixedpts_extraporder3_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_tchi0_fixedpts_extraporder3_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_txi0_fixedpts_extraporder3_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_chichi0_fixedpts_extraporder3_paramset2      = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_chixi0_fixedpts_extraporder3_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_xixi0_fixedpts_extraporder3_paramset2        = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_trace0_fixedpts_extraporder3_paramset2       = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_massdensity0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        minbdyphi0_fixedpts_extraporder3_paramset2               = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));   
	                        quasiset_tt0_fixedpts_extraporder3_paramset2             = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_tchi0_fixedpts_extraporder3_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_txi0_fixedpts_extraporder3_paramset2            = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_chichi0_fixedpts_extraporder3_paramset2         = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_chixi0_fixedpts_extraporder3_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_xixi0_fixedpts_extraporder3_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_trace0_fixedpts_extraporder3_paramset2          = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_massdensity0_fixedpts_extraporder3_paramset2    = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        quasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        AdS_mass0_fixedpts_extraporder3_paramset2                = malloc(sizeof(real));
	                        bdyphi0_fixedpts_extraporder3_paramset2                  = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));    
	                        xpbdy0_fixedpts_extraporder3_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        ypbdy0_fixedpts_extraporder3_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                        zpbdy0_fixedpts_extraporder3_paramset2              = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));   
	                       	x_outermostpt0_fixedpts_extraporder3_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                       	y_outermostpt0_fixedpts_extraporder3_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                       	z_outermostpt0_fixedpts_extraporder3_paramset2           = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));   
	
	
	                        //initialize
	                        for (i=0;i<numbdypoints_fixedpts_extraporder3_paramset2;i++)
	                        {
	                            quasiset_tt_fixedpts_extraporder3_paramset2              [i] = 0;
	                            quasiset_tchi_fixedpts_extraporder3_paramset2            [i] = 0;
	                            quasiset_txi_fixedpts_extraporder3_paramset2             [i] = 0;
	                            quasiset_chichi_fixedpts_extraporder3_paramset2          [i] = 0;
	                            quasiset_chixi_fixedpts_extraporder3_paramset2           [i] = 0;
	                            quasiset_xixi_fixedpts_extraporder3_paramset2            [i] = 0;
	                            quasiset_trace_fixedpts_extraporder3_paramset2           [i] = 0;
	                            quasiset_massdensity_fixedpts_extraporder3_paramset2     [i] = 0;
	                            quasiset_angmomdensityx_fixedpts_extraporder3_paramset2  [i] = 0;
	                            quasiset_angmomdensityy_fixedpts_extraporder3_paramset2  [i] = 0;
	                            quasiset_angmomdensityz_fixedpts_extraporder3_paramset2  [i] = 0;
	                            bdyphi_fixedpts_extraporder3_paramset2                   [i] = 0;   
	                            xpbdy_fixedpts_extraporder3_paramset2               [i] = 0;
	                            ypbdy_fixedpts_extraporder3_paramset2               [i] = 0;
	                            zpbdy_fixedpts_extraporder3_paramset2               [i] = 0;
	                           	x_outermostpt_fixedpts_extraporder3_paramset2            [i] = 0;
	                           	y_outermostpt_fixedpts_extraporder3_paramset2            [i] = 0;
	                           	z_outermostpt_fixedpts_extraporder3_paramset2            [i] = 0;
	
	                        }   
	                        for (i=0;i<basenumbdypoints_fixedpts_extraporder3_paramset2;i++)
	                        {   
	                            lquasiset_tt0_fixedpts_extraporder3_paramset2            [i] = 0;
	                            lquasiset_tchi0_fixedpts_extraporder3_paramset2          [i] = 0;
	                            lquasiset_txi0_fixedpts_extraporder3_paramset2           [i] = 0;
	                            lquasiset_chichi0_fixedpts_extraporder3_paramset2        [i] = 0;
	                            lquasiset_chixi0_fixedpts_extraporder3_paramset2         [i] = 0;
	                            lquasiset_xixi0_fixedpts_extraporder3_paramset2          [i] = 0;
	                            lquasiset_trace0_fixedpts_extraporder3_paramset2         [i] = 0;
	                            lquasiset_massdensity0_fixedpts_extraporder3_paramset2   [i] = 0;
	                            lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2[i] = 0;
	                            lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2[i] = 0;
	                            lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2[i] = 0;
	                            lbdyphi0_fixedpts_extraporder3_paramset2                 [i] = 0;             
	                            maxquasiset_tt0_fixedpts_extraporder3_paramset2          [i] = 0;
	                            maxquasiset_tchi0_fixedpts_extraporder3_paramset2        [i] = 0;
	                            maxquasiset_txi0_fixedpts_extraporder3_paramset2         [i] = 0;
	                            maxquasiset_chichi0_fixedpts_extraporder3_paramset2      [i] = 0;
	                            maxquasiset_chixi0_fixedpts_extraporder3_paramset2       [i] = 0;
	                            maxquasiset_xixi0_fixedpts_extraporder3_paramset2        [i] = 0;
	                            maxquasiset_trace0_fixedpts_extraporder3_paramset2       [i] = 0;
	                            maxquasiset_massdensity0_fixedpts_extraporder3_paramset2 [i] = 0;
	                            maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 [i] = 0;
	                            maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 [i] = 0;
	                            maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 [i] = 0;
	                            maxbdyphi0_fixedpts_extraporder3_paramset2               [i] = 0;  
	                            minquasiset_tt0_fixedpts_extraporder3_paramset2          [i] = 0;
	                            minquasiset_tchi0_fixedpts_extraporder3_paramset2        [i] = 0;
	                            minquasiset_txi0_fixedpts_extraporder3_paramset2         [i] = 0;
	                            minquasiset_chichi0_fixedpts_extraporder3_paramset2      [i] = 0;
	                            minquasiset_chixi0_fixedpts_extraporder3_paramset2       [i] = 0;
	                            minquasiset_xixi0_fixedpts_extraporder3_paramset2        [i] = 0;
	                            minquasiset_trace0_fixedpts_extraporder3_paramset2       [i] = 0;
	                            minquasiset_massdensity0_fixedpts_extraporder3_paramset2 [i] = 0;
	                            minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 [i] = 0;
	                            minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 [i] = 0;
	                            minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 [i] = 0;
	                            minbdyphi0_fixedpts_extraporder3_paramset2               [i] = 0;  
	                            quasiset_tt0_fixedpts_extraporder3_paramset2             [i] = 0;
	                            quasiset_tchi0_fixedpts_extraporder3_paramset2           [i] = 0;
	                            quasiset_txi0_fixedpts_extraporder3_paramset2            [i] = 0;
	                            quasiset_chichi0_fixedpts_extraporder3_paramset2         [i] = 0;
	                            quasiset_chixi0_fixedpts_extraporder3_paramset2          [i] = 0;
	                            quasiset_xixi0_fixedpts_extraporder3_paramset2           [i] = 0;
	                            quasiset_trace0_fixedpts_extraporder3_paramset2          [i] = 0;
	                            quasiset_massdensity0_fixedpts_extraporder3_paramset2    [i] = 0;
	                            quasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 [i] = 0;
	                            quasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 [i] = 0;
	                            quasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 [i] = 0;
	                            bdyphi0_fixedpts_extraporder3_paramset2                  [i] = 0;   
	                            xpbdy0_fixedpts_extraporder3_paramset2              [i] = 0;
	                            ypbdy0_fixedpts_extraporder3_paramset2              [i] = 0;
	                            zpbdy0_fixedpts_extraporder3_paramset2              [i] = 0;  
	                           	x_outermostpt0_fixedpts_extraporder3_paramset2           [i] = 0;
	                           	y_outermostpt0_fixedpts_extraporder3_paramset2           [i] = 0;
	                           	z_outermostpt0_fixedpts_extraporder3_paramset2           [i] = 0;
	
	                        }
	                        *AdS_mass0_fixedpts_extraporder3_paramset2                    = 0; 
	
	                        //we want the indices from is to ie to identify the bdypoints of each processor starting the count from the last bdypoint of the previous processor
	                        is_bdy_fixedpts_extraporder3_paramset2=0;
	                        if (my_rank==0)
	                        {
	                            ie_bdy_fixedpts_extraporder3_paramset2=vecbdypoints_fixedpts_extraporder3_paramset2[0];
	                        }
	                        else
	                        {
	                            for (j=0; j<my_rank; j++)
	                            {
	                                is_bdy_fixedpts_extraporder3_paramset2=is_bdy_fixedpts_extraporder3_paramset2+vecbdypoints_fixedpts_extraporder3_paramset2[j];
	                            }
	                            ie_bdy_fixedpts_extraporder3_paramset2=is_bdy_fixedpts_extraporder3_paramset2+vecbdypoints_fixedpts_extraporder3_paramset2[my_rank];
	                        }      
	                        //the ith element of dsplsbdypoints contains the number of nexttobdypoints of the processor i-1. We need this array as displacement array for MPI_Allgatherv below.
	                        for (i=0; i<uniSize; i++)
	                        {
	                            dsplsbdypoints_fixedpts_extraporder3_paramset2[i]=0;
	                        }         
	                        for (i=0; i<uniSize; i++)
	                        {
	                            if (i!=0)
	                            {
	                                for (j=0; j<i; j++)
	                                {
	                                    dsplsbdypoints_fixedpts_extraporder3_paramset2[i]=dsplsbdypoints_fixedpts_extraporder3_paramset2[i]+vecbdypoints_fixedpts_extraporder3_paramset2[j];
	                                }
	                            }
	                        }   
	
	                        xyz_extrap_outermost_(xpbdy_fixedpts_extraporder3_paramset2,ypbdy_fixedpts_extraporder3_paramset2,zpbdy_fixedpts_extraporder3_paramset2,
	                        						x_outermostpt_fixedpts_extraporder3_paramset2,y_outermostpt_fixedpts_extraporder3_paramset2,z_outermostpt_fixedpts_extraporder3_paramset2,
	                        						chrbdy_fixedpts_extraporder3_paramset2,&numbdypoints_fixedpts_extraporder3_paramset2,x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,ghost_width);    
	
	                        //x/y/zpbdy0 are arrays with xpbdy,ypbdy,zpbdy from all the processors one after the other
	                        MPI_Allgatherv(xpbdy_fixedpts_extraporder3_paramset2,numbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,xpbdy0_fixedpts_extraporder3_paramset2,vecbdypoints_fixedpts_extraporder3_paramset2,dsplsbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(ypbdy_fixedpts_extraporder3_paramset2,numbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,ypbdy0_fixedpts_extraporder3_paramset2,vecbdypoints_fixedpts_extraporder3_paramset2,dsplsbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        MPI_Allgatherv(zpbdy_fixedpts_extraporder3_paramset2,numbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,zpbdy0_fixedpts_extraporder3_paramset2,vecbdypoints_fixedpts_extraporder3_paramset2,dsplsbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);  
	                        if(output_outermostpts)
	                        {
	                        	MPI_Allgatherv(x_outermostpt_fixedpts_extraporder3_paramset2,numbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,x_outermostpt0_fixedpts_extraporder3_paramset2,vecbdypoints_fixedpts_extraporder3_paramset2,dsplsbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(y_outermostpt_fixedpts_extraporder3_paramset2,numbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,y_outermostpt0_fixedpts_extraporder3_paramset2,vecbdypoints_fixedpts_extraporder3_paramset2,dsplsbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);
	                        	MPI_Allgatherv(z_outermostpt_fixedpts_extraporder3_paramset2,numbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,z_outermostpt0_fixedpts_extraporder3_paramset2,vecbdypoints_fixedpts_extraporder3_paramset2,dsplsbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_COMM_WORLD);                       
	                        }
	                        //the following bit allocates memory to compute AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        {
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) 
	                                {
	                                    printf("THE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT TRUSTWORTHY...\n NOT ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS\n");
	                                    printf("...setting output_AdS_mass to 0...");
	                                }
	                                output_AdS_mass=0;
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("RUNNING ON ONLY 1 PROCESS...ALLOCATING MEMORY FOR COMPUTATION OF AdS MASS ON ONLY 1 PROCESS\n");
	                                rhoextrap0_fixedpts_extraporder3_paramset2 = malloc(sizeof(real));
	                                chiextrap0_fixedpts_extraporder3_paramset2 = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real));
	                                xiextrap0_fixedpts_extraporder3_paramset2  = malloc((basenumbdypoints_fixedpts_extraporder3_paramset2)*sizeof(real)); 
	                                chixiextrap_(rhoextrap0_fixedpts_extraporder3_paramset2,chiextrap0_fixedpts_extraporder3_paramset2,xiextrap0_fixedpts_extraporder3_paramset2,xpbdy0_fixedpts_extraporder3_paramset2,ypbdy0_fixedpts_extraporder3_paramset2,zpbdy0_fixedpts_extraporder3_paramset2,&basenumbdypoints_fixedpts_extraporder3_paramset2);  
	                                basebdy_Nchi_fixedpts_extraporder3_paramset2=0;//initialize
	                                basebdy_Nxi_fixedpts_extraporder3_paramset2=0; //initialize
	                                bdyn_(&basebdy_Nchi_fixedpts_extraporder3_paramset2,&basebdy_Nxi_fixedpts_extraporder3_paramset2,&basenumbdypoints_fixedpts_extraporder3_paramset2,chiextrap0_fixedpts_extraporder3_paramset2,xiextrap0_fixedpts_extraporder3_paramset2);  
	                                rhobdy0_fixedpts_extraporder3_paramset2 = malloc(sizeof(real));
	                                chibdy0_fixedpts_extraporder3_paramset2 = malloc(basebdy_Nchi_fixedpts_extraporder3_paramset2*sizeof(real));
	                                xibdy0_fixedpts_extraporder3_paramset2  = malloc(basebdy_Nxi_fixedpts_extraporder3_paramset2*sizeof(real));   
	                            }
	                        }
	
	
	                        extrap_bdyphi_fixedpts_(bdyphi_fixedpts_extraporder3_paramset2,
	                                        leadordcoeff_phi1,
	                                        xpbdy_fixedpts_extraporder3_paramset2,ypbdy_fixedpts_extraporder3_paramset2,zpbdy_fixedpts_extraporder3_paramset2,
	                                        chrbdy_fixedpts_extraporder3_paramset2,&numbdypoints_fixedpts_extraporder3_paramset2,
	                                        &bdy_extrap_order,
	                                        &ind_distance_fixedpts,
	                                        x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        extrap_quasiset_fixedpts_(quasiset_tt_fixedpts_extraporder3_paramset2,quasiset_tchi_fixedpts_extraporder3_paramset2,quasiset_txi_fixedpts_extraporder3_paramset2,
	                                quasiset_chichi_fixedpts_extraporder3_paramset2,quasiset_chixi_fixedpts_extraporder3_paramset2,
	                                quasiset_xixi_fixedpts_extraporder3_paramset2,
	                                quasiset_trace_fixedpts_extraporder3_paramset2,
	                                quasiset_massdensity_fixedpts_extraporder3_paramset2,
	                                quasiset_angmomdensityx_fixedpts_extraporder3_paramset2,
	                                quasiset_angmomdensityy_fixedpts_extraporder3_paramset2,
	                                quasiset_angmomdensityz_fixedpts_extraporder3_paramset2,
	                                quasiset_tt_ll,quasiset_tchi_ll,quasiset_txi_ll,
	                                quasiset_chichi_ll,quasiset_chixi_ll,
	                                quasiset_xixi_ll,
	                                quasiset_tracell,
	                                quasiset_massdensityll,
	                                quasiset_angmomdensityxll,
	                                quasiset_angmomdensityyll,
	                                quasiset_angmomdensityzll,
	                                xpbdy_fixedpts_extraporder3_paramset2,ypbdy_fixedpts_extraporder3_paramset2,zpbdy_fixedpts_extraporder3_paramset2,
	                                chrbdy_fixedpts_extraporder3_paramset2,&numbdypoints_fixedpts_extraporder3_paramset2,
	                                &bdy_extrap_order,
	                                &ind_distance_fixedpts,
	                                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width);    
	                        //distributing the values of the quasiset components of each process over an array lquasiset_ll0 defined globally. This array will be different for each process, in fact it will be zero everywhere except for a certain position (next to the one for the previous processor) containing the values of quasiset_ll of a specific process. This is repeated after each step of the evolution. 
	                        for (i=is_bdy_fixedpts_extraporder3_paramset2; i<ie_bdy_fixedpts_extraporder3_paramset2; i++)
	                        {
	                            lquasiset_tt0_fixedpts_extraporder3_paramset2           [i] = quasiset_tt_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_tchi0_fixedpts_extraporder3_paramset2         [i] = quasiset_tchi_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_txi0_fixedpts_extraporder3_paramset2          [i] = quasiset_txi_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_chichi0_fixedpts_extraporder3_paramset2       [i] = quasiset_chichi_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_chixi0_fixedpts_extraporder3_paramset2        [i] = quasiset_chixi_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_xixi0_fixedpts_extraporder3_paramset2         [i] = quasiset_xixi_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_trace0_fixedpts_extraporder3_paramset2        [i] = quasiset_trace_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_massdensity0_fixedpts_extraporder3_paramset2  [i] = quasiset_massdensity_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 [i] = quasiset_angmomdensityx_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 [i] = quasiset_angmomdensityy_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 [i] = quasiset_angmomdensityz_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                            lbdyphi0_fixedpts_extraporder3_paramset2                [i] = bdyphi_fixedpts_extraporder3_paramset2[i-is_bdy_fixedpts_extraporder3_paramset2];
	                        }   

	                        //PRINT BOUNDARY QUANTITIES
	                        // for each n,i point on the outer bdy, save sum{lquasisetll[n,i]}_allprocessors into quasisetll[n,i]
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder3_paramset2,          maxquasiset_tt0_fixedpts_extraporder3_paramset2,          basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder3_paramset2,        maxquasiset_tchi0_fixedpts_extraporder3_paramset2,        basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder3_paramset2,         maxquasiset_txi0_fixedpts_extraporder3_paramset2,         basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder3_paramset2,      maxquasiset_chichi0_fixedpts_extraporder3_paramset2,      basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder3_paramset2,       maxquasiset_chixi0_fixedpts_extraporder3_paramset2,       basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder3_paramset2,        maxquasiset_xixi0_fixedpts_extraporder3_paramset2,        basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder3_paramset2,       maxquasiset_trace0_fixedpts_extraporder3_paramset2,       basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder3_paramset2, maxquasiset_massdensity0_fixedpts_extraporder3_paramset2, basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2, maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2, basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2, maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2, basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2, maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2, basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder3_paramset2,               maxbdyphi0_fixedpts_extraporder3_paramset2,               basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MAX,MPI_COMM_WORLD);    
	                        MPI_Allreduce(lquasiset_tt0_fixedpts_extraporder3_paramset2,          minquasiset_tt0_fixedpts_extraporder3_paramset2,          basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_tchi0_fixedpts_extraporder3_paramset2,        minquasiset_tchi0_fixedpts_extraporder3_paramset2,        basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_txi0_fixedpts_extraporder3_paramset2,         minquasiset_txi0_fixedpts_extraporder3_paramset2,         basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chichi0_fixedpts_extraporder3_paramset2,      minquasiset_chichi0_fixedpts_extraporder3_paramset2,      basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_chixi0_fixedpts_extraporder3_paramset2,       minquasiset_chixi0_fixedpts_extraporder3_paramset2,       basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_xixi0_fixedpts_extraporder3_paramset2,        minquasiset_xixi0_fixedpts_extraporder3_paramset2,        basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_trace0_fixedpts_extraporder3_paramset2,       minquasiset_trace0_fixedpts_extraporder3_paramset2,       basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_massdensity0_fixedpts_extraporder3_paramset2, minquasiset_massdensity0_fixedpts_extraporder3_paramset2, basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2, minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2, basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2, minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2, basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2, minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2, basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);
	                        MPI_Allreduce(lbdyphi0_fixedpts_extraporder3_paramset2,               minbdyphi0_fixedpts_extraporder3_paramset2,               basenumbdypoints_fixedpts_extraporder3_paramset2,MPI_DOUBLE,MPI_MIN,MPI_COMM_WORLD);    
	                        for (i=0; i<basenumbdypoints_fixedpts_extraporder3_paramset2; i++)
	                        { 
	                            if (uniSize>1)
	                            {
	                                    quasiset_tt0_fixedpts_extraporder3_paramset2          [i] = maxquasiset_tt0_fixedpts_extraporder3_paramset2          [i] + minquasiset_tt0_fixedpts_extraporder3_paramset2          [i];
	                                    quasiset_tchi0_fixedpts_extraporder3_paramset2        [i] = maxquasiset_tchi0_fixedpts_extraporder3_paramset2        [i] + minquasiset_tchi0_fixedpts_extraporder3_paramset2        [i];
	                                    quasiset_txi0_fixedpts_extraporder3_paramset2         [i] = maxquasiset_txi0_fixedpts_extraporder3_paramset2         [i] + minquasiset_txi0_fixedpts_extraporder3_paramset2         [i];
	                                    quasiset_chichi0_fixedpts_extraporder3_paramset2      [i] = maxquasiset_chichi0_fixedpts_extraporder3_paramset2      [i] + minquasiset_chichi0_fixedpts_extraporder3_paramset2      [i];
	                                    quasiset_chixi0_fixedpts_extraporder3_paramset2       [i] = maxquasiset_chixi0_fixedpts_extraporder3_paramset2       [i] + minquasiset_chixi0_fixedpts_extraporder3_paramset2       [i];
	                                    quasiset_xixi0_fixedpts_extraporder3_paramset2        [i] = maxquasiset_xixi0_fixedpts_extraporder3_paramset2        [i] + minquasiset_xixi0_fixedpts_extraporder3_paramset2        [i];
	                                    quasiset_trace0_fixedpts_extraporder3_paramset2       [i] = maxquasiset_trace0_fixedpts_extraporder3_paramset2       [i] + minquasiset_trace0_fixedpts_extraporder3_paramset2       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder3_paramset2 [i] = maxquasiset_massdensity0_fixedpts_extraporder3_paramset2 [i] + minquasiset_massdensity0_fixedpts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 [i] + minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 [i] + minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 [i] + minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 [i];
	                                    bdyphi0_fixedpts_extraporder3_paramset2               [i] = maxbdyphi0_fixedpts_extraporder3_paramset2               [i] + minbdyphi0_fixedpts_extraporder3_paramset2               [i];
	                                }
	                                else //if uniSize==1, i.e. there is only 1 process, maxquasiset=minquasiset so we have to take only one of them into consideration
	                                {
	                                    quasiset_tt0_fixedpts_extraporder3_paramset2          [i] = maxquasiset_tt0_fixedpts_extraporder3_paramset2          [i];
	                                    quasiset_tchi0_fixedpts_extraporder3_paramset2        [i] = maxquasiset_tchi0_fixedpts_extraporder3_paramset2        [i];
	                                    quasiset_txi0_fixedpts_extraporder3_paramset2         [i] = maxquasiset_txi0_fixedpts_extraporder3_paramset2         [i];
	                                    quasiset_chichi0_fixedpts_extraporder3_paramset2      [i] = maxquasiset_chichi0_fixedpts_extraporder3_paramset2      [i];
	                                    quasiset_chixi0_fixedpts_extraporder3_paramset2       [i] = maxquasiset_chixi0_fixedpts_extraporder3_paramset2       [i];
	                                    quasiset_xixi0_fixedpts_extraporder3_paramset2        [i] = maxquasiset_xixi0_fixedpts_extraporder3_paramset2        [i];
	                                    quasiset_trace0_fixedpts_extraporder3_paramset2       [i] = maxquasiset_trace0_fixedpts_extraporder3_paramset2       [i];
	                                    quasiset_massdensity0_fixedpts_extraporder3_paramset2 [i] = maxquasiset_massdensity0_fixedpts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2 [i];
	                                    quasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 [i] = maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2 [i];
	                                    bdyphi0_fixedpts_extraporder3_paramset2               [i] = maxbdyphi0_fixedpts_extraporder3_paramset2               [i];
	                                }  
	                        }              
	
	                        if (my_rank==0)
	                        {     
	                              
	
	                            if (timestep_ascii)
	                            {
	                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    								name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder3_paramset2[j],ypbdy0_fixedpts_extraporder3_paramset2[j],zpbdy0_fixedpts_extraporder3_paramset2[j],j);
                                    }
                                    fclose(fp);
                                    free(name); 
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_xext_yext_zext_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,xpbdy0_fixedpts_extraporder3_paramset2[j],ypbdy0_fixedpts_extraporder3_paramset2[j],zpbdy0_fixedpts_extraporder3_paramset2[j],j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }   
	                                if(output_outermostpts)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder3_paramset2[j],y_outermostpt0_fixedpts_extraporder3_paramset2[j],z_outermostpt0_fixedpts_extraporder3_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
	                                	if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                	{
	                                		size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
	                                    	sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_xout_yout_zout_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    	fp = fopen(name, "w+");
	                                    	j_red=0;
	                                    	for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
	                                    	{
	                                        	if ((j%reduction_factor_ascii)==0)
	                                        	{
	                                            	fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",ct,x_outermostpt0_fixedpts_extraporder3_paramset2[j],y_outermostpt0_fixedpts_extraporder3_paramset2[j],z_outermostpt0_fixedpts_extraporder3_paramset2[j],j_red);
	                                            	j_red=j_red+1;
	                                        	}
	                                    	}
	                                    	fclose(fp);
	                                    	free(name); 
	                                	}   
	                                }
	                                if(output_bdyphi)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    									name = malloc(size_name); 
                                    	sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder3_paramset2[j],j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
    										name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_bdyphi_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",ct,bdyphi0_fixedpts_extraporder3_paramset2[j],j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                } 
	                                }    

                                    // save quasiset_ll as ascii
                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   									name = malloc(size_name); 
                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
                                    fp = fopen(name, "w+");
                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
                                    {
                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %24.16e %i \n",
                                                    ct,
                                                    quasiset_tt0_fixedpts_extraporder3_paramset2[j],quasiset_tchi0_fixedpts_extraporder3_paramset2[j],quasiset_txi0_fixedpts_extraporder3_paramset2[j],quasiset_chichi0_fixedpts_extraporder3_paramset2[j],quasiset_chixi0_fixedpts_extraporder3_paramset2[j],quasiset_xixi0_fixedpts_extraporder3_paramset2[j],
                                                    j);
                                    }
                                    fclose(fp);
                                    free(name);  
	                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_quasisetll_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    j_red=0;
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
	                                    {
	                                        if ((j%reduction_factor_ascii)==0)
	                                        {
	                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e  %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_tt0_fixedpts_extraporder3_paramset2[j],quasiset_tchi0_fixedpts_extraporder3_paramset2[j],quasiset_txi0_fixedpts_extraporder3_paramset2[j],quasiset_chichi0_fixedpts_extraporder3_paramset2[j],quasiset_chixi0_fixedpts_extraporder3_paramset2[j],quasiset_xixi0_fixedpts_extraporder3_paramset2[j],
	                                                    j_red);
	                                            j_red=j_red+1;
	                                        }
	                                    }
	                                    fclose(fp);
	                                    free(name); 
	                                }
	                                if(output_bdytrace)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_trace0_fixedpts_extraporder3_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);    
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_quasisettrace_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_trace0_fixedpts_extraporder3_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if(output_bdymassdens)
	                                {
	                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
	                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_massdensity0_fixedpts_extraporder3_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);  
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_quasisetmassdensity_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_massdensity0_fixedpts_extraporder3_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }
		                            if (output_bdyangmomdens)
		                            {
		                            	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   										name = malloc(size_name); 
		                            	sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
	                                    fp = fopen(name, "w+");
	                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
	                                    {
	                                        fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
	                                                    ct,
	                                                    quasiset_angmomdensityx0_fixedpts_extraporder3_paramset2[j],quasiset_angmomdensityy0_fixedpts_extraporder3_paramset2[j],quasiset_angmomdensityz0_fixedpts_extraporder3_paramset2[j],
	                                                    j);
	                                    }
	                                    fclose(fp);
	                                    free(name);   
		                                if ((reduced_ascii) && (reduction_factor_ascii!=0))
		                                {
		                                	size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps) + 1;
   											name = malloc(size_name); 
		                                    sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_reduced_%st_quasisetangmomdensityxyz_indbdypoint_tstep%d.txt",AMRD_save_tag,lsteps);
		                                    fp = fopen(name, "w+");
		                                    j_red=0;
		                                    for( j = 0; j < basenumbdypoints_fixedpts_extraporder3_paramset2; j++ )
		                                    {
		                                        if ((j%reduction_factor_ascii)==0)
		                                        {
		                                            fprintf(fp,"%24.16e %24.16e %24.16e %24.16e %i \n",
		                                                    ct,
		                                                    quasiset_angmomdensityx0_fixedpts_extraporder3_paramset2[j],quasiset_angmomdensityy0_fixedpts_extraporder3_paramset2[j],quasiset_angmomdensityz0_fixedpts_extraporder3_paramset2[j],
		                                                    j_red);
		                                            j_red=j_red+1;
		                                        }
		                                    }
		                                    fclose(fp);
		                                    free(name); 
		                                }
		                            }   
	
	
	                            } //closes if (timestep_ascii) condition          
	                        } //closes if (my_rank==0) condition    
	
	                        //the following bit computes and prints AdS_mass0 (see below) if we're running on only 1 process
	                        if (output_AdS_mass)
	                        { 
	                            if (uniSize>1)
	                            {
	                                if (my_rank==0) printf("\nTHE COMPUTATION OF AdS MASS ON MORE THAN 1 PROCESS IS NOT RELIABLE...NOT COMPUTING AdS MASS\n");
	                            }
	                            else //i.e. we're running on only 1 process
	                            {
	                                printf("\nRUNNING ON ONLY 1 PROCESS...THE NUMERICAL APPROXIMATION OF AdS MASS IS RELIABLE ON 1 PROCESS...COMPUTING AdS MASS\n");      
	                                *rhobdy0_fixedpts_extraporder3_paramset2=1;
	                                chibdy_xibdy_(chibdy0_fixedpts_extraporder3_paramset2,xibdy0_fixedpts_extraporder3_paramset2,xpbdy0_fixedpts_extraporder3_paramset2,ypbdy0_fixedpts_extraporder3_paramset2,zpbdy0_fixedpts_extraporder3_paramset2,&basenumbdypoints_fixedpts_extraporder3_paramset2,chiextrap0_fixedpts_extraporder3_paramset2,xiextrap0_fixedpts_extraporder3_paramset2,&basebdy_Nchi_fixedpts_extraporder3_paramset2,&basebdy_Nxi_fixedpts_extraporder3_paramset2);    
	                                doubleintegralonsphere_(AdS_mass0_fixedpts_extraporder3_paramset2,quasiset_massdensity0_fixedpts_extraporder3_paramset2,xpbdy0_fixedpts_extraporder3_paramset2,ypbdy0_fixedpts_extraporder3_paramset2,zpbdy0_fixedpts_extraporder3_paramset2,&basenumbdypoints_fixedpts_extraporder3_paramset2,rhobdy0_fixedpts_extraporder3_paramset2,chibdy0_fixedpts_extraporder3_paramset2,xibdy0_fixedpts_extraporder3_paramset2,&basebdy_Nchi_fixedpts_extraporder3_paramset2,&basebdy_Nxi_fixedpts_extraporder3_paramset2);          
	                                
	                                size_name = snprintf(NULL, 0, "AdSbdy_fixedpts_extraporder3_paramset2_%st_AdSmass.txt",AMRD_save_tag) + 1;
   									name = malloc(size_name); 
	                                sprintf(name,"AdSbdy_fixedpts_extraporder3_paramset2_%st_AdSmass.txt",AMRD_save_tag);
	                                fp = fopen(name, "a+");
	                                fprintf(fp,"%24.16e %24.16e \n",ct,*AdS_mass0_fixedpts_extraporder3_paramset2);
	                                fclose(fp);
	                                free(name); 
	                            }
	                        }     

	                        free(vecbdypoints_fixedpts_extraporder3_paramset2);
	                        free(dsplsbdypoints_fixedpts_extraporder3_paramset2);
	                        free(quasiset_tt_fixedpts_extraporder3_paramset2);
	                        free(quasiset_tchi_fixedpts_extraporder3_paramset2);
	                        free(quasiset_txi_fixedpts_extraporder3_paramset2);
	                        free(quasiset_chichi_fixedpts_extraporder3_paramset2);
	                        free(quasiset_chixi_fixedpts_extraporder3_paramset2);
	                        free(quasiset_xixi_fixedpts_extraporder3_paramset2);
	                        free(quasiset_trace_fixedpts_extraporder3_paramset2);
	                        free(quasiset_massdensity_fixedpts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityx_fixedpts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityy_fixedpts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityz_fixedpts_extraporder3_paramset2);
	                        free(bdyphi_fixedpts_extraporder3_paramset2);  
	                        free(xpbdy_fixedpts_extraporder3_paramset2);
	                        free(ypbdy_fixedpts_extraporder3_paramset2);
	                        free(zpbdy_fixedpts_extraporder3_paramset2);   
	                        free(x_outermostpt_fixedpts_extraporder3_paramset2);
	                        free(y_outermostpt_fixedpts_extraporder3_paramset2);
	                        free(z_outermostpt_fixedpts_extraporder3_paramset2);   
	
	                        free(lquasiset_tt0_fixedpts_extraporder3_paramset2);        
	                        free(lquasiset_tchi0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_txi0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_chichi0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_chixi0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_xixi0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_trace0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_massdensity0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2);
	                        free(lquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2);
	                        free(lbdyphi0_fixedpts_extraporder3_paramset2);      
	                        free(maxquasiset_tt0_fixedpts_extraporder3_paramset2);        
	                        free(maxquasiset_tchi0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_txi0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_chichi0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_chixi0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_xixi0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_trace0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_massdensity0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2);
	                        free(maxquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2);
	                        free(maxbdyphi0_fixedpts_extraporder3_paramset2);    
	                        free(minquasiset_tt0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_tchi0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_txi0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_chichi0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_chixi0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_xixi0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_trace0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_massdensity0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_angmomdensityx0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_angmomdensityy0_fixedpts_extraporder3_paramset2);
	                        free(minquasiset_angmomdensityz0_fixedpts_extraporder3_paramset2);
	                        free(minbdyphi0_fixedpts_extraporder3_paramset2);    
	                        free(quasiset_tt0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_tchi0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_txi0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_chichi0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_chixi0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_xixi0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_trace0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_massdensity0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityx0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityy0_fixedpts_extraporder3_paramset2);
	                        free(quasiset_angmomdensityz0_fixedpts_extraporder3_paramset2);
	                        free(bdyphi0_fixedpts_extraporder3_paramset2);
	                        free(AdS_mass0_fixedpts_extraporder3_paramset2);     
	                        free(xpbdy0_fixedpts_extraporder3_paramset2);
	                        free(ypbdy0_fixedpts_extraporder3_paramset2);
	                        free(zpbdy0_fixedpts_extraporder3_paramset2);
	                        free(x_outermostpt0_fixedpts_extraporder3_paramset2);
	                        free(y_outermostpt0_fixedpts_extraporder3_paramset2);
	                        free(z_outermostpt0_fixedpts_extraporder3_paramset2);  
	
	                        if (output_AdS_mass)
	                        {
	                            free(rhoextrap0_fixedpts_extraporder3_paramset2);
	                            free(chiextrap0_fixedpts_extraporder3_paramset2);
	                            free(xiextrap0_fixedpts_extraporder3_paramset2);             
	                            free(rhobdy0_fixedpts_extraporder3_paramset2);
	                            free(chibdy0_fixedpts_extraporder3_paramset2);
	                            free(xibdy0_fixedpts_extraporder3_paramset2);    
	                        }   
                		}//closes condition on output_bdy_extraporder3_paramset2

                		//MPI_Barrier(MPI_COMM_WORLD);
						//if (my_rank==0) {printf("pre_io_calc: post_fixedpts 3rd order extrap paramset2\n"); fflush(stdout);}
	
		        	}//closes condition on bdy_extrap_fixedpts		        	


	 
	        	}//closes condition on lsteps==0
	        } //closes condition on output_bdyquantities 

	    }//closes condition on (g_L==bdy_L)&& (fabs(coarse_t-ct)<pow(10,-10)))

        if (output_ires)
        {   
            ires_(efe_all_ires,
                efe_tt_ires,efe_tx_ires,efe_ty_ires,
                efe_tz_ires,
                efe_xx_ires,efe_xy_ires,
                efe_xz_ires,
                efe_yy_ires,
                efe_yz_ires,
                efe_zz_ires,
                kg_ires,
                gb_tt_np1,gb_tt_n,gb_tt_nm1,
                gb_tx_np1,gb_tx_n,gb_tx_nm1,
                gb_ty_np1,gb_ty_n,gb_ty_nm1,
                gb_tz_np1,gb_tz_n,gb_tz_nm1,
                gb_xx_np1,gb_xx_n,gb_xx_nm1,
                gb_xy_np1,gb_xy_n,gb_xy_nm1,
                gb_xz_np1,gb_xz_n,gb_xz_nm1,
                gb_yy_np1,gb_yy_n,gb_yy_nm1,
                gb_yz_np1,gb_yz_n,gb_yz_nm1,
                gb_zz_np1,gb_zz_n,gb_zz_nm1,
                Hb_t_np1,Hb_t_n,Hb_t_nm1,
                Hb_x_np1,Hb_x_n,Hb_x_nm1,
                Hb_y_np1,Hb_y_n,Hb_y_nm1,
                Hb_z_np1,Hb_z_n,Hb_z_nm1,
                phi1_np1,phi1_n,phi1_nm1,
                x,y,z,&dt,chr,&AdS_L,&AMRD_ex,&Nx,&Ny,&Nz,phys_bdy,ghost_width,
                &ief_bh_r0,&a_rot0,&kerrads_background);    
        }   
    } //closes condition on ct==0  